function _mergeNamespaces(s,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in s)){const o=Object.getOwnPropertyDescriptor(n,i);o&&Object.defineProperty(s,i,o.get?o:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();function getDefaultExportFromCjs(s){return s&&s.__esModule&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s}function getAugmentedNamespace(s){if(Object.prototype.hasOwnProperty.call(s,"__esModule"))return s;var e=s.default;if(typeof e=="function"){var t=function n(){return this instanceof n?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(s).forEach(function(n){var i=Object.getOwnPropertyDescriptor(s,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return s[n]}})}),t}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production_min;function requireReact_production_min(){if(hasRequiredReact_production_min)return react_production_min;hasRequiredReact_production_min=1;var s=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),a=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),f=Symbol.iterator;function m(D){return D===null||typeof D!="object"?null:(D=f&&D[f]||D["@@iterator"],typeof D=="function"?D:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,x={};function E(D,U,$){this.props=D,this.context=U,this.refs=x,this.updater=$||v}E.prototype.isReactComponent={},E.prototype.setState=function(D,U){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,U,"setState")},E.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function b(){}b.prototype=E.prototype;function _(D,U,$){this.props=D,this.context=U,this.refs=x,this.updater=$||v}var S=_.prototype=new b;S.constructor=_,g(S,E.prototype),S.isPureReactComponent=!0;var C=Array.isArray,A=Object.prototype.hasOwnProperty,R={current:null},L={key:!0,ref:!0,__self:!0,__source:!0};function j(D,U,$){var q,V={},P=null,O=null;if(U!=null)for(q in U.ref!==void 0&&(O=U.ref),U.key!==void 0&&(P=""+U.key),U)A.call(U,q)&&!L.hasOwnProperty(q)&&(V[q]=U[q]);var B=arguments.length-2;if(B===1)V.children=$;else if(1<B){for(var G=Array(B),Y=0;Y<B;Y++)G[Y]=arguments[Y+2];V.children=G}if(D&&D.defaultProps)for(q in B=D.defaultProps,B)V[q]===void 0&&(V[q]=B[q]);return{$$typeof:s,type:D,key:P,ref:O,props:V,_owner:R.current}}function F(D,U){return{$$typeof:s,type:D.type,key:U,ref:D.ref,props:D.props,_owner:D._owner}}function W(D){return typeof D=="object"&&D!==null&&D.$$typeof===s}function K(D){var U={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function($){return U[$]})}var ee=/\/+/g;function te(D,U){return typeof D=="object"&&D!==null&&D.key!=null?K(""+D.key):U.toString(36)}function re(D,U,$,q,V){var P=typeof D;(P==="undefined"||P==="boolean")&&(D=null);var O=!1;if(D===null)O=!0;else switch(P){case"string":case"number":O=!0;break;case"object":switch(D.$$typeof){case s:case e:O=!0}}if(O)return O=D,V=V(O),D=q===""?"."+te(O,0):q,C(V)?($="",D!=null&&($=D.replace(ee,"$&/")+"/"),re(V,U,$,"",function(Y){return Y})):V!=null&&(W(V)&&(V=F(V,$+(!V.key||O&&O.key===V.key?"":(""+V.key).replace(ee,"$&/")+"/")+D)),U.push(V)),1;if(O=0,q=q===""?".":q+":",C(D))for(var B=0;B<D.length;B++){P=D[B];var G=q+te(P,B);O+=re(P,U,$,G,V)}else if(G=m(D),typeof G=="function")for(D=G.call(D),B=0;!(P=D.next()).done;)P=P.value,G=q+te(P,B++),O+=re(P,U,$,G,V);else if(P==="object")throw U=String(D),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.");return O}function ie(D,U,$){if(D==null)return D;var q=[],V=0;return re(D,q,"","",function(P){return U.call($,P,V++)}),q}function Q(D){if(D._status===-1){var U=D._result;U=U(),U.then(function($){(D._status===0||D._status===-1)&&(D._status=1,D._result=$)},function($){(D._status===0||D._status===-1)&&(D._status=2,D._result=$)}),D._status===-1&&(D._status=0,D._result=U)}if(D._status===1)return D._result.default;throw D._result}var z={current:null},N={transition:null},k={ReactCurrentDispatcher:z,ReactCurrentBatchConfig:N,ReactCurrentOwner:R};function I(){throw Error("act(...) is not supported in production builds of React.")}return react_production_min.Children={map:ie,forEach:function(D,U,$){ie(D,function(){U.apply(this,arguments)},$)},count:function(D){var U=0;return ie(D,function(){U++}),U},toArray:function(D){return ie(D,function(U){return U})||[]},only:function(D){if(!W(D))throw Error("React.Children.only expected to receive a single React element child.");return D}},react_production_min.Component=E,react_production_min.Fragment=t,react_production_min.Profiler=i,react_production_min.PureComponent=_,react_production_min.StrictMode=n,react_production_min.Suspense=h,react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=k,react_production_min.act=I,react_production_min.cloneElement=function(D,U,$){if(D==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+D+".");var q=g({},D.props),V=D.key,P=D.ref,O=D._owner;if(U!=null){if(U.ref!==void 0&&(P=U.ref,O=R.current),U.key!==void 0&&(V=""+U.key),D.type&&D.type.defaultProps)var B=D.type.defaultProps;for(G in U)A.call(U,G)&&!L.hasOwnProperty(G)&&(q[G]=U[G]===void 0&&B!==void 0?B[G]:U[G])}var G=arguments.length-2;if(G===1)q.children=$;else if(1<G){B=Array(G);for(var Y=0;Y<G;Y++)B[Y]=arguments[Y+2];q.children=B}return{$$typeof:s,type:D.type,key:V,ref:P,props:q,_owner:O}},react_production_min.createContext=function(D){return D={$$typeof:a,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},D.Provider={$$typeof:o,_context:D},D.Consumer=D},react_production_min.createElement=j,react_production_min.createFactory=function(D){var U=j.bind(null,D);return U.type=D,U},react_production_min.createRef=function(){return{current:null}},react_production_min.forwardRef=function(D){return{$$typeof:l,render:D}},react_production_min.isValidElement=W,react_production_min.lazy=function(D){return{$$typeof:u,_payload:{_status:-1,_result:D},_init:Q}},react_production_min.memo=function(D,U){return{$$typeof:d,type:D,compare:U===void 0?null:U}},react_production_min.startTransition=function(D){var U=N.transition;N.transition={};try{D()}finally{N.transition=U}},react_production_min.unstable_act=I,react_production_min.useCallback=function(D,U){return z.current.useCallback(D,U)},react_production_min.useContext=function(D){return z.current.useContext(D)},react_production_min.useDebugValue=function(){},react_production_min.useDeferredValue=function(D){return z.current.useDeferredValue(D)},react_production_min.useEffect=function(D,U){return z.current.useEffect(D,U)},react_production_min.useId=function(){return z.current.useId()},react_production_min.useImperativeHandle=function(D,U,$){return z.current.useImperativeHandle(D,U,$)},react_production_min.useInsertionEffect=function(D,U){return z.current.useInsertionEffect(D,U)},react_production_min.useLayoutEffect=function(D,U){return z.current.useLayoutEffect(D,U)},react_production_min.useMemo=function(D,U){return z.current.useMemo(D,U)},react_production_min.useReducer=function(D,U,$){return z.current.useReducer(D,U,$)},react_production_min.useRef=function(D){return z.current.useRef(D)},react_production_min.useState=function(D){return z.current.useState(D)},react_production_min.useSyncExternalStore=function(D,U,$){return z.current.useSyncExternalStore(D,U,$)},react_production_min.useTransition=function(){return z.current.useTransition()},react_production_min.version="18.3.1",react_production_min}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production_min()),react.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production_min;function requireReactJsxRuntime_production_min(){if(hasRequiredReactJsxRuntime_production_min)return reactJsxRuntime_production_min;hasRequiredReactJsxRuntime_production_min=1;var s=requireReact(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function a(l,h,d){var u,f={},m=null,v=null;d!==void 0&&(m=""+d),h.key!==void 0&&(m=""+h.key),h.ref!==void 0&&(v=h.ref);for(u in h)n.call(h,u)&&!o.hasOwnProperty(u)&&(f[u]=h[u]);if(l&&l.defaultProps)for(u in h=l.defaultProps,h)f[u]===void 0&&(f[u]=h[u]);return{$$typeof:e,type:l,key:m,ref:v,props:f,_owner:i.current}}return reactJsxRuntime_production_min.Fragment=t,reactJsxRuntime_production_min.jsx=a,reactJsxRuntime_production_min.jsxs=a,reactJsxRuntime_production_min}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production_min()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production_min;function requireScheduler_production_min(){return hasRequiredScheduler_production_min||(hasRequiredScheduler_production_min=1,(function(s){function e(N,k){var I=N.length;N.push(k);e:for(;0<I;){var D=I-1>>>1,U=N[D];if(0<i(U,k))N[D]=k,N[I]=U,I=D;else break e}}function t(N){return N.length===0?null:N[0]}function n(N){if(N.length===0)return null;var k=N[0],I=N.pop();if(I!==k){N[0]=I;e:for(var D=0,U=N.length,$=U>>>1;D<$;){var q=2*(D+1)-1,V=N[q],P=q+1,O=N[P];if(0>i(V,I))P<U&&0>i(O,V)?(N[D]=O,N[P]=I,D=P):(N[D]=V,N[q]=I,D=q);else if(P<U&&0>i(O,I))N[D]=O,N[P]=I,D=P;else break e}}return k}function i(N,k){var I=N.sortIndex-k.sortIndex;return I!==0?I:N.id-k.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;s.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();s.unstable_now=function(){return a.now()-l}}var h=[],d=[],u=1,f=null,m=3,v=!1,g=!1,x=!1,E=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(N){for(var k=t(d);k!==null;){if(k.callback===null)n(d);else if(k.startTime<=N)n(d),k.sortIndex=k.expirationTime,e(h,k);else break;k=t(d)}}function C(N){if(x=!1,S(N),!g)if(t(h)!==null)g=!0,Q(A);else{var k=t(d);k!==null&&z(C,k.startTime-N)}}function A(N,k){g=!1,x&&(x=!1,b(j),j=-1),v=!0;var I=m;try{for(S(k),f=t(h);f!==null&&(!(f.expirationTime>k)||N&&!K());){var D=f.callback;if(typeof D=="function"){f.callback=null,m=f.priorityLevel;var U=D(f.expirationTime<=k);k=s.unstable_now(),typeof U=="function"?f.callback=U:f===t(h)&&n(h),S(k)}else n(h);f=t(h)}if(f!==null)var $=!0;else{var q=t(d);q!==null&&z(C,q.startTime-k),$=!1}return $}finally{f=null,m=I,v=!1}}var R=!1,L=null,j=-1,F=5,W=-1;function K(){return!(s.unstable_now()-W<F)}function ee(){if(L!==null){var N=s.unstable_now();W=N;var k=!0;try{k=L(!0,N)}finally{k?te():(R=!1,L=null)}}else R=!1}var te;if(typeof _=="function")te=function(){_(ee)};else if(typeof MessageChannel<"u"){var re=new MessageChannel,ie=re.port2;re.port1.onmessage=ee,te=function(){ie.postMessage(null)}}else te=function(){E(ee,0)};function Q(N){L=N,R||(R=!0,te())}function z(N,k){j=E(function(){N(s.unstable_now())},k)}s.unstable_IdlePriority=5,s.unstable_ImmediatePriority=1,s.unstable_LowPriority=4,s.unstable_NormalPriority=3,s.unstable_Profiling=null,s.unstable_UserBlockingPriority=2,s.unstable_cancelCallback=function(N){N.callback=null},s.unstable_continueExecution=function(){g||v||(g=!0,Q(A))},s.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<N?Math.floor(1e3/N):5},s.unstable_getCurrentPriorityLevel=function(){return m},s.unstable_getFirstCallbackNode=function(){return t(h)},s.unstable_next=function(N){switch(m){case 1:case 2:case 3:var k=3;break;default:k=m}var I=m;m=k;try{return N()}finally{m=I}},s.unstable_pauseExecution=function(){},s.unstable_requestPaint=function(){},s.unstable_runWithPriority=function(N,k){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var I=m;m=N;try{return k()}finally{m=I}},s.unstable_scheduleCallback=function(N,k,I){var D=s.unstable_now();switch(typeof I=="object"&&I!==null?(I=I.delay,I=typeof I=="number"&&0<I?D+I:D):I=D,N){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=I+U,N={id:u++,callback:k,priorityLevel:N,startTime:I,expirationTime:U,sortIndex:-1},I>D?(N.sortIndex=I,e(d,N),t(h)===null&&N===t(d)&&(x?(b(j),j=-1):x=!0,z(C,I-D))):(N.sortIndex=U,e(h,N),g||v||(g=!0,Q(A))),N},s.unstable_shouldYield=K,s.unstable_wrapCallback=function(N){var k=m;return function(){var I=m;m=k;try{return N.apply(this,arguments)}finally{m=I}}}})(scheduler_production_min)),scheduler_production_min}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production_min()),scheduler.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production_min;function requireReactDom_production_min(){if(hasRequiredReactDom_production_min)return reactDom_production_min;hasRequiredReactDom_production_min=1;var s=requireReact(),e=requireScheduler();function t(c){for(var p="https://reactjs.org/docs/error-decoder.html?invariant="+c,y=1;y<arguments.length;y++)p+="&args[]="+encodeURIComponent(arguments[y]);return"Minified React error #"+c+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function o(c,p){a(c,p),a(c+"Capture",p)}function a(c,p){for(i[c]=p,c=0;c<p.length;c++)n.add(p[c])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,u={},f={};function m(c){return h.call(f,c)?!0:h.call(u,c)?!1:d.test(c)?f[c]=!0:(u[c]=!0,!1)}function v(c,p,y,w){if(y!==null&&y.type===0)return!1;switch(typeof p){case"function":case"symbol":return!0;case"boolean":return w?!1:y!==null?!y.acceptsBooleans:(c=c.toLowerCase().slice(0,5),c!=="data-"&&c!=="aria-");default:return!1}}function g(c,p,y,w){if(p===null||typeof p>"u"||v(c,p,y,w))return!0;if(w)return!1;if(y!==null)switch(y.type){case 3:return!p;case 4:return p===!1;case 5:return isNaN(p);case 6:return isNaN(p)||1>p}return!1}function x(c,p,y,w,T,M,H){this.acceptsBooleans=p===2||p===3||p===4,this.attributeName=w,this.attributeNamespace=T,this.mustUseProperty=y,this.propertyName=c,this.type=p,this.sanitizeURL=M,this.removeEmptyString=H}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(c){E[c]=new x(c,0,!1,c,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(c){var p=c[0];E[p]=new x(p,1,!1,c[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(c){E[c]=new x(c,2,!1,c.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(c){E[c]=new x(c,2,!1,c,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(c){E[c]=new x(c,3,!1,c.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(c){E[c]=new x(c,3,!0,c,null,!1,!1)}),["capture","download"].forEach(function(c){E[c]=new x(c,4,!1,c,null,!1,!1)}),["cols","rows","size","span"].forEach(function(c){E[c]=new x(c,6,!1,c,null,!1,!1)}),["rowSpan","start"].forEach(function(c){E[c]=new x(c,5,!1,c.toLowerCase(),null,!1,!1)});var b=/[\-:]([a-z])/g;function _(c){return c[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(c){var p=c.replace(b,_);E[p]=new x(p,1,!1,c,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(c){var p=c.replace(b,_);E[p]=new x(p,1,!1,c,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(c){var p=c.replace(b,_);E[p]=new x(p,1,!1,c,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(c){E[c]=new x(c,1,!1,c.toLowerCase(),null,!1,!1)}),E.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(c){E[c]=new x(c,1,!1,c.toLowerCase(),null,!0,!0)});function S(c,p,y,w){var T=E.hasOwnProperty(p)?E[p]:null;(T!==null?T.type!==0:w||!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(g(p,y,T,w)&&(y=null),w||T===null?m(p)&&(y===null?c.removeAttribute(p):c.setAttribute(p,""+y)):T.mustUseProperty?c[T.propertyName]=y===null?T.type===3?!1:"":y:(p=T.attributeName,w=T.attributeNamespace,y===null?c.removeAttribute(p):(T=T.type,y=T===3||T===4&&y===!0?"":""+y,w?c.setAttributeNS(w,p,y):c.setAttribute(p,y))))}var C=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,A=Symbol.for("react.element"),R=Symbol.for("react.portal"),L=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),F=Symbol.for("react.profiler"),W=Symbol.for("react.provider"),K=Symbol.for("react.context"),ee=Symbol.for("react.forward_ref"),te=Symbol.for("react.suspense"),re=Symbol.for("react.suspense_list"),ie=Symbol.for("react.memo"),Q=Symbol.for("react.lazy"),z=Symbol.for("react.offscreen"),N=Symbol.iterator;function k(c){return c===null||typeof c!="object"?null:(c=N&&c[N]||c["@@iterator"],typeof c=="function"?c:null)}var I=Object.assign,D;function U(c){if(D===void 0)try{throw Error()}catch(y){var p=y.stack.trim().match(/\n( *(at )?)/);D=p&&p[1]||""}return`
`+D+c}var $=!1;function q(c,p){if(!c||$)return"";$=!0;var y=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(p)if(p=function(){throw Error()},Object.defineProperty(p.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(p,[])}catch(ge){var w=ge}Reflect.construct(c,[],p)}else{try{p.call()}catch(ge){w=ge}c.call(p.prototype)}else{try{throw Error()}catch(ge){w=ge}c()}}catch(ge){if(ge&&w&&typeof ge.stack=="string"){for(var T=ge.stack.split(`
`),M=w.stack.split(`
`),H=T.length-1,ne=M.length-1;1<=H&&0<=ne&&T[H]!==M[ne];)ne--;for(;1<=H&&0<=ne;H--,ne--)if(T[H]!==M[ne]){if(H!==1||ne!==1)do if(H--,ne--,0>ne||T[H]!==M[ne]){var se=`
`+T[H].replace(" at new "," at ");return c.displayName&&se.includes("<anonymous>")&&(se=se.replace("<anonymous>",c.displayName)),se}while(1<=H&&0<=ne);break}}}finally{$=!1,Error.prepareStackTrace=y}return(c=c?c.displayName||c.name:"")?U(c):""}function V(c){switch(c.tag){case 5:return U(c.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return c=q(c.type,!1),c;case 11:return c=q(c.type.render,!1),c;case 1:return c=q(c.type,!0),c;default:return""}}function P(c){if(c==null)return null;if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c;switch(c){case L:return"Fragment";case R:return"Portal";case F:return"Profiler";case j:return"StrictMode";case te:return"Suspense";case re:return"SuspenseList"}if(typeof c=="object")switch(c.$$typeof){case K:return(c.displayName||"Context")+".Consumer";case W:return(c._context.displayName||"Context")+".Provider";case ee:var p=c.render;return c=c.displayName,c||(c=p.displayName||p.name||"",c=c!==""?"ForwardRef("+c+")":"ForwardRef"),c;case ie:return p=c.displayName||null,p!==null?p:P(c.type)||"Memo";case Q:p=c._payload,c=c._init;try{return P(c(p))}catch{}}return null}function O(c){var p=c.type;switch(c.tag){case 24:return"Cache";case 9:return(p.displayName||"Context")+".Consumer";case 10:return(p._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return c=p.render,c=c.displayName||c.name||"",p.displayName||(c!==""?"ForwardRef("+c+")":"ForwardRef");case 7:return"Fragment";case 5:return p;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return P(p);case 8:return p===j?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p}return null}function B(c){switch(typeof c){case"boolean":case"number":case"string":case"undefined":return c;case"object":return c;default:return""}}function G(c){var p=c.type;return(c=c.nodeName)&&c.toLowerCase()==="input"&&(p==="checkbox"||p==="radio")}function Y(c){var p=G(c)?"checked":"value",y=Object.getOwnPropertyDescriptor(c.constructor.prototype,p),w=""+c[p];if(!c.hasOwnProperty(p)&&typeof y<"u"&&typeof y.get=="function"&&typeof y.set=="function"){var T=y.get,M=y.set;return Object.defineProperty(c,p,{configurable:!0,get:function(){return T.call(this)},set:function(H){w=""+H,M.call(this,H)}}),Object.defineProperty(c,p,{enumerable:y.enumerable}),{getValue:function(){return w},setValue:function(H){w=""+H},stopTracking:function(){c._valueTracker=null,delete c[p]}}}}function J(c){c._valueTracker||(c._valueTracker=Y(c))}function Z(c){if(!c)return!1;var p=c._valueTracker;if(!p)return!0;var y=p.getValue(),w="";return c&&(w=G(c)?c.checked?"true":"false":c.value),c=w,c!==y?(p.setValue(c),!0):!1}function oe(c){if(c=c||(typeof document<"u"?document:void 0),typeof c>"u")return null;try{return c.activeElement||c.body}catch{return c.body}}function ve(c,p){var y=p.checked;return I({},p,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:y??c._wrapperState.initialChecked})}function ce(c,p){var y=p.defaultValue==null?"":p.defaultValue,w=p.checked!=null?p.checked:p.defaultChecked;y=B(p.value!=null?p.value:y),c._wrapperState={initialChecked:w,initialValue:y,controlled:p.type==="checkbox"||p.type==="radio"?p.checked!=null:p.value!=null}}function ue(c,p){p=p.checked,p!=null&&S(c,"checked",p,!1)}function de(c,p){ue(c,p);var y=B(p.value),w=p.type;if(y!=null)w==="number"?(y===0&&c.value===""||c.value!=y)&&(c.value=""+y):c.value!==""+y&&(c.value=""+y);else if(w==="submit"||w==="reset"){c.removeAttribute("value");return}p.hasOwnProperty("value")?ye(c,p.type,y):p.hasOwnProperty("defaultValue")&&ye(c,p.type,B(p.defaultValue)),p.checked==null&&p.defaultChecked!=null&&(c.defaultChecked=!!p.defaultChecked)}function pe(c,p,y){if(p.hasOwnProperty("value")||p.hasOwnProperty("defaultValue")){var w=p.type;if(!(w!=="submit"&&w!=="reset"||p.value!==void 0&&p.value!==null))return;p=""+c._wrapperState.initialValue,y||p===c.value||(c.value=p),c.defaultValue=p}y=c.name,y!==""&&(c.name=""),c.defaultChecked=!!c._wrapperState.initialChecked,y!==""&&(c.name=y)}function ye(c,p,y){(p!=="number"||oe(c.ownerDocument)!==c)&&(y==null?c.defaultValue=""+c._wrapperState.initialValue:c.defaultValue!==""+y&&(c.defaultValue=""+y))}var Ae=Array.isArray;function Ce(c,p,y,w){if(c=c.options,p){p={};for(var T=0;T<y.length;T++)p["$"+y[T]]=!0;for(y=0;y<c.length;y++)T=p.hasOwnProperty("$"+c[y].value),c[y].selected!==T&&(c[y].selected=T),T&&w&&(c[y].defaultSelected=!0)}else{for(y=""+B(y),p=null,T=0;T<c.length;T++){if(c[T].value===y){c[T].selected=!0,w&&(c[T].defaultSelected=!0);return}p!==null||c[T].disabled||(p=c[T])}p!==null&&(p.selected=!0)}}function Pe(c,p){if(p.dangerouslySetInnerHTML!=null)throw Error(t(91));return I({},p,{value:void 0,defaultValue:void 0,children:""+c._wrapperState.initialValue})}function Oe(c,p){var y=p.value;if(y==null){if(y=p.children,p=p.defaultValue,y!=null){if(p!=null)throw Error(t(92));if(Ae(y)){if(1<y.length)throw Error(t(93));y=y[0]}p=y}p==null&&(p=""),y=p}c._wrapperState={initialValue:B(y)}}function xe(c,p){var y=B(p.value),w=B(p.defaultValue);y!=null&&(y=""+y,y!==c.value&&(c.value=y),p.defaultValue==null&&c.defaultValue!==y&&(c.defaultValue=y)),w!=null&&(c.defaultValue=""+w)}function Te(c){var p=c.textContent;p===c._wrapperState.initialValue&&p!==""&&p!==null&&(c.value=p)}function $e(c){switch(c){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ue(c,p){return c==null||c==="http://www.w3.org/1999/xhtml"?$e(p):c==="http://www.w3.org/2000/svg"&&p==="foreignObject"?"http://www.w3.org/1999/xhtml":c}var qe,Ke=(function(c){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(p,y,w,T){MSApp.execUnsafeLocalFunction(function(){return c(p,y,w,T)})}:c})(function(c,p){if(c.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in c)c.innerHTML=p;else{for(qe=qe||document.createElement("div"),qe.innerHTML="<svg>"+p.valueOf().toString()+"</svg>",p=qe.firstChild;c.firstChild;)c.removeChild(c.firstChild);for(;p.firstChild;)c.appendChild(p.firstChild)}});function Ge(c,p){if(p){var y=c.firstChild;if(y&&y===c.lastChild&&y.nodeType===3){y.nodeValue=p;return}}c.textContent=p}var xt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ut=["Webkit","ms","Moz","O"];Object.keys(xt).forEach(function(c){ut.forEach(function(p){p=p+c.charAt(0).toUpperCase()+c.substring(1),xt[p]=xt[c]})});function Ot(c,p,y){return p==null||typeof p=="boolean"||p===""?"":y||typeof p!="number"||p===0||xt.hasOwnProperty(c)&&xt[c]?(""+p).trim():p+"px"}function be(c,p){c=c.style;for(var y in p)if(p.hasOwnProperty(y)){var w=y.indexOf("--")===0,T=Ot(y,p[y],w);y==="float"&&(y="cssFloat"),w?c.setProperty(y,T):c[y]=T}}var he=I({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function le(c,p){if(p){if(he[c]&&(p.children!=null||p.dangerouslySetInnerHTML!=null))throw Error(t(137,c));if(p.dangerouslySetInnerHTML!=null){if(p.children!=null)throw Error(t(60));if(typeof p.dangerouslySetInnerHTML!="object"||!("__html"in p.dangerouslySetInnerHTML))throw Error(t(61))}if(p.style!=null&&typeof p.style!="object")throw Error(t(62))}}function Re(c,p){if(c.indexOf("-")===-1)return typeof p.is=="string";switch(c){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ze=null;function He(c){return c=c.target||c.srcElement||window,c.correspondingUseElement&&(c=c.correspondingUseElement),c.nodeType===3?c.parentNode:c}var st=null,Mt=null,Tt=null;function $t(c){if(c=$r(c)){if(typeof st!="function")throw Error(t(280));var p=c.stateNode;p&&(p=ws(p),st(c.stateNode,c.type,p))}}function Le(c){Mt?Tt?Tt.push(c):Tt=[c]:Mt=c}function Ye(){if(Mt){var c=Mt,p=Tt;if(Tt=Mt=null,$t(c),p)for(c=0;c<p.length;c++)$t(p[c])}}function Je(c,p){return c(p)}function dt(){}var Qe=!1;function et(c,p,y){if(Qe)return c(p,y);Qe=!0;try{return Je(c,p,y)}finally{Qe=!1,(Mt!==null||Tt!==null)&&(dt(),Ye())}}function it(c,p){var y=c.stateNode;if(y===null)return null;var w=ws(y);if(w===null)return null;y=w[p];e:switch(p){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(w=!w.disabled)||(c=c.type,w=!(c==="button"||c==="input"||c==="select"||c==="textarea")),c=!w;break e;default:c=!1}if(c)return null;if(y&&typeof y!="function")throw Error(t(231,p,typeof y));return y}var Wt=!1;if(l)try{var ht={};Object.defineProperty(ht,"passive",{get:function(){Wt=!0}}),window.addEventListener("test",ht,ht),window.removeEventListener("test",ht,ht)}catch{Wt=!1}function gt(c,p,y,w,T,M,H,ne,se){var ge=Array.prototype.slice.call(arguments,3);try{p.apply(y,ge)}catch(we){this.onError(we)}}var lt=!1,bt=null,fn=!1,ai=null,Ec={onError:function(c){lt=!0,bt=c}};function wc(c,p,y,w,T,M,H,ne,se){lt=!1,bt=null,gt.apply(Ec,arguments)}function _c(c,p,y,w,T,M,H,ne,se){if(wc.apply(this,arguments),lt){if(lt){var ge=bt;lt=!1,bt=null}else throw Error(t(198));fn||(fn=!0,ai=ge)}}function Un(c){var p=c,y=c;if(c.alternate)for(;p.return;)p=p.return;else{c=p;do p=c,(p.flags&4098)!==0&&(y=p.return),c=p.return;while(c)}return p.tag===3?y:null}function Vo(c){if(c.tag===13){var p=c.memoizedState;if(p===null&&(c=c.alternate,c!==null&&(p=c.memoizedState)),p!==null)return p.dehydrated}return null}function Ho(c){if(Un(c)!==c)throw Error(t(188))}function Ac(c){var p=c.alternate;if(!p){if(p=Un(c),p===null)throw Error(t(188));return p!==c?null:c}for(var y=c,w=p;;){var T=y.return;if(T===null)break;var M=T.alternate;if(M===null){if(w=T.return,w!==null){y=w;continue}break}if(T.child===M.child){for(M=T.child;M;){if(M===y)return Ho(T),c;if(M===w)return Ho(T),p;M=M.sibling}throw Error(t(188))}if(y.return!==w.return)y=T,w=M;else{for(var H=!1,ne=T.child;ne;){if(ne===y){H=!0,y=T,w=M;break}if(ne===w){H=!0,w=T,y=M;break}ne=ne.sibling}if(!H){for(ne=M.child;ne;){if(ne===y){H=!0,y=M,w=T;break}if(ne===w){H=!0,w=M,y=T;break}ne=ne.sibling}if(!H)throw Error(t(189))}}if(y.alternate!==w)throw Error(t(190))}if(y.tag!==3)throw Error(t(188));return y.stateNode.current===y?c:p}function Wo(c){return c=Ac(c),c!==null?Go(c):null}function Go(c){if(c.tag===5||c.tag===6)return c;for(c=c.child;c!==null;){var p=Go(c);if(p!==null)return p;c=c.sibling}return null}var qo=e.unstable_scheduleCallback,Ko=e.unstable_cancelCallback,Sc=e.unstable_shouldYield,Tc=e.unstable_requestPaint,ft=e.unstable_now,Cc=e.unstable_getCurrentPriorityLevel,li=e.unstable_ImmediatePriority,Xo=e.unstable_UserBlockingPriority,ns=e.unstable_NormalPriority,Rc=e.unstable_LowPriority,Yo=e.unstable_IdlePriority,rs=null,an=null;function Pc(c){if(an&&typeof an.onCommitFiberRoot=="function")try{an.onCommitFiberRoot(rs,c,void 0,(c.current.flags&128)===128)}catch{}}var Zt=Math.clz32?Math.clz32:Dc,kc=Math.log,Mc=Math.LN2;function Dc(c){return c>>>=0,c===0?32:31-(kc(c)/Mc|0)|0}var ss=64,is=4194304;function wr(c){switch(c&-c){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return c&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return c}}function os(c,p){var y=c.pendingLanes;if(y===0)return 0;var w=0,T=c.suspendedLanes,M=c.pingedLanes,H=y&268435455;if(H!==0){var ne=H&~T;ne!==0?w=wr(ne):(M&=H,M!==0&&(w=wr(M)))}else H=y&~T,H!==0?w=wr(H):M!==0&&(w=wr(M));if(w===0)return 0;if(p!==0&&p!==w&&(p&T)===0&&(T=w&-w,M=p&-p,T>=M||T===16&&(M&4194240)!==0))return p;if((w&4)!==0&&(w|=y&16),p=c.entangledLanes,p!==0)for(c=c.entanglements,p&=w;0<p;)y=31-Zt(p),T=1<<y,w|=c[y],p&=~T;return w}function Ic(c,p){switch(c){case 1:case 2:case 4:return p+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Oc(c,p){for(var y=c.suspendedLanes,w=c.pingedLanes,T=c.expirationTimes,M=c.pendingLanes;0<M;){var H=31-Zt(M),ne=1<<H,se=T[H];se===-1?((ne&y)===0||(ne&w)!==0)&&(T[H]=Ic(ne,p)):se<=p&&(c.expiredLanes|=ne),M&=~ne}}function ci(c){return c=c.pendingLanes&-1073741825,c!==0?c:c&1073741824?1073741824:0}function Jo(){var c=ss;return ss<<=1,(ss&4194240)===0&&(ss=64),c}function ui(c){for(var p=[],y=0;31>y;y++)p.push(c);return p}function _r(c,p,y){c.pendingLanes|=p,p!==536870912&&(c.suspendedLanes=0,c.pingedLanes=0),c=c.eventTimes,p=31-Zt(p),c[p]=y}function Nc(c,p){var y=c.pendingLanes&~p;c.pendingLanes=p,c.suspendedLanes=0,c.pingedLanes=0,c.expiredLanes&=p,c.mutableReadLanes&=p,c.entangledLanes&=p,p=c.entanglements;var w=c.eventTimes;for(c=c.expirationTimes;0<y;){var T=31-Zt(y),M=1<<T;p[T]=0,w[T]=-1,c[T]=-1,y&=~M}}function di(c,p){var y=c.entangledLanes|=p;for(c=c.entanglements;y;){var w=31-Zt(y),T=1<<w;T&p|c[w]&p&&(c[w]|=p),y&=~T}}var Xe=0;function Qo(c){return c&=-c,1<c?4<c?(c&268435455)!==0?16:536870912:4:1}var Zo,hi,ea,ta,na,fi=!1,as=[],wn=null,_n=null,An=null,Ar=new Map,Sr=new Map,Sn=[],Lc="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ra(c,p){switch(c){case"focusin":case"focusout":wn=null;break;case"dragenter":case"dragleave":_n=null;break;case"mouseover":case"mouseout":An=null;break;case"pointerover":case"pointerout":Ar.delete(p.pointerId);break;case"gotpointercapture":case"lostpointercapture":Sr.delete(p.pointerId)}}function Tr(c,p,y,w,T,M){return c===null||c.nativeEvent!==M?(c={blockedOn:p,domEventName:y,eventSystemFlags:w,nativeEvent:M,targetContainers:[T]},p!==null&&(p=$r(p),p!==null&&hi(p)),c):(c.eventSystemFlags|=w,p=c.targetContainers,T!==null&&p.indexOf(T)===-1&&p.push(T),c)}function Fc(c,p,y,w,T){switch(p){case"focusin":return wn=Tr(wn,c,p,y,w,T),!0;case"dragenter":return _n=Tr(_n,c,p,y,w,T),!0;case"mouseover":return An=Tr(An,c,p,y,w,T),!0;case"pointerover":var M=T.pointerId;return Ar.set(M,Tr(Ar.get(M)||null,c,p,y,w,T)),!0;case"gotpointercapture":return M=T.pointerId,Sr.set(M,Tr(Sr.get(M)||null,c,p,y,w,T)),!0}return!1}function sa(c){var p=zn(c.target);if(p!==null){var y=Un(p);if(y!==null){if(p=y.tag,p===13){if(p=Vo(y),p!==null){c.blockedOn=p,na(c.priority,function(){ea(y)});return}}else if(p===3&&y.stateNode.current.memoizedState.isDehydrated){c.blockedOn=y.tag===3?y.stateNode.containerInfo:null;return}}}c.blockedOn=null}function ls(c){if(c.blockedOn!==null)return!1;for(var p=c.targetContainers;0<p.length;){var y=mi(c.domEventName,c.eventSystemFlags,p[0],c.nativeEvent);if(y===null){y=c.nativeEvent;var w=new y.constructor(y.type,y);ze=w,y.target.dispatchEvent(w),ze=null}else return p=$r(y),p!==null&&hi(p),c.blockedOn=y,!1;p.shift()}return!0}function ia(c,p,y){ls(c)&&y.delete(p)}function jc(){fi=!1,wn!==null&&ls(wn)&&(wn=null),_n!==null&&ls(_n)&&(_n=null),An!==null&&ls(An)&&(An=null),Ar.forEach(ia),Sr.forEach(ia)}function Cr(c,p){c.blockedOn===p&&(c.blockedOn=null,fi||(fi=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,jc)))}function Rr(c){function p(T){return Cr(T,c)}if(0<as.length){Cr(as[0],c);for(var y=1;y<as.length;y++){var w=as[y];w.blockedOn===c&&(w.blockedOn=null)}}for(wn!==null&&Cr(wn,c),_n!==null&&Cr(_n,c),An!==null&&Cr(An,c),Ar.forEach(p),Sr.forEach(p),y=0;y<Sn.length;y++)w=Sn[y],w.blockedOn===c&&(w.blockedOn=null);for(;0<Sn.length&&(y=Sn[0],y.blockedOn===null);)sa(y),y.blockedOn===null&&Sn.shift()}var er=C.ReactCurrentBatchConfig,cs=!0;function Bc(c,p,y,w){var T=Xe,M=er.transition;er.transition=null;try{Xe=1,pi(c,p,y,w)}finally{Xe=T,er.transition=M}}function $c(c,p,y,w){var T=Xe,M=er.transition;er.transition=null;try{Xe=4,pi(c,p,y,w)}finally{Xe=T,er.transition=M}}function pi(c,p,y,w){if(cs){var T=mi(c,p,y,w);if(T===null)Di(c,p,w,us,y),ra(c,w);else if(Fc(T,c,p,y,w))w.stopPropagation();else if(ra(c,w),p&4&&-1<Lc.indexOf(c)){for(;T!==null;){var M=$r(T);if(M!==null&&Zo(M),M=mi(c,p,y,w),M===null&&Di(c,p,w,us,y),M===T)break;T=M}T!==null&&w.stopPropagation()}else Di(c,p,w,null,y)}}var us=null;function mi(c,p,y,w){if(us=null,c=He(w),c=zn(c),c!==null)if(p=Un(c),p===null)c=null;else if(y=p.tag,y===13){if(c=Vo(p),c!==null)return c;c=null}else if(y===3){if(p.stateNode.current.memoizedState.isDehydrated)return p.tag===3?p.stateNode.containerInfo:null;c=null}else p!==c&&(c=null);return us=c,null}function oa(c){switch(c){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Cc()){case li:return 1;case Xo:return 4;case ns:case Rc:return 16;case Yo:return 536870912;default:return 16}default:return 16}}var Tn=null,gi=null,ds=null;function aa(){if(ds)return ds;var c,p=gi,y=p.length,w,T="value"in Tn?Tn.value:Tn.textContent,M=T.length;for(c=0;c<y&&p[c]===T[c];c++);var H=y-c;for(w=1;w<=H&&p[y-w]===T[M-w];w++);return ds=T.slice(c,1<w?1-w:void 0)}function hs(c){var p=c.keyCode;return"charCode"in c?(c=c.charCode,c===0&&p===13&&(c=13)):c=p,c===10&&(c=13),32<=c||c===13?c:0}function fs(){return!0}function la(){return!1}function Ut(c){function p(y,w,T,M,H){this._reactName=y,this._targetInst=T,this.type=w,this.nativeEvent=M,this.target=H,this.currentTarget=null;for(var ne in c)c.hasOwnProperty(ne)&&(y=c[ne],this[ne]=y?y(M):M[ne]);return this.isDefaultPrevented=(M.defaultPrevented!=null?M.defaultPrevented:M.returnValue===!1)?fs:la,this.isPropagationStopped=la,this}return I(p.prototype,{preventDefault:function(){this.defaultPrevented=!0;var y=this.nativeEvent;y&&(y.preventDefault?y.preventDefault():typeof y.returnValue!="unknown"&&(y.returnValue=!1),this.isDefaultPrevented=fs)},stopPropagation:function(){var y=this.nativeEvent;y&&(y.stopPropagation?y.stopPropagation():typeof y.cancelBubble!="unknown"&&(y.cancelBubble=!0),this.isPropagationStopped=fs)},persist:function(){},isPersistent:fs}),p}var tr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(c){return c.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},vi=Ut(tr),Pr=I({},tr,{view:0,detail:0}),Uc=Ut(Pr),yi,xi,kr,ps=I({},Pr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ei,button:0,buttons:0,relatedTarget:function(c){return c.relatedTarget===void 0?c.fromElement===c.srcElement?c.toElement:c.fromElement:c.relatedTarget},movementX:function(c){return"movementX"in c?c.movementX:(c!==kr&&(kr&&c.type==="mousemove"?(yi=c.screenX-kr.screenX,xi=c.screenY-kr.screenY):xi=yi=0,kr=c),yi)},movementY:function(c){return"movementY"in c?c.movementY:xi}}),ca=Ut(ps),zc=I({},ps,{dataTransfer:0}),Vc=Ut(zc),Hc=I({},Pr,{relatedTarget:0}),bi=Ut(Hc),Wc=I({},tr,{animationName:0,elapsedTime:0,pseudoElement:0}),Gc=Ut(Wc),qc=I({},tr,{clipboardData:function(c){return"clipboardData"in c?c.clipboardData:window.clipboardData}}),Kc=Ut(qc),Xc=I({},tr,{data:0}),ua=Ut(Xc),Yc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Jc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Qc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Zc(c){var p=this.nativeEvent;return p.getModifierState?p.getModifierState(c):(c=Qc[c])?!!p[c]:!1}function Ei(){return Zc}var eu=I({},Pr,{key:function(c){if(c.key){var p=Yc[c.key]||c.key;if(p!=="Unidentified")return p}return c.type==="keypress"?(c=hs(c),c===13?"Enter":String.fromCharCode(c)):c.type==="keydown"||c.type==="keyup"?Jc[c.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ei,charCode:function(c){return c.type==="keypress"?hs(c):0},keyCode:function(c){return c.type==="keydown"||c.type==="keyup"?c.keyCode:0},which:function(c){return c.type==="keypress"?hs(c):c.type==="keydown"||c.type==="keyup"?c.keyCode:0}}),tu=Ut(eu),nu=I({},ps,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),da=Ut(nu),ru=I({},Pr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ei}),su=Ut(ru),iu=I({},tr,{propertyName:0,elapsedTime:0,pseudoElement:0}),ou=Ut(iu),au=I({},ps,{deltaX:function(c){return"deltaX"in c?c.deltaX:"wheelDeltaX"in c?-c.wheelDeltaX:0},deltaY:function(c){return"deltaY"in c?c.deltaY:"wheelDeltaY"in c?-c.wheelDeltaY:"wheelDelta"in c?-c.wheelDelta:0},deltaZ:0,deltaMode:0}),lu=Ut(au),cu=[9,13,27,32],wi=l&&"CompositionEvent"in window,Mr=null;l&&"documentMode"in document&&(Mr=document.documentMode);var uu=l&&"TextEvent"in window&&!Mr,ha=l&&(!wi||Mr&&8<Mr&&11>=Mr),fa=" ",pa=!1;function ma(c,p){switch(c){case"keyup":return cu.indexOf(p.keyCode)!==-1;case"keydown":return p.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ga(c){return c=c.detail,typeof c=="object"&&"data"in c?c.data:null}var nr=!1;function du(c,p){switch(c){case"compositionend":return ga(p);case"keypress":return p.which!==32?null:(pa=!0,fa);case"textInput":return c=p.data,c===fa&&pa?null:c;default:return null}}function hu(c,p){if(nr)return c==="compositionend"||!wi&&ma(c,p)?(c=aa(),ds=gi=Tn=null,nr=!1,c):null;switch(c){case"paste":return null;case"keypress":if(!(p.ctrlKey||p.altKey||p.metaKey)||p.ctrlKey&&p.altKey){if(p.char&&1<p.char.length)return p.char;if(p.which)return String.fromCharCode(p.which)}return null;case"compositionend":return ha&&p.locale!=="ko"?null:p.data;default:return null}}var fu={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function va(c){var p=c&&c.nodeName&&c.nodeName.toLowerCase();return p==="input"?!!fu[c.type]:p==="textarea"}function ya(c,p,y,w){Le(w),p=xs(p,"onChange"),0<p.length&&(y=new vi("onChange","change",null,y,w),c.push({event:y,listeners:p}))}var Dr=null,Ir=null;function pu(c){La(c,0)}function ms(c){var p=ar(c);if(Z(p))return c}function mu(c,p){if(c==="change")return p}var xa=!1;if(l){var _i;if(l){var Ai="oninput"in document;if(!Ai){var ba=document.createElement("div");ba.setAttribute("oninput","return;"),Ai=typeof ba.oninput=="function"}_i=Ai}else _i=!1;xa=_i&&(!document.documentMode||9<document.documentMode)}function Ea(){Dr&&(Dr.detachEvent("onpropertychange",wa),Ir=Dr=null)}function wa(c){if(c.propertyName==="value"&&ms(Ir)){var p=[];ya(p,Ir,c,He(c)),et(pu,p)}}function gu(c,p,y){c==="focusin"?(Ea(),Dr=p,Ir=y,Dr.attachEvent("onpropertychange",wa)):c==="focusout"&&Ea()}function vu(c){if(c==="selectionchange"||c==="keyup"||c==="keydown")return ms(Ir)}function yu(c,p){if(c==="click")return ms(p)}function xu(c,p){if(c==="input"||c==="change")return ms(p)}function bu(c,p){return c===p&&(c!==0||1/c===1/p)||c!==c&&p!==p}var en=typeof Object.is=="function"?Object.is:bu;function Or(c,p){if(en(c,p))return!0;if(typeof c!="object"||c===null||typeof p!="object"||p===null)return!1;var y=Object.keys(c),w=Object.keys(p);if(y.length!==w.length)return!1;for(w=0;w<y.length;w++){var T=y[w];if(!h.call(p,T)||!en(c[T],p[T]))return!1}return!0}function _a(c){for(;c&&c.firstChild;)c=c.firstChild;return c}function Aa(c,p){var y=_a(c);c=0;for(var w;y;){if(y.nodeType===3){if(w=c+y.textContent.length,c<=p&&w>=p)return{node:y,offset:p-c};c=w}e:{for(;y;){if(y.nextSibling){y=y.nextSibling;break e}y=y.parentNode}y=void 0}y=_a(y)}}function Sa(c,p){return c&&p?c===p?!0:c&&c.nodeType===3?!1:p&&p.nodeType===3?Sa(c,p.parentNode):"contains"in c?c.contains(p):c.compareDocumentPosition?!!(c.compareDocumentPosition(p)&16):!1:!1}function Ta(){for(var c=window,p=oe();p instanceof c.HTMLIFrameElement;){try{var y=typeof p.contentWindow.location.href=="string"}catch{y=!1}if(y)c=p.contentWindow;else break;p=oe(c.document)}return p}function Si(c){var p=c&&c.nodeName&&c.nodeName.toLowerCase();return p&&(p==="input"&&(c.type==="text"||c.type==="search"||c.type==="tel"||c.type==="url"||c.type==="password")||p==="textarea"||c.contentEditable==="true")}function Eu(c){var p=Ta(),y=c.focusedElem,w=c.selectionRange;if(p!==y&&y&&y.ownerDocument&&Sa(y.ownerDocument.documentElement,y)){if(w!==null&&Si(y)){if(p=w.start,c=w.end,c===void 0&&(c=p),"selectionStart"in y)y.selectionStart=p,y.selectionEnd=Math.min(c,y.value.length);else if(c=(p=y.ownerDocument||document)&&p.defaultView||window,c.getSelection){c=c.getSelection();var T=y.textContent.length,M=Math.min(w.start,T);w=w.end===void 0?M:Math.min(w.end,T),!c.extend&&M>w&&(T=w,w=M,M=T),T=Aa(y,M);var H=Aa(y,w);T&&H&&(c.rangeCount!==1||c.anchorNode!==T.node||c.anchorOffset!==T.offset||c.focusNode!==H.node||c.focusOffset!==H.offset)&&(p=p.createRange(),p.setStart(T.node,T.offset),c.removeAllRanges(),M>w?(c.addRange(p),c.extend(H.node,H.offset)):(p.setEnd(H.node,H.offset),c.addRange(p)))}}for(p=[],c=y;c=c.parentNode;)c.nodeType===1&&p.push({element:c,left:c.scrollLeft,top:c.scrollTop});for(typeof y.focus=="function"&&y.focus(),y=0;y<p.length;y++)c=p[y],c.element.scrollLeft=c.left,c.element.scrollTop=c.top}}var wu=l&&"documentMode"in document&&11>=document.documentMode,rr=null,Ti=null,Nr=null,Ci=!1;function Ca(c,p,y){var w=y.window===y?y.document:y.nodeType===9?y:y.ownerDocument;Ci||rr==null||rr!==oe(w)||(w=rr,"selectionStart"in w&&Si(w)?w={start:w.selectionStart,end:w.selectionEnd}:(w=(w.ownerDocument&&w.ownerDocument.defaultView||window).getSelection(),w={anchorNode:w.anchorNode,anchorOffset:w.anchorOffset,focusNode:w.focusNode,focusOffset:w.focusOffset}),Nr&&Or(Nr,w)||(Nr=w,w=xs(Ti,"onSelect"),0<w.length&&(p=new vi("onSelect","select",null,p,y),c.push({event:p,listeners:w}),p.target=rr)))}function gs(c,p){var y={};return y[c.toLowerCase()]=p.toLowerCase(),y["Webkit"+c]="webkit"+p,y["Moz"+c]="moz"+p,y}var sr={animationend:gs("Animation","AnimationEnd"),animationiteration:gs("Animation","AnimationIteration"),animationstart:gs("Animation","AnimationStart"),transitionend:gs("Transition","TransitionEnd")},Ri={},Ra={};l&&(Ra=document.createElement("div").style,"AnimationEvent"in window||(delete sr.animationend.animation,delete sr.animationiteration.animation,delete sr.animationstart.animation),"TransitionEvent"in window||delete sr.transitionend.transition);function vs(c){if(Ri[c])return Ri[c];if(!sr[c])return c;var p=sr[c],y;for(y in p)if(p.hasOwnProperty(y)&&y in Ra)return Ri[c]=p[y];return c}var Pa=vs("animationend"),ka=vs("animationiteration"),Ma=vs("animationstart"),Da=vs("transitionend"),Ia=new Map,Oa="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Cn(c,p){Ia.set(c,p),o(p,[c])}for(var Pi=0;Pi<Oa.length;Pi++){var ki=Oa[Pi],_u=ki.toLowerCase(),Au=ki[0].toUpperCase()+ki.slice(1);Cn(_u,"on"+Au)}Cn(Pa,"onAnimationEnd"),Cn(ka,"onAnimationIteration"),Cn(Ma,"onAnimationStart"),Cn("dblclick","onDoubleClick"),Cn("focusin","onFocus"),Cn("focusout","onBlur"),Cn(Da,"onTransitionEnd"),a("onMouseEnter",["mouseout","mouseover"]),a("onMouseLeave",["mouseout","mouseover"]),a("onPointerEnter",["pointerout","pointerover"]),a("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Su=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lr));function Na(c,p,y){var w=c.type||"unknown-event";c.currentTarget=y,_c(w,p,void 0,c),c.currentTarget=null}function La(c,p){p=(p&4)!==0;for(var y=0;y<c.length;y++){var w=c[y],T=w.event;w=w.listeners;e:{var M=void 0;if(p)for(var H=w.length-1;0<=H;H--){var ne=w[H],se=ne.instance,ge=ne.currentTarget;if(ne=ne.listener,se!==M&&T.isPropagationStopped())break e;Na(T,ne,ge),M=se}else for(H=0;H<w.length;H++){if(ne=w[H],se=ne.instance,ge=ne.currentTarget,ne=ne.listener,se!==M&&T.isPropagationStopped())break e;Na(T,ne,ge),M=se}}}if(fn)throw c=ai,fn=!1,ai=null,c}function tt(c,p){var y=p[ji];y===void 0&&(y=p[ji]=new Set);var w=c+"__bubble";y.has(w)||(Fa(p,c,2,!1),y.add(w))}function Mi(c,p,y){var w=0;p&&(w|=4),Fa(y,c,w,p)}var ys="_reactListening"+Math.random().toString(36).slice(2);function Fr(c){if(!c[ys]){c[ys]=!0,n.forEach(function(y){y!=="selectionchange"&&(Su.has(y)||Mi(y,!1,c),Mi(y,!0,c))});var p=c.nodeType===9?c:c.ownerDocument;p===null||p[ys]||(p[ys]=!0,Mi("selectionchange",!1,p))}}function Fa(c,p,y,w){switch(oa(p)){case 1:var T=Bc;break;case 4:T=$c;break;default:T=pi}y=T.bind(null,p,y,c),T=void 0,!Wt||p!=="touchstart"&&p!=="touchmove"&&p!=="wheel"||(T=!0),w?T!==void 0?c.addEventListener(p,y,{capture:!0,passive:T}):c.addEventListener(p,y,!0):T!==void 0?c.addEventListener(p,y,{passive:T}):c.addEventListener(p,y,!1)}function Di(c,p,y,w,T){var M=w;if((p&1)===0&&(p&2)===0&&w!==null)e:for(;;){if(w===null)return;var H=w.tag;if(H===3||H===4){var ne=w.stateNode.containerInfo;if(ne===T||ne.nodeType===8&&ne.parentNode===T)break;if(H===4)for(H=w.return;H!==null;){var se=H.tag;if((se===3||se===4)&&(se=H.stateNode.containerInfo,se===T||se.nodeType===8&&se.parentNode===T))return;H=H.return}for(;ne!==null;){if(H=zn(ne),H===null)return;if(se=H.tag,se===5||se===6){w=M=H;continue e}ne=ne.parentNode}}w=w.return}et(function(){var ge=M,we=He(y),_e=[];e:{var Ee=Ia.get(c);if(Ee!==void 0){var ke=vi,De=c;switch(c){case"keypress":if(hs(y)===0)break e;case"keydown":case"keyup":ke=tu;break;case"focusin":De="focus",ke=bi;break;case"focusout":De="blur",ke=bi;break;case"beforeblur":case"afterblur":ke=bi;break;case"click":if(y.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ke=ca;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ke=Vc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ke=su;break;case Pa:case ka:case Ma:ke=Gc;break;case Da:ke=ou;break;case"scroll":ke=Uc;break;case"wheel":ke=lu;break;case"copy":case"cut":case"paste":ke=Kc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ke=da}var Ie=(p&4)!==0,pt=!Ie&&c==="scroll",fe=Ie?Ee!==null?Ee+"Capture":null:Ee;Ie=[];for(var ae=ge,me;ae!==null;){me=ae;var Se=me.stateNode;if(me.tag===5&&Se!==null&&(me=Se,fe!==null&&(Se=it(ae,fe),Se!=null&&Ie.push(jr(ae,Se,me)))),pt)break;ae=ae.return}0<Ie.length&&(Ee=new ke(Ee,De,null,y,we),_e.push({event:Ee,listeners:Ie}))}}if((p&7)===0){e:{if(Ee=c==="mouseover"||c==="pointerover",ke=c==="mouseout"||c==="pointerout",Ee&&y!==ze&&(De=y.relatedTarget||y.fromElement)&&(zn(De)||De[pn]))break e;if((ke||Ee)&&(Ee=we.window===we?we:(Ee=we.ownerDocument)?Ee.defaultView||Ee.parentWindow:window,ke?(De=y.relatedTarget||y.toElement,ke=ge,De=De?zn(De):null,De!==null&&(pt=Un(De),De!==pt||De.tag!==5&&De.tag!==6)&&(De=null)):(ke=null,De=ge),ke!==De)){if(Ie=ca,Se="onMouseLeave",fe="onMouseEnter",ae="mouse",(c==="pointerout"||c==="pointerover")&&(Ie=da,Se="onPointerLeave",fe="onPointerEnter",ae="pointer"),pt=ke==null?Ee:ar(ke),me=De==null?Ee:ar(De),Ee=new Ie(Se,ae+"leave",ke,y,we),Ee.target=pt,Ee.relatedTarget=me,Se=null,zn(we)===ge&&(Ie=new Ie(fe,ae+"enter",De,y,we),Ie.target=me,Ie.relatedTarget=pt,Se=Ie),pt=Se,ke&&De)t:{for(Ie=ke,fe=De,ae=0,me=Ie;me;me=ir(me))ae++;for(me=0,Se=fe;Se;Se=ir(Se))me++;for(;0<ae-me;)Ie=ir(Ie),ae--;for(;0<me-ae;)fe=ir(fe),me--;for(;ae--;){if(Ie===fe||fe!==null&&Ie===fe.alternate)break t;Ie=ir(Ie),fe=ir(fe)}Ie=null}else Ie=null;ke!==null&&ja(_e,Ee,ke,Ie,!1),De!==null&&pt!==null&&ja(_e,pt,De,Ie,!0)}}e:{if(Ee=ge?ar(ge):window,ke=Ee.nodeName&&Ee.nodeName.toLowerCase(),ke==="select"||ke==="input"&&Ee.type==="file")var Ne=mu;else if(va(Ee))if(xa)Ne=xu;else{Ne=vu;var Fe=gu}else(ke=Ee.nodeName)&&ke.toLowerCase()==="input"&&(Ee.type==="checkbox"||Ee.type==="radio")&&(Ne=yu);if(Ne&&(Ne=Ne(c,ge))){ya(_e,Ne,y,we);break e}Fe&&Fe(c,Ee,ge),c==="focusout"&&(Fe=Ee._wrapperState)&&Fe.controlled&&Ee.type==="number"&&ye(Ee,"number",Ee.value)}switch(Fe=ge?ar(ge):window,c){case"focusin":(va(Fe)||Fe.contentEditable==="true")&&(rr=Fe,Ti=ge,Nr=null);break;case"focusout":Nr=Ti=rr=null;break;case"mousedown":Ci=!0;break;case"contextmenu":case"mouseup":case"dragend":Ci=!1,Ca(_e,y,we);break;case"selectionchange":if(wu)break;case"keydown":case"keyup":Ca(_e,y,we)}var je;if(wi)e:{switch(c){case"compositionstart":var Be="onCompositionStart";break e;case"compositionend":Be="onCompositionEnd";break e;case"compositionupdate":Be="onCompositionUpdate";break e}Be=void 0}else nr?ma(c,y)&&(Be="onCompositionEnd"):c==="keydown"&&y.keyCode===229&&(Be="onCompositionStart");Be&&(ha&&y.locale!=="ko"&&(nr||Be!=="onCompositionStart"?Be==="onCompositionEnd"&&nr&&(je=aa()):(Tn=we,gi="value"in Tn?Tn.value:Tn.textContent,nr=!0)),Fe=xs(ge,Be),0<Fe.length&&(Be=new ua(Be,c,null,y,we),_e.push({event:Be,listeners:Fe}),je?Be.data=je:(je=ga(y),je!==null&&(Be.data=je)))),(je=uu?du(c,y):hu(c,y))&&(ge=xs(ge,"onBeforeInput"),0<ge.length&&(we=new ua("onBeforeInput","beforeinput",null,y,we),_e.push({event:we,listeners:ge}),we.data=je))}La(_e,p)})}function jr(c,p,y){return{instance:c,listener:p,currentTarget:y}}function xs(c,p){for(var y=p+"Capture",w=[];c!==null;){var T=c,M=T.stateNode;T.tag===5&&M!==null&&(T=M,M=it(c,y),M!=null&&w.unshift(jr(c,M,T)),M=it(c,p),M!=null&&w.push(jr(c,M,T))),c=c.return}return w}function ir(c){if(c===null)return null;do c=c.return;while(c&&c.tag!==5);return c||null}function ja(c,p,y,w,T){for(var M=p._reactName,H=[];y!==null&&y!==w;){var ne=y,se=ne.alternate,ge=ne.stateNode;if(se!==null&&se===w)break;ne.tag===5&&ge!==null&&(ne=ge,T?(se=it(y,M),se!=null&&H.unshift(jr(y,se,ne))):T||(se=it(y,M),se!=null&&H.push(jr(y,se,ne)))),y=y.return}H.length!==0&&c.push({event:p,listeners:H})}var Tu=/\r\n?/g,Cu=/\u0000|\uFFFD/g;function Ba(c){return(typeof c=="string"?c:""+c).replace(Tu,`
`).replace(Cu,"")}function bs(c,p,y){if(p=Ba(p),Ba(c)!==p&&y)throw Error(t(425))}function Es(){}var Ii=null,Oi=null;function Ni(c,p){return c==="textarea"||c==="noscript"||typeof p.children=="string"||typeof p.children=="number"||typeof p.dangerouslySetInnerHTML=="object"&&p.dangerouslySetInnerHTML!==null&&p.dangerouslySetInnerHTML.__html!=null}var Li=typeof setTimeout=="function"?setTimeout:void 0,Ru=typeof clearTimeout=="function"?clearTimeout:void 0,$a=typeof Promise=="function"?Promise:void 0,Pu=typeof queueMicrotask=="function"?queueMicrotask:typeof $a<"u"?function(c){return $a.resolve(null).then(c).catch(ku)}:Li;function ku(c){setTimeout(function(){throw c})}function Fi(c,p){var y=p,w=0;do{var T=y.nextSibling;if(c.removeChild(y),T&&T.nodeType===8)if(y=T.data,y==="/$"){if(w===0){c.removeChild(T),Rr(p);return}w--}else y!=="$"&&y!=="$?"&&y!=="$!"||w++;y=T}while(y);Rr(p)}function Rn(c){for(;c!=null;c=c.nextSibling){var p=c.nodeType;if(p===1||p===3)break;if(p===8){if(p=c.data,p==="$"||p==="$!"||p==="$?")break;if(p==="/$")return null}}return c}function Ua(c){c=c.previousSibling;for(var p=0;c;){if(c.nodeType===8){var y=c.data;if(y==="$"||y==="$!"||y==="$?"){if(p===0)return c;p--}else y==="/$"&&p++}c=c.previousSibling}return null}var or=Math.random().toString(36).slice(2),ln="__reactFiber$"+or,Br="__reactProps$"+or,pn="__reactContainer$"+or,ji="__reactEvents$"+or,Mu="__reactListeners$"+or,Du="__reactHandles$"+or;function zn(c){var p=c[ln];if(p)return p;for(var y=c.parentNode;y;){if(p=y[pn]||y[ln]){if(y=p.alternate,p.child!==null||y!==null&&y.child!==null)for(c=Ua(c);c!==null;){if(y=c[ln])return y;c=Ua(c)}return p}c=y,y=c.parentNode}return null}function $r(c){return c=c[ln]||c[pn],!c||c.tag!==5&&c.tag!==6&&c.tag!==13&&c.tag!==3?null:c}function ar(c){if(c.tag===5||c.tag===6)return c.stateNode;throw Error(t(33))}function ws(c){return c[Br]||null}var Bi=[],lr=-1;function Pn(c){return{current:c}}function nt(c){0>lr||(c.current=Bi[lr],Bi[lr]=null,lr--)}function Ze(c,p){lr++,Bi[lr]=c.current,c.current=p}var kn={},Ct=Pn(kn),Nt=Pn(!1),Vn=kn;function cr(c,p){var y=c.type.contextTypes;if(!y)return kn;var w=c.stateNode;if(w&&w.__reactInternalMemoizedUnmaskedChildContext===p)return w.__reactInternalMemoizedMaskedChildContext;var T={},M;for(M in y)T[M]=p[M];return w&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=p,c.__reactInternalMemoizedMaskedChildContext=T),T}function Lt(c){return c=c.childContextTypes,c!=null}function _s(){nt(Nt),nt(Ct)}function za(c,p,y){if(Ct.current!==kn)throw Error(t(168));Ze(Ct,p),Ze(Nt,y)}function Va(c,p,y){var w=c.stateNode;if(p=p.childContextTypes,typeof w.getChildContext!="function")return y;w=w.getChildContext();for(var T in w)if(!(T in p))throw Error(t(108,O(c)||"Unknown",T));return I({},y,w)}function As(c){return c=(c=c.stateNode)&&c.__reactInternalMemoizedMergedChildContext||kn,Vn=Ct.current,Ze(Ct,c),Ze(Nt,Nt.current),!0}function Ha(c,p,y){var w=c.stateNode;if(!w)throw Error(t(169));y?(c=Va(c,p,Vn),w.__reactInternalMemoizedMergedChildContext=c,nt(Nt),nt(Ct),Ze(Ct,c)):nt(Nt),Ze(Nt,y)}var mn=null,Ss=!1,$i=!1;function Wa(c){mn===null?mn=[c]:mn.push(c)}function Iu(c){Ss=!0,Wa(c)}function Mn(){if(!$i&&mn!==null){$i=!0;var c=0,p=Xe;try{var y=mn;for(Xe=1;c<y.length;c++){var w=y[c];do w=w(!0);while(w!==null)}mn=null,Ss=!1}catch(T){throw mn!==null&&(mn=mn.slice(c+1)),qo(li,Mn),T}finally{Xe=p,$i=!1}}return null}var ur=[],dr=0,Ts=null,Cs=0,Gt=[],qt=0,Hn=null,gn=1,vn="";function Wn(c,p){ur[dr++]=Cs,ur[dr++]=Ts,Ts=c,Cs=p}function Ga(c,p,y){Gt[qt++]=gn,Gt[qt++]=vn,Gt[qt++]=Hn,Hn=c;var w=gn;c=vn;var T=32-Zt(w)-1;w&=~(1<<T),y+=1;var M=32-Zt(p)+T;if(30<M){var H=T-T%5;M=(w&(1<<H)-1).toString(32),w>>=H,T-=H,gn=1<<32-Zt(p)+T|y<<T|w,vn=M+c}else gn=1<<M|y<<T|w,vn=c}function Ui(c){c.return!==null&&(Wn(c,1),Ga(c,1,0))}function zi(c){for(;c===Ts;)Ts=ur[--dr],ur[dr]=null,Cs=ur[--dr],ur[dr]=null;for(;c===Hn;)Hn=Gt[--qt],Gt[qt]=null,vn=Gt[--qt],Gt[qt]=null,gn=Gt[--qt],Gt[qt]=null}var zt=null,Vt=null,rt=!1,tn=null;function qa(c,p){var y=Jt(5,null,null,0);y.elementType="DELETED",y.stateNode=p,y.return=c,p=c.deletions,p===null?(c.deletions=[y],c.flags|=16):p.push(y)}function Ka(c,p){switch(c.tag){case 5:var y=c.type;return p=p.nodeType!==1||y.toLowerCase()!==p.nodeName.toLowerCase()?null:p,p!==null?(c.stateNode=p,zt=c,Vt=Rn(p.firstChild),!0):!1;case 6:return p=c.pendingProps===""||p.nodeType!==3?null:p,p!==null?(c.stateNode=p,zt=c,Vt=null,!0):!1;case 13:return p=p.nodeType!==8?null:p,p!==null?(y=Hn!==null?{id:gn,overflow:vn}:null,c.memoizedState={dehydrated:p,treeContext:y,retryLane:1073741824},y=Jt(18,null,null,0),y.stateNode=p,y.return=c,c.child=y,zt=c,Vt=null,!0):!1;default:return!1}}function Vi(c){return(c.mode&1)!==0&&(c.flags&128)===0}function Hi(c){if(rt){var p=Vt;if(p){var y=p;if(!Ka(c,p)){if(Vi(c))throw Error(t(418));p=Rn(y.nextSibling);var w=zt;p&&Ka(c,p)?qa(w,y):(c.flags=c.flags&-4097|2,rt=!1,zt=c)}}else{if(Vi(c))throw Error(t(418));c.flags=c.flags&-4097|2,rt=!1,zt=c}}}function Xa(c){for(c=c.return;c!==null&&c.tag!==5&&c.tag!==3&&c.tag!==13;)c=c.return;zt=c}function Rs(c){if(c!==zt)return!1;if(!rt)return Xa(c),rt=!0,!1;var p;if((p=c.tag!==3)&&!(p=c.tag!==5)&&(p=c.type,p=p!=="head"&&p!=="body"&&!Ni(c.type,c.memoizedProps)),p&&(p=Vt)){if(Vi(c))throw Ya(),Error(t(418));for(;p;)qa(c,p),p=Rn(p.nextSibling)}if(Xa(c),c.tag===13){if(c=c.memoizedState,c=c!==null?c.dehydrated:null,!c)throw Error(t(317));e:{for(c=c.nextSibling,p=0;c;){if(c.nodeType===8){var y=c.data;if(y==="/$"){if(p===0){Vt=Rn(c.nextSibling);break e}p--}else y!=="$"&&y!=="$!"&&y!=="$?"||p++}c=c.nextSibling}Vt=null}}else Vt=zt?Rn(c.stateNode.nextSibling):null;return!0}function Ya(){for(var c=Vt;c;)c=Rn(c.nextSibling)}function hr(){Vt=zt=null,rt=!1}function Wi(c){tn===null?tn=[c]:tn.push(c)}var Ou=C.ReactCurrentBatchConfig;function Ur(c,p,y){if(c=y.ref,c!==null&&typeof c!="function"&&typeof c!="object"){if(y._owner){if(y=y._owner,y){if(y.tag!==1)throw Error(t(309));var w=y.stateNode}if(!w)throw Error(t(147,c));var T=w,M=""+c;return p!==null&&p.ref!==null&&typeof p.ref=="function"&&p.ref._stringRef===M?p.ref:(p=function(H){var ne=T.refs;H===null?delete ne[M]:ne[M]=H},p._stringRef=M,p)}if(typeof c!="string")throw Error(t(284));if(!y._owner)throw Error(t(290,c))}return c}function Ps(c,p){throw c=Object.prototype.toString.call(p),Error(t(31,c==="[object Object]"?"object with keys {"+Object.keys(p).join(", ")+"}":c))}function Ja(c){var p=c._init;return p(c._payload)}function Qa(c){function p(fe,ae){if(c){var me=fe.deletions;me===null?(fe.deletions=[ae],fe.flags|=16):me.push(ae)}}function y(fe,ae){if(!c)return null;for(;ae!==null;)p(fe,ae),ae=ae.sibling;return null}function w(fe,ae){for(fe=new Map;ae!==null;)ae.key!==null?fe.set(ae.key,ae):fe.set(ae.index,ae),ae=ae.sibling;return fe}function T(fe,ae){return fe=Bn(fe,ae),fe.index=0,fe.sibling=null,fe}function M(fe,ae,me){return fe.index=me,c?(me=fe.alternate,me!==null?(me=me.index,me<ae?(fe.flags|=2,ae):me):(fe.flags|=2,ae)):(fe.flags|=1048576,ae)}function H(fe){return c&&fe.alternate===null&&(fe.flags|=2),fe}function ne(fe,ae,me,Se){return ae===null||ae.tag!==6?(ae=Fo(me,fe.mode,Se),ae.return=fe,ae):(ae=T(ae,me),ae.return=fe,ae)}function se(fe,ae,me,Se){var Ne=me.type;return Ne===L?we(fe,ae,me.props.children,Se,me.key):ae!==null&&(ae.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===Q&&Ja(Ne)===ae.type)?(Se=T(ae,me.props),Se.ref=Ur(fe,ae,me),Se.return=fe,Se):(Se=Zs(me.type,me.key,me.props,null,fe.mode,Se),Se.ref=Ur(fe,ae,me),Se.return=fe,Se)}function ge(fe,ae,me,Se){return ae===null||ae.tag!==4||ae.stateNode.containerInfo!==me.containerInfo||ae.stateNode.implementation!==me.implementation?(ae=jo(me,fe.mode,Se),ae.return=fe,ae):(ae=T(ae,me.children||[]),ae.return=fe,ae)}function we(fe,ae,me,Se,Ne){return ae===null||ae.tag!==7?(ae=Zn(me,fe.mode,Se,Ne),ae.return=fe,ae):(ae=T(ae,me),ae.return=fe,ae)}function _e(fe,ae,me){if(typeof ae=="string"&&ae!==""||typeof ae=="number")return ae=Fo(""+ae,fe.mode,me),ae.return=fe,ae;if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case A:return me=Zs(ae.type,ae.key,ae.props,null,fe.mode,me),me.ref=Ur(fe,null,ae),me.return=fe,me;case R:return ae=jo(ae,fe.mode,me),ae.return=fe,ae;case Q:var Se=ae._init;return _e(fe,Se(ae._payload),me)}if(Ae(ae)||k(ae))return ae=Zn(ae,fe.mode,me,null),ae.return=fe,ae;Ps(fe,ae)}return null}function Ee(fe,ae,me,Se){var Ne=ae!==null?ae.key:null;if(typeof me=="string"&&me!==""||typeof me=="number")return Ne!==null?null:ne(fe,ae,""+me,Se);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case A:return me.key===Ne?se(fe,ae,me,Se):null;case R:return me.key===Ne?ge(fe,ae,me,Se):null;case Q:return Ne=me._init,Ee(fe,ae,Ne(me._payload),Se)}if(Ae(me)||k(me))return Ne!==null?null:we(fe,ae,me,Se,null);Ps(fe,me)}return null}function ke(fe,ae,me,Se,Ne){if(typeof Se=="string"&&Se!==""||typeof Se=="number")return fe=fe.get(me)||null,ne(ae,fe,""+Se,Ne);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case A:return fe=fe.get(Se.key===null?me:Se.key)||null,se(ae,fe,Se,Ne);case R:return fe=fe.get(Se.key===null?me:Se.key)||null,ge(ae,fe,Se,Ne);case Q:var Fe=Se._init;return ke(fe,ae,me,Fe(Se._payload),Ne)}if(Ae(Se)||k(Se))return fe=fe.get(me)||null,we(ae,fe,Se,Ne,null);Ps(ae,Se)}return null}function De(fe,ae,me,Se){for(var Ne=null,Fe=null,je=ae,Be=ae=0,_t=null;je!==null&&Be<me.length;Be++){je.index>Be?(_t=je,je=null):_t=je.sibling;var We=Ee(fe,je,me[Be],Se);if(We===null){je===null&&(je=_t);break}c&&je&&We.alternate===null&&p(fe,je),ae=M(We,ae,Be),Fe===null?Ne=We:Fe.sibling=We,Fe=We,je=_t}if(Be===me.length)return y(fe,je),rt&&Wn(fe,Be),Ne;if(je===null){for(;Be<me.length;Be++)je=_e(fe,me[Be],Se),je!==null&&(ae=M(je,ae,Be),Fe===null?Ne=je:Fe.sibling=je,Fe=je);return rt&&Wn(fe,Be),Ne}for(je=w(fe,je);Be<me.length;Be++)_t=ke(je,fe,Be,me[Be],Se),_t!==null&&(c&&_t.alternate!==null&&je.delete(_t.key===null?Be:_t.key),ae=M(_t,ae,Be),Fe===null?Ne=_t:Fe.sibling=_t,Fe=_t);return c&&je.forEach(function($n){return p(fe,$n)}),rt&&Wn(fe,Be),Ne}function Ie(fe,ae,me,Se){var Ne=k(me);if(typeof Ne!="function")throw Error(t(150));if(me=Ne.call(me),me==null)throw Error(t(151));for(var Fe=Ne=null,je=ae,Be=ae=0,_t=null,We=me.next();je!==null&&!We.done;Be++,We=me.next()){je.index>Be?(_t=je,je=null):_t=je.sibling;var $n=Ee(fe,je,We.value,Se);if($n===null){je===null&&(je=_t);break}c&&je&&$n.alternate===null&&p(fe,je),ae=M($n,ae,Be),Fe===null?Ne=$n:Fe.sibling=$n,Fe=$n,je=_t}if(We.done)return y(fe,je),rt&&Wn(fe,Be),Ne;if(je===null){for(;!We.done;Be++,We=me.next())We=_e(fe,We.value,Se),We!==null&&(ae=M(We,ae,Be),Fe===null?Ne=We:Fe.sibling=We,Fe=We);return rt&&Wn(fe,Be),Ne}for(je=w(fe,je);!We.done;Be++,We=me.next())We=ke(je,fe,Be,We.value,Se),We!==null&&(c&&We.alternate!==null&&je.delete(We.key===null?Be:We.key),ae=M(We,ae,Be),Fe===null?Ne=We:Fe.sibling=We,Fe=We);return c&&je.forEach(function(pd){return p(fe,pd)}),rt&&Wn(fe,Be),Ne}function pt(fe,ae,me,Se){if(typeof me=="object"&&me!==null&&me.type===L&&me.key===null&&(me=me.props.children),typeof me=="object"&&me!==null){switch(me.$$typeof){case A:e:{for(var Ne=me.key,Fe=ae;Fe!==null;){if(Fe.key===Ne){if(Ne=me.type,Ne===L){if(Fe.tag===7){y(fe,Fe.sibling),ae=T(Fe,me.props.children),ae.return=fe,fe=ae;break e}}else if(Fe.elementType===Ne||typeof Ne=="object"&&Ne!==null&&Ne.$$typeof===Q&&Ja(Ne)===Fe.type){y(fe,Fe.sibling),ae=T(Fe,me.props),ae.ref=Ur(fe,Fe,me),ae.return=fe,fe=ae;break e}y(fe,Fe);break}else p(fe,Fe);Fe=Fe.sibling}me.type===L?(ae=Zn(me.props.children,fe.mode,Se,me.key),ae.return=fe,fe=ae):(Se=Zs(me.type,me.key,me.props,null,fe.mode,Se),Se.ref=Ur(fe,ae,me),Se.return=fe,fe=Se)}return H(fe);case R:e:{for(Fe=me.key;ae!==null;){if(ae.key===Fe)if(ae.tag===4&&ae.stateNode.containerInfo===me.containerInfo&&ae.stateNode.implementation===me.implementation){y(fe,ae.sibling),ae=T(ae,me.children||[]),ae.return=fe,fe=ae;break e}else{y(fe,ae);break}else p(fe,ae);ae=ae.sibling}ae=jo(me,fe.mode,Se),ae.return=fe,fe=ae}return H(fe);case Q:return Fe=me._init,pt(fe,ae,Fe(me._payload),Se)}if(Ae(me))return De(fe,ae,me,Se);if(k(me))return Ie(fe,ae,me,Se);Ps(fe,me)}return typeof me=="string"&&me!==""||typeof me=="number"?(me=""+me,ae!==null&&ae.tag===6?(y(fe,ae.sibling),ae=T(ae,me),ae.return=fe,fe=ae):(y(fe,ae),ae=Fo(me,fe.mode,Se),ae.return=fe,fe=ae),H(fe)):y(fe,ae)}return pt}var fr=Qa(!0),Za=Qa(!1),ks=Pn(null),Ms=null,pr=null,Gi=null;function qi(){Gi=pr=Ms=null}function Ki(c){var p=ks.current;nt(ks),c._currentValue=p}function Xi(c,p,y){for(;c!==null;){var w=c.alternate;if((c.childLanes&p)!==p?(c.childLanes|=p,w!==null&&(w.childLanes|=p)):w!==null&&(w.childLanes&p)!==p&&(w.childLanes|=p),c===y)break;c=c.return}}function mr(c,p){Ms=c,Gi=pr=null,c=c.dependencies,c!==null&&c.firstContext!==null&&((c.lanes&p)!==0&&(Ft=!0),c.firstContext=null)}function Kt(c){var p=c._currentValue;if(Gi!==c)if(c={context:c,memoizedValue:p,next:null},pr===null){if(Ms===null)throw Error(t(308));pr=c,Ms.dependencies={lanes:0,firstContext:c}}else pr=pr.next=c;return p}var Gn=null;function Yi(c){Gn===null?Gn=[c]:Gn.push(c)}function el(c,p,y,w){var T=p.interleaved;return T===null?(y.next=y,Yi(p)):(y.next=T.next,T.next=y),p.interleaved=y,yn(c,w)}function yn(c,p){c.lanes|=p;var y=c.alternate;for(y!==null&&(y.lanes|=p),y=c,c=c.return;c!==null;)c.childLanes|=p,y=c.alternate,y!==null&&(y.childLanes|=p),y=c,c=c.return;return y.tag===3?y.stateNode:null}var Dn=!1;function Ji(c){c.updateQueue={baseState:c.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function tl(c,p){c=c.updateQueue,p.updateQueue===c&&(p.updateQueue={baseState:c.baseState,firstBaseUpdate:c.firstBaseUpdate,lastBaseUpdate:c.lastBaseUpdate,shared:c.shared,effects:c.effects})}function xn(c,p){return{eventTime:c,lane:p,tag:0,payload:null,callback:null,next:null}}function In(c,p,y){var w=c.updateQueue;if(w===null)return null;if(w=w.shared,(Ve&2)!==0){var T=w.pending;return T===null?p.next=p:(p.next=T.next,T.next=p),w.pending=p,yn(c,y)}return T=w.interleaved,T===null?(p.next=p,Yi(w)):(p.next=T.next,T.next=p),w.interleaved=p,yn(c,y)}function Ds(c,p,y){if(p=p.updateQueue,p!==null&&(p=p.shared,(y&4194240)!==0)){var w=p.lanes;w&=c.pendingLanes,y|=w,p.lanes=y,di(c,y)}}function nl(c,p){var y=c.updateQueue,w=c.alternate;if(w!==null&&(w=w.updateQueue,y===w)){var T=null,M=null;if(y=y.firstBaseUpdate,y!==null){do{var H={eventTime:y.eventTime,lane:y.lane,tag:y.tag,payload:y.payload,callback:y.callback,next:null};M===null?T=M=H:M=M.next=H,y=y.next}while(y!==null);M===null?T=M=p:M=M.next=p}else T=M=p;y={baseState:w.baseState,firstBaseUpdate:T,lastBaseUpdate:M,shared:w.shared,effects:w.effects},c.updateQueue=y;return}c=y.lastBaseUpdate,c===null?y.firstBaseUpdate=p:c.next=p,y.lastBaseUpdate=p}function Is(c,p,y,w){var T=c.updateQueue;Dn=!1;var M=T.firstBaseUpdate,H=T.lastBaseUpdate,ne=T.shared.pending;if(ne!==null){T.shared.pending=null;var se=ne,ge=se.next;se.next=null,H===null?M=ge:H.next=ge,H=se;var we=c.alternate;we!==null&&(we=we.updateQueue,ne=we.lastBaseUpdate,ne!==H&&(ne===null?we.firstBaseUpdate=ge:ne.next=ge,we.lastBaseUpdate=se))}if(M!==null){var _e=T.baseState;H=0,we=ge=se=null,ne=M;do{var Ee=ne.lane,ke=ne.eventTime;if((w&Ee)===Ee){we!==null&&(we=we.next={eventTime:ke,lane:0,tag:ne.tag,payload:ne.payload,callback:ne.callback,next:null});e:{var De=c,Ie=ne;switch(Ee=p,ke=y,Ie.tag){case 1:if(De=Ie.payload,typeof De=="function"){_e=De.call(ke,_e,Ee);break e}_e=De;break e;case 3:De.flags=De.flags&-65537|128;case 0:if(De=Ie.payload,Ee=typeof De=="function"?De.call(ke,_e,Ee):De,Ee==null)break e;_e=I({},_e,Ee);break e;case 2:Dn=!0}}ne.callback!==null&&ne.lane!==0&&(c.flags|=64,Ee=T.effects,Ee===null?T.effects=[ne]:Ee.push(ne))}else ke={eventTime:ke,lane:Ee,tag:ne.tag,payload:ne.payload,callback:ne.callback,next:null},we===null?(ge=we=ke,se=_e):we=we.next=ke,H|=Ee;if(ne=ne.next,ne===null){if(ne=T.shared.pending,ne===null)break;Ee=ne,ne=Ee.next,Ee.next=null,T.lastBaseUpdate=Ee,T.shared.pending=null}}while(!0);if(we===null&&(se=_e),T.baseState=se,T.firstBaseUpdate=ge,T.lastBaseUpdate=we,p=T.shared.interleaved,p!==null){T=p;do H|=T.lane,T=T.next;while(T!==p)}else M===null&&(T.shared.lanes=0);Xn|=H,c.lanes=H,c.memoizedState=_e}}function rl(c,p,y){if(c=p.effects,p.effects=null,c!==null)for(p=0;p<c.length;p++){var w=c[p],T=w.callback;if(T!==null){if(w.callback=null,w=y,typeof T!="function")throw Error(t(191,T));T.call(w)}}}var zr={},un=Pn(zr),Vr=Pn(zr),Hr=Pn(zr);function qn(c){if(c===zr)throw Error(t(174));return c}function Qi(c,p){switch(Ze(Hr,p),Ze(Vr,c),Ze(un,zr),c=p.nodeType,c){case 9:case 11:p=(p=p.documentElement)?p.namespaceURI:Ue(null,"");break;default:c=c===8?p.parentNode:p,p=c.namespaceURI||null,c=c.tagName,p=Ue(p,c)}nt(un),Ze(un,p)}function gr(){nt(un),nt(Vr),nt(Hr)}function sl(c){qn(Hr.current);var p=qn(un.current),y=Ue(p,c.type);p!==y&&(Ze(Vr,c),Ze(un,y))}function Zi(c){Vr.current===c&&(nt(un),nt(Vr))}var ot=Pn(0);function Os(c){for(var p=c;p!==null;){if(p.tag===13){var y=p.memoizedState;if(y!==null&&(y=y.dehydrated,y===null||y.data==="$?"||y.data==="$!"))return p}else if(p.tag===19&&p.memoizedProps.revealOrder!==void 0){if((p.flags&128)!==0)return p}else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===c)break;for(;p.sibling===null;){if(p.return===null||p.return===c)return null;p=p.return}p.sibling.return=p.return,p=p.sibling}return null}var eo=[];function to(){for(var c=0;c<eo.length;c++)eo[c]._workInProgressVersionPrimary=null;eo.length=0}var Ns=C.ReactCurrentDispatcher,no=C.ReactCurrentBatchConfig,Kn=0,at=null,vt=null,Et=null,Ls=!1,Wr=!1,Gr=0,Nu=0;function Rt(){throw Error(t(321))}function ro(c,p){if(p===null)return!1;for(var y=0;y<p.length&&y<c.length;y++)if(!en(c[y],p[y]))return!1;return!0}function so(c,p,y,w,T,M){if(Kn=M,at=p,p.memoizedState=null,p.updateQueue=null,p.lanes=0,Ns.current=c===null||c.memoizedState===null?Bu:$u,c=y(w,T),Wr){M=0;do{if(Wr=!1,Gr=0,25<=M)throw Error(t(301));M+=1,Et=vt=null,p.updateQueue=null,Ns.current=Uu,c=y(w,T)}while(Wr)}if(Ns.current=Bs,p=vt!==null&&vt.next!==null,Kn=0,Et=vt=at=null,Ls=!1,p)throw Error(t(300));return c}function io(){var c=Gr!==0;return Gr=0,c}function dn(){var c={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Et===null?at.memoizedState=Et=c:Et=Et.next=c,Et}function Xt(){if(vt===null){var c=at.alternate;c=c!==null?c.memoizedState:null}else c=vt.next;var p=Et===null?at.memoizedState:Et.next;if(p!==null)Et=p,vt=c;else{if(c===null)throw Error(t(310));vt=c,c={memoizedState:vt.memoizedState,baseState:vt.baseState,baseQueue:vt.baseQueue,queue:vt.queue,next:null},Et===null?at.memoizedState=Et=c:Et=Et.next=c}return Et}function qr(c,p){return typeof p=="function"?p(c):p}function oo(c){var p=Xt(),y=p.queue;if(y===null)throw Error(t(311));y.lastRenderedReducer=c;var w=vt,T=w.baseQueue,M=y.pending;if(M!==null){if(T!==null){var H=T.next;T.next=M.next,M.next=H}w.baseQueue=T=M,y.pending=null}if(T!==null){M=T.next,w=w.baseState;var ne=H=null,se=null,ge=M;do{var we=ge.lane;if((Kn&we)===we)se!==null&&(se=se.next={lane:0,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null}),w=ge.hasEagerState?ge.eagerState:c(w,ge.action);else{var _e={lane:we,action:ge.action,hasEagerState:ge.hasEagerState,eagerState:ge.eagerState,next:null};se===null?(ne=se=_e,H=w):se=se.next=_e,at.lanes|=we,Xn|=we}ge=ge.next}while(ge!==null&&ge!==M);se===null?H=w:se.next=ne,en(w,p.memoizedState)||(Ft=!0),p.memoizedState=w,p.baseState=H,p.baseQueue=se,y.lastRenderedState=w}if(c=y.interleaved,c!==null){T=c;do M=T.lane,at.lanes|=M,Xn|=M,T=T.next;while(T!==c)}else T===null&&(y.lanes=0);return[p.memoizedState,y.dispatch]}function ao(c){var p=Xt(),y=p.queue;if(y===null)throw Error(t(311));y.lastRenderedReducer=c;var w=y.dispatch,T=y.pending,M=p.memoizedState;if(T!==null){y.pending=null;var H=T=T.next;do M=c(M,H.action),H=H.next;while(H!==T);en(M,p.memoizedState)||(Ft=!0),p.memoizedState=M,p.baseQueue===null&&(p.baseState=M),y.lastRenderedState=M}return[M,w]}function il(){}function ol(c,p){var y=at,w=Xt(),T=p(),M=!en(w.memoizedState,T);if(M&&(w.memoizedState=T,Ft=!0),w=w.queue,lo(cl.bind(null,y,w,c),[c]),w.getSnapshot!==p||M||Et!==null&&Et.memoizedState.tag&1){if(y.flags|=2048,Kr(9,ll.bind(null,y,w,T,p),void 0,null),wt===null)throw Error(t(349));(Kn&30)!==0||al(y,p,T)}return T}function al(c,p,y){c.flags|=16384,c={getSnapshot:p,value:y},p=at.updateQueue,p===null?(p={lastEffect:null,stores:null},at.updateQueue=p,p.stores=[c]):(y=p.stores,y===null?p.stores=[c]:y.push(c))}function ll(c,p,y,w){p.value=y,p.getSnapshot=w,ul(p)&&dl(c)}function cl(c,p,y){return y(function(){ul(p)&&dl(c)})}function ul(c){var p=c.getSnapshot;c=c.value;try{var y=p();return!en(c,y)}catch{return!0}}function dl(c){var p=yn(c,1);p!==null&&on(p,c,1,-1)}function hl(c){var p=dn();return typeof c=="function"&&(c=c()),p.memoizedState=p.baseState=c,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:qr,lastRenderedState:c},p.queue=c,c=c.dispatch=ju.bind(null,at,c),[p.memoizedState,c]}function Kr(c,p,y,w){return c={tag:c,create:p,destroy:y,deps:w,next:null},p=at.updateQueue,p===null?(p={lastEffect:null,stores:null},at.updateQueue=p,p.lastEffect=c.next=c):(y=p.lastEffect,y===null?p.lastEffect=c.next=c:(w=y.next,y.next=c,c.next=w,p.lastEffect=c)),c}function fl(){return Xt().memoizedState}function Fs(c,p,y,w){var T=dn();at.flags|=c,T.memoizedState=Kr(1|p,y,void 0,w===void 0?null:w)}function js(c,p,y,w){var T=Xt();w=w===void 0?null:w;var M=void 0;if(vt!==null){var H=vt.memoizedState;if(M=H.destroy,w!==null&&ro(w,H.deps)){T.memoizedState=Kr(p,y,M,w);return}}at.flags|=c,T.memoizedState=Kr(1|p,y,M,w)}function pl(c,p){return Fs(8390656,8,c,p)}function lo(c,p){return js(2048,8,c,p)}function ml(c,p){return js(4,2,c,p)}function gl(c,p){return js(4,4,c,p)}function vl(c,p){if(typeof p=="function")return c=c(),p(c),function(){p(null)};if(p!=null)return c=c(),p.current=c,function(){p.current=null}}function yl(c,p,y){return y=y!=null?y.concat([c]):null,js(4,4,vl.bind(null,p,c),y)}function co(){}function xl(c,p){var y=Xt();p=p===void 0?null:p;var w=y.memoizedState;return w!==null&&p!==null&&ro(p,w[1])?w[0]:(y.memoizedState=[c,p],c)}function bl(c,p){var y=Xt();p=p===void 0?null:p;var w=y.memoizedState;return w!==null&&p!==null&&ro(p,w[1])?w[0]:(c=c(),y.memoizedState=[c,p],c)}function El(c,p,y){return(Kn&21)===0?(c.baseState&&(c.baseState=!1,Ft=!0),c.memoizedState=y):(en(y,p)||(y=Jo(),at.lanes|=y,Xn|=y,c.baseState=!0),p)}function Lu(c,p){var y=Xe;Xe=y!==0&&4>y?y:4,c(!0);var w=no.transition;no.transition={};try{c(!1),p()}finally{Xe=y,no.transition=w}}function wl(){return Xt().memoizedState}function Fu(c,p,y){var w=Fn(c);if(y={lane:w,action:y,hasEagerState:!1,eagerState:null,next:null},_l(c))Al(p,y);else if(y=el(c,p,y,w),y!==null){var T=It();on(y,c,w,T),Sl(y,p,w)}}function ju(c,p,y){var w=Fn(c),T={lane:w,action:y,hasEagerState:!1,eagerState:null,next:null};if(_l(c))Al(p,T);else{var M=c.alternate;if(c.lanes===0&&(M===null||M.lanes===0)&&(M=p.lastRenderedReducer,M!==null))try{var H=p.lastRenderedState,ne=M(H,y);if(T.hasEagerState=!0,T.eagerState=ne,en(ne,H)){var se=p.interleaved;se===null?(T.next=T,Yi(p)):(T.next=se.next,se.next=T),p.interleaved=T;return}}catch{}finally{}y=el(c,p,T,w),y!==null&&(T=It(),on(y,c,w,T),Sl(y,p,w))}}function _l(c){var p=c.alternate;return c===at||p!==null&&p===at}function Al(c,p){Wr=Ls=!0;var y=c.pending;y===null?p.next=p:(p.next=y.next,y.next=p),c.pending=p}function Sl(c,p,y){if((y&4194240)!==0){var w=p.lanes;w&=c.pendingLanes,y|=w,p.lanes=y,di(c,y)}}var Bs={readContext:Kt,useCallback:Rt,useContext:Rt,useEffect:Rt,useImperativeHandle:Rt,useInsertionEffect:Rt,useLayoutEffect:Rt,useMemo:Rt,useReducer:Rt,useRef:Rt,useState:Rt,useDebugValue:Rt,useDeferredValue:Rt,useTransition:Rt,useMutableSource:Rt,useSyncExternalStore:Rt,useId:Rt,unstable_isNewReconciler:!1},Bu={readContext:Kt,useCallback:function(c,p){return dn().memoizedState=[c,p===void 0?null:p],c},useContext:Kt,useEffect:pl,useImperativeHandle:function(c,p,y){return y=y!=null?y.concat([c]):null,Fs(4194308,4,vl.bind(null,p,c),y)},useLayoutEffect:function(c,p){return Fs(4194308,4,c,p)},useInsertionEffect:function(c,p){return Fs(4,2,c,p)},useMemo:function(c,p){var y=dn();return p=p===void 0?null:p,c=c(),y.memoizedState=[c,p],c},useReducer:function(c,p,y){var w=dn();return p=y!==void 0?y(p):p,w.memoizedState=w.baseState=p,c={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:c,lastRenderedState:p},w.queue=c,c=c.dispatch=Fu.bind(null,at,c),[w.memoizedState,c]},useRef:function(c){var p=dn();return c={current:c},p.memoizedState=c},useState:hl,useDebugValue:co,useDeferredValue:function(c){return dn().memoizedState=c},useTransition:function(){var c=hl(!1),p=c[0];return c=Lu.bind(null,c[1]),dn().memoizedState=c,[p,c]},useMutableSource:function(){},useSyncExternalStore:function(c,p,y){var w=at,T=dn();if(rt){if(y===void 0)throw Error(t(407));y=y()}else{if(y=p(),wt===null)throw Error(t(349));(Kn&30)!==0||al(w,p,y)}T.memoizedState=y;var M={value:y,getSnapshot:p};return T.queue=M,pl(cl.bind(null,w,M,c),[c]),w.flags|=2048,Kr(9,ll.bind(null,w,M,y,p),void 0,null),y},useId:function(){var c=dn(),p=wt.identifierPrefix;if(rt){var y=vn,w=gn;y=(w&~(1<<32-Zt(w)-1)).toString(32)+y,p=":"+p+"R"+y,y=Gr++,0<y&&(p+="H"+y.toString(32)),p+=":"}else y=Nu++,p=":"+p+"r"+y.toString(32)+":";return c.memoizedState=p},unstable_isNewReconciler:!1},$u={readContext:Kt,useCallback:xl,useContext:Kt,useEffect:lo,useImperativeHandle:yl,useInsertionEffect:ml,useLayoutEffect:gl,useMemo:bl,useReducer:oo,useRef:fl,useState:function(){return oo(qr)},useDebugValue:co,useDeferredValue:function(c){var p=Xt();return El(p,vt.memoizedState,c)},useTransition:function(){var c=oo(qr)[0],p=Xt().memoizedState;return[c,p]},useMutableSource:il,useSyncExternalStore:ol,useId:wl,unstable_isNewReconciler:!1},Uu={readContext:Kt,useCallback:xl,useContext:Kt,useEffect:lo,useImperativeHandle:yl,useInsertionEffect:ml,useLayoutEffect:gl,useMemo:bl,useReducer:ao,useRef:fl,useState:function(){return ao(qr)},useDebugValue:co,useDeferredValue:function(c){var p=Xt();return vt===null?p.memoizedState=c:El(p,vt.memoizedState,c)},useTransition:function(){var c=ao(qr)[0],p=Xt().memoizedState;return[c,p]},useMutableSource:il,useSyncExternalStore:ol,useId:wl,unstable_isNewReconciler:!1};function nn(c,p){if(c&&c.defaultProps){p=I({},p),c=c.defaultProps;for(var y in c)p[y]===void 0&&(p[y]=c[y]);return p}return p}function uo(c,p,y,w){p=c.memoizedState,y=y(w,p),y=y==null?p:I({},p,y),c.memoizedState=y,c.lanes===0&&(c.updateQueue.baseState=y)}var $s={isMounted:function(c){return(c=c._reactInternals)?Un(c)===c:!1},enqueueSetState:function(c,p,y){c=c._reactInternals;var w=It(),T=Fn(c),M=xn(w,T);M.payload=p,y!=null&&(M.callback=y),p=In(c,M,T),p!==null&&(on(p,c,T,w),Ds(p,c,T))},enqueueReplaceState:function(c,p,y){c=c._reactInternals;var w=It(),T=Fn(c),M=xn(w,T);M.tag=1,M.payload=p,y!=null&&(M.callback=y),p=In(c,M,T),p!==null&&(on(p,c,T,w),Ds(p,c,T))},enqueueForceUpdate:function(c,p){c=c._reactInternals;var y=It(),w=Fn(c),T=xn(y,w);T.tag=2,p!=null&&(T.callback=p),p=In(c,T,w),p!==null&&(on(p,c,w,y),Ds(p,c,w))}};function Tl(c,p,y,w,T,M,H){return c=c.stateNode,typeof c.shouldComponentUpdate=="function"?c.shouldComponentUpdate(w,M,H):p.prototype&&p.prototype.isPureReactComponent?!Or(y,w)||!Or(T,M):!0}function Cl(c,p,y){var w=!1,T=kn,M=p.contextType;return typeof M=="object"&&M!==null?M=Kt(M):(T=Lt(p)?Vn:Ct.current,w=p.contextTypes,M=(w=w!=null)?cr(c,T):kn),p=new p(y,M),c.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=$s,c.stateNode=p,p._reactInternals=c,w&&(c=c.stateNode,c.__reactInternalMemoizedUnmaskedChildContext=T,c.__reactInternalMemoizedMaskedChildContext=M),p}function Rl(c,p,y,w){c=p.state,typeof p.componentWillReceiveProps=="function"&&p.componentWillReceiveProps(y,w),typeof p.UNSAFE_componentWillReceiveProps=="function"&&p.UNSAFE_componentWillReceiveProps(y,w),p.state!==c&&$s.enqueueReplaceState(p,p.state,null)}function ho(c,p,y,w){var T=c.stateNode;T.props=y,T.state=c.memoizedState,T.refs={},Ji(c);var M=p.contextType;typeof M=="object"&&M!==null?T.context=Kt(M):(M=Lt(p)?Vn:Ct.current,T.context=cr(c,M)),T.state=c.memoizedState,M=p.getDerivedStateFromProps,typeof M=="function"&&(uo(c,p,M,y),T.state=c.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(p=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),p!==T.state&&$s.enqueueReplaceState(T,T.state,null),Is(c,y,T,w),T.state=c.memoizedState),typeof T.componentDidMount=="function"&&(c.flags|=4194308)}function vr(c,p){try{var y="",w=p;do y+=V(w),w=w.return;while(w);var T=y}catch(M){T=`
Error generating stack: `+M.message+`
`+M.stack}return{value:c,source:p,stack:T,digest:null}}function fo(c,p,y){return{value:c,source:null,stack:y??null,digest:p??null}}function po(c,p){try{console.error(p.value)}catch(y){setTimeout(function(){throw y})}}var zu=typeof WeakMap=="function"?WeakMap:Map;function Pl(c,p,y){y=xn(-1,y),y.tag=3,y.payload={element:null};var w=p.value;return y.callback=function(){qs||(qs=!0,Po=w),po(c,p)},y}function kl(c,p,y){y=xn(-1,y),y.tag=3;var w=c.type.getDerivedStateFromError;if(typeof w=="function"){var T=p.value;y.payload=function(){return w(T)},y.callback=function(){po(c,p)}}var M=c.stateNode;return M!==null&&typeof M.componentDidCatch=="function"&&(y.callback=function(){po(c,p),typeof w!="function"&&(Nn===null?Nn=new Set([this]):Nn.add(this));var H=p.stack;this.componentDidCatch(p.value,{componentStack:H!==null?H:""})}),y}function Ml(c,p,y){var w=c.pingCache;if(w===null){w=c.pingCache=new zu;var T=new Set;w.set(p,T)}else T=w.get(p),T===void 0&&(T=new Set,w.set(p,T));T.has(y)||(T.add(y),c=nd.bind(null,c,p,y),p.then(c,c))}function Dl(c){do{var p;if((p=c.tag===13)&&(p=c.memoizedState,p=p!==null?p.dehydrated!==null:!0),p)return c;c=c.return}while(c!==null);return null}function Il(c,p,y,w,T){return(c.mode&1)===0?(c===p?c.flags|=65536:(c.flags|=128,y.flags|=131072,y.flags&=-52805,y.tag===1&&(y.alternate===null?y.tag=17:(p=xn(-1,1),p.tag=2,In(y,p,1))),y.lanes|=1),c):(c.flags|=65536,c.lanes=T,c)}var Vu=C.ReactCurrentOwner,Ft=!1;function Dt(c,p,y,w){p.child=c===null?Za(p,null,y,w):fr(p,c.child,y,w)}function Ol(c,p,y,w,T){y=y.render;var M=p.ref;return mr(p,T),w=so(c,p,y,w,M,T),y=io(),c!==null&&!Ft?(p.updateQueue=c.updateQueue,p.flags&=-2053,c.lanes&=~T,bn(c,p,T)):(rt&&y&&Ui(p),p.flags|=1,Dt(c,p,w,T),p.child)}function Nl(c,p,y,w,T){if(c===null){var M=y.type;return typeof M=="function"&&!Lo(M)&&M.defaultProps===void 0&&y.compare===null&&y.defaultProps===void 0?(p.tag=15,p.type=M,Ll(c,p,M,w,T)):(c=Zs(y.type,null,w,p,p.mode,T),c.ref=p.ref,c.return=p,p.child=c)}if(M=c.child,(c.lanes&T)===0){var H=M.memoizedProps;if(y=y.compare,y=y!==null?y:Or,y(H,w)&&c.ref===p.ref)return bn(c,p,T)}return p.flags|=1,c=Bn(M,w),c.ref=p.ref,c.return=p,p.child=c}function Ll(c,p,y,w,T){if(c!==null){var M=c.memoizedProps;if(Or(M,w)&&c.ref===p.ref)if(Ft=!1,p.pendingProps=w=M,(c.lanes&T)!==0)(c.flags&131072)!==0&&(Ft=!0);else return p.lanes=c.lanes,bn(c,p,T)}return mo(c,p,y,w,T)}function Fl(c,p,y){var w=p.pendingProps,T=w.children,M=c!==null?c.memoizedState:null;if(w.mode==="hidden")if((p.mode&1)===0)p.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ze(xr,Ht),Ht|=y;else{if((y&1073741824)===0)return c=M!==null?M.baseLanes|y:y,p.lanes=p.childLanes=1073741824,p.memoizedState={baseLanes:c,cachePool:null,transitions:null},p.updateQueue=null,Ze(xr,Ht),Ht|=c,null;p.memoizedState={baseLanes:0,cachePool:null,transitions:null},w=M!==null?M.baseLanes:y,Ze(xr,Ht),Ht|=w}else M!==null?(w=M.baseLanes|y,p.memoizedState=null):w=y,Ze(xr,Ht),Ht|=w;return Dt(c,p,T,y),p.child}function jl(c,p){var y=p.ref;(c===null&&y!==null||c!==null&&c.ref!==y)&&(p.flags|=512,p.flags|=2097152)}function mo(c,p,y,w,T){var M=Lt(y)?Vn:Ct.current;return M=cr(p,M),mr(p,T),y=so(c,p,y,w,M,T),w=io(),c!==null&&!Ft?(p.updateQueue=c.updateQueue,p.flags&=-2053,c.lanes&=~T,bn(c,p,T)):(rt&&w&&Ui(p),p.flags|=1,Dt(c,p,y,T),p.child)}function Bl(c,p,y,w,T){if(Lt(y)){var M=!0;As(p)}else M=!1;if(mr(p,T),p.stateNode===null)zs(c,p),Cl(p,y,w),ho(p,y,w,T),w=!0;else if(c===null){var H=p.stateNode,ne=p.memoizedProps;H.props=ne;var se=H.context,ge=y.contextType;typeof ge=="object"&&ge!==null?ge=Kt(ge):(ge=Lt(y)?Vn:Ct.current,ge=cr(p,ge));var we=y.getDerivedStateFromProps,_e=typeof we=="function"||typeof H.getSnapshotBeforeUpdate=="function";_e||typeof H.UNSAFE_componentWillReceiveProps!="function"&&typeof H.componentWillReceiveProps!="function"||(ne!==w||se!==ge)&&Rl(p,H,w,ge),Dn=!1;var Ee=p.memoizedState;H.state=Ee,Is(p,w,H,T),se=p.memoizedState,ne!==w||Ee!==se||Nt.current||Dn?(typeof we=="function"&&(uo(p,y,we,w),se=p.memoizedState),(ne=Dn||Tl(p,y,ne,w,Ee,se,ge))?(_e||typeof H.UNSAFE_componentWillMount!="function"&&typeof H.componentWillMount!="function"||(typeof H.componentWillMount=="function"&&H.componentWillMount(),typeof H.UNSAFE_componentWillMount=="function"&&H.UNSAFE_componentWillMount()),typeof H.componentDidMount=="function"&&(p.flags|=4194308)):(typeof H.componentDidMount=="function"&&(p.flags|=4194308),p.memoizedProps=w,p.memoizedState=se),H.props=w,H.state=se,H.context=ge,w=ne):(typeof H.componentDidMount=="function"&&(p.flags|=4194308),w=!1)}else{H=p.stateNode,tl(c,p),ne=p.memoizedProps,ge=p.type===p.elementType?ne:nn(p.type,ne),H.props=ge,_e=p.pendingProps,Ee=H.context,se=y.contextType,typeof se=="object"&&se!==null?se=Kt(se):(se=Lt(y)?Vn:Ct.current,se=cr(p,se));var ke=y.getDerivedStateFromProps;(we=typeof ke=="function"||typeof H.getSnapshotBeforeUpdate=="function")||typeof H.UNSAFE_componentWillReceiveProps!="function"&&typeof H.componentWillReceiveProps!="function"||(ne!==_e||Ee!==se)&&Rl(p,H,w,se),Dn=!1,Ee=p.memoizedState,H.state=Ee,Is(p,w,H,T);var De=p.memoizedState;ne!==_e||Ee!==De||Nt.current||Dn?(typeof ke=="function"&&(uo(p,y,ke,w),De=p.memoizedState),(ge=Dn||Tl(p,y,ge,w,Ee,De,se)||!1)?(we||typeof H.UNSAFE_componentWillUpdate!="function"&&typeof H.componentWillUpdate!="function"||(typeof H.componentWillUpdate=="function"&&H.componentWillUpdate(w,De,se),typeof H.UNSAFE_componentWillUpdate=="function"&&H.UNSAFE_componentWillUpdate(w,De,se)),typeof H.componentDidUpdate=="function"&&(p.flags|=4),typeof H.getSnapshotBeforeUpdate=="function"&&(p.flags|=1024)):(typeof H.componentDidUpdate!="function"||ne===c.memoizedProps&&Ee===c.memoizedState||(p.flags|=4),typeof H.getSnapshotBeforeUpdate!="function"||ne===c.memoizedProps&&Ee===c.memoizedState||(p.flags|=1024),p.memoizedProps=w,p.memoizedState=De),H.props=w,H.state=De,H.context=se,w=ge):(typeof H.componentDidUpdate!="function"||ne===c.memoizedProps&&Ee===c.memoizedState||(p.flags|=4),typeof H.getSnapshotBeforeUpdate!="function"||ne===c.memoizedProps&&Ee===c.memoizedState||(p.flags|=1024),w=!1)}return go(c,p,y,w,M,T)}function go(c,p,y,w,T,M){jl(c,p);var H=(p.flags&128)!==0;if(!w&&!H)return T&&Ha(p,y,!1),bn(c,p,M);w=p.stateNode,Vu.current=p;var ne=H&&typeof y.getDerivedStateFromError!="function"?null:w.render();return p.flags|=1,c!==null&&H?(p.child=fr(p,c.child,null,M),p.child=fr(p,null,ne,M)):Dt(c,p,ne,M),p.memoizedState=w.state,T&&Ha(p,y,!0),p.child}function $l(c){var p=c.stateNode;p.pendingContext?za(c,p.pendingContext,p.pendingContext!==p.context):p.context&&za(c,p.context,!1),Qi(c,p.containerInfo)}function Ul(c,p,y,w,T){return hr(),Wi(T),p.flags|=256,Dt(c,p,y,w),p.child}var vo={dehydrated:null,treeContext:null,retryLane:0};function yo(c){return{baseLanes:c,cachePool:null,transitions:null}}function zl(c,p,y){var w=p.pendingProps,T=ot.current,M=!1,H=(p.flags&128)!==0,ne;if((ne=H)||(ne=c!==null&&c.memoizedState===null?!1:(T&2)!==0),ne?(M=!0,p.flags&=-129):(c===null||c.memoizedState!==null)&&(T|=1),Ze(ot,T&1),c===null)return Hi(p),c=p.memoizedState,c!==null&&(c=c.dehydrated,c!==null)?((p.mode&1)===0?p.lanes=1:c.data==="$!"?p.lanes=8:p.lanes=1073741824,null):(H=w.children,c=w.fallback,M?(w=p.mode,M=p.child,H={mode:"hidden",children:H},(w&1)===0&&M!==null?(M.childLanes=0,M.pendingProps=H):M=ei(H,w,0,null),c=Zn(c,w,y,null),M.return=p,c.return=p,M.sibling=c,p.child=M,p.child.memoizedState=yo(y),p.memoizedState=vo,c):xo(p,H));if(T=c.memoizedState,T!==null&&(ne=T.dehydrated,ne!==null))return Hu(c,p,H,w,ne,T,y);if(M){M=w.fallback,H=p.mode,T=c.child,ne=T.sibling;var se={mode:"hidden",children:w.children};return(H&1)===0&&p.child!==T?(w=p.child,w.childLanes=0,w.pendingProps=se,p.deletions=null):(w=Bn(T,se),w.subtreeFlags=T.subtreeFlags&14680064),ne!==null?M=Bn(ne,M):(M=Zn(M,H,y,null),M.flags|=2),M.return=p,w.return=p,w.sibling=M,p.child=w,w=M,M=p.child,H=c.child.memoizedState,H=H===null?yo(y):{baseLanes:H.baseLanes|y,cachePool:null,transitions:H.transitions},M.memoizedState=H,M.childLanes=c.childLanes&~y,p.memoizedState=vo,w}return M=c.child,c=M.sibling,w=Bn(M,{mode:"visible",children:w.children}),(p.mode&1)===0&&(w.lanes=y),w.return=p,w.sibling=null,c!==null&&(y=p.deletions,y===null?(p.deletions=[c],p.flags|=16):y.push(c)),p.child=w,p.memoizedState=null,w}function xo(c,p){return p=ei({mode:"visible",children:p},c.mode,0,null),p.return=c,c.child=p}function Us(c,p,y,w){return w!==null&&Wi(w),fr(p,c.child,null,y),c=xo(p,p.pendingProps.children),c.flags|=2,p.memoizedState=null,c}function Hu(c,p,y,w,T,M,H){if(y)return p.flags&256?(p.flags&=-257,w=fo(Error(t(422))),Us(c,p,H,w)):p.memoizedState!==null?(p.child=c.child,p.flags|=128,null):(M=w.fallback,T=p.mode,w=ei({mode:"visible",children:w.children},T,0,null),M=Zn(M,T,H,null),M.flags|=2,w.return=p,M.return=p,w.sibling=M,p.child=w,(p.mode&1)!==0&&fr(p,c.child,null,H),p.child.memoizedState=yo(H),p.memoizedState=vo,M);if((p.mode&1)===0)return Us(c,p,H,null);if(T.data==="$!"){if(w=T.nextSibling&&T.nextSibling.dataset,w)var ne=w.dgst;return w=ne,M=Error(t(419)),w=fo(M,w,void 0),Us(c,p,H,w)}if(ne=(H&c.childLanes)!==0,Ft||ne){if(w=wt,w!==null){switch(H&-H){case 4:T=2;break;case 16:T=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:T=32;break;case 536870912:T=268435456;break;default:T=0}T=(T&(w.suspendedLanes|H))!==0?0:T,T!==0&&T!==M.retryLane&&(M.retryLane=T,yn(c,T),on(w,c,T,-1))}return No(),w=fo(Error(t(421))),Us(c,p,H,w)}return T.data==="$?"?(p.flags|=128,p.child=c.child,p=rd.bind(null,c),T._reactRetry=p,null):(c=M.treeContext,Vt=Rn(T.nextSibling),zt=p,rt=!0,tn=null,c!==null&&(Gt[qt++]=gn,Gt[qt++]=vn,Gt[qt++]=Hn,gn=c.id,vn=c.overflow,Hn=p),p=xo(p,w.children),p.flags|=4096,p)}function Vl(c,p,y){c.lanes|=p;var w=c.alternate;w!==null&&(w.lanes|=p),Xi(c.return,p,y)}function bo(c,p,y,w,T){var M=c.memoizedState;M===null?c.memoizedState={isBackwards:p,rendering:null,renderingStartTime:0,last:w,tail:y,tailMode:T}:(M.isBackwards=p,M.rendering=null,M.renderingStartTime=0,M.last=w,M.tail=y,M.tailMode=T)}function Hl(c,p,y){var w=p.pendingProps,T=w.revealOrder,M=w.tail;if(Dt(c,p,w.children,y),w=ot.current,(w&2)!==0)w=w&1|2,p.flags|=128;else{if(c!==null&&(c.flags&128)!==0)e:for(c=p.child;c!==null;){if(c.tag===13)c.memoizedState!==null&&Vl(c,y,p);else if(c.tag===19)Vl(c,y,p);else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===p)break e;for(;c.sibling===null;){if(c.return===null||c.return===p)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}w&=1}if(Ze(ot,w),(p.mode&1)===0)p.memoizedState=null;else switch(T){case"forwards":for(y=p.child,T=null;y!==null;)c=y.alternate,c!==null&&Os(c)===null&&(T=y),y=y.sibling;y=T,y===null?(T=p.child,p.child=null):(T=y.sibling,y.sibling=null),bo(p,!1,T,y,M);break;case"backwards":for(y=null,T=p.child,p.child=null;T!==null;){if(c=T.alternate,c!==null&&Os(c)===null){p.child=T;break}c=T.sibling,T.sibling=y,y=T,T=c}bo(p,!0,y,null,M);break;case"together":bo(p,!1,null,null,void 0);break;default:p.memoizedState=null}return p.child}function zs(c,p){(p.mode&1)===0&&c!==null&&(c.alternate=null,p.alternate=null,p.flags|=2)}function bn(c,p,y){if(c!==null&&(p.dependencies=c.dependencies),Xn|=p.lanes,(y&p.childLanes)===0)return null;if(c!==null&&p.child!==c.child)throw Error(t(153));if(p.child!==null){for(c=p.child,y=Bn(c,c.pendingProps),p.child=y,y.return=p;c.sibling!==null;)c=c.sibling,y=y.sibling=Bn(c,c.pendingProps),y.return=p;y.sibling=null}return p.child}function Wu(c,p,y){switch(p.tag){case 3:$l(p),hr();break;case 5:sl(p);break;case 1:Lt(p.type)&&As(p);break;case 4:Qi(p,p.stateNode.containerInfo);break;case 10:var w=p.type._context,T=p.memoizedProps.value;Ze(ks,w._currentValue),w._currentValue=T;break;case 13:if(w=p.memoizedState,w!==null)return w.dehydrated!==null?(Ze(ot,ot.current&1),p.flags|=128,null):(y&p.child.childLanes)!==0?zl(c,p,y):(Ze(ot,ot.current&1),c=bn(c,p,y),c!==null?c.sibling:null);Ze(ot,ot.current&1);break;case 19:if(w=(y&p.childLanes)!==0,(c.flags&128)!==0){if(w)return Hl(c,p,y);p.flags|=128}if(T=p.memoizedState,T!==null&&(T.rendering=null,T.tail=null,T.lastEffect=null),Ze(ot,ot.current),w)break;return null;case 22:case 23:return p.lanes=0,Fl(c,p,y)}return bn(c,p,y)}var Wl,Eo,Gl,ql;Wl=function(c,p){for(var y=p.child;y!==null;){if(y.tag===5||y.tag===6)c.appendChild(y.stateNode);else if(y.tag!==4&&y.child!==null){y.child.return=y,y=y.child;continue}if(y===p)break;for(;y.sibling===null;){if(y.return===null||y.return===p)return;y=y.return}y.sibling.return=y.return,y=y.sibling}},Eo=function(){},Gl=function(c,p,y,w){var T=c.memoizedProps;if(T!==w){c=p.stateNode,qn(un.current);var M=null;switch(y){case"input":T=ve(c,T),w=ve(c,w),M=[];break;case"select":T=I({},T,{value:void 0}),w=I({},w,{value:void 0}),M=[];break;case"textarea":T=Pe(c,T),w=Pe(c,w),M=[];break;default:typeof T.onClick!="function"&&typeof w.onClick=="function"&&(c.onclick=Es)}le(y,w);var H;y=null;for(ge in T)if(!w.hasOwnProperty(ge)&&T.hasOwnProperty(ge)&&T[ge]!=null)if(ge==="style"){var ne=T[ge];for(H in ne)ne.hasOwnProperty(H)&&(y||(y={}),y[H]="")}else ge!=="dangerouslySetInnerHTML"&&ge!=="children"&&ge!=="suppressContentEditableWarning"&&ge!=="suppressHydrationWarning"&&ge!=="autoFocus"&&(i.hasOwnProperty(ge)?M||(M=[]):(M=M||[]).push(ge,null));for(ge in w){var se=w[ge];if(ne=T?.[ge],w.hasOwnProperty(ge)&&se!==ne&&(se!=null||ne!=null))if(ge==="style")if(ne){for(H in ne)!ne.hasOwnProperty(H)||se&&se.hasOwnProperty(H)||(y||(y={}),y[H]="");for(H in se)se.hasOwnProperty(H)&&ne[H]!==se[H]&&(y||(y={}),y[H]=se[H])}else y||(M||(M=[]),M.push(ge,y)),y=se;else ge==="dangerouslySetInnerHTML"?(se=se?se.__html:void 0,ne=ne?ne.__html:void 0,se!=null&&ne!==se&&(M=M||[]).push(ge,se)):ge==="children"?typeof se!="string"&&typeof se!="number"||(M=M||[]).push(ge,""+se):ge!=="suppressContentEditableWarning"&&ge!=="suppressHydrationWarning"&&(i.hasOwnProperty(ge)?(se!=null&&ge==="onScroll"&&tt("scroll",c),M||ne===se||(M=[])):(M=M||[]).push(ge,se))}y&&(M=M||[]).push("style",y);var ge=M;(p.updateQueue=ge)&&(p.flags|=4)}},ql=function(c,p,y,w){y!==w&&(p.flags|=4)};function Xr(c,p){if(!rt)switch(c.tailMode){case"hidden":p=c.tail;for(var y=null;p!==null;)p.alternate!==null&&(y=p),p=p.sibling;y===null?c.tail=null:y.sibling=null;break;case"collapsed":y=c.tail;for(var w=null;y!==null;)y.alternate!==null&&(w=y),y=y.sibling;w===null?p||c.tail===null?c.tail=null:c.tail.sibling=null:w.sibling=null}}function Pt(c){var p=c.alternate!==null&&c.alternate.child===c.child,y=0,w=0;if(p)for(var T=c.child;T!==null;)y|=T.lanes|T.childLanes,w|=T.subtreeFlags&14680064,w|=T.flags&14680064,T.return=c,T=T.sibling;else for(T=c.child;T!==null;)y|=T.lanes|T.childLanes,w|=T.subtreeFlags,w|=T.flags,T.return=c,T=T.sibling;return c.subtreeFlags|=w,c.childLanes=y,p}function Gu(c,p,y){var w=p.pendingProps;switch(zi(p),p.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pt(p),null;case 1:return Lt(p.type)&&_s(),Pt(p),null;case 3:return w=p.stateNode,gr(),nt(Nt),nt(Ct),to(),w.pendingContext&&(w.context=w.pendingContext,w.pendingContext=null),(c===null||c.child===null)&&(Rs(p)?p.flags|=4:c===null||c.memoizedState.isDehydrated&&(p.flags&256)===0||(p.flags|=1024,tn!==null&&(Do(tn),tn=null))),Eo(c,p),Pt(p),null;case 5:Zi(p);var T=qn(Hr.current);if(y=p.type,c!==null&&p.stateNode!=null)Gl(c,p,y,w,T),c.ref!==p.ref&&(p.flags|=512,p.flags|=2097152);else{if(!w){if(p.stateNode===null)throw Error(t(166));return Pt(p),null}if(c=qn(un.current),Rs(p)){w=p.stateNode,y=p.type;var M=p.memoizedProps;switch(w[ln]=p,w[Br]=M,c=(p.mode&1)!==0,y){case"dialog":tt("cancel",w),tt("close",w);break;case"iframe":case"object":case"embed":tt("load",w);break;case"video":case"audio":for(T=0;T<Lr.length;T++)tt(Lr[T],w);break;case"source":tt("error",w);break;case"img":case"image":case"link":tt("error",w),tt("load",w);break;case"details":tt("toggle",w);break;case"input":ce(w,M),tt("invalid",w);break;case"select":w._wrapperState={wasMultiple:!!M.multiple},tt("invalid",w);break;case"textarea":Oe(w,M),tt("invalid",w)}le(y,M),T=null;for(var H in M)if(M.hasOwnProperty(H)){var ne=M[H];H==="children"?typeof ne=="string"?w.textContent!==ne&&(M.suppressHydrationWarning!==!0&&bs(w.textContent,ne,c),T=["children",ne]):typeof ne=="number"&&w.textContent!==""+ne&&(M.suppressHydrationWarning!==!0&&bs(w.textContent,ne,c),T=["children",""+ne]):i.hasOwnProperty(H)&&ne!=null&&H==="onScroll"&&tt("scroll",w)}switch(y){case"input":J(w),pe(w,M,!0);break;case"textarea":J(w),Te(w);break;case"select":case"option":break;default:typeof M.onClick=="function"&&(w.onclick=Es)}w=T,p.updateQueue=w,w!==null&&(p.flags|=4)}else{H=T.nodeType===9?T:T.ownerDocument,c==="http://www.w3.org/1999/xhtml"&&(c=$e(y)),c==="http://www.w3.org/1999/xhtml"?y==="script"?(c=H.createElement("div"),c.innerHTML="<script><\/script>",c=c.removeChild(c.firstChild)):typeof w.is=="string"?c=H.createElement(y,{is:w.is}):(c=H.createElement(y),y==="select"&&(H=c,w.multiple?H.multiple=!0:w.size&&(H.size=w.size))):c=H.createElementNS(c,y),c[ln]=p,c[Br]=w,Wl(c,p,!1,!1),p.stateNode=c;e:{switch(H=Re(y,w),y){case"dialog":tt("cancel",c),tt("close",c),T=w;break;case"iframe":case"object":case"embed":tt("load",c),T=w;break;case"video":case"audio":for(T=0;T<Lr.length;T++)tt(Lr[T],c);T=w;break;case"source":tt("error",c),T=w;break;case"img":case"image":case"link":tt("error",c),tt("load",c),T=w;break;case"details":tt("toggle",c),T=w;break;case"input":ce(c,w),T=ve(c,w),tt("invalid",c);break;case"option":T=w;break;case"select":c._wrapperState={wasMultiple:!!w.multiple},T=I({},w,{value:void 0}),tt("invalid",c);break;case"textarea":Oe(c,w),T=Pe(c,w),tt("invalid",c);break;default:T=w}le(y,T),ne=T;for(M in ne)if(ne.hasOwnProperty(M)){var se=ne[M];M==="style"?be(c,se):M==="dangerouslySetInnerHTML"?(se=se?se.__html:void 0,se!=null&&Ke(c,se)):M==="children"?typeof se=="string"?(y!=="textarea"||se!=="")&&Ge(c,se):typeof se=="number"&&Ge(c,""+se):M!=="suppressContentEditableWarning"&&M!=="suppressHydrationWarning"&&M!=="autoFocus"&&(i.hasOwnProperty(M)?se!=null&&M==="onScroll"&&tt("scroll",c):se!=null&&S(c,M,se,H))}switch(y){case"input":J(c),pe(c,w,!1);break;case"textarea":J(c),Te(c);break;case"option":w.value!=null&&c.setAttribute("value",""+B(w.value));break;case"select":c.multiple=!!w.multiple,M=w.value,M!=null?Ce(c,!!w.multiple,M,!1):w.defaultValue!=null&&Ce(c,!!w.multiple,w.defaultValue,!0);break;default:typeof T.onClick=="function"&&(c.onclick=Es)}switch(y){case"button":case"input":case"select":case"textarea":w=!!w.autoFocus;break e;case"img":w=!0;break e;default:w=!1}}w&&(p.flags|=4)}p.ref!==null&&(p.flags|=512,p.flags|=2097152)}return Pt(p),null;case 6:if(c&&p.stateNode!=null)ql(c,p,c.memoizedProps,w);else{if(typeof w!="string"&&p.stateNode===null)throw Error(t(166));if(y=qn(Hr.current),qn(un.current),Rs(p)){if(w=p.stateNode,y=p.memoizedProps,w[ln]=p,(M=w.nodeValue!==y)&&(c=zt,c!==null))switch(c.tag){case 3:bs(w.nodeValue,y,(c.mode&1)!==0);break;case 5:c.memoizedProps.suppressHydrationWarning!==!0&&bs(w.nodeValue,y,(c.mode&1)!==0)}M&&(p.flags|=4)}else w=(y.nodeType===9?y:y.ownerDocument).createTextNode(w),w[ln]=p,p.stateNode=w}return Pt(p),null;case 13:if(nt(ot),w=p.memoizedState,c===null||c.memoizedState!==null&&c.memoizedState.dehydrated!==null){if(rt&&Vt!==null&&(p.mode&1)!==0&&(p.flags&128)===0)Ya(),hr(),p.flags|=98560,M=!1;else if(M=Rs(p),w!==null&&w.dehydrated!==null){if(c===null){if(!M)throw Error(t(318));if(M=p.memoizedState,M=M!==null?M.dehydrated:null,!M)throw Error(t(317));M[ln]=p}else hr(),(p.flags&128)===0&&(p.memoizedState=null),p.flags|=4;Pt(p),M=!1}else tn!==null&&(Do(tn),tn=null),M=!0;if(!M)return p.flags&65536?p:null}return(p.flags&128)!==0?(p.lanes=y,p):(w=w!==null,w!==(c!==null&&c.memoizedState!==null)&&w&&(p.child.flags|=8192,(p.mode&1)!==0&&(c===null||(ot.current&1)!==0?yt===0&&(yt=3):No())),p.updateQueue!==null&&(p.flags|=4),Pt(p),null);case 4:return gr(),Eo(c,p),c===null&&Fr(p.stateNode.containerInfo),Pt(p),null;case 10:return Ki(p.type._context),Pt(p),null;case 17:return Lt(p.type)&&_s(),Pt(p),null;case 19:if(nt(ot),M=p.memoizedState,M===null)return Pt(p),null;if(w=(p.flags&128)!==0,H=M.rendering,H===null)if(w)Xr(M,!1);else{if(yt!==0||c!==null&&(c.flags&128)!==0)for(c=p.child;c!==null;){if(H=Os(c),H!==null){for(p.flags|=128,Xr(M,!1),w=H.updateQueue,w!==null&&(p.updateQueue=w,p.flags|=4),p.subtreeFlags=0,w=y,y=p.child;y!==null;)M=y,c=w,M.flags&=14680066,H=M.alternate,H===null?(M.childLanes=0,M.lanes=c,M.child=null,M.subtreeFlags=0,M.memoizedProps=null,M.memoizedState=null,M.updateQueue=null,M.dependencies=null,M.stateNode=null):(M.childLanes=H.childLanes,M.lanes=H.lanes,M.child=H.child,M.subtreeFlags=0,M.deletions=null,M.memoizedProps=H.memoizedProps,M.memoizedState=H.memoizedState,M.updateQueue=H.updateQueue,M.type=H.type,c=H.dependencies,M.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext}),y=y.sibling;return Ze(ot,ot.current&1|2),p.child}c=c.sibling}M.tail!==null&&ft()>br&&(p.flags|=128,w=!0,Xr(M,!1),p.lanes=4194304)}else{if(!w)if(c=Os(H),c!==null){if(p.flags|=128,w=!0,y=c.updateQueue,y!==null&&(p.updateQueue=y,p.flags|=4),Xr(M,!0),M.tail===null&&M.tailMode==="hidden"&&!H.alternate&&!rt)return Pt(p),null}else 2*ft()-M.renderingStartTime>br&&y!==1073741824&&(p.flags|=128,w=!0,Xr(M,!1),p.lanes=4194304);M.isBackwards?(H.sibling=p.child,p.child=H):(y=M.last,y!==null?y.sibling=H:p.child=H,M.last=H)}return M.tail!==null?(p=M.tail,M.rendering=p,M.tail=p.sibling,M.renderingStartTime=ft(),p.sibling=null,y=ot.current,Ze(ot,w?y&1|2:y&1),p):(Pt(p),null);case 22:case 23:return Oo(),w=p.memoizedState!==null,c!==null&&c.memoizedState!==null!==w&&(p.flags|=8192),w&&(p.mode&1)!==0?(Ht&1073741824)!==0&&(Pt(p),p.subtreeFlags&6&&(p.flags|=8192)):Pt(p),null;case 24:return null;case 25:return null}throw Error(t(156,p.tag))}function qu(c,p){switch(zi(p),p.tag){case 1:return Lt(p.type)&&_s(),c=p.flags,c&65536?(p.flags=c&-65537|128,p):null;case 3:return gr(),nt(Nt),nt(Ct),to(),c=p.flags,(c&65536)!==0&&(c&128)===0?(p.flags=c&-65537|128,p):null;case 5:return Zi(p),null;case 13:if(nt(ot),c=p.memoizedState,c!==null&&c.dehydrated!==null){if(p.alternate===null)throw Error(t(340));hr()}return c=p.flags,c&65536?(p.flags=c&-65537|128,p):null;case 19:return nt(ot),null;case 4:return gr(),null;case 10:return Ki(p.type._context),null;case 22:case 23:return Oo(),null;case 24:return null;default:return null}}var Vs=!1,kt=!1,Ku=typeof WeakSet=="function"?WeakSet:Set,Me=null;function yr(c,p){var y=c.ref;if(y!==null)if(typeof y=="function")try{y(null)}catch(w){ct(c,p,w)}else y.current=null}function wo(c,p,y){try{y()}catch(w){ct(c,p,w)}}var Kl=!1;function Xu(c,p){if(Ii=cs,c=Ta(),Si(c)){if("selectionStart"in c)var y={start:c.selectionStart,end:c.selectionEnd};else e:{y=(y=c.ownerDocument)&&y.defaultView||window;var w=y.getSelection&&y.getSelection();if(w&&w.rangeCount!==0){y=w.anchorNode;var T=w.anchorOffset,M=w.focusNode;w=w.focusOffset;try{y.nodeType,M.nodeType}catch{y=null;break e}var H=0,ne=-1,se=-1,ge=0,we=0,_e=c,Ee=null;t:for(;;){for(var ke;_e!==y||T!==0&&_e.nodeType!==3||(ne=H+T),_e!==M||w!==0&&_e.nodeType!==3||(se=H+w),_e.nodeType===3&&(H+=_e.nodeValue.length),(ke=_e.firstChild)!==null;)Ee=_e,_e=ke;for(;;){if(_e===c)break t;if(Ee===y&&++ge===T&&(ne=H),Ee===M&&++we===w&&(se=H),(ke=_e.nextSibling)!==null)break;_e=Ee,Ee=_e.parentNode}_e=ke}y=ne===-1||se===-1?null:{start:ne,end:se}}else y=null}y=y||{start:0,end:0}}else y=null;for(Oi={focusedElem:c,selectionRange:y},cs=!1,Me=p;Me!==null;)if(p=Me,c=p.child,(p.subtreeFlags&1028)!==0&&c!==null)c.return=p,Me=c;else for(;Me!==null;){p=Me;try{var De=p.alternate;if((p.flags&1024)!==0)switch(p.tag){case 0:case 11:case 15:break;case 1:if(De!==null){var Ie=De.memoizedProps,pt=De.memoizedState,fe=p.stateNode,ae=fe.getSnapshotBeforeUpdate(p.elementType===p.type?Ie:nn(p.type,Ie),pt);fe.__reactInternalSnapshotBeforeUpdate=ae}break;case 3:var me=p.stateNode.containerInfo;me.nodeType===1?me.textContent="":me.nodeType===9&&me.documentElement&&me.removeChild(me.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Se){ct(p,p.return,Se)}if(c=p.sibling,c!==null){c.return=p.return,Me=c;break}Me=p.return}return De=Kl,Kl=!1,De}function Yr(c,p,y){var w=p.updateQueue;if(w=w!==null?w.lastEffect:null,w!==null){var T=w=w.next;do{if((T.tag&c)===c){var M=T.destroy;T.destroy=void 0,M!==void 0&&wo(p,y,M)}T=T.next}while(T!==w)}}function Hs(c,p){if(p=p.updateQueue,p=p!==null?p.lastEffect:null,p!==null){var y=p=p.next;do{if((y.tag&c)===c){var w=y.create;y.destroy=w()}y=y.next}while(y!==p)}}function _o(c){var p=c.ref;if(p!==null){var y=c.stateNode;switch(c.tag){case 5:c=y;break;default:c=y}typeof p=="function"?p(c):p.current=c}}function Xl(c){var p=c.alternate;p!==null&&(c.alternate=null,Xl(p)),c.child=null,c.deletions=null,c.sibling=null,c.tag===5&&(p=c.stateNode,p!==null&&(delete p[ln],delete p[Br],delete p[ji],delete p[Mu],delete p[Du])),c.stateNode=null,c.return=null,c.dependencies=null,c.memoizedProps=null,c.memoizedState=null,c.pendingProps=null,c.stateNode=null,c.updateQueue=null}function Yl(c){return c.tag===5||c.tag===3||c.tag===4}function Jl(c){e:for(;;){for(;c.sibling===null;){if(c.return===null||Yl(c.return))return null;c=c.return}for(c.sibling.return=c.return,c=c.sibling;c.tag!==5&&c.tag!==6&&c.tag!==18;){if(c.flags&2||c.child===null||c.tag===4)continue e;c.child.return=c,c=c.child}if(!(c.flags&2))return c.stateNode}}function Ao(c,p,y){var w=c.tag;if(w===5||w===6)c=c.stateNode,p?y.nodeType===8?y.parentNode.insertBefore(c,p):y.insertBefore(c,p):(y.nodeType===8?(p=y.parentNode,p.insertBefore(c,y)):(p=y,p.appendChild(c)),y=y._reactRootContainer,y!=null||p.onclick!==null||(p.onclick=Es));else if(w!==4&&(c=c.child,c!==null))for(Ao(c,p,y),c=c.sibling;c!==null;)Ao(c,p,y),c=c.sibling}function So(c,p,y){var w=c.tag;if(w===5||w===6)c=c.stateNode,p?y.insertBefore(c,p):y.appendChild(c);else if(w!==4&&(c=c.child,c!==null))for(So(c,p,y),c=c.sibling;c!==null;)So(c,p,y),c=c.sibling}var At=null,rn=!1;function On(c,p,y){for(y=y.child;y!==null;)Ql(c,p,y),y=y.sibling}function Ql(c,p,y){if(an&&typeof an.onCommitFiberUnmount=="function")try{an.onCommitFiberUnmount(rs,y)}catch{}switch(y.tag){case 5:kt||yr(y,p);case 6:var w=At,T=rn;At=null,On(c,p,y),At=w,rn=T,At!==null&&(rn?(c=At,y=y.stateNode,c.nodeType===8?c.parentNode.removeChild(y):c.removeChild(y)):At.removeChild(y.stateNode));break;case 18:At!==null&&(rn?(c=At,y=y.stateNode,c.nodeType===8?Fi(c.parentNode,y):c.nodeType===1&&Fi(c,y),Rr(c)):Fi(At,y.stateNode));break;case 4:w=At,T=rn,At=y.stateNode.containerInfo,rn=!0,On(c,p,y),At=w,rn=T;break;case 0:case 11:case 14:case 15:if(!kt&&(w=y.updateQueue,w!==null&&(w=w.lastEffect,w!==null))){T=w=w.next;do{var M=T,H=M.destroy;M=M.tag,H!==void 0&&((M&2)!==0||(M&4)!==0)&&wo(y,p,H),T=T.next}while(T!==w)}On(c,p,y);break;case 1:if(!kt&&(yr(y,p),w=y.stateNode,typeof w.componentWillUnmount=="function"))try{w.props=y.memoizedProps,w.state=y.memoizedState,w.componentWillUnmount()}catch(ne){ct(y,p,ne)}On(c,p,y);break;case 21:On(c,p,y);break;case 22:y.mode&1?(kt=(w=kt)||y.memoizedState!==null,On(c,p,y),kt=w):On(c,p,y);break;default:On(c,p,y)}}function Zl(c){var p=c.updateQueue;if(p!==null){c.updateQueue=null;var y=c.stateNode;y===null&&(y=c.stateNode=new Ku),p.forEach(function(w){var T=sd.bind(null,c,w);y.has(w)||(y.add(w),w.then(T,T))})}}function sn(c,p){var y=p.deletions;if(y!==null)for(var w=0;w<y.length;w++){var T=y[w];try{var M=c,H=p,ne=H;e:for(;ne!==null;){switch(ne.tag){case 5:At=ne.stateNode,rn=!1;break e;case 3:At=ne.stateNode.containerInfo,rn=!0;break e;case 4:At=ne.stateNode.containerInfo,rn=!0;break e}ne=ne.return}if(At===null)throw Error(t(160));Ql(M,H,T),At=null,rn=!1;var se=T.alternate;se!==null&&(se.return=null),T.return=null}catch(ge){ct(T,p,ge)}}if(p.subtreeFlags&12854)for(p=p.child;p!==null;)ec(p,c),p=p.sibling}function ec(c,p){var y=c.alternate,w=c.flags;switch(c.tag){case 0:case 11:case 14:case 15:if(sn(p,c),hn(c),w&4){try{Yr(3,c,c.return),Hs(3,c)}catch(Ie){ct(c,c.return,Ie)}try{Yr(5,c,c.return)}catch(Ie){ct(c,c.return,Ie)}}break;case 1:sn(p,c),hn(c),w&512&&y!==null&&yr(y,y.return);break;case 5:if(sn(p,c),hn(c),w&512&&y!==null&&yr(y,y.return),c.flags&32){var T=c.stateNode;try{Ge(T,"")}catch(Ie){ct(c,c.return,Ie)}}if(w&4&&(T=c.stateNode,T!=null)){var M=c.memoizedProps,H=y!==null?y.memoizedProps:M,ne=c.type,se=c.updateQueue;if(c.updateQueue=null,se!==null)try{ne==="input"&&M.type==="radio"&&M.name!=null&&ue(T,M),Re(ne,H);var ge=Re(ne,M);for(H=0;H<se.length;H+=2){var we=se[H],_e=se[H+1];we==="style"?be(T,_e):we==="dangerouslySetInnerHTML"?Ke(T,_e):we==="children"?Ge(T,_e):S(T,we,_e,ge)}switch(ne){case"input":de(T,M);break;case"textarea":xe(T,M);break;case"select":var Ee=T._wrapperState.wasMultiple;T._wrapperState.wasMultiple=!!M.multiple;var ke=M.value;ke!=null?Ce(T,!!M.multiple,ke,!1):Ee!==!!M.multiple&&(M.defaultValue!=null?Ce(T,!!M.multiple,M.defaultValue,!0):Ce(T,!!M.multiple,M.multiple?[]:"",!1))}T[Br]=M}catch(Ie){ct(c,c.return,Ie)}}break;case 6:if(sn(p,c),hn(c),w&4){if(c.stateNode===null)throw Error(t(162));T=c.stateNode,M=c.memoizedProps;try{T.nodeValue=M}catch(Ie){ct(c,c.return,Ie)}}break;case 3:if(sn(p,c),hn(c),w&4&&y!==null&&y.memoizedState.isDehydrated)try{Rr(p.containerInfo)}catch(Ie){ct(c,c.return,Ie)}break;case 4:sn(p,c),hn(c);break;case 13:sn(p,c),hn(c),T=c.child,T.flags&8192&&(M=T.memoizedState!==null,T.stateNode.isHidden=M,!M||T.alternate!==null&&T.alternate.memoizedState!==null||(Ro=ft())),w&4&&Zl(c);break;case 22:if(we=y!==null&&y.memoizedState!==null,c.mode&1?(kt=(ge=kt)||we,sn(p,c),kt=ge):sn(p,c),hn(c),w&8192){if(ge=c.memoizedState!==null,(c.stateNode.isHidden=ge)&&!we&&(c.mode&1)!==0)for(Me=c,we=c.child;we!==null;){for(_e=Me=we;Me!==null;){switch(Ee=Me,ke=Ee.child,Ee.tag){case 0:case 11:case 14:case 15:Yr(4,Ee,Ee.return);break;case 1:yr(Ee,Ee.return);var De=Ee.stateNode;if(typeof De.componentWillUnmount=="function"){w=Ee,y=Ee.return;try{p=w,De.props=p.memoizedProps,De.state=p.memoizedState,De.componentWillUnmount()}catch(Ie){ct(w,y,Ie)}}break;case 5:yr(Ee,Ee.return);break;case 22:if(Ee.memoizedState!==null){rc(_e);continue}}ke!==null?(ke.return=Ee,Me=ke):rc(_e)}we=we.sibling}e:for(we=null,_e=c;;){if(_e.tag===5){if(we===null){we=_e;try{T=_e.stateNode,ge?(M=T.style,typeof M.setProperty=="function"?M.setProperty("display","none","important"):M.display="none"):(ne=_e.stateNode,se=_e.memoizedProps.style,H=se!=null&&se.hasOwnProperty("display")?se.display:null,ne.style.display=Ot("display",H))}catch(Ie){ct(c,c.return,Ie)}}}else if(_e.tag===6){if(we===null)try{_e.stateNode.nodeValue=ge?"":_e.memoizedProps}catch(Ie){ct(c,c.return,Ie)}}else if((_e.tag!==22&&_e.tag!==23||_e.memoizedState===null||_e===c)&&_e.child!==null){_e.child.return=_e,_e=_e.child;continue}if(_e===c)break e;for(;_e.sibling===null;){if(_e.return===null||_e.return===c)break e;we===_e&&(we=null),_e=_e.return}we===_e&&(we=null),_e.sibling.return=_e.return,_e=_e.sibling}}break;case 19:sn(p,c),hn(c),w&4&&Zl(c);break;case 21:break;default:sn(p,c),hn(c)}}function hn(c){var p=c.flags;if(p&2){try{e:{for(var y=c.return;y!==null;){if(Yl(y)){var w=y;break e}y=y.return}throw Error(t(160))}switch(w.tag){case 5:var T=w.stateNode;w.flags&32&&(Ge(T,""),w.flags&=-33);var M=Jl(c);So(c,M,T);break;case 3:case 4:var H=w.stateNode.containerInfo,ne=Jl(c);Ao(c,ne,H);break;default:throw Error(t(161))}}catch(se){ct(c,c.return,se)}c.flags&=-3}p&4096&&(c.flags&=-4097)}function Yu(c,p,y){Me=c,tc(c)}function tc(c,p,y){for(var w=(c.mode&1)!==0;Me!==null;){var T=Me,M=T.child;if(T.tag===22&&w){var H=T.memoizedState!==null||Vs;if(!H){var ne=T.alternate,se=ne!==null&&ne.memoizedState!==null||kt;ne=Vs;var ge=kt;if(Vs=H,(kt=se)&&!ge)for(Me=T;Me!==null;)H=Me,se=H.child,H.tag===22&&H.memoizedState!==null?sc(T):se!==null?(se.return=H,Me=se):sc(T);for(;M!==null;)Me=M,tc(M),M=M.sibling;Me=T,Vs=ne,kt=ge}nc(c)}else(T.subtreeFlags&8772)!==0&&M!==null?(M.return=T,Me=M):nc(c)}}function nc(c){for(;Me!==null;){var p=Me;if((p.flags&8772)!==0){var y=p.alternate;try{if((p.flags&8772)!==0)switch(p.tag){case 0:case 11:case 15:kt||Hs(5,p);break;case 1:var w=p.stateNode;if(p.flags&4&&!kt)if(y===null)w.componentDidMount();else{var T=p.elementType===p.type?y.memoizedProps:nn(p.type,y.memoizedProps);w.componentDidUpdate(T,y.memoizedState,w.__reactInternalSnapshotBeforeUpdate)}var M=p.updateQueue;M!==null&&rl(p,M,w);break;case 3:var H=p.updateQueue;if(H!==null){if(y=null,p.child!==null)switch(p.child.tag){case 5:y=p.child.stateNode;break;case 1:y=p.child.stateNode}rl(p,H,y)}break;case 5:var ne=p.stateNode;if(y===null&&p.flags&4){y=ne;var se=p.memoizedProps;switch(p.type){case"button":case"input":case"select":case"textarea":se.autoFocus&&y.focus();break;case"img":se.src&&(y.src=se.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(p.memoizedState===null){var ge=p.alternate;if(ge!==null){var we=ge.memoizedState;if(we!==null){var _e=we.dehydrated;_e!==null&&Rr(_e)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}kt||p.flags&512&&_o(p)}catch(Ee){ct(p,p.return,Ee)}}if(p===c){Me=null;break}if(y=p.sibling,y!==null){y.return=p.return,Me=y;break}Me=p.return}}function rc(c){for(;Me!==null;){var p=Me;if(p===c){Me=null;break}var y=p.sibling;if(y!==null){y.return=p.return,Me=y;break}Me=p.return}}function sc(c){for(;Me!==null;){var p=Me;try{switch(p.tag){case 0:case 11:case 15:var y=p.return;try{Hs(4,p)}catch(se){ct(p,y,se)}break;case 1:var w=p.stateNode;if(typeof w.componentDidMount=="function"){var T=p.return;try{w.componentDidMount()}catch(se){ct(p,T,se)}}var M=p.return;try{_o(p)}catch(se){ct(p,M,se)}break;case 5:var H=p.return;try{_o(p)}catch(se){ct(p,H,se)}}}catch(se){ct(p,p.return,se)}if(p===c){Me=null;break}var ne=p.sibling;if(ne!==null){ne.return=p.return,Me=ne;break}Me=p.return}}var Ju=Math.ceil,Ws=C.ReactCurrentDispatcher,To=C.ReactCurrentOwner,Yt=C.ReactCurrentBatchConfig,Ve=0,wt=null,mt=null,St=0,Ht=0,xr=Pn(0),yt=0,Jr=null,Xn=0,Gs=0,Co=0,Qr=null,jt=null,Ro=0,br=1/0,En=null,qs=!1,Po=null,Nn=null,Ks=!1,Ln=null,Xs=0,Zr=0,ko=null,Ys=-1,Js=0;function It(){return(Ve&6)!==0?ft():Ys!==-1?Ys:Ys=ft()}function Fn(c){return(c.mode&1)===0?1:(Ve&2)!==0&&St!==0?St&-St:Ou.transition!==null?(Js===0&&(Js=Jo()),Js):(c=Xe,c!==0||(c=window.event,c=c===void 0?16:oa(c.type)),c)}function on(c,p,y,w){if(50<Zr)throw Zr=0,ko=null,Error(t(185));_r(c,y,w),((Ve&2)===0||c!==wt)&&(c===wt&&((Ve&2)===0&&(Gs|=y),yt===4&&jn(c,St)),Bt(c,w),y===1&&Ve===0&&(p.mode&1)===0&&(br=ft()+500,Ss&&Mn()))}function Bt(c,p){var y=c.callbackNode;Oc(c,p);var w=os(c,c===wt?St:0);if(w===0)y!==null&&Ko(y),c.callbackNode=null,c.callbackPriority=0;else if(p=w&-w,c.callbackPriority!==p){if(y!=null&&Ko(y),p===1)c.tag===0?Iu(oc.bind(null,c)):Wa(oc.bind(null,c)),Pu(function(){(Ve&6)===0&&Mn()}),y=null;else{switch(Qo(w)){case 1:y=li;break;case 4:y=Xo;break;case 16:y=ns;break;case 536870912:y=Yo;break;default:y=ns}y=pc(y,ic.bind(null,c))}c.callbackPriority=p,c.callbackNode=y}}function ic(c,p){if(Ys=-1,Js=0,(Ve&6)!==0)throw Error(t(327));var y=c.callbackNode;if(Er()&&c.callbackNode!==y)return null;var w=os(c,c===wt?St:0);if(w===0)return null;if((w&30)!==0||(w&c.expiredLanes)!==0||p)p=Qs(c,w);else{p=w;var T=Ve;Ve|=2;var M=lc();(wt!==c||St!==p)&&(En=null,br=ft()+500,Jn(c,p));do try{ed();break}catch(ne){ac(c,ne)}while(!0);qi(),Ws.current=M,Ve=T,mt!==null?p=0:(wt=null,St=0,p=yt)}if(p!==0){if(p===2&&(T=ci(c),T!==0&&(w=T,p=Mo(c,T))),p===1)throw y=Jr,Jn(c,0),jn(c,w),Bt(c,ft()),y;if(p===6)jn(c,w);else{if(T=c.current.alternate,(w&30)===0&&!Qu(T)&&(p=Qs(c,w),p===2&&(M=ci(c),M!==0&&(w=M,p=Mo(c,M))),p===1))throw y=Jr,Jn(c,0),jn(c,w),Bt(c,ft()),y;switch(c.finishedWork=T,c.finishedLanes=w,p){case 0:case 1:throw Error(t(345));case 2:Qn(c,jt,En);break;case 3:if(jn(c,w),(w&130023424)===w&&(p=Ro+500-ft(),10<p)){if(os(c,0)!==0)break;if(T=c.suspendedLanes,(T&w)!==w){It(),c.pingedLanes|=c.suspendedLanes&T;break}c.timeoutHandle=Li(Qn.bind(null,c,jt,En),p);break}Qn(c,jt,En);break;case 4:if(jn(c,w),(w&4194240)===w)break;for(p=c.eventTimes,T=-1;0<w;){var H=31-Zt(w);M=1<<H,H=p[H],H>T&&(T=H),w&=~M}if(w=T,w=ft()-w,w=(120>w?120:480>w?480:1080>w?1080:1920>w?1920:3e3>w?3e3:4320>w?4320:1960*Ju(w/1960))-w,10<w){c.timeoutHandle=Li(Qn.bind(null,c,jt,En),w);break}Qn(c,jt,En);break;case 5:Qn(c,jt,En);break;default:throw Error(t(329))}}}return Bt(c,ft()),c.callbackNode===y?ic.bind(null,c):null}function Mo(c,p){var y=Qr;return c.current.memoizedState.isDehydrated&&(Jn(c,p).flags|=256),c=Qs(c,p),c!==2&&(p=jt,jt=y,p!==null&&Do(p)),c}function Do(c){jt===null?jt=c:jt.push.apply(jt,c)}function Qu(c){for(var p=c;;){if(p.flags&16384){var y=p.updateQueue;if(y!==null&&(y=y.stores,y!==null))for(var w=0;w<y.length;w++){var T=y[w],M=T.getSnapshot;T=T.value;try{if(!en(M(),T))return!1}catch{return!1}}}if(y=p.child,p.subtreeFlags&16384&&y!==null)y.return=p,p=y;else{if(p===c)break;for(;p.sibling===null;){if(p.return===null||p.return===c)return!0;p=p.return}p.sibling.return=p.return,p=p.sibling}}return!0}function jn(c,p){for(p&=~Co,p&=~Gs,c.suspendedLanes|=p,c.pingedLanes&=~p,c=c.expirationTimes;0<p;){var y=31-Zt(p),w=1<<y;c[y]=-1,p&=~w}}function oc(c){if((Ve&6)!==0)throw Error(t(327));Er();var p=os(c,0);if((p&1)===0)return Bt(c,ft()),null;var y=Qs(c,p);if(c.tag!==0&&y===2){var w=ci(c);w!==0&&(p=w,y=Mo(c,w))}if(y===1)throw y=Jr,Jn(c,0),jn(c,p),Bt(c,ft()),y;if(y===6)throw Error(t(345));return c.finishedWork=c.current.alternate,c.finishedLanes=p,Qn(c,jt,En),Bt(c,ft()),null}function Io(c,p){var y=Ve;Ve|=1;try{return c(p)}finally{Ve=y,Ve===0&&(br=ft()+500,Ss&&Mn())}}function Yn(c){Ln!==null&&Ln.tag===0&&(Ve&6)===0&&Er();var p=Ve;Ve|=1;var y=Yt.transition,w=Xe;try{if(Yt.transition=null,Xe=1,c)return c()}finally{Xe=w,Yt.transition=y,Ve=p,(Ve&6)===0&&Mn()}}function Oo(){Ht=xr.current,nt(xr)}function Jn(c,p){c.finishedWork=null,c.finishedLanes=0;var y=c.timeoutHandle;if(y!==-1&&(c.timeoutHandle=-1,Ru(y)),mt!==null)for(y=mt.return;y!==null;){var w=y;switch(zi(w),w.tag){case 1:w=w.type.childContextTypes,w!=null&&_s();break;case 3:gr(),nt(Nt),nt(Ct),to();break;case 5:Zi(w);break;case 4:gr();break;case 13:nt(ot);break;case 19:nt(ot);break;case 10:Ki(w.type._context);break;case 22:case 23:Oo()}y=y.return}if(wt=c,mt=c=Bn(c.current,null),St=Ht=p,yt=0,Jr=null,Co=Gs=Xn=0,jt=Qr=null,Gn!==null){for(p=0;p<Gn.length;p++)if(y=Gn[p],w=y.interleaved,w!==null){y.interleaved=null;var T=w.next,M=y.pending;if(M!==null){var H=M.next;M.next=T,w.next=H}y.pending=w}Gn=null}return c}function ac(c,p){do{var y=mt;try{if(qi(),Ns.current=Bs,Ls){for(var w=at.memoizedState;w!==null;){var T=w.queue;T!==null&&(T.pending=null),w=w.next}Ls=!1}if(Kn=0,Et=vt=at=null,Wr=!1,Gr=0,To.current=null,y===null||y.return===null){yt=1,Jr=p,mt=null;break}e:{var M=c,H=y.return,ne=y,se=p;if(p=St,ne.flags|=32768,se!==null&&typeof se=="object"&&typeof se.then=="function"){var ge=se,we=ne,_e=we.tag;if((we.mode&1)===0&&(_e===0||_e===11||_e===15)){var Ee=we.alternate;Ee?(we.updateQueue=Ee.updateQueue,we.memoizedState=Ee.memoizedState,we.lanes=Ee.lanes):(we.updateQueue=null,we.memoizedState=null)}var ke=Dl(H);if(ke!==null){ke.flags&=-257,Il(ke,H,ne,M,p),ke.mode&1&&Ml(M,ge,p),p=ke,se=ge;var De=p.updateQueue;if(De===null){var Ie=new Set;Ie.add(se),p.updateQueue=Ie}else De.add(se);break e}else{if((p&1)===0){Ml(M,ge,p),No();break e}se=Error(t(426))}}else if(rt&&ne.mode&1){var pt=Dl(H);if(pt!==null){(pt.flags&65536)===0&&(pt.flags|=256),Il(pt,H,ne,M,p),Wi(vr(se,ne));break e}}M=se=vr(se,ne),yt!==4&&(yt=2),Qr===null?Qr=[M]:Qr.push(M),M=H;do{switch(M.tag){case 3:M.flags|=65536,p&=-p,M.lanes|=p;var fe=Pl(M,se,p);nl(M,fe);break e;case 1:ne=se;var ae=M.type,me=M.stateNode;if((M.flags&128)===0&&(typeof ae.getDerivedStateFromError=="function"||me!==null&&typeof me.componentDidCatch=="function"&&(Nn===null||!Nn.has(me)))){M.flags|=65536,p&=-p,M.lanes|=p;var Se=kl(M,ne,p);nl(M,Se);break e}}M=M.return}while(M!==null)}uc(y)}catch(Ne){p=Ne,mt===y&&y!==null&&(mt=y=y.return);continue}break}while(!0)}function lc(){var c=Ws.current;return Ws.current=Bs,c===null?Bs:c}function No(){(yt===0||yt===3||yt===2)&&(yt=4),wt===null||(Xn&268435455)===0&&(Gs&268435455)===0||jn(wt,St)}function Qs(c,p){var y=Ve;Ve|=2;var w=lc();(wt!==c||St!==p)&&(En=null,Jn(c,p));do try{Zu();break}catch(T){ac(c,T)}while(!0);if(qi(),Ve=y,Ws.current=w,mt!==null)throw Error(t(261));return wt=null,St=0,yt}function Zu(){for(;mt!==null;)cc(mt)}function ed(){for(;mt!==null&&!Sc();)cc(mt)}function cc(c){var p=fc(c.alternate,c,Ht);c.memoizedProps=c.pendingProps,p===null?uc(c):mt=p,To.current=null}function uc(c){var p=c;do{var y=p.alternate;if(c=p.return,(p.flags&32768)===0){if(y=Gu(y,p,Ht),y!==null){mt=y;return}}else{if(y=qu(y,p),y!==null){y.flags&=32767,mt=y;return}if(c!==null)c.flags|=32768,c.subtreeFlags=0,c.deletions=null;else{yt=6,mt=null;return}}if(p=p.sibling,p!==null){mt=p;return}mt=p=c}while(p!==null);yt===0&&(yt=5)}function Qn(c,p,y){var w=Xe,T=Yt.transition;try{Yt.transition=null,Xe=1,td(c,p,y,w)}finally{Yt.transition=T,Xe=w}return null}function td(c,p,y,w){do Er();while(Ln!==null);if((Ve&6)!==0)throw Error(t(327));y=c.finishedWork;var T=c.finishedLanes;if(y===null)return null;if(c.finishedWork=null,c.finishedLanes=0,y===c.current)throw Error(t(177));c.callbackNode=null,c.callbackPriority=0;var M=y.lanes|y.childLanes;if(Nc(c,M),c===wt&&(mt=wt=null,St=0),(y.subtreeFlags&2064)===0&&(y.flags&2064)===0||Ks||(Ks=!0,pc(ns,function(){return Er(),null})),M=(y.flags&15990)!==0,(y.subtreeFlags&15990)!==0||M){M=Yt.transition,Yt.transition=null;var H=Xe;Xe=1;var ne=Ve;Ve|=4,To.current=null,Xu(c,y),ec(y,c),Eu(Oi),cs=!!Ii,Oi=Ii=null,c.current=y,Yu(y),Tc(),Ve=ne,Xe=H,Yt.transition=M}else c.current=y;if(Ks&&(Ks=!1,Ln=c,Xs=T),M=c.pendingLanes,M===0&&(Nn=null),Pc(y.stateNode),Bt(c,ft()),p!==null)for(w=c.onRecoverableError,y=0;y<p.length;y++)T=p[y],w(T.value,{componentStack:T.stack,digest:T.digest});if(qs)throw qs=!1,c=Po,Po=null,c;return(Xs&1)!==0&&c.tag!==0&&Er(),M=c.pendingLanes,(M&1)!==0?c===ko?Zr++:(Zr=0,ko=c):Zr=0,Mn(),null}function Er(){if(Ln!==null){var c=Qo(Xs),p=Yt.transition,y=Xe;try{if(Yt.transition=null,Xe=16>c?16:c,Ln===null)var w=!1;else{if(c=Ln,Ln=null,Xs=0,(Ve&6)!==0)throw Error(t(331));var T=Ve;for(Ve|=4,Me=c.current;Me!==null;){var M=Me,H=M.child;if((Me.flags&16)!==0){var ne=M.deletions;if(ne!==null){for(var se=0;se<ne.length;se++){var ge=ne[se];for(Me=ge;Me!==null;){var we=Me;switch(we.tag){case 0:case 11:case 15:Yr(8,we,M)}var _e=we.child;if(_e!==null)_e.return=we,Me=_e;else for(;Me!==null;){we=Me;var Ee=we.sibling,ke=we.return;if(Xl(we),we===ge){Me=null;break}if(Ee!==null){Ee.return=ke,Me=Ee;break}Me=ke}}}var De=M.alternate;if(De!==null){var Ie=De.child;if(Ie!==null){De.child=null;do{var pt=Ie.sibling;Ie.sibling=null,Ie=pt}while(Ie!==null)}}Me=M}}if((M.subtreeFlags&2064)!==0&&H!==null)H.return=M,Me=H;else e:for(;Me!==null;){if(M=Me,(M.flags&2048)!==0)switch(M.tag){case 0:case 11:case 15:Yr(9,M,M.return)}var fe=M.sibling;if(fe!==null){fe.return=M.return,Me=fe;break e}Me=M.return}}var ae=c.current;for(Me=ae;Me!==null;){H=Me;var me=H.child;if((H.subtreeFlags&2064)!==0&&me!==null)me.return=H,Me=me;else e:for(H=ae;Me!==null;){if(ne=Me,(ne.flags&2048)!==0)try{switch(ne.tag){case 0:case 11:case 15:Hs(9,ne)}}catch(Ne){ct(ne,ne.return,Ne)}if(ne===H){Me=null;break e}var Se=ne.sibling;if(Se!==null){Se.return=ne.return,Me=Se;break e}Me=ne.return}}if(Ve=T,Mn(),an&&typeof an.onPostCommitFiberRoot=="function")try{an.onPostCommitFiberRoot(rs,c)}catch{}w=!0}return w}finally{Xe=y,Yt.transition=p}}return!1}function dc(c,p,y){p=vr(y,p),p=Pl(c,p,1),c=In(c,p,1),p=It(),c!==null&&(_r(c,1,p),Bt(c,p))}function ct(c,p,y){if(c.tag===3)dc(c,c,y);else for(;p!==null;){if(p.tag===3){dc(p,c,y);break}else if(p.tag===1){var w=p.stateNode;if(typeof p.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(Nn===null||!Nn.has(w))){c=vr(y,c),c=kl(p,c,1),p=In(p,c,1),c=It(),p!==null&&(_r(p,1,c),Bt(p,c));break}}p=p.return}}function nd(c,p,y){var w=c.pingCache;w!==null&&w.delete(p),p=It(),c.pingedLanes|=c.suspendedLanes&y,wt===c&&(St&y)===y&&(yt===4||yt===3&&(St&130023424)===St&&500>ft()-Ro?Jn(c,0):Co|=y),Bt(c,p)}function hc(c,p){p===0&&((c.mode&1)===0?p=1:(p=is,is<<=1,(is&130023424)===0&&(is=4194304)));var y=It();c=yn(c,p),c!==null&&(_r(c,p,y),Bt(c,y))}function rd(c){var p=c.memoizedState,y=0;p!==null&&(y=p.retryLane),hc(c,y)}function sd(c,p){var y=0;switch(c.tag){case 13:var w=c.stateNode,T=c.memoizedState;T!==null&&(y=T.retryLane);break;case 19:w=c.stateNode;break;default:throw Error(t(314))}w!==null&&w.delete(p),hc(c,y)}var fc;fc=function(c,p,y){if(c!==null)if(c.memoizedProps!==p.pendingProps||Nt.current)Ft=!0;else{if((c.lanes&y)===0&&(p.flags&128)===0)return Ft=!1,Wu(c,p,y);Ft=(c.flags&131072)!==0}else Ft=!1,rt&&(p.flags&1048576)!==0&&Ga(p,Cs,p.index);switch(p.lanes=0,p.tag){case 2:var w=p.type;zs(c,p),c=p.pendingProps;var T=cr(p,Ct.current);mr(p,y),T=so(null,p,w,c,T,y);var M=io();return p.flags|=1,typeof T=="object"&&T!==null&&typeof T.render=="function"&&T.$$typeof===void 0?(p.tag=1,p.memoizedState=null,p.updateQueue=null,Lt(w)?(M=!0,As(p)):M=!1,p.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,Ji(p),T.updater=$s,p.stateNode=T,T._reactInternals=p,ho(p,w,c,y),p=go(null,p,w,!0,M,y)):(p.tag=0,rt&&M&&Ui(p),Dt(null,p,T,y),p=p.child),p;case 16:w=p.elementType;e:{switch(zs(c,p),c=p.pendingProps,T=w._init,w=T(w._payload),p.type=w,T=p.tag=ad(w),c=nn(w,c),T){case 0:p=mo(null,p,w,c,y);break e;case 1:p=Bl(null,p,w,c,y);break e;case 11:p=Ol(null,p,w,c,y);break e;case 14:p=Nl(null,p,w,nn(w.type,c),y);break e}throw Error(t(306,w,""))}return p;case 0:return w=p.type,T=p.pendingProps,T=p.elementType===w?T:nn(w,T),mo(c,p,w,T,y);case 1:return w=p.type,T=p.pendingProps,T=p.elementType===w?T:nn(w,T),Bl(c,p,w,T,y);case 3:e:{if($l(p),c===null)throw Error(t(387));w=p.pendingProps,M=p.memoizedState,T=M.element,tl(c,p),Is(p,w,null,y);var H=p.memoizedState;if(w=H.element,M.isDehydrated)if(M={element:w,isDehydrated:!1,cache:H.cache,pendingSuspenseBoundaries:H.pendingSuspenseBoundaries,transitions:H.transitions},p.updateQueue.baseState=M,p.memoizedState=M,p.flags&256){T=vr(Error(t(423)),p),p=Ul(c,p,w,y,T);break e}else if(w!==T){T=vr(Error(t(424)),p),p=Ul(c,p,w,y,T);break e}else for(Vt=Rn(p.stateNode.containerInfo.firstChild),zt=p,rt=!0,tn=null,y=Za(p,null,w,y),p.child=y;y;)y.flags=y.flags&-3|4096,y=y.sibling;else{if(hr(),w===T){p=bn(c,p,y);break e}Dt(c,p,w,y)}p=p.child}return p;case 5:return sl(p),c===null&&Hi(p),w=p.type,T=p.pendingProps,M=c!==null?c.memoizedProps:null,H=T.children,Ni(w,T)?H=null:M!==null&&Ni(w,M)&&(p.flags|=32),jl(c,p),Dt(c,p,H,y),p.child;case 6:return c===null&&Hi(p),null;case 13:return zl(c,p,y);case 4:return Qi(p,p.stateNode.containerInfo),w=p.pendingProps,c===null?p.child=fr(p,null,w,y):Dt(c,p,w,y),p.child;case 11:return w=p.type,T=p.pendingProps,T=p.elementType===w?T:nn(w,T),Ol(c,p,w,T,y);case 7:return Dt(c,p,p.pendingProps,y),p.child;case 8:return Dt(c,p,p.pendingProps.children,y),p.child;case 12:return Dt(c,p,p.pendingProps.children,y),p.child;case 10:e:{if(w=p.type._context,T=p.pendingProps,M=p.memoizedProps,H=T.value,Ze(ks,w._currentValue),w._currentValue=H,M!==null)if(en(M.value,H)){if(M.children===T.children&&!Nt.current){p=bn(c,p,y);break e}}else for(M=p.child,M!==null&&(M.return=p);M!==null;){var ne=M.dependencies;if(ne!==null){H=M.child;for(var se=ne.firstContext;se!==null;){if(se.context===w){if(M.tag===1){se=xn(-1,y&-y),se.tag=2;var ge=M.updateQueue;if(ge!==null){ge=ge.shared;var we=ge.pending;we===null?se.next=se:(se.next=we.next,we.next=se),ge.pending=se}}M.lanes|=y,se=M.alternate,se!==null&&(se.lanes|=y),Xi(M.return,y,p),ne.lanes|=y;break}se=se.next}}else if(M.tag===10)H=M.type===p.type?null:M.child;else if(M.tag===18){if(H=M.return,H===null)throw Error(t(341));H.lanes|=y,ne=H.alternate,ne!==null&&(ne.lanes|=y),Xi(H,y,p),H=M.sibling}else H=M.child;if(H!==null)H.return=M;else for(H=M;H!==null;){if(H===p){H=null;break}if(M=H.sibling,M!==null){M.return=H.return,H=M;break}H=H.return}M=H}Dt(c,p,T.children,y),p=p.child}return p;case 9:return T=p.type,w=p.pendingProps.children,mr(p,y),T=Kt(T),w=w(T),p.flags|=1,Dt(c,p,w,y),p.child;case 14:return w=p.type,T=nn(w,p.pendingProps),T=nn(w.type,T),Nl(c,p,w,T,y);case 15:return Ll(c,p,p.type,p.pendingProps,y);case 17:return w=p.type,T=p.pendingProps,T=p.elementType===w?T:nn(w,T),zs(c,p),p.tag=1,Lt(w)?(c=!0,As(p)):c=!1,mr(p,y),Cl(p,w,T),ho(p,w,T,y),go(null,p,w,!0,c,y);case 19:return Hl(c,p,y);case 22:return Fl(c,p,y)}throw Error(t(156,p.tag))};function pc(c,p){return qo(c,p)}function od(c,p,y,w){this.tag=c,this.key=y,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=p,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Jt(c,p,y,w){return new od(c,p,y,w)}function Lo(c){return c=c.prototype,!(!c||!c.isReactComponent)}function ad(c){if(typeof c=="function")return Lo(c)?1:0;if(c!=null){if(c=c.$$typeof,c===ee)return 11;if(c===ie)return 14}return 2}function Bn(c,p){var y=c.alternate;return y===null?(y=Jt(c.tag,p,c.key,c.mode),y.elementType=c.elementType,y.type=c.type,y.stateNode=c.stateNode,y.alternate=c,c.alternate=y):(y.pendingProps=p,y.type=c.type,y.flags=0,y.subtreeFlags=0,y.deletions=null),y.flags=c.flags&14680064,y.childLanes=c.childLanes,y.lanes=c.lanes,y.child=c.child,y.memoizedProps=c.memoizedProps,y.memoizedState=c.memoizedState,y.updateQueue=c.updateQueue,p=c.dependencies,y.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext},y.sibling=c.sibling,y.index=c.index,y.ref=c.ref,y}function Zs(c,p,y,w,T,M){var H=2;if(w=c,typeof c=="function")Lo(c)&&(H=1);else if(typeof c=="string")H=5;else e:switch(c){case L:return Zn(y.children,T,M,p);case j:H=8,T|=8;break;case F:return c=Jt(12,y,p,T|2),c.elementType=F,c.lanes=M,c;case te:return c=Jt(13,y,p,T),c.elementType=te,c.lanes=M,c;case re:return c=Jt(19,y,p,T),c.elementType=re,c.lanes=M,c;case z:return ei(y,T,M,p);default:if(typeof c=="object"&&c!==null)switch(c.$$typeof){case W:H=10;break e;case K:H=9;break e;case ee:H=11;break e;case ie:H=14;break e;case Q:H=16,w=null;break e}throw Error(t(130,c==null?c:typeof c,""))}return p=Jt(H,y,p,T),p.elementType=c,p.type=w,p.lanes=M,p}function Zn(c,p,y,w){return c=Jt(7,c,w,p),c.lanes=y,c}function ei(c,p,y,w){return c=Jt(22,c,w,p),c.elementType=z,c.lanes=y,c.stateNode={isHidden:!1},c}function Fo(c,p,y){return c=Jt(6,c,null,p),c.lanes=y,c}function jo(c,p,y){return p=Jt(4,c.children!==null?c.children:[],c.key,p),p.lanes=y,p.stateNode={containerInfo:c.containerInfo,pendingChildren:null,implementation:c.implementation},p}function ld(c,p,y,w,T){this.tag=p,this.containerInfo=c,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ui(0),this.expirationTimes=ui(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ui(0),this.identifierPrefix=w,this.onRecoverableError=T,this.mutableSourceEagerHydrationData=null}function Bo(c,p,y,w,T,M,H,ne,se){return c=new ld(c,p,y,ne,se),p===1?(p=1,M===!0&&(p|=8)):p=0,M=Jt(3,null,null,p),c.current=M,M.stateNode=c,M.memoizedState={element:w,isDehydrated:y,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ji(M),c}function cd(c,p,y){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:R,key:w==null?null:""+w,children:c,containerInfo:p,implementation:y}}function mc(c){if(!c)return kn;c=c._reactInternals;e:{if(Un(c)!==c||c.tag!==1)throw Error(t(170));var p=c;do{switch(p.tag){case 3:p=p.stateNode.context;break e;case 1:if(Lt(p.type)){p=p.stateNode.__reactInternalMemoizedMergedChildContext;break e}}p=p.return}while(p!==null);throw Error(t(171))}if(c.tag===1){var y=c.type;if(Lt(y))return Va(c,y,p)}return p}function gc(c,p,y,w,T,M,H,ne,se){return c=Bo(y,w,!0,c,T,M,H,ne,se),c.context=mc(null),y=c.current,w=It(),T=Fn(y),M=xn(w,T),M.callback=p??null,In(y,M,T),c.current.lanes=T,_r(c,T,w),Bt(c,w),c}function ti(c,p,y,w){var T=p.current,M=It(),H=Fn(T);return y=mc(y),p.context===null?p.context=y:p.pendingContext=y,p=xn(M,H),p.payload={element:c},w=w===void 0?null:w,w!==null&&(p.callback=w),c=In(T,p,H),c!==null&&(on(c,T,H,M),Ds(c,T,H)),H}function ni(c){if(c=c.current,!c.child)return null;switch(c.child.tag){case 5:return c.child.stateNode;default:return c.child.stateNode}}function vc(c,p){if(c=c.memoizedState,c!==null&&c.dehydrated!==null){var y=c.retryLane;c.retryLane=y!==0&&y<p?y:p}}function $o(c,p){vc(c,p),(c=c.alternate)&&vc(c,p)}function ud(){return null}var yc=typeof reportError=="function"?reportError:function(c){console.error(c)};function Uo(c){this._internalRoot=c}ri.prototype.render=Uo.prototype.render=function(c){var p=this._internalRoot;if(p===null)throw Error(t(409));ti(c,p,null,null)},ri.prototype.unmount=Uo.prototype.unmount=function(){var c=this._internalRoot;if(c!==null){this._internalRoot=null;var p=c.containerInfo;Yn(function(){ti(null,c,null,null)}),p[pn]=null}};function ri(c){this._internalRoot=c}ri.prototype.unstable_scheduleHydration=function(c){if(c){var p=ta();c={blockedOn:null,target:c,priority:p};for(var y=0;y<Sn.length&&p!==0&&p<Sn[y].priority;y++);Sn.splice(y,0,c),y===0&&sa(c)}};function zo(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)}function si(c){return!(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11&&(c.nodeType!==8||c.nodeValue!==" react-mount-point-unstable "))}function xc(){}function dd(c,p,y,w,T){if(T){if(typeof w=="function"){var M=w;w=function(){var ge=ni(H);M.call(ge)}}var H=gc(p,w,c,0,null,!1,!1,"",xc);return c._reactRootContainer=H,c[pn]=H.current,Fr(c.nodeType===8?c.parentNode:c),Yn(),H}for(;T=c.lastChild;)c.removeChild(T);if(typeof w=="function"){var ne=w;w=function(){var ge=ni(se);ne.call(ge)}}var se=Bo(c,0,!1,null,null,!1,!1,"",xc);return c._reactRootContainer=se,c[pn]=se.current,Fr(c.nodeType===8?c.parentNode:c),Yn(function(){ti(p,se,y,w)}),se}function ii(c,p,y,w,T){var M=y._reactRootContainer;if(M){var H=M;if(typeof T=="function"){var ne=T;T=function(){var se=ni(H);ne.call(se)}}ti(p,H,c,T)}else H=dd(y,p,c,T,w);return ni(H)}Zo=function(c){switch(c.tag){case 3:var p=c.stateNode;if(p.current.memoizedState.isDehydrated){var y=wr(p.pendingLanes);y!==0&&(di(p,y|1),Bt(p,ft()),(Ve&6)===0&&(br=ft()+500,Mn()))}break;case 13:Yn(function(){var w=yn(c,1);if(w!==null){var T=It();on(w,c,1,T)}}),$o(c,1)}},hi=function(c){if(c.tag===13){var p=yn(c,134217728);if(p!==null){var y=It();on(p,c,134217728,y)}$o(c,134217728)}},ea=function(c){if(c.tag===13){var p=Fn(c),y=yn(c,p);if(y!==null){var w=It();on(y,c,p,w)}$o(c,p)}},ta=function(){return Xe},na=function(c,p){var y=Xe;try{return Xe=c,p()}finally{Xe=y}},st=function(c,p,y){switch(p){case"input":if(de(c,y),p=y.name,y.type==="radio"&&p!=null){for(y=c;y.parentNode;)y=y.parentNode;for(y=y.querySelectorAll("input[name="+JSON.stringify(""+p)+'][type="radio"]'),p=0;p<y.length;p++){var w=y[p];if(w!==c&&w.form===c.form){var T=ws(w);if(!T)throw Error(t(90));Z(w),de(w,T)}}}break;case"textarea":xe(c,y);break;case"select":p=y.value,p!=null&&Ce(c,!!y.multiple,p,!1)}},Je=Io,dt=Yn;var hd={usingClientEntryPoint:!1,Events:[$r,ar,ws,Le,Ye,Io]},ts={findFiberByHostInstance:zn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},fd={bundleType:ts.bundleType,version:ts.version,rendererPackageName:ts.rendererPackageName,rendererConfig:ts.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:C.ReactCurrentDispatcher,findHostInstanceByFiber:function(c){return c=Wo(c),c===null?null:c.stateNode},findFiberByHostInstance:ts.findFiberByHostInstance||ud,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var oi=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!oi.isDisabled&&oi.supportsFiber)try{rs=oi.inject(fd),an=oi}catch{}}return reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hd,reactDom_production_min.createPortal=function(c,p){var y=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!zo(p))throw Error(t(200));return cd(c,p,null,y)},reactDom_production_min.createRoot=function(c,p){if(!zo(c))throw Error(t(299));var y=!1,w="",T=yc;return p!=null&&(p.unstable_strictMode===!0&&(y=!0),p.identifierPrefix!==void 0&&(w=p.identifierPrefix),p.onRecoverableError!==void 0&&(T=p.onRecoverableError)),p=Bo(c,1,!1,null,null,y,!1,w,T),c[pn]=p.current,Fr(c.nodeType===8?c.parentNode:c),new Uo(p)},reactDom_production_min.findDOMNode=function(c){if(c==null)return null;if(c.nodeType===1)return c;var p=c._reactInternals;if(p===void 0)throw typeof c.render=="function"?Error(t(188)):(c=Object.keys(c).join(","),Error(t(268,c)));return c=Wo(p),c=c===null?null:c.stateNode,c},reactDom_production_min.flushSync=function(c){return Yn(c)},reactDom_production_min.hydrate=function(c,p,y){if(!si(p))throw Error(t(200));return ii(null,c,p,!0,y)},reactDom_production_min.hydrateRoot=function(c,p,y){if(!zo(c))throw Error(t(405));var w=y!=null&&y.hydratedSources||null,T=!1,M="",H=yc;if(y!=null&&(y.unstable_strictMode===!0&&(T=!0),y.identifierPrefix!==void 0&&(M=y.identifierPrefix),y.onRecoverableError!==void 0&&(H=y.onRecoverableError)),p=gc(p,null,c,1,y??null,T,!1,M,H),c[pn]=p.current,Fr(c),w)for(c=0;c<w.length;c++)y=w[c],T=y._getVersion,T=T(y._source),p.mutableSourceEagerHydrationData==null?p.mutableSourceEagerHydrationData=[y,T]:p.mutableSourceEagerHydrationData.push(y,T);return new ri(p)},reactDom_production_min.render=function(c,p,y){if(!si(p))throw Error(t(200));return ii(null,c,p,!1,y)},reactDom_production_min.unmountComponentAtNode=function(c){if(!si(c))throw Error(t(40));return c._reactRootContainer?(Yn(function(){ii(null,null,c,!1,function(){c._reactRootContainer=null,c[pn]=null})}),!0):!1},reactDom_production_min.unstable_batchedUpdates=Io,reactDom_production_min.unstable_renderSubtreeIntoContainer=function(c,p,y,w){if(!si(y))throw Error(t(200));if(c==null||c._reactInternals===void 0)throw Error(t(38));return ii(c,p,y,!1,w)},reactDom_production_min.version="18.3.1-next-f1338f8080-20240426",reactDom_production_min}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function s(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(s)}catch(e){console.error(e)}}return s(),reactDom.exports=requireReactDom_production_min(),reactDom.exports}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client;hasRequiredClient=1;var s=requireReactDom();return client.createRoot=s.createRoot,client.hydrateRoot=s.hydrateRoot,client}var clientExports=requireClient(),Subscribable=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(s){return this.listeners.add(s),this.onSubscribe(),()=>{this.listeners.delete(s),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},defaultTimeoutProvider={setTimeout:(s,e)=>setTimeout(s,e),clearTimeout:s=>clearTimeout(s),setInterval:(s,e)=>setInterval(s,e),clearInterval:s=>clearInterval(s)},TimeoutManager=class{#e=defaultTimeoutProvider;#t=!1;setTimeoutProvider(s){this.#e=s}setTimeout(s,e){return this.#e.setTimeout(s,e)}clearTimeout(s){this.#e.clearTimeout(s)}setInterval(s,e){return this.#e.setInterval(s,e)}clearInterval(s){this.#e.clearInterval(s)}},timeoutManager=new TimeoutManager;function systemSetTimeoutZero(s){setTimeout(s,0)}var isServer=typeof window>"u"||"Deno"in globalThis;function noop$5(){}function functionalUpdate(s,e){return typeof s=="function"?s(e):s}function isValidTimeout(s){return typeof s=="number"&&s>=0&&s!==1/0}function timeUntilStale(s,e){return Math.max(s+(e||0)-Date.now(),0)}function resolveStaleTime(s,e){return typeof s=="function"?s(e):s}function resolveEnabled(s,e){return typeof s=="function"?s(e):s}function matchQuery(s,e){const{type:t="all",exact:n,fetchStatus:i,predicate:o,queryKey:a,stale:l}=s;if(a){if(n){if(e.queryHash!==hashQueryKeyByOptions(a,e.options))return!1}else if(!partialMatchKey(e.queryKey,a))return!1}if(t!=="all"){const h=e.isActive();if(t==="active"&&!h||t==="inactive"&&h)return!1}return!(typeof l=="boolean"&&e.isStale()!==l||i&&i!==e.state.fetchStatus||o&&!o(e))}function matchMutation(s,e){const{exact:t,status:n,predicate:i,mutationKey:o}=s;if(o){if(!e.options.mutationKey)return!1;if(t){if(hashKey(e.options.mutationKey)!==hashKey(o))return!1}else if(!partialMatchKey(e.options.mutationKey,o))return!1}return!(n&&e.state.status!==n||i&&!i(e))}function hashQueryKeyByOptions(s,e){return(e?.queryKeyHashFn||hashKey)(s)}function hashKey(s){return JSON.stringify(s,(e,t)=>isPlainObject$1(t)?Object.keys(t).sort().reduce((n,i)=>(n[i]=t[i],n),{}):t)}function partialMatchKey(s,e){return s===e?!0:typeof s!=typeof e?!1:s&&e&&typeof s=="object"&&typeof e=="object"?Object.keys(e).every(t=>partialMatchKey(s[t],e[t])):!1}var hasOwn=Object.prototype.hasOwnProperty;function replaceEqualDeep(s,e){if(s===e)return s;const t=isPlainArray(s)&&isPlainArray(e);if(!t&&!(isPlainObject$1(s)&&isPlainObject$1(e)))return e;const i=(t?s:Object.keys(s)).length,o=t?e:Object.keys(e),a=o.length,l=t?new Array(a):{};let h=0;for(let d=0;d<a;d++){const u=t?d:o[d],f=s[u],m=e[u];if(f===m){l[u]=f,(t?d<i:hasOwn.call(s,u))&&h++;continue}if(f===null||m===null||typeof f!="object"||typeof m!="object"){l[u]=m;continue}const v=replaceEqualDeep(f,m);l[u]=v,v===f&&h++}return i===a&&h===i?s:l}function isPlainArray(s){return Array.isArray(s)&&s.length===Object.keys(s).length}function isPlainObject$1(s){if(!hasObjectPrototype(s))return!1;const e=s.constructor;if(e===void 0)return!0;const t=e.prototype;return!(!hasObjectPrototype(t)||!t.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(s)!==Object.prototype)}function hasObjectPrototype(s){return Object.prototype.toString.call(s)==="[object Object]"}function sleep$1(s){return new Promise(e=>{timeoutManager.setTimeout(e,s)})}function replaceData(s,e,t){return typeof t.structuralSharing=="function"?t.structuralSharing(s,e):t.structuralSharing!==!1?replaceEqualDeep(s,e):e}function addToEnd(s,e,t=0){const n=[...s,e];return t&&n.length>t?n.slice(1):n}function addToStart(s,e,t=0){const n=[e,...s];return t&&n.length>t?n.slice(0,-1):n}var skipToken=Symbol();function ensureQueryFn(s,e){return!s.queryFn&&e?.initialPromise?()=>e.initialPromise:!s.queryFn||s.queryFn===skipToken?()=>Promise.reject(new Error(`Missing queryFn: '${s.queryHash}'`)):s.queryFn}var FocusManager=class extends Subscribable{#e;#t;#n;constructor(){super(),this.#n=s=>{if(!isServer&&window.addEventListener){const e=()=>s();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(s){this.#n=s,this.#t?.(),this.#t=s(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(s){this.#e!==s&&(this.#e=s,this.onFocus())}onFocus(){const s=this.isFocused();this.listeners.forEach(e=>{e(s)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},focusManager=new FocusManager;function pendingThenable(){let s,e;const t=new Promise((i,o)=>{s=i,e=o});t.status="pending",t.catch(()=>{});function n(i){Object.assign(t,i),delete t.resolve,delete t.reject}return t.resolve=i=>{n({status:"fulfilled",value:i}),s(i)},t.reject=i=>{n({status:"rejected",reason:i}),e(i)},t}var defaultScheduler=systemSetTimeoutZero;function createNotifyManager(){let s=[],e=0,t=l=>{l()},n=l=>{l()},i=defaultScheduler;const o=l=>{e?s.push(l):i(()=>{t(l)})},a=()=>{const l=s;s=[],l.length&&i(()=>{n(()=>{l.forEach(h=>{t(h)})})})};return{batch:l=>{let h;e++;try{h=l()}finally{e--,e||a()}return h},batchCalls:l=>(...h)=>{o(()=>{l(...h)})},schedule:o,setNotifyFunction:l=>{t=l},setBatchNotifyFunction:l=>{n=l},setScheduler:l=>{i=l}}}var notifyManager=createNotifyManager(),OnlineManager=class extends Subscribable{#e=!0;#t;#n;constructor(){super(),this.#n=s=>{if(!isServer&&window.addEventListener){const e=()=>s(!0),t=()=>s(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",t,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(s){this.#n=s,this.#t?.(),this.#t=s(this.setOnline.bind(this))}setOnline(s){this.#e!==s&&(this.#e=s,this.listeners.forEach(t=>{t(s)}))}isOnline(){return this.#e}},onlineManager=new OnlineManager;function defaultRetryDelay(s){return Math.min(1e3*2**s,3e4)}function canFetch(s){return(s??"online")==="online"?onlineManager.isOnline():!0}var CancelledError=class extends Error{constructor(s){super("CancelledError"),this.revert=s?.revert,this.silent=s?.silent}};function createRetryer(s){let e=!1,t=0,n;const i=pendingThenable(),o=()=>i.status!=="pending",a=x=>{if(!o()){const E=new CancelledError(x);m(E),s.onCancel?.(E)}},l=()=>{e=!0},h=()=>{e=!1},d=()=>focusManager.isFocused()&&(s.networkMode==="always"||onlineManager.isOnline())&&s.canRun(),u=()=>canFetch(s.networkMode)&&s.canRun(),f=x=>{o()||(n?.(),i.resolve(x))},m=x=>{o()||(n?.(),i.reject(x))},v=()=>new Promise(x=>{n=E=>{(o()||d())&&x(E)},s.onPause?.()}).then(()=>{n=void 0,o()||s.onContinue?.()}),g=()=>{if(o())return;let x;const E=t===0?s.initialPromise:void 0;try{x=E??s.fn()}catch(b){x=Promise.reject(b)}Promise.resolve(x).then(f).catch(b=>{if(o())return;const _=s.retry??(isServer?0:3),S=s.retryDelay??defaultRetryDelay,C=typeof S=="function"?S(t,b):S,A=_===!0||typeof _=="number"&&t<_||typeof _=="function"&&_(t,b);if(e||!A){m(b);return}t++,s.onFail?.(t,b),sleep$1(C).then(()=>d()?void 0:v()).then(()=>{e?m(b):g()})})};return{promise:i,status:()=>i.status,cancel:a,continue:()=>(n?.(),i),cancelRetry:l,continueRetry:h,canStart:u,start:()=>(u()?g():v().then(g),i)}}var Removable=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),isValidTimeout(this.gcTime)&&(this.#e=timeoutManager.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(s){this.gcTime=Math.max(this.gcTime||0,s??(isServer?1/0:300*1e3))}clearGcTimeout(){this.#e&&(timeoutManager.clearTimeout(this.#e),this.#e=void 0)}},Query=class extends Removable{#e;#t;#n;#r;#s;#o;#i;constructor(s){super(),this.#i=!1,this.#o=s.defaultOptions,this.setOptions(s.options),this.observers=[],this.#r=s.client,this.#n=this.#r.getQueryCache(),this.queryKey=s.queryKey,this.queryHash=s.queryHash,this.#e=getDefaultState$1(this.options),this.state=s.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#s?.promise}setOptions(s){if(this.options={...this.#o,...s},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const e=getDefaultState$1(this.options);e.data!==void 0&&(this.setData(e.data,{updatedAt:e.dataUpdatedAt,manual:!0}),this.#e=e)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(s,e){const t=replaceData(this.state.data,s,this.options);return this.#a({data:t,type:"success",dataUpdatedAt:e?.updatedAt,manual:e?.manual}),t}setState(s,e){this.#a({type:"setState",state:s,setStateOptions:e})}cancel(s){const e=this.#s?.promise;return this.#s?.cancel(s),e?e.then(noop$5).catch(noop$5):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(s=>resolveEnabled(s.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===skipToken||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(s=>resolveStaleTime(s.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(s=>s.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(s=0){return this.state.data===void 0?!0:s==="static"?!1:this.state.isInvalidated?!0:!timeUntilStale(this.state.dataUpdatedAt,s)}onFocus(){this.observers.find(e=>e.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#s?.continue()}onOnline(){this.observers.find(e=>e.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#s?.continue()}addObserver(s){this.observers.includes(s)||(this.observers.push(s),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:s}))}removeObserver(s){this.observers.includes(s)&&(this.observers=this.observers.filter(e=>e!==s),this.observers.length||(this.#s&&(this.#i?this.#s.cancel({revert:!0}):this.#s.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:s}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#a({type:"invalidate"})}async fetch(s,e){if(this.state.fetchStatus!=="idle"&&this.#s?.status()!=="rejected"){if(this.state.data!==void 0&&e?.cancelRefetch)this.cancel({silent:!0});else if(this.#s)return this.#s.continueRetry(),this.#s.promise}if(s&&this.setOptions(s),!this.options.queryFn){const l=this.observers.find(h=>h.options.queryFn);l&&this.setOptions(l.options)}const t=new AbortController,n=l=>{Object.defineProperty(l,"signal",{enumerable:!0,get:()=>(this.#i=!0,t.signal)})},i=()=>{const l=ensureQueryFn(this.options,e),d=(()=>{const u={client:this.#r,queryKey:this.queryKey,meta:this.meta};return n(u),u})();return this.#i=!1,this.options.persister?this.options.persister(l,d,this):l(d)},a=(()=>{const l={fetchOptions:e,options:this.options,queryKey:this.queryKey,client:this.#r,state:this.state,fetchFn:i};return n(l),l})();this.options.behavior?.onFetch(a,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==a.fetchOptions?.meta)&&this.#a({type:"fetch",meta:a.fetchOptions?.meta}),this.#s=createRetryer({initialPromise:e?.initialPromise,fn:a.fetchFn,onCancel:l=>{l instanceof CancelledError&&l.revert&&this.setState({...this.#t,fetchStatus:"idle"}),t.abort()},onFail:(l,h)=>{this.#a({type:"failed",failureCount:l,error:h})},onPause:()=>{this.#a({type:"pause"})},onContinue:()=>{this.#a({type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0});try{const l=await this.#s.start();if(l===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(l),this.#n.config.onSuccess?.(l,this),this.#n.config.onSettled?.(l,this.state.error,this),l}catch(l){if(l instanceof CancelledError){if(l.silent)return this.#s.promise;if(l.revert){if(this.state.data===void 0)throw l;return this.state.data}}throw this.#a({type:"error",error:l}),this.#n.config.onError?.(l,this),this.#n.config.onSettled?.(this.state.data,l,this),l}finally{this.scheduleGc()}}#a(s){const e=t=>{switch(s.type){case"failed":return{...t,fetchFailureCount:s.failureCount,fetchFailureReason:s.error};case"pause":return{...t,fetchStatus:"paused"};case"continue":return{...t,fetchStatus:"fetching"};case"fetch":return{...t,...fetchState(t.data,this.options),fetchMeta:s.meta??null};case"success":const n={...t,data:s.data,dataUpdateCount:t.dataUpdateCount+1,dataUpdatedAt:s.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!s.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=s.manual?n:void 0,n;case"error":const i=s.error;return{...t,error:i,errorUpdateCount:t.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:t.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...t,isInvalidated:!0};case"setState":return{...t,...s.state}}};this.state=e(this.state),notifyManager.batch(()=>{this.observers.forEach(t=>{t.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:s})})}};function fetchState(s,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:canFetch(e.networkMode)?"fetching":"paused",...s===void 0&&{error:null,status:"pending"}}}function getDefaultState$1(s){const e=typeof s.initialData=="function"?s.initialData():s.initialData,t=e!==void 0,n=t?typeof s.initialDataUpdatedAt=="function"?s.initialDataUpdatedAt():s.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:t?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:t?"success":"pending",fetchStatus:"idle"}}function infiniteQueryBehavior(s){return{onFetch:(e,t)=>{const n=e.options,i=e.fetchOptions?.meta?.fetchMore?.direction,o=e.state.data?.pages||[],a=e.state.data?.pageParams||[];let l={pages:[],pageParams:[]},h=0;const d=async()=>{let u=!1;const f=g=>{Object.defineProperty(g,"signal",{enumerable:!0,get:()=>(e.signal.aborted?u=!0:e.signal.addEventListener("abort",()=>{u=!0}),e.signal)})},m=ensureQueryFn(e.options,e.fetchOptions),v=async(g,x,E)=>{if(u)return Promise.reject();if(x==null&&g.pages.length)return Promise.resolve(g);const _=(()=>{const R={client:e.client,queryKey:e.queryKey,pageParam:x,direction:E?"backward":"forward",meta:e.options.meta};return f(R),R})(),S=await m(_),{maxPages:C}=e.options,A=E?addToStart:addToEnd;return{pages:A(g.pages,S,C),pageParams:A(g.pageParams,x,C)}};if(i&&o.length){const g=i==="backward",x=g?getPreviousPageParam:getNextPageParam,E={pages:o,pageParams:a},b=x(n,E);l=await v(E,b,g)}else{const g=s??o.length;do{const x=h===0?a[0]??n.initialPageParam:getNextPageParam(n,l);if(h>0&&x==null)break;l=await v(l,x),h++}while(h<g)}return l};e.options.persister?e.fetchFn=()=>e.options.persister?.(d,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},t):e.fetchFn=d}}}function getNextPageParam(s,{pages:e,pageParams:t}){const n=e.length-1;return e.length>0?s.getNextPageParam(e[n],e,t[n],t):void 0}function getPreviousPageParam(s,{pages:e,pageParams:t}){return e.length>0?s.getPreviousPageParam?.(e[0],e,t[0],t):void 0}var Mutation=class extends Removable{#e;#t;#n;#r;constructor(s){super(),this.#e=s.client,this.mutationId=s.mutationId,this.#n=s.mutationCache,this.#t=[],this.state=s.state||getDefaultState(),this.setOptions(s.options),this.scheduleGc()}setOptions(s){this.options=s,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(s){this.#t.includes(s)||(this.#t.push(s),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",mutation:this,observer:s}))}removeObserver(s){this.#t=this.#t.filter(e=>e!==s),this.scheduleGc(),this.#n.notify({type:"observerRemoved",mutation:this,observer:s})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#n.remove(this))}continue(){return this.#r?.continue()??this.execute(this.state.variables)}async execute(s){const e=()=>{this.#s({type:"continue"})},t={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#r=createRetryer({fn:()=>this.options.mutationFn?this.options.mutationFn(s,t):Promise.reject(new Error("No mutationFn found")),onFail:(o,a)=>{this.#s({type:"failed",failureCount:o,error:a})},onPause:()=>{this.#s({type:"pause"})},onContinue:e,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#n.canRun(this)});const n=this.state.status==="pending",i=!this.#r.canStart();try{if(n)e();else{this.#s({type:"pending",variables:s,isPaused:i}),await this.#n.config.onMutate?.(s,this,t);const a=await this.options.onMutate?.(s,t);a!==this.state.context&&this.#s({type:"pending",context:a,variables:s,isPaused:i})}const o=await this.#r.start();return await this.#n.config.onSuccess?.(o,s,this.state.context,this,t),await this.options.onSuccess?.(o,s,this.state.context,t),await this.#n.config.onSettled?.(o,null,this.state.variables,this.state.context,this,t),await this.options.onSettled?.(o,null,s,this.state.context,t),this.#s({type:"success",data:o}),o}catch(o){try{throw await this.#n.config.onError?.(o,s,this.state.context,this,t),await this.options.onError?.(o,s,this.state.context,t),await this.#n.config.onSettled?.(void 0,o,this.state.variables,this.state.context,this,t),await this.options.onSettled?.(void 0,o,s,this.state.context,t),o}finally{this.#s({type:"error",error:o})}}finally{this.#n.runNext(this)}}#s(s){const e=t=>{switch(s.type){case"failed":return{...t,failureCount:s.failureCount,failureReason:s.error};case"pause":return{...t,isPaused:!0};case"continue":return{...t,isPaused:!1};case"pending":return{...t,context:s.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:s.isPaused,status:"pending",variables:s.variables,submittedAt:Date.now()};case"success":return{...t,data:s.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...t,data:void 0,error:s.error,failureCount:t.failureCount+1,failureReason:s.error,isPaused:!1,status:"error"}}};this.state=e(this.state),notifyManager.batch(()=>{this.#t.forEach(t=>{t.onMutationUpdate(s)}),this.#n.notify({mutation:this,type:"updated",action:s})})}};function getDefaultState(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var MutationCache=class extends Subscribable{constructor(s={}){super(),this.config=s,this.#e=new Set,this.#t=new Map,this.#n=0}#e;#t;#n;build(s,e,t){const n=new Mutation({client:s,mutationCache:this,mutationId:++this.#n,options:s.defaultMutationOptions(e),state:t});return this.add(n),n}add(s){this.#e.add(s);const e=scopeFor(s);if(typeof e=="string"){const t=this.#t.get(e);t?t.push(s):this.#t.set(e,[s])}this.notify({type:"added",mutation:s})}remove(s){if(this.#e.delete(s)){const e=scopeFor(s);if(typeof e=="string"){const t=this.#t.get(e);if(t)if(t.length>1){const n=t.indexOf(s);n!==-1&&t.splice(n,1)}else t[0]===s&&this.#t.delete(e)}}this.notify({type:"removed",mutation:s})}canRun(s){const e=scopeFor(s);if(typeof e=="string"){const n=this.#t.get(e)?.find(i=>i.state.status==="pending");return!n||n===s}else return!0}runNext(s){const e=scopeFor(s);return typeof e=="string"?this.#t.get(e)?.find(n=>n!==s&&n.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){notifyManager.batch(()=>{this.#e.forEach(s=>{this.notify({type:"removed",mutation:s})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(s){const e={exact:!0,...s};return this.getAll().find(t=>matchMutation(e,t))}findAll(s={}){return this.getAll().filter(e=>matchMutation(s,e))}notify(s){notifyManager.batch(()=>{this.listeners.forEach(e=>{e(s)})})}resumePausedMutations(){const s=this.getAll().filter(e=>e.state.isPaused);return notifyManager.batch(()=>Promise.all(s.map(e=>e.continue().catch(noop$5))))}};function scopeFor(s){return s.options.scope?.id}var QueryCache=class extends Subscribable{constructor(s={}){super(),this.config=s,this.#e=new Map}#e;build(s,e,t){const n=e.queryKey,i=e.queryHash??hashQueryKeyByOptions(n,e);let o=this.get(i);return o||(o=new Query({client:s,queryKey:n,queryHash:i,options:s.defaultQueryOptions(e),state:t,defaultOptions:s.getQueryDefaults(n)}),this.add(o)),o}add(s){this.#e.has(s.queryHash)||(this.#e.set(s.queryHash,s),this.notify({type:"added",query:s}))}remove(s){const e=this.#e.get(s.queryHash);e&&(s.destroy(),e===s&&this.#e.delete(s.queryHash),this.notify({type:"removed",query:s}))}clear(){notifyManager.batch(()=>{this.getAll().forEach(s=>{this.remove(s)})})}get(s){return this.#e.get(s)}getAll(){return[...this.#e.values()]}find(s){const e={exact:!0,...s};return this.getAll().find(t=>matchQuery(e,t))}findAll(s={}){const e=this.getAll();return Object.keys(s).length>0?e.filter(t=>matchQuery(s,t)):e}notify(s){notifyManager.batch(()=>{this.listeners.forEach(e=>{e(s)})})}onFocus(){notifyManager.batch(()=>{this.getAll().forEach(s=>{s.onFocus()})})}onOnline(){notifyManager.batch(()=>{this.getAll().forEach(s=>{s.onOnline()})})}},QueryClient=class{#e;#t;#n;#r;#s;#o;#i;#a;constructor(s={}){this.#e=s.queryCache||new QueryCache,this.#t=s.mutationCache||new MutationCache,this.#n=s.defaultOptions||{},this.#r=new Map,this.#s=new Map,this.#o=0}mount(){this.#o++,this.#o===1&&(this.#i=focusManager.subscribe(async s=>{s&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#a=onlineManager.subscribe(async s=>{s&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#o--,this.#o===0&&(this.#i?.(),this.#i=void 0,this.#a?.(),this.#a=void 0)}isFetching(s){return this.#e.findAll({...s,fetchStatus:"fetching"}).length}isMutating(s){return this.#t.findAll({...s,status:"pending"}).length}getQueryData(s){const e=this.defaultQueryOptions({queryKey:s});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(s){const e=this.defaultQueryOptions(s),t=this.#e.build(this,e),n=t.state.data;return n===void 0?this.fetchQuery(s):(s.revalidateIfStale&&t.isStaleByTime(resolveStaleTime(e.staleTime,t))&&this.prefetchQuery(e),Promise.resolve(n))}getQueriesData(s){return this.#e.findAll(s).map(({queryKey:e,state:t})=>{const n=t.data;return[e,n]})}setQueryData(s,e,t){const n=this.defaultQueryOptions({queryKey:s}),o=this.#e.get(n.queryHash)?.state.data,a=functionalUpdate(e,o);if(a!==void 0)return this.#e.build(this,n).setData(a,{...t,manual:!0})}setQueriesData(s,e,t){return notifyManager.batch(()=>this.#e.findAll(s).map(({queryKey:n})=>[n,this.setQueryData(n,e,t)]))}getQueryState(s){const e=this.defaultQueryOptions({queryKey:s});return this.#e.get(e.queryHash)?.state}removeQueries(s){const e=this.#e;notifyManager.batch(()=>{e.findAll(s).forEach(t=>{e.remove(t)})})}resetQueries(s,e){const t=this.#e;return notifyManager.batch(()=>(t.findAll(s).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...s},e)))}cancelQueries(s,e={}){const t={revert:!0,...e},n=notifyManager.batch(()=>this.#e.findAll(s).map(i=>i.cancel(t)));return Promise.all(n).then(noop$5).catch(noop$5)}invalidateQueries(s,e={}){return notifyManager.batch(()=>(this.#e.findAll(s).forEach(t=>{t.invalidate()}),s?.refetchType==="none"?Promise.resolve():this.refetchQueries({...s,type:s?.refetchType??s?.type??"active"},e)))}refetchQueries(s,e={}){const t={...e,cancelRefetch:e.cancelRefetch??!0},n=notifyManager.batch(()=>this.#e.findAll(s).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let o=i.fetch(void 0,t);return t.throwOnError||(o=o.catch(noop$5)),i.state.fetchStatus==="paused"?Promise.resolve():o}));return Promise.all(n).then(noop$5)}fetchQuery(s){const e=this.defaultQueryOptions(s);e.retry===void 0&&(e.retry=!1);const t=this.#e.build(this,e);return t.isStaleByTime(resolveStaleTime(e.staleTime,t))?t.fetch(e):Promise.resolve(t.state.data)}prefetchQuery(s){return this.fetchQuery(s).then(noop$5).catch(noop$5)}fetchInfiniteQuery(s){return s.behavior=infiniteQueryBehavior(s.pages),this.fetchQuery(s)}prefetchInfiniteQuery(s){return this.fetchInfiniteQuery(s).then(noop$5).catch(noop$5)}ensureInfiniteQueryData(s){return s.behavior=infiniteQueryBehavior(s.pages),this.ensureQueryData(s)}resumePausedMutations(){return onlineManager.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(s){this.#n=s}setQueryDefaults(s,e){this.#r.set(hashKey(s),{queryKey:s,defaultOptions:e})}getQueryDefaults(s){const e=[...this.#r.values()],t={};return e.forEach(n=>{partialMatchKey(s,n.queryKey)&&Object.assign(t,n.defaultOptions)}),t}setMutationDefaults(s,e){this.#s.set(hashKey(s),{mutationKey:s,defaultOptions:e})}getMutationDefaults(s){const e=[...this.#s.values()],t={};return e.forEach(n=>{partialMatchKey(s,n.mutationKey)&&Object.assign(t,n.defaultOptions)}),t}defaultQueryOptions(s){if(s._defaulted)return s;const e={...this.#n.queries,...this.getQueryDefaults(s.queryKey),...s,_defaulted:!0};return e.queryHash||(e.queryHash=hashQueryKeyByOptions(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===skipToken&&(e.enabled=!1),e}defaultMutationOptions(s){return s?._defaulted?s:{...this.#n.mutations,...s?.mutationKey&&this.getMutationDefaults(s.mutationKey),...s,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports),React$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);var QueryClientContext=reactExports.createContext(void 0),QueryClientProvider=({client:s,children:e})=>(reactExports.useEffect(()=>(s.mount(),()=>{s.unmount()}),[s]),jsxRuntimeExports.jsx(QueryClientContext.Provider,{value:s,children:e})),reactDomExports=requireReactDom();const ReactDOM=getDefaultExportFromCjs(reactDomExports);function __insertCSS(s){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",e.appendChild(t),t.styleSheet?t.styleSheet.cssText=s:t.appendChild(document.createTextNode(s))}const getAsset=s=>{switch(s){case"success":return SuccessIcon;case"info":return InfoIcon;case"warning":return WarningIcon;case"error":return ErrorIcon;default:return null}},bars=Array(12).fill(0),Loader=({visible:s,className:e})=>React.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":s},React.createElement("div",{className:"sonner-spinner"},bars.map((t,n)=>React.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${n}`})))),SuccessIcon=React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},React.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),WarningIcon=React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},React.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),InfoIcon=React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},React.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),ErrorIcon=React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},React.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),CloseIcon=React.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},React.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),React.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),useIsDocumentHidden=()=>{const[s,e]=React.useState(document.hidden);return React.useEffect(()=>{const t=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",t),()=>window.removeEventListener("visibilitychange",t)},[]),s};let toastsCounter=1;class Observer{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{const t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;const{message:n,...i}=e,o=typeof e?.id=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:toastsCounter++,a=this.toasts.find(h=>h.id===o),l=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(o)&&this.dismissedToasts.delete(o),a?this.toasts=this.toasts.map(h=>h.id===o?(this.publish({...h,...e,id:o,title:n}),{...h,...e,id:o,dismissible:l,title:n}):h):this.addToast({title:n,...i,dismissible:l,id:o}),o},this.dismiss=e=>(e?(this.dismissedToasts.add(e),requestAnimationFrame(()=>this.subscribers.forEach(t=>t({id:e,dismiss:!0})))):this.toasts.forEach(t=>{this.subscribers.forEach(n=>n({id:t.id,dismiss:!0}))}),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let n;t.loading!==void 0&&(n=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));const i=Promise.resolve(e instanceof Function?e():e);let o=n!==void 0,a;const l=i.then(async d=>{if(a=["resolve",d],React.isValidElement(d))o=!1,this.create({id:n,type:"default",message:d});else if(isHttpResponse(d)&&!d.ok){o=!1;const f=typeof t.error=="function"?await t.error(`HTTP error! status: ${d.status}`):t.error,m=typeof t.description=="function"?await t.description(`HTTP error! status: ${d.status}`):t.description,g=typeof f=="object"&&!React.isValidElement(f)?f:{message:f};this.create({id:n,type:"error",description:m,...g})}else if(d instanceof Error){o=!1;const f=typeof t.error=="function"?await t.error(d):t.error,m=typeof t.description=="function"?await t.description(d):t.description,g=typeof f=="object"&&!React.isValidElement(f)?f:{message:f};this.create({id:n,type:"error",description:m,...g})}else if(t.success!==void 0){o=!1;const f=typeof t.success=="function"?await t.success(d):t.success,m=typeof t.description=="function"?await t.description(d):t.description,g=typeof f=="object"&&!React.isValidElement(f)?f:{message:f};this.create({id:n,type:"success",description:m,...g})}}).catch(async d=>{if(a=["reject",d],t.error!==void 0){o=!1;const u=typeof t.error=="function"?await t.error(d):t.error,f=typeof t.description=="function"?await t.description(d):t.description,v=typeof u=="object"&&!React.isValidElement(u)?u:{message:u};this.create({id:n,type:"error",description:f,...v})}}).finally(()=>{o&&(this.dismiss(n),n=void 0),t.finally==null||t.finally.call(t)}),h=()=>new Promise((d,u)=>l.then(()=>a[0]==="reject"?u(a[1]):d(a[1])).catch(u));return typeof n!="string"&&typeof n!="number"?{unwrap:h}:Object.assign(n,{unwrap:h})},this.custom=(e,t)=>{const n=t?.id||toastsCounter++;return this.create({jsx:e(n),id:n,...t}),n},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const ToastState=new Observer,toastFunction=(s,e)=>{const t=e?.id||toastsCounter++;return ToastState.addToast({title:s,...e,id:t}),t},isHttpResponse=s=>s&&typeof s=="object"&&"ok"in s&&typeof s.ok=="boolean"&&"status"in s&&typeof s.status=="number",basicToast=toastFunction,getHistory=()=>ToastState.toasts,getToasts=()=>ToastState.getActiveToasts(),toast=Object.assign(basicToast,{success:ToastState.success,info:ToastState.info,warning:ToastState.warning,error:ToastState.error,custom:ToastState.custom,message:ToastState.message,promise:ToastState.promise,dismiss:ToastState.dismiss,loading:ToastState.loading},{getHistory,getToasts});__insertCSS("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function isAction(s){return s.label!==void 0}const VISIBLE_TOASTS_AMOUNT=3,VIEWPORT_OFFSET="24px",MOBILE_VIEWPORT_OFFSET="16px",TOAST_LIFETIME=4e3,TOAST_WIDTH=356,GAP=14,SWIPE_THRESHOLD=45,TIME_BEFORE_UNMOUNT=200;function cn$1(...s){return s.filter(Boolean).join(" ")}function getDefaultSwipeDirections(s){const[e,t]=s.split("-"),n=[];return e&&n.push(e),t&&n.push(t),n}const Toast=s=>{var e,t,n,i,o,a,l,h,d;const{invert:u,toast:f,unstyled:m,interacting:v,setHeights:g,visibleToasts:x,heights:E,index:b,toasts:_,expanded:S,removeToast:C,defaultRichColors:A,closeButton:R,style:L,cancelButtonStyle:j,actionButtonStyle:F,className:W="",descriptionClassName:K="",duration:ee,position:te,gap:re,expandByDefault:ie,classNames:Q,icons:z,closeButtonAriaLabel:N="Close toast"}=s,[k,I]=React.useState(null),[D,U]=React.useState(null),[$,q]=React.useState(!1),[V,P]=React.useState(!1),[O,B]=React.useState(!1),[G,Y]=React.useState(!1),[J,Z]=React.useState(!1),[oe,ve]=React.useState(0),[ce,ue]=React.useState(0),de=React.useRef(f.duration||ee||TOAST_LIFETIME),pe=React.useRef(null),ye=React.useRef(null),Ae=b===0,Ce=b+1<=x,Pe=f.type,Oe=f.dismissible!==!1,xe=f.className||"",Te=f.descriptionClassName||"",$e=React.useMemo(()=>E.findIndex(Le=>Le.toastId===f.id)||0,[E,f.id]),Ue=React.useMemo(()=>{var Le;return(Le=f.closeButton)!=null?Le:R},[f.closeButton,R]),qe=React.useMemo(()=>f.duration||ee||TOAST_LIFETIME,[f.duration,ee]),Ke=React.useRef(0),Ge=React.useRef(0),xt=React.useRef(0),ut=React.useRef(null),[Ot,be]=te.split("-"),he=React.useMemo(()=>E.reduce((Le,Ye,Je)=>Je>=$e?Le:Le+Ye.height,0),[E,$e]),le=useIsDocumentHidden(),Re=f.invert||u,ze=Pe==="loading";Ge.current=React.useMemo(()=>$e*re+he,[$e,he]),React.useEffect(()=>{de.current=qe},[qe]),React.useEffect(()=>{q(!0)},[]),React.useEffect(()=>{const Le=ye.current;if(Le){const Ye=Le.getBoundingClientRect().height;return ue(Ye),g(Je=>[{toastId:f.id,height:Ye,position:f.position},...Je]),()=>g(Je=>Je.filter(dt=>dt.toastId!==f.id))}},[g,f.id]),React.useLayoutEffect(()=>{if(!$)return;const Le=ye.current,Ye=Le.style.height;Le.style.height="auto";const Je=Le.getBoundingClientRect().height;Le.style.height=Ye,ue(Je),g(dt=>dt.find(et=>et.toastId===f.id)?dt.map(et=>et.toastId===f.id?{...et,height:Je}:et):[{toastId:f.id,height:Je,position:f.position},...dt])},[$,f.title,f.description,g,f.id,f.jsx,f.action,f.cancel]);const He=React.useCallback(()=>{P(!0),ve(Ge.current),g(Le=>Le.filter(Ye=>Ye.toastId!==f.id)),setTimeout(()=>{C(f)},TIME_BEFORE_UNMOUNT)},[f,C,g,Ge]);React.useEffect(()=>{if(f.promise&&Pe==="loading"||f.duration===1/0||f.type==="loading")return;let Le;return S||v||le?(()=>{if(xt.current<Ke.current){const dt=new Date().getTime()-Ke.current;de.current=de.current-dt}xt.current=new Date().getTime()})():(()=>{de.current!==1/0&&(Ke.current=new Date().getTime(),Le=setTimeout(()=>{f.onAutoClose==null||f.onAutoClose.call(f,f),He()},de.current))})(),()=>clearTimeout(Le)},[S,v,f,Pe,le,He]),React.useEffect(()=>{f.delete&&(He(),f.onDismiss==null||f.onDismiss.call(f,f))},[He,f.delete]);function st(){var Le;if(z?.loading){var Ye;return React.createElement("div",{className:cn$1(Q?.loader,f==null||(Ye=f.classNames)==null?void 0:Ye.loader,"sonner-loader"),"data-visible":Pe==="loading"},z.loading)}return React.createElement(Loader,{className:cn$1(Q?.loader,f==null||(Le=f.classNames)==null?void 0:Le.loader),visible:Pe==="loading"})}const Mt=f.icon||z?.[Pe]||getAsset(Pe);var Tt,$t;return React.createElement("li",{tabIndex:0,ref:ye,className:cn$1(W,xe,Q?.toast,f==null||(e=f.classNames)==null?void 0:e.toast,Q?.default,Q?.[Pe],f==null||(t=f.classNames)==null?void 0:t[Pe]),"data-sonner-toast":"","data-rich-colors":(Tt=f.richColors)!=null?Tt:A,"data-styled":!(f.jsx||f.unstyled||m),"data-mounted":$,"data-promise":!!f.promise,"data-swiped":J,"data-removed":V,"data-visible":Ce,"data-y-position":Ot,"data-x-position":be,"data-index":b,"data-front":Ae,"data-swiping":O,"data-dismissible":Oe,"data-type":Pe,"data-invert":Re,"data-swipe-out":G,"data-swipe-direction":D,"data-expanded":!!(S||ie&&$),"data-testid":f.testId,style:{"--index":b,"--toasts-before":b,"--z-index":_.length-b,"--offset":`${V?oe:Ge.current}px`,"--initial-height":ie?"auto":`${ce}px`,...L,...f.style},onDragEnd:()=>{B(!1),I(null),ut.current=null},onPointerDown:Le=>{Le.button!==2&&(ze||!Oe||(pe.current=new Date,ve(Ge.current),Le.target.setPointerCapture(Le.pointerId),Le.target.tagName!=="BUTTON"&&(B(!0),ut.current={x:Le.clientX,y:Le.clientY})))},onPointerUp:()=>{var Le,Ye,Je;if(G||!Oe)return;ut.current=null;const dt=Number(((Le=ye.current)==null?void 0:Le.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Qe=Number(((Ye=ye.current)==null?void 0:Ye.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),et=new Date().getTime()-((Je=pe.current)==null?void 0:Je.getTime()),it=k==="x"?dt:Qe,Wt=Math.abs(it)/et;if(Math.abs(it)>=SWIPE_THRESHOLD||Wt>.11){ve(Ge.current),f.onDismiss==null||f.onDismiss.call(f,f),U(k==="x"?dt>0?"right":"left":Qe>0?"down":"up"),He(),Y(!0);return}else{var ht,gt;(ht=ye.current)==null||ht.style.setProperty("--swipe-amount-x","0px"),(gt=ye.current)==null||gt.style.setProperty("--swipe-amount-y","0px")}Z(!1),B(!1),I(null)},onPointerMove:Le=>{var Ye,Je,dt;if(!ut.current||!Oe||((Ye=window.getSelection())==null?void 0:Ye.toString().length)>0)return;const et=Le.clientY-ut.current.y,it=Le.clientX-ut.current.x;var Wt;const ht=(Wt=s.swipeDirections)!=null?Wt:getDefaultSwipeDirections(te);!k&&(Math.abs(it)>1||Math.abs(et)>1)&&I(Math.abs(it)>Math.abs(et)?"x":"y");let gt={x:0,y:0};const lt=bt=>1/(1.5+Math.abs(bt)/20);if(k==="y"){if(ht.includes("top")||ht.includes("bottom"))if(ht.includes("top")&&et<0||ht.includes("bottom")&&et>0)gt.y=et;else{const bt=et*lt(et);gt.y=Math.abs(bt)<Math.abs(et)?bt:et}}else if(k==="x"&&(ht.includes("left")||ht.includes("right")))if(ht.includes("left")&&it<0||ht.includes("right")&&it>0)gt.x=it;else{const bt=it*lt(it);gt.x=Math.abs(bt)<Math.abs(it)?bt:it}(Math.abs(gt.x)>0||Math.abs(gt.y)>0)&&Z(!0),(Je=ye.current)==null||Je.style.setProperty("--swipe-amount-x",`${gt.x}px`),(dt=ye.current)==null||dt.style.setProperty("--swipe-amount-y",`${gt.y}px`)}},Ue&&!f.jsx&&Pe!=="loading"?React.createElement("button",{"aria-label":N,"data-disabled":ze,"data-close-button":!0,onClick:ze||!Oe?()=>{}:()=>{He(),f.onDismiss==null||f.onDismiss.call(f,f)},className:cn$1(Q?.closeButton,f==null||(n=f.classNames)==null?void 0:n.closeButton)},($t=z?.close)!=null?$t:CloseIcon):null,(Pe||f.icon||f.promise)&&f.icon!==null&&(z?.[Pe]!==null||f.icon)?React.createElement("div",{"data-icon":"",className:cn$1(Q?.icon,f==null||(i=f.classNames)==null?void 0:i.icon)},f.promise||f.type==="loading"&&!f.icon?f.icon||st():null,f.type!=="loading"?Mt:null):null,React.createElement("div",{"data-content":"",className:cn$1(Q?.content,f==null||(o=f.classNames)==null?void 0:o.content)},React.createElement("div",{"data-title":"",className:cn$1(Q?.title,f==null||(a=f.classNames)==null?void 0:a.title)},f.jsx?f.jsx:typeof f.title=="function"?f.title():f.title),f.description?React.createElement("div",{"data-description":"",className:cn$1(K,Te,Q?.description,f==null||(l=f.classNames)==null?void 0:l.description)},typeof f.description=="function"?f.description():f.description):null),React.isValidElement(f.cancel)?f.cancel:f.cancel&&isAction(f.cancel)?React.createElement("button",{"data-button":!0,"data-cancel":!0,style:f.cancelButtonStyle||j,onClick:Le=>{isAction(f.cancel)&&Oe&&(f.cancel.onClick==null||f.cancel.onClick.call(f.cancel,Le),He())},className:cn$1(Q?.cancelButton,f==null||(h=f.classNames)==null?void 0:h.cancelButton)},f.cancel.label):null,React.isValidElement(f.action)?f.action:f.action&&isAction(f.action)?React.createElement("button",{"data-button":!0,"data-action":!0,style:f.actionButtonStyle||F,onClick:Le=>{isAction(f.action)&&(f.action.onClick==null||f.action.onClick.call(f.action,Le),!Le.defaultPrevented&&He())},className:cn$1(Q?.actionButton,f==null||(d=f.classNames)==null?void 0:d.actionButton)},f.action.label):null)};function getDocumentDirection(){if(typeof window>"u"||typeof document>"u")return"ltr";const s=document.documentElement.getAttribute("dir");return s==="auto"||!s?window.getComputedStyle(document.documentElement).direction:s}function assignOffset(s,e){const t={};return[s,e].forEach((n,i)=>{const o=i===1,a=o?"--mobile-offset":"--offset",l=o?MOBILE_VIEWPORT_OFFSET:VIEWPORT_OFFSET;function h(d){["top","right","bottom","left"].forEach(u=>{t[`${a}-${u}`]=typeof d=="number"?`${d}px`:d})}typeof n=="number"||typeof n=="string"?h(n):typeof n=="object"?["top","right","bottom","left"].forEach(d=>{n[d]===void 0?t[`${a}-${d}`]=l:t[`${a}-${d}`]=typeof n[d]=="number"?`${n[d]}px`:n[d]}):h(l)}),t}const Toaster=React.forwardRef(function(e,t){const{id:n,invert:i,position:o="bottom-right",hotkey:a=["altKey","KeyT"],expand:l,closeButton:h,className:d,offset:u,mobileOffset:f,theme:m="light",richColors:v,duration:g,style:x,visibleToasts:E=VISIBLE_TOASTS_AMOUNT,toastOptions:b,dir:_=getDocumentDirection(),gap:S=GAP,icons:C,containerAriaLabel:A="Notifications"}=e,[R,L]=React.useState([]),j=React.useMemo(()=>n?R.filter($=>$.toasterId===n):R.filter($=>!$.toasterId),[R,n]),F=React.useMemo(()=>Array.from(new Set([o].concat(j.filter($=>$.position).map($=>$.position)))),[j,o]),[W,K]=React.useState([]),[ee,te]=React.useState(!1),[re,ie]=React.useState(!1),[Q,z]=React.useState(m!=="system"?m:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),N=React.useRef(null),k=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),I=React.useRef(null),D=React.useRef(!1),U=React.useCallback($=>{L(q=>{var V;return(V=q.find(P=>P.id===$.id))!=null&&V.delete||ToastState.dismiss($.id),q.filter(({id:P})=>P!==$.id)})},[]);return React.useEffect(()=>ToastState.subscribe($=>{if($.dismiss){requestAnimationFrame(()=>{L(q=>q.map(V=>V.id===$.id?{...V,delete:!0}:V))});return}setTimeout(()=>{ReactDOM.flushSync(()=>{L(q=>{const V=q.findIndex(P=>P.id===$.id);return V!==-1?[...q.slice(0,V),{...q[V],...$},...q.slice(V+1)]:[$,...q]})})})}),[R]),React.useEffect(()=>{if(m!=="system"){z(m);return}if(m==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?z("dark"):z("light")),typeof window>"u")return;const $=window.matchMedia("(prefers-color-scheme: dark)");try{$.addEventListener("change",({matches:q})=>{z(q?"dark":"light")})}catch{$.addListener(({matches:V})=>{try{z(V?"dark":"light")}catch(P){console.error(P)}})}},[m]),React.useEffect(()=>{R.length<=1&&te(!1)},[R]),React.useEffect(()=>{const $=q=>{var V;if(a.every(B=>q[B]||q.code===B)){var O;te(!0),(O=N.current)==null||O.focus()}q.code==="Escape"&&(document.activeElement===N.current||(V=N.current)!=null&&V.contains(document.activeElement))&&te(!1)};return document.addEventListener("keydown",$),()=>document.removeEventListener("keydown",$)},[a]),React.useEffect(()=>{if(N.current)return()=>{I.current&&(I.current.focus({preventScroll:!0}),I.current=null,D.current=!1)}},[N.current]),React.createElement("section",{ref:t,"aria-label":`${A} ${k}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},F.map(($,q)=>{var V;const[P,O]=$.split("-");return j.length?React.createElement("ol",{key:$,dir:_==="auto"?getDocumentDirection():_,tabIndex:-1,ref:N,className:d,"data-sonner-toaster":!0,"data-sonner-theme":Q,"data-y-position":P,"data-x-position":O,style:{"--front-toast-height":`${((V=W[0])==null?void 0:V.height)||0}px`,"--width":`${TOAST_WIDTH}px`,"--gap":`${S}px`,...x,...assignOffset(u,f)},onBlur:B=>{D.current&&!B.currentTarget.contains(B.relatedTarget)&&(D.current=!1,I.current&&(I.current.focus({preventScroll:!0}),I.current=null))},onFocus:B=>{B.target instanceof HTMLElement&&B.target.dataset.dismissible==="false"||D.current||(D.current=!0,I.current=B.relatedTarget)},onMouseEnter:()=>te(!0),onMouseMove:()=>te(!0),onMouseLeave:()=>{re||te(!1)},onDragEnd:()=>te(!1),onPointerDown:B=>{B.target instanceof HTMLElement&&B.target.dataset.dismissible==="false"||ie(!0)},onPointerUp:()=>ie(!1)},j.filter(B=>!B.position&&q===0||B.position===$).map((B,G)=>{var Y,J;return React.createElement(Toast,{key:B.id,icons:C,index:G,toast:B,defaultRichColors:v,duration:(Y=b?.duration)!=null?Y:g,className:b?.className,descriptionClassName:b?.descriptionClassName,invert:i,visibleToasts:E,closeButton:(J=b?.closeButton)!=null?J:h,interacting:re,position:$,style:b?.style,unstyled:b?.unstyled,classNames:b?.classNames,cancelButtonStyle:b?.cancelButtonStyle,actionButtonStyle:b?.actionButtonStyle,closeButtonAriaLabel:b?.closeButtonAriaLabel,removeToast:U,toasts:j.filter(Z=>Z.position==B.position),heights:W.filter(Z=>Z.position==B.position),setHeights:K,expandByDefault:l,gap:S,expanded:ee,swipeDirections:e.swipeDirections})})):null}))});/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const toKebabCase=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),toCamelCase=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),toPascalCase=s=>{const e=toCamelCase(s);return e.charAt(0).toUpperCase()+e.slice(1)},mergeClasses=(...s)=>s.filter((e,t,n)=>!!e&&e.trim()!==""&&n.indexOf(e)===t).join(" ").trim();/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Icon$1=reactExports.forwardRef(({color:s="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:i="",children:o,iconNode:a,...l},h)=>reactExports.createElement("svg",{ref:h,...defaultAttributes,width:e,height:e,stroke:s,strokeWidth:n?Number(t)*24/Number(e):t,className:mergeClasses("lucide",i),...l},[...a.map(([d,u])=>reactExports.createElement(d,u)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const createLucideIcon=(s,e)=>{const t=reactExports.forwardRef(({className:n,...i},o)=>reactExports.createElement(Icon$1,{ref:o,iconNode:e,className:mergeClasses(`lucide-${toKebabCase(toPascalCase(s))}`,`lucide-${s}`,n),...i}));return t.displayName=toPascalCase(s),t};/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$o=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],BookOpen=createLucideIcon("book-open",__iconNode$o);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$n=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],Brain=createLucideIcon("brain",__iconNode$n);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$m=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Check=createLucideIcon("check",__iconNode$m);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$l=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],ChevronDown=createLucideIcon("chevron-down",__iconNode$l);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$k=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],ChevronLeft=createLucideIcon("chevron-left",__iconNode$k);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$j=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ChevronRight=createLucideIcon("chevron-right",__iconNode$j);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$i=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],ChevronUp=createLucideIcon("chevron-up",__iconNode$i);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$h=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],Download=createLucideIcon("download",__iconNode$h);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$g=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],EllipsisVertical=createLucideIcon("ellipsis-vertical",__iconNode$g);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$f=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],FileDown=createLucideIcon("file-down",__iconNode$f);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$e=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],FileText=createLucideIcon("file-text",__iconNode$e);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$d=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],GripVertical=createLucideIcon("grip-vertical",__iconNode$d);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$c=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],LoaderCircle=createLucideIcon("loader-circle",__iconNode$c);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$b=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]],LogOut=createLucideIcon("log-out",__iconNode$b);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$a=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Plus=createLucideIcon("plus",__iconNode$a);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$9=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],RotateCw=createLucideIcon("rotate-cw",__iconNode$9);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$8=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],Search=createLucideIcon("search",__iconNode$8);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$7=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],Send=createLucideIcon("send",__iconNode$7);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$6=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],Sparkles=createLucideIcon("sparkles",__iconNode$6);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$5=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Trash2=createLucideIcon("trash-2",__iconNode$5);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$4=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],Upload=createLucideIcon("upload",__iconNode$4);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$3=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],User=createLucideIcon("user",__iconNode$3);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$2=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],X=createLucideIcon("x",__iconNode$2);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$1=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],ZoomIn=createLucideIcon("zoom-in",__iconNode$1);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],ZoomOut=createLucideIcon("zoom-out",__iconNode);function clamp$2(s,[e,t]){return Math.min(t,Math.max(e,s))}function composeEventHandlers$1(s,e,{checkForDefaultPrevented:t=!0}={}){return function(i){if(s?.(i),t===!1||!i.defaultPrevented)return e?.(i)}}function createContext2(s,e){const t=reactExports.createContext(e),n=o=>{const{children:a,...l}=o,h=reactExports.useMemo(()=>l,Object.values(l));return jsxRuntimeExports.jsx(t.Provider,{value:h,children:a})};n.displayName=s+"Provider";function i(o){const a=reactExports.useContext(t);if(a)return a;if(e!==void 0)return e;throw new Error(`\`${o}\` must be used within \`${s}\``)}return[n,i]}function createContextScope(s,e=[]){let t=[];function n(o,a){const l=reactExports.createContext(a),h=t.length;t=[...t,a];const d=f=>{const{scope:m,children:v,...g}=f,x=m?.[s]?.[h]||l,E=reactExports.useMemo(()=>g,Object.values(g));return jsxRuntimeExports.jsx(x.Provider,{value:E,children:v})};d.displayName=o+"Provider";function u(f,m){const v=m?.[s]?.[h]||l,g=reactExports.useContext(v);if(g)return g;if(a!==void 0)return a;throw new Error(`\`${f}\` must be used within \`${o}\``)}return[d,u]}const i=()=>{const o=t.map(a=>reactExports.createContext(a));return function(l){const h=l?.[s]||o;return reactExports.useMemo(()=>({[`__scope${s}`]:{...l,[s]:h}}),[l,h])}};return i.scopeName=s,[n,composeContextScopes(i,...e)]}function composeContextScopes(...s){const e=s[0];if(s.length===1)return e;const t=()=>{const n=s.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(o){const a=n.reduce((l,{useScope:h,scopeName:d})=>{const f=h(o)[`__scope${d}`];return{...l,...f}},{});return reactExports.useMemo(()=>({[`__scope${e.scopeName}`]:a}),[a])}};return t.scopeName=e.scopeName,t}function setRef(s,e){if(typeof s=="function")return s(e);s!=null&&(s.current=e)}function composeRefs(...s){return e=>{let t=!1;const n=s.map(i=>{const o=setRef(i,e);return!t&&typeof o=="function"&&(t=!0),o});if(t)return()=>{for(let i=0;i<n.length;i++){const o=n[i];typeof o=="function"?o():setRef(s[i],null)}}}}function useComposedRefs(...s){return reactExports.useCallback(composeRefs(...s),s)}function createSlot(s){const e=createSlotClone(s),t=reactExports.forwardRef((n,i)=>{const{children:o,...a}=n,l=reactExports.Children.toArray(o),h=l.find(isSlottable);if(h){const d=h.props.children,u=l.map(f=>f===h?reactExports.Children.count(d)>1?reactExports.Children.only(null):reactExports.isValidElement(d)?d.props.children:null:f);return jsxRuntimeExports.jsx(e,{...a,ref:i,children:reactExports.isValidElement(d)?reactExports.cloneElement(d,void 0,u):null})}return jsxRuntimeExports.jsx(e,{...a,ref:i,children:o})});return t.displayName=`${s}.Slot`,t}var Slot$3=createSlot("Slot");function createSlotClone(s){const e=reactExports.forwardRef((t,n)=>{const{children:i,...o}=t;if(reactExports.isValidElement(i)){const a=getElementRef$1(i),l=mergeProps(o,i.props);return i.type!==reactExports.Fragment&&(l.ref=n?composeRefs(n,a):a),reactExports.cloneElement(i,l)}return reactExports.Children.count(i)>1?reactExports.Children.only(null):null});return e.displayName=`${s}.SlotClone`,e}var SLOTTABLE_IDENTIFIER=Symbol("radix.slottable");function createSlottable(s){const e=({children:t})=>jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:t});return e.displayName=`${s}.Slottable`,e.__radixId=SLOTTABLE_IDENTIFIER,e}function isSlottable(s){return reactExports.isValidElement(s)&&typeof s.type=="function"&&"__radixId"in s.type&&s.type.__radixId===SLOTTABLE_IDENTIFIER}function mergeProps(s,e){const t={...e};for(const n in e){const i=s[n],o=e[n];/^on[A-Z]/.test(n)?i&&o?t[n]=(...l)=>{const h=o(...l);return i(...l),h}:i&&(t[n]=i):n==="style"?t[n]={...i,...o}:n==="className"&&(t[n]=[i,o].filter(Boolean).join(" "))}return{...s,...t}}function getElementRef$1(s){let e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?s.ref:(e=Object.getOwnPropertyDescriptor(s,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?s.props.ref:s.props.ref||s.ref)}function createCollection(s){const e=s+"CollectionProvider",[t,n]=createContextScope(e),[i,o]=t(e,{collectionRef:{current:null},itemMap:new Map}),a=x=>{const{scope:E,children:b}=x,_=React.useRef(null),S=React.useRef(new Map).current;return jsxRuntimeExports.jsx(i,{scope:E,itemMap:S,collectionRef:_,children:b})};a.displayName=e;const l=s+"CollectionSlot",h=createSlot(l),d=React.forwardRef((x,E)=>{const{scope:b,children:_}=x,S=o(l,b),C=useComposedRefs(E,S.collectionRef);return jsxRuntimeExports.jsx(h,{ref:C,children:_})});d.displayName=l;const u=s+"CollectionItemSlot",f="data-radix-collection-item",m=createSlot(u),v=React.forwardRef((x,E)=>{const{scope:b,children:_,...S}=x,C=React.useRef(null),A=useComposedRefs(E,C),R=o(u,b);return React.useEffect(()=>(R.itemMap.set(C,{ref:C,...S}),()=>void R.itemMap.delete(C))),jsxRuntimeExports.jsx(m,{[f]:"",ref:A,children:_})});v.displayName=u;function g(x){const E=o(s+"CollectionConsumer",x);return React.useCallback(()=>{const _=E.collectionRef.current;if(!_)return[];const S=Array.from(_.querySelectorAll(`[${f}]`));return Array.from(E.itemMap.values()).sort((R,L)=>S.indexOf(R.ref.current)-S.indexOf(L.ref.current))},[E.collectionRef,E.itemMap])}return[{Provider:a,Slot:d,ItemSlot:v},g,n]}var DirectionContext=reactExports.createContext(void 0);function useDirection(s){const e=reactExports.useContext(DirectionContext);return s||e||"ltr"}var NODES=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Primitive=NODES.reduce((s,e)=>{const t=createSlot(`Primitive.${e}`),n=reactExports.forwardRef((i,o)=>{const{asChild:a,...l}=i,h=a?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),jsxRuntimeExports.jsx(h,{...l,ref:o})});return n.displayName=`Primitive.${e}`,{...s,[e]:n}},{});function dispatchDiscreteCustomEvent(s,e){s&&reactDomExports.flushSync(()=>s.dispatchEvent(e))}function useCallbackRef$1(s){const e=reactExports.useRef(s);return reactExports.useEffect(()=>{e.current=s}),reactExports.useMemo(()=>(...t)=>e.current?.(...t),[])}function useEscapeKeydown(s,e=globalThis?.document){const t=useCallbackRef$1(s);reactExports.useEffect(()=>{const n=i=>{i.key==="Escape"&&t(i)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[t,e])}var DISMISSABLE_LAYER_NAME="DismissableLayer",CONTEXT_UPDATE="dismissableLayer.update",POINTER_DOWN_OUTSIDE="dismissableLayer.pointerDownOutside",FOCUS_OUTSIDE="dismissableLayer.focusOutside",originalBodyPointerEvents,DismissableLayerContext=reactExports.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),DismissableLayer=reactExports.forwardRef((s,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:n,onPointerDownOutside:i,onFocusOutside:o,onInteractOutside:a,onDismiss:l,...h}=s,d=reactExports.useContext(DismissableLayerContext),[u,f]=reactExports.useState(null),m=u?.ownerDocument??globalThis?.document,[,v]=reactExports.useState({}),g=useComposedRefs(e,L=>f(L)),x=Array.from(d.layers),[E]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),b=x.indexOf(E),_=u?x.indexOf(u):-1,S=d.layersWithOutsidePointerEventsDisabled.size>0,C=_>=b,A=usePointerDownOutside(L=>{const j=L.target,F=[...d.branches].some(W=>W.contains(j));!C||F||(i?.(L),a?.(L),L.defaultPrevented||l?.())},m),R=useFocusOutside(L=>{const j=L.target;[...d.branches].some(W=>W.contains(j))||(o?.(L),a?.(L),L.defaultPrevented||l?.())},m);return useEscapeKeydown(L=>{_===d.layers.size-1&&(n?.(L),!L.defaultPrevented&&l&&(L.preventDefault(),l()))},m),reactExports.useEffect(()=>{if(u)return t&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(originalBodyPointerEvents=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(u)),d.layers.add(u),dispatchUpdate(),()=>{t&&d.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=originalBodyPointerEvents)}},[u,m,t,d]),reactExports.useEffect(()=>()=>{u&&(d.layers.delete(u),d.layersWithOutsidePointerEventsDisabled.delete(u),dispatchUpdate())},[u,d]),reactExports.useEffect(()=>{const L=()=>v({});return document.addEventListener(CONTEXT_UPDATE,L),()=>document.removeEventListener(CONTEXT_UPDATE,L)},[]),jsxRuntimeExports.jsx(Primitive.div,{...h,ref:g,style:{pointerEvents:S?C?"auto":"none":void 0,...s.style},onFocusCapture:composeEventHandlers$1(s.onFocusCapture,R.onFocusCapture),onBlurCapture:composeEventHandlers$1(s.onBlurCapture,R.onBlurCapture),onPointerDownCapture:composeEventHandlers$1(s.onPointerDownCapture,A.onPointerDownCapture)})});DismissableLayer.displayName=DISMISSABLE_LAYER_NAME;var BRANCH_NAME="DismissableLayerBranch",DismissableLayerBranch=reactExports.forwardRef((s,e)=>{const t=reactExports.useContext(DismissableLayerContext),n=reactExports.useRef(null),i=useComposedRefs(e,n);return reactExports.useEffect(()=>{const o=n.current;if(o)return t.branches.add(o),()=>{t.branches.delete(o)}},[t.branches]),jsxRuntimeExports.jsx(Primitive.div,{...s,ref:i})});DismissableLayerBranch.displayName=BRANCH_NAME;function usePointerDownOutside(s,e=globalThis?.document){const t=useCallbackRef$1(s),n=reactExports.useRef(!1),i=reactExports.useRef(()=>{});return reactExports.useEffect(()=>{const o=l=>{if(l.target&&!n.current){let h=function(){handleAndDispatchCustomEvent(POINTER_DOWN_OUTSIDE,t,d,{discrete:!0})};const d={originalEvent:l};l.pointerType==="touch"?(e.removeEventListener("click",i.current),i.current=h,e.addEventListener("click",i.current,{once:!0})):h()}else e.removeEventListener("click",i.current);n.current=!1},a=window.setTimeout(()=>{e.addEventListener("pointerdown",o)},0);return()=>{window.clearTimeout(a),e.removeEventListener("pointerdown",o),e.removeEventListener("click",i.current)}},[e,t]),{onPointerDownCapture:()=>n.current=!0}}function useFocusOutside(s,e=globalThis?.document){const t=useCallbackRef$1(s),n=reactExports.useRef(!1);return reactExports.useEffect(()=>{const i=o=>{o.target&&!n.current&&handleAndDispatchCustomEvent(FOCUS_OUTSIDE,t,{originalEvent:o},{discrete:!1})};return e.addEventListener("focusin",i),()=>e.removeEventListener("focusin",i)},[e,t]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function dispatchUpdate(){const s=new CustomEvent(CONTEXT_UPDATE);document.dispatchEvent(s)}function handleAndDispatchCustomEvent(s,e,t,{discrete:n}){const i=t.originalEvent.target,o=new CustomEvent(s,{bubbles:!1,cancelable:!0,detail:t});e&&i.addEventListener(s,e,{once:!0}),n?dispatchDiscreteCustomEvent(i,o):i.dispatchEvent(o)}var count$1=0;function useFocusGuards(){reactExports.useEffect(()=>{const s=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",s[0]??createFocusGuard()),document.body.insertAdjacentElement("beforeend",s[1]??createFocusGuard()),count$1++,()=>{count$1===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),count$1--}},[])}function createFocusGuard(){const s=document.createElement("span");return s.setAttribute("data-radix-focus-guard",""),s.tabIndex=0,s.style.outline="none",s.style.opacity="0",s.style.position="fixed",s.style.pointerEvents="none",s}var AUTOFOCUS_ON_MOUNT="focusScope.autoFocusOnMount",AUTOFOCUS_ON_UNMOUNT="focusScope.autoFocusOnUnmount",EVENT_OPTIONS$1={bubbles:!1,cancelable:!0},FOCUS_SCOPE_NAME="FocusScope",FocusScope=reactExports.forwardRef((s,e)=>{const{loop:t=!1,trapped:n=!1,onMountAutoFocus:i,onUnmountAutoFocus:o,...a}=s,[l,h]=reactExports.useState(null),d=useCallbackRef$1(i),u=useCallbackRef$1(o),f=reactExports.useRef(null),m=useComposedRefs(e,x=>h(x)),v=reactExports.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;reactExports.useEffect(()=>{if(n){let x=function(S){if(v.paused||!l)return;const C=S.target;l.contains(C)?f.current=C:focus(f.current,{select:!0})},E=function(S){if(v.paused||!l)return;const C=S.relatedTarget;C!==null&&(l.contains(C)||focus(f.current,{select:!0}))},b=function(S){if(document.activeElement===document.body)for(const A of S)A.removedNodes.length>0&&focus(l)};document.addEventListener("focusin",x),document.addEventListener("focusout",E);const _=new MutationObserver(b);return l&&_.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",E),_.disconnect()}}},[n,l,v.paused]),reactExports.useEffect(()=>{if(l){focusScopesStack.add(v);const x=document.activeElement;if(!l.contains(x)){const b=new CustomEvent(AUTOFOCUS_ON_MOUNT,EVENT_OPTIONS$1);l.addEventListener(AUTOFOCUS_ON_MOUNT,d),l.dispatchEvent(b),b.defaultPrevented||(focusFirst$2(removeLinks(getTabbableCandidates(l)),{select:!0}),document.activeElement===x&&focus(l))}return()=>{l.removeEventListener(AUTOFOCUS_ON_MOUNT,d),setTimeout(()=>{const b=new CustomEvent(AUTOFOCUS_ON_UNMOUNT,EVENT_OPTIONS$1);l.addEventListener(AUTOFOCUS_ON_UNMOUNT,u),l.dispatchEvent(b),b.defaultPrevented||focus(x??document.body,{select:!0}),l.removeEventListener(AUTOFOCUS_ON_UNMOUNT,u),focusScopesStack.remove(v)},0)}}},[l,d,u,v]);const g=reactExports.useCallback(x=>{if(!t&&!n||v.paused)return;const E=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,b=document.activeElement;if(E&&b){const _=x.currentTarget,[S,C]=getTabbableEdges(_);S&&C?!x.shiftKey&&b===C?(x.preventDefault(),t&&focus(S,{select:!0})):x.shiftKey&&b===S&&(x.preventDefault(),t&&focus(C,{select:!0})):b===_&&x.preventDefault()}},[t,n,v.paused]);return jsxRuntimeExports.jsx(Primitive.div,{tabIndex:-1,...a,ref:m,onKeyDown:g})});FocusScope.displayName=FOCUS_SCOPE_NAME;function focusFirst$2(s,{select:e=!1}={}){const t=document.activeElement;for(const n of s)if(focus(n,{select:e}),document.activeElement!==t)return}function getTabbableEdges(s){const e=getTabbableCandidates(s),t=findVisible(e,s),n=findVisible(e.reverse(),s);return[t,n]}function getTabbableCandidates(s){const e=[],t=document.createTreeWalker(s,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const i=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||i?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)e.push(t.currentNode);return e}function findVisible(s,e){for(const t of s)if(!isHidden(t,{upTo:e}))return t}function isHidden(s,{upTo:e}){if(getComputedStyle(s).visibility==="hidden")return!0;for(;s;){if(e!==void 0&&s===e)return!1;if(getComputedStyle(s).display==="none")return!0;s=s.parentElement}return!1}function isSelectableInput(s){return s instanceof HTMLInputElement&&"select"in s}function focus(s,{select:e=!1}={}){if(s&&s.focus){const t=document.activeElement;s.focus({preventScroll:!0}),s!==t&&isSelectableInput(s)&&e&&s.select()}}var focusScopesStack=createFocusScopesStack();function createFocusScopesStack(){let s=[];return{add(e){const t=s[0];e!==t&&t?.pause(),s=arrayRemove(s,e),s.unshift(e)},remove(e){s=arrayRemove(s,e),s[0]?.resume()}}}function arrayRemove(s,e){const t=[...s],n=t.indexOf(e);return n!==-1&&t.splice(n,1),t}function removeLinks(s){return s.filter(e=>e.tagName!=="A")}var useLayoutEffect2=globalThis?.document?reactExports.useLayoutEffect:()=>{},useReactId=React$1[" useId ".trim().toString()]||(()=>{}),count=0;function useId$1(s){const[e,t]=reactExports.useState(useReactId());return useLayoutEffect2(()=>{t(n=>n??String(count++))},[s]),s||(e?`radix-${e}`:"")}const sides=["top","right","bottom","left"],min=Math.min,max=Math.max,round=Math.round,floor$1=Math.floor,createCoords=s=>({x:s,y:s}),oppositeSideMap={left:"right",right:"left",bottom:"top",top:"bottom"},oppositeAlignmentMap={start:"end",end:"start"};function clamp$1(s,e,t){return max(s,min(e,t))}function evaluate(s,e){return typeof s=="function"?s(e):s}function getSide(s){return s.split("-")[0]}function getAlignment(s){return s.split("-")[1]}function getOppositeAxis(s){return s==="x"?"y":"x"}function getAxisLength(s){return s==="y"?"height":"width"}const yAxisSides=new Set(["top","bottom"]);function getSideAxis(s){return yAxisSides.has(getSide(s))?"y":"x"}function getAlignmentAxis(s){return getOppositeAxis(getSideAxis(s))}function getAlignmentSides(s,e,t){t===void 0&&(t=!1);const n=getAlignment(s),i=getAlignmentAxis(s),o=getAxisLength(i);let a=i==="x"?n===(t?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(a=getOppositePlacement(a)),[a,getOppositePlacement(a)]}function getExpandedPlacements(s){const e=getOppositePlacement(s);return[getOppositeAlignmentPlacement(s),e,getOppositeAlignmentPlacement(e)]}function getOppositeAlignmentPlacement(s){return s.replace(/start|end/g,e=>oppositeAlignmentMap[e])}const lrPlacement=["left","right"],rlPlacement=["right","left"],tbPlacement=["top","bottom"],btPlacement=["bottom","top"];function getSideList(s,e,t){switch(s){case"top":case"bottom":return t?e?rlPlacement:lrPlacement:e?lrPlacement:rlPlacement;case"left":case"right":return e?tbPlacement:btPlacement;default:return[]}}function getOppositeAxisPlacements(s,e,t,n){const i=getAlignment(s);let o=getSideList(getSide(s),t==="start",n);return i&&(o=o.map(a=>a+"-"+i),e&&(o=o.concat(o.map(getOppositeAlignmentPlacement)))),o}function getOppositePlacement(s){return s.replace(/left|right|bottom|top/g,e=>oppositeSideMap[e])}function expandPaddingObject(s){return{top:0,right:0,bottom:0,left:0,...s}}function getPaddingObject(s){return typeof s!="number"?expandPaddingObject(s):{top:s,right:s,bottom:s,left:s}}function rectToClientRect(s){const{x:e,y:t,width:n,height:i}=s;return{width:n,height:i,top:t,left:e,right:e+n,bottom:t+i,x:e,y:t}}function computeCoordsFromPlacement(s,e,t){let{reference:n,floating:i}=s;const o=getSideAxis(e),a=getAlignmentAxis(e),l=getAxisLength(a),h=getSide(e),d=o==="y",u=n.x+n.width/2-i.width/2,f=n.y+n.height/2-i.height/2,m=n[l]/2-i[l]/2;let v;switch(h){case"top":v={x:u,y:n.y-i.height};break;case"bottom":v={x:u,y:n.y+n.height};break;case"right":v={x:n.x+n.width,y:f};break;case"left":v={x:n.x-i.width,y:f};break;default:v={x:n.x,y:n.y}}switch(getAlignment(e)){case"start":v[a]-=m*(t&&d?-1:1);break;case"end":v[a]+=m*(t&&d?-1:1);break}return v}const computePosition$1=async(s,e,t)=>{const{placement:n="bottom",strategy:i="absolute",middleware:o=[],platform:a}=t,l=o.filter(Boolean),h=await(a.isRTL==null?void 0:a.isRTL(e));let d=await a.getElementRects({reference:s,floating:e,strategy:i}),{x:u,y:f}=computeCoordsFromPlacement(d,n,h),m=n,v={},g=0;for(let x=0;x<l.length;x++){const{name:E,fn:b}=l[x],{x:_,y:S,data:C,reset:A}=await b({x:u,y:f,initialPlacement:n,placement:m,strategy:i,middlewareData:v,rects:d,platform:a,elements:{reference:s,floating:e}});u=_??u,f=S??f,v={...v,[E]:{...v[E],...C}},A&&g<=50&&(g++,typeof A=="object"&&(A.placement&&(m=A.placement),A.rects&&(d=A.rects===!0?await a.getElementRects({reference:s,floating:e,strategy:i}):A.rects),{x:u,y:f}=computeCoordsFromPlacement(d,m,h)),x=-1)}return{x:u,y:f,placement:m,strategy:i,middlewareData:v}};async function detectOverflow(s,e){var t;e===void 0&&(e={});const{x:n,y:i,platform:o,rects:a,elements:l,strategy:h}=s,{boundary:d="clippingAncestors",rootBoundary:u="viewport",elementContext:f="floating",altBoundary:m=!1,padding:v=0}=evaluate(e,s),g=getPaddingObject(v),E=l[m?f==="floating"?"reference":"floating":f],b=rectToClientRect(await o.getClippingRect({element:(t=await(o.isElement==null?void 0:o.isElement(E)))==null||t?E:E.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(l.floating)),boundary:d,rootBoundary:u,strategy:h})),_=f==="floating"?{x:n,y:i,width:a.floating.width,height:a.floating.height}:a.reference,S=await(o.getOffsetParent==null?void 0:o.getOffsetParent(l.floating)),C=await(o.isElement==null?void 0:o.isElement(S))?await(o.getScale==null?void 0:o.getScale(S))||{x:1,y:1}:{x:1,y:1},A=rectToClientRect(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:_,offsetParent:S,strategy:h}):_);return{top:(b.top-A.top+g.top)/C.y,bottom:(A.bottom-b.bottom+g.bottom)/C.y,left:(b.left-A.left+g.left)/C.x,right:(A.right-b.right+g.right)/C.x}}const arrow$3=s=>({name:"arrow",options:s,async fn(e){const{x:t,y:n,placement:i,rects:o,platform:a,elements:l,middlewareData:h}=e,{element:d,padding:u=0}=evaluate(s,e)||{};if(d==null)return{};const f=getPaddingObject(u),m={x:t,y:n},v=getAlignmentAxis(i),g=getAxisLength(v),x=await a.getDimensions(d),E=v==="y",b=E?"top":"left",_=E?"bottom":"right",S=E?"clientHeight":"clientWidth",C=o.reference[g]+o.reference[v]-m[v]-o.floating[g],A=m[v]-o.reference[v],R=await(a.getOffsetParent==null?void 0:a.getOffsetParent(d));let L=R?R[S]:0;(!L||!await(a.isElement==null?void 0:a.isElement(R)))&&(L=l.floating[S]||o.floating[g]);const j=C/2-A/2,F=L/2-x[g]/2-1,W=min(f[b],F),K=min(f[_],F),ee=W,te=L-x[g]-K,re=L/2-x[g]/2+j,ie=clamp$1(ee,re,te),Q=!h.arrow&&getAlignment(i)!=null&&re!==ie&&o.reference[g]/2-(re<ee?W:K)-x[g]/2<0,z=Q?re<ee?re-ee:re-te:0;return{[v]:m[v]+z,data:{[v]:ie,centerOffset:re-ie-z,...Q&&{alignmentOffset:z}},reset:Q}}}),flip$2=function(s){return s===void 0&&(s={}),{name:"flip",options:s,async fn(e){var t,n;const{placement:i,middlewareData:o,rects:a,initialPlacement:l,platform:h,elements:d}=e,{mainAxis:u=!0,crossAxis:f=!0,fallbackPlacements:m,fallbackStrategy:v="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:x=!0,...E}=evaluate(s,e);if((t=o.arrow)!=null&&t.alignmentOffset)return{};const b=getSide(i),_=getSideAxis(l),S=getSide(l)===l,C=await(h.isRTL==null?void 0:h.isRTL(d.floating)),A=m||(S||!x?[getOppositePlacement(l)]:getExpandedPlacements(l)),R=g!=="none";!m&&R&&A.push(...getOppositeAxisPlacements(l,x,g,C));const L=[l,...A],j=await detectOverflow(e,E),F=[];let W=((n=o.flip)==null?void 0:n.overflows)||[];if(u&&F.push(j[b]),f){const re=getAlignmentSides(i,a,C);F.push(j[re[0]],j[re[1]])}if(W=[...W,{placement:i,overflows:F}],!F.every(re=>re<=0)){var K,ee;const re=(((K=o.flip)==null?void 0:K.index)||0)+1,ie=L[re];if(ie&&(!(f==="alignment"?_!==getSideAxis(ie):!1)||W.every(N=>getSideAxis(N.placement)===_?N.overflows[0]>0:!0)))return{data:{index:re,overflows:W},reset:{placement:ie}};let Q=(ee=W.filter(z=>z.overflows[0]<=0).sort((z,N)=>z.overflows[1]-N.overflows[1])[0])==null?void 0:ee.placement;if(!Q)switch(v){case"bestFit":{var te;const z=(te=W.filter(N=>{if(R){const k=getSideAxis(N.placement);return k===_||k==="y"}return!0}).map(N=>[N.placement,N.overflows.filter(k=>k>0).reduce((k,I)=>k+I,0)]).sort((N,k)=>N[1]-k[1])[0])==null?void 0:te[0];z&&(Q=z);break}case"initialPlacement":Q=l;break}if(i!==Q)return{reset:{placement:Q}}}return{}}}};function getSideOffsets(s,e){return{top:s.top-e.height,right:s.right-e.width,bottom:s.bottom-e.height,left:s.left-e.width}}function isAnySideFullyClipped(s){return sides.some(e=>s[e]>=0)}const hide$2=function(s){return s===void 0&&(s={}),{name:"hide",options:s,async fn(e){const{rects:t}=e,{strategy:n="referenceHidden",...i}=evaluate(s,e);switch(n){case"referenceHidden":{const o=await detectOverflow(e,{...i,elementContext:"reference"}),a=getSideOffsets(o,t.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:isAnySideFullyClipped(a)}}}case"escaped":{const o=await detectOverflow(e,{...i,altBoundary:!0}),a=getSideOffsets(o,t.floating);return{data:{escapedOffsets:a,escaped:isAnySideFullyClipped(a)}}}default:return{}}}}},originSides=new Set(["left","top"]);async function convertValueToCoords(s,e){const{placement:t,platform:n,elements:i}=s,o=await(n.isRTL==null?void 0:n.isRTL(i.floating)),a=getSide(t),l=getAlignment(t),h=getSideAxis(t)==="y",d=originSides.has(a)?-1:1,u=o&&h?-1:1,f=evaluate(e,s);let{mainAxis:m,crossAxis:v,alignmentAxis:g}=typeof f=="number"?{mainAxis:f,crossAxis:0,alignmentAxis:null}:{mainAxis:f.mainAxis||0,crossAxis:f.crossAxis||0,alignmentAxis:f.alignmentAxis};return l&&typeof g=="number"&&(v=l==="end"?g*-1:g),h?{x:v*u,y:m*d}:{x:m*d,y:v*u}}const offset$2=function(s){return s===void 0&&(s=0),{name:"offset",options:s,async fn(e){var t,n;const{x:i,y:o,placement:a,middlewareData:l}=e,h=await convertValueToCoords(e,s);return a===((t=l.offset)==null?void 0:t.placement)&&(n=l.arrow)!=null&&n.alignmentOffset?{}:{x:i+h.x,y:o+h.y,data:{...h,placement:a}}}}},shift$2=function(s){return s===void 0&&(s={}),{name:"shift",options:s,async fn(e){const{x:t,y:n,placement:i}=e,{mainAxis:o=!0,crossAxis:a=!1,limiter:l={fn:E=>{let{x:b,y:_}=E;return{x:b,y:_}}},...h}=evaluate(s,e),d={x:t,y:n},u=await detectOverflow(e,h),f=getSideAxis(getSide(i)),m=getOppositeAxis(f);let v=d[m],g=d[f];if(o){const E=m==="y"?"top":"left",b=m==="y"?"bottom":"right",_=v+u[E],S=v-u[b];v=clamp$1(_,v,S)}if(a){const E=f==="y"?"top":"left",b=f==="y"?"bottom":"right",_=g+u[E],S=g-u[b];g=clamp$1(_,g,S)}const x=l.fn({...e,[m]:v,[f]:g});return{...x,data:{x:x.x-t,y:x.y-n,enabled:{[m]:o,[f]:a}}}}}},limitShift$2=function(s){return s===void 0&&(s={}),{options:s,fn(e){const{x:t,y:n,placement:i,rects:o,middlewareData:a}=e,{offset:l=0,mainAxis:h=!0,crossAxis:d=!0}=evaluate(s,e),u={x:t,y:n},f=getSideAxis(i),m=getOppositeAxis(f);let v=u[m],g=u[f];const x=evaluate(l,e),E=typeof x=="number"?{mainAxis:x,crossAxis:0}:{mainAxis:0,crossAxis:0,...x};if(h){const S=m==="y"?"height":"width",C=o.reference[m]-o.floating[S]+E.mainAxis,A=o.reference[m]+o.reference[S]-E.mainAxis;v<C?v=C:v>A&&(v=A)}if(d){var b,_;const S=m==="y"?"width":"height",C=originSides.has(getSide(i)),A=o.reference[f]-o.floating[S]+(C&&((b=a.offset)==null?void 0:b[f])||0)+(C?0:E.crossAxis),R=o.reference[f]+o.reference[S]+(C?0:((_=a.offset)==null?void 0:_[f])||0)-(C?E.crossAxis:0);g<A?g=A:g>R&&(g=R)}return{[m]:v,[f]:g}}}},size$2=function(s){return s===void 0&&(s={}),{name:"size",options:s,async fn(e){var t,n;const{placement:i,rects:o,platform:a,elements:l}=e,{apply:h=()=>{},...d}=evaluate(s,e),u=await detectOverflow(e,d),f=getSide(i),m=getAlignment(i),v=getSideAxis(i)==="y",{width:g,height:x}=o.floating;let E,b;f==="top"||f==="bottom"?(E=f,b=m===(await(a.isRTL==null?void 0:a.isRTL(l.floating))?"start":"end")?"left":"right"):(b=f,E=m==="end"?"top":"bottom");const _=x-u.top-u.bottom,S=g-u.left-u.right,C=min(x-u[E],_),A=min(g-u[b],S),R=!e.middlewareData.shift;let L=C,j=A;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(j=S),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(L=_),R&&!m){const W=max(u.left,0),K=max(u.right,0),ee=max(u.top,0),te=max(u.bottom,0);v?j=g-2*(W!==0||K!==0?W+K:max(u.left,u.right)):L=x-2*(ee!==0||te!==0?ee+te:max(u.top,u.bottom))}await h({...e,availableWidth:j,availableHeight:L});const F=await a.getDimensions(l.floating);return g!==F.width||x!==F.height?{reset:{rects:!0}}:{}}}};function hasWindow(){return typeof window<"u"}function getNodeName(s){return isNode(s)?(s.nodeName||"").toLowerCase():"#document"}function getWindow(s){var e;return(s==null||(e=s.ownerDocument)==null?void 0:e.defaultView)||window}function getDocumentElement(s){var e;return(e=(isNode(s)?s.ownerDocument:s.document)||window.document)==null?void 0:e.documentElement}function isNode(s){return hasWindow()?s instanceof Node||s instanceof getWindow(s).Node:!1}function isElement(s){return hasWindow()?s instanceof Element||s instanceof getWindow(s).Element:!1}function isHTMLElement(s){return hasWindow()?s instanceof HTMLElement||s instanceof getWindow(s).HTMLElement:!1}function isShadowRoot(s){return!hasWindow()||typeof ShadowRoot>"u"?!1:s instanceof ShadowRoot||s instanceof getWindow(s).ShadowRoot}const invalidOverflowDisplayValues=new Set(["inline","contents"]);function isOverflowElement(s){const{overflow:e,overflowX:t,overflowY:n,display:i}=getComputedStyle$2(s);return/auto|scroll|overlay|hidden|clip/.test(e+n+t)&&!invalidOverflowDisplayValues.has(i)}const tableElements=new Set(["table","td","th"]);function isTableElement(s){return tableElements.has(getNodeName(s))}const topLayerSelectors=[":popover-open",":modal"];function isTopLayer(s){return topLayerSelectors.some(e=>{try{return s.matches(e)}catch{return!1}})}const transformProperties=["transform","translate","scale","rotate","perspective"],willChangeValues=["transform","translate","scale","rotate","perspective","filter"],containValues=["paint","layout","strict","content"];function isContainingBlock(s){const e=isWebKit(),t=isElement(s)?getComputedStyle$2(s):s;return transformProperties.some(n=>t[n]?t[n]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||willChangeValues.some(n=>(t.willChange||"").includes(n))||containValues.some(n=>(t.contain||"").includes(n))}function getContainingBlock(s){let e=getParentNode(s);for(;isHTMLElement(e)&&!isLastTraversableNode(e);){if(isContainingBlock(e))return e;if(isTopLayer(e))return null;e=getParentNode(e)}return null}function isWebKit(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const lastTraversableNodeNames=new Set(["html","body","#document"]);function isLastTraversableNode(s){return lastTraversableNodeNames.has(getNodeName(s))}function getComputedStyle$2(s){return getWindow(s).getComputedStyle(s)}function getNodeScroll(s){return isElement(s)?{scrollLeft:s.scrollLeft,scrollTop:s.scrollTop}:{scrollLeft:s.scrollX,scrollTop:s.scrollY}}function getParentNode(s){if(getNodeName(s)==="html")return s;const e=s.assignedSlot||s.parentNode||isShadowRoot(s)&&s.host||getDocumentElement(s);return isShadowRoot(e)?e.host:e}function getNearestOverflowAncestor(s){const e=getParentNode(s);return isLastTraversableNode(e)?s.ownerDocument?s.ownerDocument.body:s.body:isHTMLElement(e)&&isOverflowElement(e)?e:getNearestOverflowAncestor(e)}function getOverflowAncestors(s,e,t){var n;e===void 0&&(e=[]),t===void 0&&(t=!0);const i=getNearestOverflowAncestor(s),o=i===((n=s.ownerDocument)==null?void 0:n.body),a=getWindow(i);if(o){const l=getFrameElement(a);return e.concat(a,a.visualViewport||[],isOverflowElement(i)?i:[],l&&t?getOverflowAncestors(l):[])}return e.concat(i,getOverflowAncestors(i,[],t))}function getFrameElement(s){return s.parent&&Object.getPrototypeOf(s.parent)?s.frameElement:null}function getCssDimensions(s){const e=getComputedStyle$2(s);let t=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const i=isHTMLElement(s),o=i?s.offsetWidth:t,a=i?s.offsetHeight:n,l=round(t)!==o||round(n)!==a;return l&&(t=o,n=a),{width:t,height:n,$:l}}function unwrapElement(s){return isElement(s)?s:s.contextElement}function getScale(s){const e=unwrapElement(s);if(!isHTMLElement(e))return createCoords(1);const t=e.getBoundingClientRect(),{width:n,height:i,$:o}=getCssDimensions(e);let a=(o?round(t.width):t.width)/n,l=(o?round(t.height):t.height)/i;return(!a||!Number.isFinite(a))&&(a=1),(!l||!Number.isFinite(l))&&(l=1),{x:a,y:l}}const noOffsets=createCoords(0);function getVisualOffsets(s){const e=getWindow(s);return!isWebKit()||!e.visualViewport?noOffsets:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function shouldAddVisualOffsets(s,e,t){return e===void 0&&(e=!1),!t||e&&t!==getWindow(s)?!1:e}function getBoundingClientRect(s,e,t,n){e===void 0&&(e=!1),t===void 0&&(t=!1);const i=s.getBoundingClientRect(),o=unwrapElement(s);let a=createCoords(1);e&&(n?isElement(n)&&(a=getScale(n)):a=getScale(s));const l=shouldAddVisualOffsets(o,t,n)?getVisualOffsets(o):createCoords(0);let h=(i.left+l.x)/a.x,d=(i.top+l.y)/a.y,u=i.width/a.x,f=i.height/a.y;if(o){const m=getWindow(o),v=n&&isElement(n)?getWindow(n):n;let g=m,x=getFrameElement(g);for(;x&&n&&v!==g;){const E=getScale(x),b=x.getBoundingClientRect(),_=getComputedStyle$2(x),S=b.left+(x.clientLeft+parseFloat(_.paddingLeft))*E.x,C=b.top+(x.clientTop+parseFloat(_.paddingTop))*E.y;h*=E.x,d*=E.y,u*=E.x,f*=E.y,h+=S,d+=C,g=getWindow(x),x=getFrameElement(g)}}return rectToClientRect({width:u,height:f,x:h,y:d})}function getWindowScrollBarX(s,e){const t=getNodeScroll(s).scrollLeft;return e?e.left+t:getBoundingClientRect(getDocumentElement(s)).left+t}function getHTMLOffset(s,e){const t=s.getBoundingClientRect(),n=t.left+e.scrollLeft-getWindowScrollBarX(s,t),i=t.top+e.scrollTop;return{x:n,y:i}}function convertOffsetParentRelativeRectToViewportRelativeRect(s){let{elements:e,rect:t,offsetParent:n,strategy:i}=s;const o=i==="fixed",a=getDocumentElement(n),l=e?isTopLayer(e.floating):!1;if(n===a||l&&o)return t;let h={scrollLeft:0,scrollTop:0},d=createCoords(1);const u=createCoords(0),f=isHTMLElement(n);if((f||!f&&!o)&&((getNodeName(n)!=="body"||isOverflowElement(a))&&(h=getNodeScroll(n)),isHTMLElement(n))){const v=getBoundingClientRect(n);d=getScale(n),u.x=v.x+n.clientLeft,u.y=v.y+n.clientTop}const m=a&&!f&&!o?getHTMLOffset(a,h):createCoords(0);return{width:t.width*d.x,height:t.height*d.y,x:t.x*d.x-h.scrollLeft*d.x+u.x+m.x,y:t.y*d.y-h.scrollTop*d.y+u.y+m.y}}function getClientRects(s){return Array.from(s.getClientRects())}function getDocumentRect(s){const e=getDocumentElement(s),t=getNodeScroll(s),n=s.ownerDocument.body,i=max(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),o=max(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let a=-t.scrollLeft+getWindowScrollBarX(s);const l=-t.scrollTop;return getComputedStyle$2(n).direction==="rtl"&&(a+=max(e.clientWidth,n.clientWidth)-i),{width:i,height:o,x:a,y:l}}const SCROLLBAR_MAX=25;function getViewportRect(s,e){const t=getWindow(s),n=getDocumentElement(s),i=t.visualViewport;let o=n.clientWidth,a=n.clientHeight,l=0,h=0;if(i){o=i.width,a=i.height;const u=isWebKit();(!u||u&&e==="fixed")&&(l=i.offsetLeft,h=i.offsetTop)}const d=getWindowScrollBarX(n);if(d<=0){const u=n.ownerDocument,f=u.body,m=getComputedStyle(f),v=u.compatMode==="CSS1Compat"&&parseFloat(m.marginLeft)+parseFloat(m.marginRight)||0,g=Math.abs(n.clientWidth-f.clientWidth-v);g<=SCROLLBAR_MAX&&(o-=g)}else d<=SCROLLBAR_MAX&&(o+=d);return{width:o,height:a,x:l,y:h}}const absoluteOrFixed=new Set(["absolute","fixed"]);function getInnerBoundingClientRect(s,e){const t=getBoundingClientRect(s,!0,e==="fixed"),n=t.top+s.clientTop,i=t.left+s.clientLeft,o=isHTMLElement(s)?getScale(s):createCoords(1),a=s.clientWidth*o.x,l=s.clientHeight*o.y,h=i*o.x,d=n*o.y;return{width:a,height:l,x:h,y:d}}function getClientRectFromClippingAncestor(s,e,t){let n;if(e==="viewport")n=getViewportRect(s,t);else if(e==="document")n=getDocumentRect(getDocumentElement(s));else if(isElement(e))n=getInnerBoundingClientRect(e,t);else{const i=getVisualOffsets(s);n={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return rectToClientRect(n)}function hasFixedPositionAncestor(s,e){const t=getParentNode(s);return t===e||!isElement(t)||isLastTraversableNode(t)?!1:getComputedStyle$2(t).position==="fixed"||hasFixedPositionAncestor(t,e)}function getClippingElementAncestors(s,e){const t=e.get(s);if(t)return t;let n=getOverflowAncestors(s,[],!1).filter(l=>isElement(l)&&getNodeName(l)!=="body"),i=null;const o=getComputedStyle$2(s).position==="fixed";let a=o?getParentNode(s):s;for(;isElement(a)&&!isLastTraversableNode(a);){const l=getComputedStyle$2(a),h=isContainingBlock(a);!h&&l.position==="fixed"&&(i=null),(o?!h&&!i:!h&&l.position==="static"&&!!i&&absoluteOrFixed.has(i.position)||isOverflowElement(a)&&!h&&hasFixedPositionAncestor(s,a))?n=n.filter(u=>u!==a):i=l,a=getParentNode(a)}return e.set(s,n),n}function getClippingRect(s){let{element:e,boundary:t,rootBoundary:n,strategy:i}=s;const a=[...t==="clippingAncestors"?isTopLayer(e)?[]:getClippingElementAncestors(e,this._c):[].concat(t),n],l=a[0],h=a.reduce((d,u)=>{const f=getClientRectFromClippingAncestor(e,u,i);return d.top=max(f.top,d.top),d.right=min(f.right,d.right),d.bottom=min(f.bottom,d.bottom),d.left=max(f.left,d.left),d},getClientRectFromClippingAncestor(e,l,i));return{width:h.right-h.left,height:h.bottom-h.top,x:h.left,y:h.top}}function getDimensions(s){const{width:e,height:t}=getCssDimensions(s);return{width:e,height:t}}function getRectRelativeToOffsetParent(s,e,t){const n=isHTMLElement(e),i=getDocumentElement(e),o=t==="fixed",a=getBoundingClientRect(s,!0,o,e);let l={scrollLeft:0,scrollTop:0};const h=createCoords(0);function d(){h.x=getWindowScrollBarX(i)}if(n||!n&&!o)if((getNodeName(e)!=="body"||isOverflowElement(i))&&(l=getNodeScroll(e)),n){const v=getBoundingClientRect(e,!0,o,e);h.x=v.x+e.clientLeft,h.y=v.y+e.clientTop}else i&&d();o&&!n&&i&&d();const u=i&&!n&&!o?getHTMLOffset(i,l):createCoords(0),f=a.left+l.scrollLeft-h.x-u.x,m=a.top+l.scrollTop-h.y-u.y;return{x:f,y:m,width:a.width,height:a.height}}function isStaticPositioned(s){return getComputedStyle$2(s).position==="static"}function getTrueOffsetParent(s,e){if(!isHTMLElement(s)||getComputedStyle$2(s).position==="fixed")return null;if(e)return e(s);let t=s.offsetParent;return getDocumentElement(s)===t&&(t=t.ownerDocument.body),t}function getOffsetParent(s,e){const t=getWindow(s);if(isTopLayer(s))return t;if(!isHTMLElement(s)){let i=getParentNode(s);for(;i&&!isLastTraversableNode(i);){if(isElement(i)&&!isStaticPositioned(i))return i;i=getParentNode(i)}return t}let n=getTrueOffsetParent(s,e);for(;n&&isTableElement(n)&&isStaticPositioned(n);)n=getTrueOffsetParent(n,e);return n&&isLastTraversableNode(n)&&isStaticPositioned(n)&&!isContainingBlock(n)?t:n||getContainingBlock(s)||t}const getElementRects=async function(s){const e=this.getOffsetParent||getOffsetParent,t=this.getDimensions,n=await t(s.floating);return{reference:getRectRelativeToOffsetParent(s.reference,await e(s.floating),s.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function isRTL(s){return getComputedStyle$2(s).direction==="rtl"}const platform={convertOffsetParentRelativeRectToViewportRelativeRect,getDocumentElement,getClippingRect,getOffsetParent,getElementRects,getClientRects,getDimensions,getScale,isElement,isRTL};function rectsAreEqual(s,e){return s.x===e.x&&s.y===e.y&&s.width===e.width&&s.height===e.height}function observeMove(s,e){let t=null,n;const i=getDocumentElement(s);function o(){var l;clearTimeout(n),(l=t)==null||l.disconnect(),t=null}function a(l,h){l===void 0&&(l=!1),h===void 0&&(h=1),o();const d=s.getBoundingClientRect(),{left:u,top:f,width:m,height:v}=d;if(l||e(),!m||!v)return;const g=floor$1(f),x=floor$1(i.clientWidth-(u+m)),E=floor$1(i.clientHeight-(f+v)),b=floor$1(u),S={rootMargin:-g+"px "+-x+"px "+-E+"px "+-b+"px",threshold:max(0,min(1,h))||1};let C=!0;function A(R){const L=R[0].intersectionRatio;if(L!==h){if(!C)return a();L?a(!1,L):n=setTimeout(()=>{a(!1,1e-7)},1e3)}L===1&&!rectsAreEqual(d,s.getBoundingClientRect())&&a(),C=!1}try{t=new IntersectionObserver(A,{...S,root:i.ownerDocument})}catch{t=new IntersectionObserver(A,S)}t.observe(s)}return a(!0),o}function autoUpdate(s,e,t,n){n===void 0&&(n={});const{ancestorScroll:i=!0,ancestorResize:o=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:h=!1}=n,d=unwrapElement(s),u=i||o?[...d?getOverflowAncestors(d):[],...getOverflowAncestors(e)]:[];u.forEach(b=>{i&&b.addEventListener("scroll",t,{passive:!0}),o&&b.addEventListener("resize",t)});const f=d&&l?observeMove(d,t):null;let m=-1,v=null;a&&(v=new ResizeObserver(b=>{let[_]=b;_&&_.target===d&&v&&(v.unobserve(e),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{var S;(S=v)==null||S.observe(e)})),t()}),d&&!h&&v.observe(d),v.observe(e));let g,x=h?getBoundingClientRect(s):null;h&&E();function E(){const b=getBoundingClientRect(s);x&&!rectsAreEqual(x,b)&&t(),x=b,g=requestAnimationFrame(E)}return t(),()=>{var b;u.forEach(_=>{i&&_.removeEventListener("scroll",t),o&&_.removeEventListener("resize",t)}),f?.(),(b=v)==null||b.disconnect(),v=null,h&&cancelAnimationFrame(g)}}const offset$1=offset$2,shift$1=shift$2,flip$1=flip$2,size$1=size$2,hide$1=hide$2,arrow$2=arrow$3,limitShift$1=limitShift$2,computePosition=(s,e,t)=>{const n=new Map,i={platform,...t},o={...i.platform,_c:n};return computePosition$1(s,e,{...i,platform:o})};var isClient=typeof document<"u",noop$4=function(){},index$1=isClient?reactExports.useLayoutEffect:noop$4;function deepEqual(s,e){if(s===e)return!0;if(typeof s!=typeof e)return!1;if(typeof s=="function"&&s.toString()===e.toString())return!0;let t,n,i;if(s&&e&&typeof s=="object"){if(Array.isArray(s)){if(t=s.length,t!==e.length)return!1;for(n=t;n--!==0;)if(!deepEqual(s[n],e[n]))return!1;return!0}if(i=Object.keys(s),t=i.length,t!==Object.keys(e).length)return!1;for(n=t;n--!==0;)if(!{}.hasOwnProperty.call(e,i[n]))return!1;for(n=t;n--!==0;){const o=i[n];if(!(o==="_owner"&&s.$$typeof)&&!deepEqual(s[o],e[o]))return!1}return!0}return s!==s&&e!==e}function getDPR(s){return typeof window>"u"?1:(s.ownerDocument.defaultView||window).devicePixelRatio||1}function roundByDPR(s,e){const t=getDPR(s);return Math.round(e*t)/t}function useLatestRef(s){const e=reactExports.useRef(s);return index$1(()=>{e.current=s}),e}function useFloating(s){s===void 0&&(s={});const{placement:e="bottom",strategy:t="absolute",middleware:n=[],platform:i,elements:{reference:o,floating:a}={},transform:l=!0,whileElementsMounted:h,open:d}=s,[u,f]=reactExports.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[m,v]=reactExports.useState(n);deepEqual(m,n)||v(n);const[g,x]=reactExports.useState(null),[E,b]=reactExports.useState(null),_=reactExports.useCallback(N=>{N!==R.current&&(R.current=N,x(N))},[]),S=reactExports.useCallback(N=>{N!==L.current&&(L.current=N,b(N))},[]),C=o||g,A=a||E,R=reactExports.useRef(null),L=reactExports.useRef(null),j=reactExports.useRef(u),F=h!=null,W=useLatestRef(h),K=useLatestRef(i),ee=useLatestRef(d),te=reactExports.useCallback(()=>{if(!R.current||!L.current)return;const N={placement:e,strategy:t,middleware:m};K.current&&(N.platform=K.current),computePosition(R.current,L.current,N).then(k=>{const I={...k,isPositioned:ee.current!==!1};re.current&&!deepEqual(j.current,I)&&(j.current=I,reactDomExports.flushSync(()=>{f(I)}))})},[m,e,t,K,ee]);index$1(()=>{d===!1&&j.current.isPositioned&&(j.current.isPositioned=!1,f(N=>({...N,isPositioned:!1})))},[d]);const re=reactExports.useRef(!1);index$1(()=>(re.current=!0,()=>{re.current=!1}),[]),index$1(()=>{if(C&&(R.current=C),A&&(L.current=A),C&&A){if(W.current)return W.current(C,A,te);te()}},[C,A,te,W,F]);const ie=reactExports.useMemo(()=>({reference:R,floating:L,setReference:_,setFloating:S}),[_,S]),Q=reactExports.useMemo(()=>({reference:C,floating:A}),[C,A]),z=reactExports.useMemo(()=>{const N={position:t,left:0,top:0};if(!Q.floating)return N;const k=roundByDPR(Q.floating,u.x),I=roundByDPR(Q.floating,u.y);return l?{...N,transform:"translate("+k+"px, "+I+"px)",...getDPR(Q.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:k,top:I}},[t,l,Q.floating,u.x,u.y]);return reactExports.useMemo(()=>({...u,update:te,refs:ie,elements:Q,floatingStyles:z}),[u,te,ie,Q,z])}const arrow$1=s=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:s,fn(t){const{element:n,padding:i}=typeof s=="function"?s(t):s;return n&&e(n)?n.current!=null?arrow$2({element:n.current,padding:i}).fn(t):{}:n?arrow$2({element:n,padding:i}).fn(t):{}}}},offset=(s,e)=>({...offset$1(s),options:[s,e]}),shift=(s,e)=>({...shift$1(s),options:[s,e]}),limitShift=(s,e)=>({...limitShift$1(s),options:[s,e]}),flip=(s,e)=>({...flip$1(s),options:[s,e]}),size=(s,e)=>({...size$1(s),options:[s,e]}),hide=(s,e)=>({...hide$1(s),options:[s,e]}),arrow=(s,e)=>({...arrow$1(s),options:[s,e]});var NAME$2="Arrow",Arrow$1=reactExports.forwardRef((s,e)=>{const{children:t,width:n=10,height:i=5,...o}=s;return jsxRuntimeExports.jsx(Primitive.svg,{...o,ref:e,width:n,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:s.asChild?t:jsxRuntimeExports.jsx("polygon",{points:"0,0 30,0 15,10"})})});Arrow$1.displayName=NAME$2;var Root$4=Arrow$1;function useSize(s){const[e,t]=reactExports.useState(void 0);return useLayoutEffect2(()=>{if(s){t({width:s.offsetWidth,height:s.offsetHeight});const n=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const o=i[0];let a,l;if("borderBoxSize"in o){const h=o.borderBoxSize,d=Array.isArray(h)?h[0]:h;a=d.inlineSize,l=d.blockSize}else a=s.offsetWidth,l=s.offsetHeight;t({width:a,height:l})});return n.observe(s,{box:"border-box"}),()=>n.unobserve(s)}else t(void 0)},[s]),e}var POPPER_NAME="Popper",[createPopperContext,createPopperScope]=createContextScope(POPPER_NAME),[PopperProvider,usePopperContext]=createPopperContext(POPPER_NAME),Popper=s=>{const{__scopePopper:e,children:t}=s,[n,i]=reactExports.useState(null);return jsxRuntimeExports.jsx(PopperProvider,{scope:e,anchor:n,onAnchorChange:i,children:t})};Popper.displayName=POPPER_NAME;var ANCHOR_NAME$1="PopperAnchor",PopperAnchor=reactExports.forwardRef((s,e)=>{const{__scopePopper:t,virtualRef:n,...i}=s,o=usePopperContext(ANCHOR_NAME$1,t),a=reactExports.useRef(null),l=useComposedRefs(e,a),h=reactExports.useRef(null);return reactExports.useEffect(()=>{const d=h.current;h.current=n?.current||a.current,d!==h.current&&o.onAnchorChange(h.current)}),n?null:jsxRuntimeExports.jsx(Primitive.div,{...i,ref:l})});PopperAnchor.displayName=ANCHOR_NAME$1;var CONTENT_NAME$6="PopperContent",[PopperContentProvider,useContentContext]=createPopperContext(CONTENT_NAME$6),PopperContent=reactExports.forwardRef((s,e)=>{const{__scopePopper:t,side:n="bottom",sideOffset:i=0,align:o="center",alignOffset:a=0,arrowPadding:l=0,avoidCollisions:h=!0,collisionBoundary:d=[],collisionPadding:u=0,sticky:f="partial",hideWhenDetached:m=!1,updatePositionStrategy:v="optimized",onPlaced:g,...x}=s,E=usePopperContext(CONTENT_NAME$6,t),[b,_]=reactExports.useState(null),S=useComposedRefs(e,O=>_(O)),[C,A]=reactExports.useState(null),R=useSize(C),L=R?.width??0,j=R?.height??0,F=n+(o!=="center"?"-"+o:""),W=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},K=Array.isArray(d)?d:[d],ee=K.length>0,te={padding:W,boundary:K.filter(isNotNull$1),altBoundary:ee},{refs:re,floatingStyles:ie,placement:Q,isPositioned:z,middlewareData:N}=useFloating({strategy:"fixed",placement:F,whileElementsMounted:(...O)=>autoUpdate(...O,{animationFrame:v==="always"}),elements:{reference:E.anchor},middleware:[offset({mainAxis:i+j,alignmentAxis:a}),h&&shift({mainAxis:!0,crossAxis:!1,limiter:f==="partial"?limitShift():void 0,...te}),h&&flip({...te}),size({...te,apply:({elements:O,rects:B,availableWidth:G,availableHeight:Y})=>{const{width:J,height:Z}=B.reference,oe=O.floating.style;oe.setProperty("--radix-popper-available-width",`${G}px`),oe.setProperty("--radix-popper-available-height",`${Y}px`),oe.setProperty("--radix-popper-anchor-width",`${J}px`),oe.setProperty("--radix-popper-anchor-height",`${Z}px`)}}),C&&arrow({element:C,padding:l}),transformOrigin({arrowWidth:L,arrowHeight:j}),m&&hide({strategy:"referenceHidden",...te})]}),[k,I]=getSideAndAlignFromPlacement(Q),D=useCallbackRef$1(g);useLayoutEffect2(()=>{z&&D?.()},[z,D]);const U=N.arrow?.x,$=N.arrow?.y,q=N.arrow?.centerOffset!==0,[V,P]=reactExports.useState();return useLayoutEffect2(()=>{b&&P(window.getComputedStyle(b).zIndex)},[b]),jsxRuntimeExports.jsx("div",{ref:re.setFloating,"data-radix-popper-content-wrapper":"",style:{...ie,transform:z?ie.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:V,"--radix-popper-transform-origin":[N.transformOrigin?.x,N.transformOrigin?.y].join(" "),...N.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:s.dir,children:jsxRuntimeExports.jsx(PopperContentProvider,{scope:t,placedSide:k,onArrowChange:A,arrowX:U,arrowY:$,shouldHideArrow:q,children:jsxRuntimeExports.jsx(Primitive.div,{"data-side":k,"data-align":I,...x,ref:S,style:{...x.style,animation:z?void 0:"none"}})})})});PopperContent.displayName=CONTENT_NAME$6;var ARROW_NAME$3="PopperArrow",OPPOSITE_SIDE={top:"bottom",right:"left",bottom:"top",left:"right"},PopperArrow=reactExports.forwardRef(function(e,t){const{__scopePopper:n,...i}=e,o=useContentContext(ARROW_NAME$3,n),a=OPPOSITE_SIDE[o.placedSide];return jsxRuntimeExports.jsx("span",{ref:o.onArrowChange,style:{position:"absolute",left:o.arrowX,top:o.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[o.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[o.placedSide],visibility:o.shouldHideArrow?"hidden":void 0},children:jsxRuntimeExports.jsx(Root$4,{...i,ref:t,style:{...i.style,display:"block"}})})});PopperArrow.displayName=ARROW_NAME$3;function isNotNull$1(s){return s!==null}var transformOrigin=s=>({name:"transformOrigin",options:s,fn(e){const{placement:t,rects:n,middlewareData:i}=e,a=i.arrow?.centerOffset!==0,l=a?0:s.arrowWidth,h=a?0:s.arrowHeight,[d,u]=getSideAndAlignFromPlacement(t),f={start:"0%",center:"50%",end:"100%"}[u],m=(i.arrow?.x??0)+l/2,v=(i.arrow?.y??0)+h/2;let g="",x="";return d==="bottom"?(g=a?f:`${m}px`,x=`${-h}px`):d==="top"?(g=a?f:`${m}px`,x=`${n.floating.height+h}px`):d==="right"?(g=`${-h}px`,x=a?f:`${v}px`):d==="left"&&(g=`${n.floating.width+h}px`,x=a?f:`${v}px`),{data:{x:g,y:x}}}});function getSideAndAlignFromPlacement(s){const[e,t="center"]=s.split("-");return[e,t]}var Root2$4=Popper,Anchor=PopperAnchor,Content$2=PopperContent,Arrow=PopperArrow,PORTAL_NAME$5="Portal",Portal$3=reactExports.forwardRef((s,e)=>{const{container:t,...n}=s,[i,o]=reactExports.useState(!1);useLayoutEffect2(()=>o(!0),[]);const a=t||i&&globalThis?.document?.body;return a?ReactDOM.createPortal(jsxRuntimeExports.jsx(Primitive.div,{...n,ref:e}),a):null});Portal$3.displayName=PORTAL_NAME$5;var useInsertionEffect=React$1[" useInsertionEffect ".trim().toString()]||useLayoutEffect2;function useControllableState({prop:s,defaultProp:e,onChange:t=()=>{},caller:n}){const[i,o,a]=useUncontrolledState({defaultProp:e,onChange:t}),l=s!==void 0,h=l?s:i;{const u=reactExports.useRef(s!==void 0);reactExports.useEffect(()=>{const f=u.current;f!==l&&console.warn(`${n} is changing from ${f?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=l},[l,n])}const d=reactExports.useCallback(u=>{if(l){const f=isFunction(u)?u(s):u;f!==s&&a.current?.(f)}else o(u)},[l,s,o,a]);return[h,d]}function useUncontrolledState({defaultProp:s,onChange:e}){const[t,n]=reactExports.useState(s),i=reactExports.useRef(t),o=reactExports.useRef(e);return useInsertionEffect(()=>{o.current=e},[e]),reactExports.useEffect(()=>{i.current!==t&&(o.current?.(t),i.current=t)},[t,i]),[t,n,o]}function isFunction(s){return typeof s=="function"}function usePrevious(s){const e=reactExports.useRef({value:s,previous:s});return reactExports.useMemo(()=>(e.current.value!==s&&(e.current.previous=e.current.value,e.current.value=s),e.current.previous),[s])}var VISUALLY_HIDDEN_STYLES=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),NAME$1="VisuallyHidden",VisuallyHidden=reactExports.forwardRef((s,e)=>jsxRuntimeExports.jsx(Primitive.span,{...s,ref:e,style:{...VISUALLY_HIDDEN_STYLES,...s.style}}));VisuallyHidden.displayName=NAME$1;var getDefaultParent=function(s){if(typeof document>"u")return null;var e=Array.isArray(s)?s[0]:s;return e.ownerDocument.body},counterMap=new WeakMap,uncontrolledNodes=new WeakMap,markerMap={},lockCount=0,unwrapHost=function(s){return s&&(s.host||unwrapHost(s.parentNode))},correctTargets=function(s,e){return e.map(function(t){if(s.contains(t))return t;var n=unwrapHost(t);return n&&s.contains(n)?n:(console.error("aria-hidden",t,"in not contained inside",s,". Doing nothing"),null)}).filter(function(t){return!!t})},applyAttributeToOthers=function(s,e,t,n){var i=correctTargets(e,Array.isArray(s)?s:[s]);markerMap[t]||(markerMap[t]=new WeakMap);var o=markerMap[t],a=[],l=new Set,h=new Set(i),d=function(f){!f||l.has(f)||(l.add(f),d(f.parentNode))};i.forEach(d);var u=function(f){!f||h.has(f)||Array.prototype.forEach.call(f.children,function(m){if(l.has(m))u(m);else try{var v=m.getAttribute(n),g=v!==null&&v!=="false",x=(counterMap.get(m)||0)+1,E=(o.get(m)||0)+1;counterMap.set(m,x),o.set(m,E),a.push(m),x===1&&g&&uncontrolledNodes.set(m,!0),E===1&&m.setAttribute(t,"true"),g||m.setAttribute(n,"true")}catch(b){console.error("aria-hidden: cannot operate on ",m,b)}})};return u(e),l.clear(),lockCount++,function(){a.forEach(function(f){var m=counterMap.get(f)-1,v=o.get(f)-1;counterMap.set(f,m),o.set(f,v),m||(uncontrolledNodes.has(f)||f.removeAttribute(n),uncontrolledNodes.delete(f)),v||f.removeAttribute(t)}),lockCount--,lockCount||(counterMap=new WeakMap,counterMap=new WeakMap,uncontrolledNodes=new WeakMap,markerMap={})}},hideOthers=function(s,e,t){t===void 0&&(t="data-aria-hidden");var n=Array.from(Array.isArray(s)?s:[s]),i=getDefaultParent(s);return i?(n.push.apply(n,Array.from(i.querySelectorAll("[aria-live], script"))),applyAttributeToOthers(n,i,t,"aria-hidden")):function(){return null}},__assign=function(){return __assign=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},__assign.apply(this,arguments)};function __rest$5(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(s);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(s,n[i])&&(t[n[i]]=s[n[i]]);return t}function __awaiter$b(s,e,t,n){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function l(u){try{d(n.next(u))}catch(f){a(f)}}function h(u){try{d(n.throw(u))}catch(f){a(f)}}function d(u){u.done?o(u.value):i(u.value).then(l,h)}d((n=n.apply(s,e||[])).next())})}function __spreadArray$1(s,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return s.concat(o||Array.prototype.slice.call(e))}typeof SuppressedError=="function"&&SuppressedError;var zeroRightClassName="right-scroll-bar-position",fullWidthClassName="width-before-scroll-bar",noScrollbarsClassName="with-scroll-bars-hidden",removedBarSizeVariable="--removed-body-scroll-bar-size";function assignRef(s,e){return typeof s=="function"?s(e):s&&(s.current=e),s}function useCallbackRef(s,e){var t=reactExports.useState(function(){return{value:s,callback:e,facade:{get current(){return t.value},set current(n){var i=t.value;i!==n&&(t.value=n,t.callback(n,i))}}}})[0];return t.callback=e,t.facade}var useIsomorphicLayoutEffect$2=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect,currentValues=new WeakMap;function useMergeRefs(s,e){var t=useCallbackRef(null,function(n){return s.forEach(function(i){return assignRef(i,n)})});return useIsomorphicLayoutEffect$2(function(){var n=currentValues.get(t);if(n){var i=new Set(n),o=new Set(s),a=t.current;i.forEach(function(l){o.has(l)||assignRef(l,null)}),o.forEach(function(l){i.has(l)||assignRef(l,a)})}currentValues.set(t,s)},[s]),t}function ItoI(s){return s}function innerCreateMedium(s,e){e===void 0&&(e=ItoI);var t=[],n=!1,i={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return t.length?t[t.length-1]:s},useMedium:function(o){var a=e(o,n);return t.push(a),function(){t=t.filter(function(l){return l!==a})}},assignSyncMedium:function(o){for(n=!0;t.length;){var a=t;t=[],a.forEach(o)}t={push:function(l){return o(l)},filter:function(){return t}}},assignMedium:function(o){n=!0;var a=[];if(t.length){var l=t;t=[],l.forEach(o),a=t}var h=function(){var u=a;a=[],u.forEach(o)},d=function(){return Promise.resolve().then(h)};d(),t={push:function(u){a.push(u),d()},filter:function(u){return a=a.filter(u),t}}}};return i}function createSidecarMedium(s){s===void 0&&(s={});var e=innerCreateMedium(null);return e.options=__assign({async:!0,ssr:!1},s),e}var SideCar$1=function(s){var e=s.sideCar,t=__rest$5(s,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=e.read();if(!n)throw new Error("Sidecar medium not found");return reactExports.createElement(n,__assign({},t))};SideCar$1.isSideCarExport=!0;function exportSidecar(s,e){return s.useMedium(e),SideCar$1}var effectCar=createSidecarMedium(),nothing=function(){},RemoveScroll=reactExports.forwardRef(function(s,e){var t=reactExports.useRef(null),n=reactExports.useState({onScrollCapture:nothing,onWheelCapture:nothing,onTouchMoveCapture:nothing}),i=n[0],o=n[1],a=s.forwardProps,l=s.children,h=s.className,d=s.removeScrollBar,u=s.enabled,f=s.shards,m=s.sideCar,v=s.noRelative,g=s.noIsolation,x=s.inert,E=s.allowPinchZoom,b=s.as,_=b===void 0?"div":b,S=s.gapMode,C=__rest$5(s,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),A=m,R=useMergeRefs([t,e]),L=__assign(__assign({},C),i);return reactExports.createElement(reactExports.Fragment,null,u&&reactExports.createElement(A,{sideCar:effectCar,removeScrollBar:d,shards:f,noRelative:v,noIsolation:g,inert:x,setCallbacks:o,allowPinchZoom:!!E,lockRef:t,gapMode:S}),a?reactExports.cloneElement(reactExports.Children.only(l),__assign(__assign({},L),{ref:R})):reactExports.createElement(_,__assign({},L,{className:h,ref:R}),l))});RemoveScroll.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};RemoveScroll.classNames={fullWidth:fullWidthClassName,zeroRight:zeroRightClassName};var getNonce=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function makeStyleTag(){if(!document)return null;var s=document.createElement("style");s.type="text/css";var e=getNonce();return e&&s.setAttribute("nonce",e),s}function injectStyles(s,e){s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}function insertStyleTag(s){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(s)}var stylesheetSingleton=function(){var s=0,e=null;return{add:function(t){s==0&&(e=makeStyleTag())&&(injectStyles(e,t),insertStyleTag(e)),s++},remove:function(){s--,!s&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},styleHookSingleton=function(){var s=stylesheetSingleton();return function(e,t){reactExports.useEffect(function(){return s.add(e),function(){s.remove()}},[e&&t])}},styleSingleton=function(){var s=styleHookSingleton(),e=function(t){var n=t.styles,i=t.dynamic;return s(n,i),null};return e},zeroGap={left:0,top:0,right:0,gap:0},parse=function(s){return parseInt(s||"",10)||0},getOffset=function(s){var e=window.getComputedStyle(document.body),t=e[s==="padding"?"paddingLeft":"marginLeft"],n=e[s==="padding"?"paddingTop":"marginTop"],i=e[s==="padding"?"paddingRight":"marginRight"];return[parse(t),parse(n),parse(i)]},getGapWidth=function(s){if(s===void 0&&(s="margin"),typeof window>"u")return zeroGap;var e=getOffset(s),t=document.documentElement.clientWidth,n=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,n-t+e[2]-e[0])}},Style=styleSingleton(),lockAttribute="data-scroll-locked",getStyles=function(s,e,t,n){var i=s.left,o=s.top,a=s.right,l=s.gap;return t===void 0&&(t="margin"),`
  .`.concat(noScrollbarsClassName,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(l,"px ").concat(n,`;
  }
  body[`).concat(lockAttribute,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(n,";"),t==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(n,`;
    `),t==="padding"&&"padding-right: ".concat(l,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(zeroRightClassName,` {
    right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(fullWidthClassName,` {
    margin-right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(zeroRightClassName," .").concat(zeroRightClassName,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(fullWidthClassName," .").concat(fullWidthClassName,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(lockAttribute,`] {
    `).concat(removedBarSizeVariable,": ").concat(l,`px;
  }
`)},getCurrentUseCounter=function(){var s=parseInt(document.body.getAttribute(lockAttribute)||"0",10);return isFinite(s)?s:0},useLockAttribute=function(){reactExports.useEffect(function(){return document.body.setAttribute(lockAttribute,(getCurrentUseCounter()+1).toString()),function(){var s=getCurrentUseCounter()-1;s<=0?document.body.removeAttribute(lockAttribute):document.body.setAttribute(lockAttribute,s.toString())}},[])},RemoveScrollBar=function(s){var e=s.noRelative,t=s.noImportant,n=s.gapMode,i=n===void 0?"margin":n;useLockAttribute();var o=reactExports.useMemo(function(){return getGapWidth(i)},[i]);return reactExports.createElement(Style,{styles:getStyles(o,!e,i,t?"":"!important")})},passiveSupported=!1;if(typeof window<"u")try{var options=Object.defineProperty({},"passive",{get:function(){return passiveSupported=!0,!0}});window.addEventListener("test",options,options),window.removeEventListener("test",options,options)}catch{passiveSupported=!1}var nonPassive=passiveSupported?{passive:!1}:!1,alwaysContainsScroll=function(s){return s.tagName==="TEXTAREA"},elementCanBeScrolled=function(s,e){if(!(s instanceof Element))return!1;var t=window.getComputedStyle(s);return t[e]!=="hidden"&&!(t.overflowY===t.overflowX&&!alwaysContainsScroll(s)&&t[e]==="visible")},elementCouldBeVScrolled=function(s){return elementCanBeScrolled(s,"overflowY")},elementCouldBeHScrolled=function(s){return elementCanBeScrolled(s,"overflowX")},locationCouldBeScrolled=function(s,e){var t=e.ownerDocument,n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var i=elementCouldBeScrolled(s,n);if(i){var o=getScrollVariables(s,n),a=o[1],l=o[2];if(a>l)return!0}n=n.parentNode}while(n&&n!==t.body);return!1},getVScrollVariables=function(s){var e=s.scrollTop,t=s.scrollHeight,n=s.clientHeight;return[e,t,n]},getHScrollVariables=function(s){var e=s.scrollLeft,t=s.scrollWidth,n=s.clientWidth;return[e,t,n]},elementCouldBeScrolled=function(s,e){return s==="v"?elementCouldBeVScrolled(e):elementCouldBeHScrolled(e)},getScrollVariables=function(s,e){return s==="v"?getVScrollVariables(e):getHScrollVariables(e)},getDirectionFactor=function(s,e){return s==="h"&&e==="rtl"?-1:1},handleScroll=function(s,e,t,n,i){var o=getDirectionFactor(s,window.getComputedStyle(e).direction),a=o*n,l=t.target,h=e.contains(l),d=!1,u=a>0,f=0,m=0;do{if(!l)break;var v=getScrollVariables(s,l),g=v[0],x=v[1],E=v[2],b=x-E-o*g;(g||b)&&elementCouldBeScrolled(s,l)&&(f+=b,m+=g);var _=l.parentNode;l=_&&_.nodeType===Node.DOCUMENT_FRAGMENT_NODE?_.host:_}while(!h&&l!==document.body||h&&(e.contains(l)||e===l));return(u&&Math.abs(f)<1||!u&&Math.abs(m)<1)&&(d=!0),d},getTouchXY=function(s){return"changedTouches"in s?[s.changedTouches[0].clientX,s.changedTouches[0].clientY]:[0,0]},getDeltaXY=function(s){return[s.deltaX,s.deltaY]},extractRef=function(s){return s&&"current"in s?s.current:s},deltaCompare=function(s,e){return s[0]===e[0]&&s[1]===e[1]},generateStyle=function(s){return`
  .block-interactivity-`.concat(s,` {pointer-events: none;}
  .allow-interactivity-`).concat(s,` {pointer-events: all;}
`)},idCounter=0,lockStack=[];function RemoveScrollSideCar(s){var e=reactExports.useRef([]),t=reactExports.useRef([0,0]),n=reactExports.useRef(),i=reactExports.useState(idCounter++)[0],o=reactExports.useState(styleSingleton)[0],a=reactExports.useRef(s);reactExports.useEffect(function(){a.current=s},[s]),reactExports.useEffect(function(){if(s.inert){document.body.classList.add("block-interactivity-".concat(i));var x=__spreadArray$1([s.lockRef.current],(s.shards||[]).map(extractRef),!0).filter(Boolean);return x.forEach(function(E){return E.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),x.forEach(function(E){return E.classList.remove("allow-interactivity-".concat(i))})}}},[s.inert,s.lockRef.current,s.shards]);var l=reactExports.useCallback(function(x,E){if("touches"in x&&x.touches.length===2||x.type==="wheel"&&x.ctrlKey)return!a.current.allowPinchZoom;var b=getTouchXY(x),_=t.current,S="deltaX"in x?x.deltaX:_[0]-b[0],C="deltaY"in x?x.deltaY:_[1]-b[1],A,R=x.target,L=Math.abs(S)>Math.abs(C)?"h":"v";if("touches"in x&&L==="h"&&R.type==="range")return!1;var j=locationCouldBeScrolled(L,R);if(!j)return!0;if(j?A=L:(A=L==="v"?"h":"v",j=locationCouldBeScrolled(L,R)),!j)return!1;if(!n.current&&"changedTouches"in x&&(S||C)&&(n.current=A),!A)return!0;var F=n.current||A;return handleScroll(F,E,x,F==="h"?S:C)},[]),h=reactExports.useCallback(function(x){var E=x;if(!(!lockStack.length||lockStack[lockStack.length-1]!==o)){var b="deltaY"in E?getDeltaXY(E):getTouchXY(E),_=e.current.filter(function(A){return A.name===E.type&&(A.target===E.target||E.target===A.shadowParent)&&deltaCompare(A.delta,b)})[0];if(_&&_.should){E.cancelable&&E.preventDefault();return}if(!_){var S=(a.current.shards||[]).map(extractRef).filter(Boolean).filter(function(A){return A.contains(E.target)}),C=S.length>0?l(E,S[0]):!a.current.noIsolation;C&&E.cancelable&&E.preventDefault()}}},[]),d=reactExports.useCallback(function(x,E,b,_){var S={name:x,delta:E,target:b,should:_,shadowParent:getOutermostShadowParent(b)};e.current.push(S),setTimeout(function(){e.current=e.current.filter(function(C){return C!==S})},1)},[]),u=reactExports.useCallback(function(x){t.current=getTouchXY(x),n.current=void 0},[]),f=reactExports.useCallback(function(x){d(x.type,getDeltaXY(x),x.target,l(x,s.lockRef.current))},[]),m=reactExports.useCallback(function(x){d(x.type,getTouchXY(x),x.target,l(x,s.lockRef.current))},[]);reactExports.useEffect(function(){return lockStack.push(o),s.setCallbacks({onScrollCapture:f,onWheelCapture:f,onTouchMoveCapture:m}),document.addEventListener("wheel",h,nonPassive),document.addEventListener("touchmove",h,nonPassive),document.addEventListener("touchstart",u,nonPassive),function(){lockStack=lockStack.filter(function(x){return x!==o}),document.removeEventListener("wheel",h,nonPassive),document.removeEventListener("touchmove",h,nonPassive),document.removeEventListener("touchstart",u,nonPassive)}},[]);var v=s.removeScrollBar,g=s.inert;return reactExports.createElement(reactExports.Fragment,null,g?reactExports.createElement(o,{styles:generateStyle(i)}):null,v?reactExports.createElement(RemoveScrollBar,{noRelative:s.noRelative,gapMode:s.gapMode}):null)}function getOutermostShadowParent(s){for(var e=null;s!==null;)s instanceof ShadowRoot&&(e=s.host,s=s.host),s=s.parentNode;return e}const SideCar=exportSidecar(effectCar,RemoveScrollSideCar);var ReactRemoveScroll=reactExports.forwardRef(function(s,e){return reactExports.createElement(RemoveScroll,__assign({},s,{ref:e,sideCar:SideCar}))});ReactRemoveScroll.classNames=RemoveScroll.classNames;var OPEN_KEYS=[" ","Enter","ArrowUp","ArrowDown"],SELECTION_KEYS$1=[" ","Enter"],SELECT_NAME="Select",[Collection$2,useCollection$2,createCollectionScope$2]=createCollection(SELECT_NAME),[createSelectContext]=createContextScope(SELECT_NAME,[createCollectionScope$2,createPopperScope]),usePopperScope$1=createPopperScope(),[SelectProvider,useSelectContext]=createSelectContext(SELECT_NAME),[SelectNativeOptionsProvider,useSelectNativeOptionsContext]=createSelectContext(SELECT_NAME),Select$1=s=>{const{__scopeSelect:e,children:t,open:n,defaultOpen:i,onOpenChange:o,value:a,defaultValue:l,onValueChange:h,dir:d,name:u,autoComplete:f,disabled:m,required:v,form:g}=s,x=usePopperScope$1(e),[E,b]=reactExports.useState(null),[_,S]=reactExports.useState(null),[C,A]=reactExports.useState(!1),R=useDirection(d),[L,j]=useControllableState({prop:n,defaultProp:i??!1,onChange:o,caller:SELECT_NAME}),[F,W]=useControllableState({prop:a,defaultProp:l,onChange:h,caller:SELECT_NAME}),K=reactExports.useRef(null),ee=E?g||!!E.closest("form"):!0,[te,re]=reactExports.useState(new Set),ie=Array.from(te).map(Q=>Q.props.value).join(";");return jsxRuntimeExports.jsx(Root2$4,{...x,children:jsxRuntimeExports.jsxs(SelectProvider,{required:v,scope:e,trigger:E,onTriggerChange:b,valueNode:_,onValueNodeChange:S,valueNodeHasChildren:C,onValueNodeHasChildrenChange:A,contentId:useId$1(),value:F,onValueChange:W,open:L,onOpenChange:j,dir:R,triggerPointerDownPosRef:K,disabled:m,children:[jsxRuntimeExports.jsx(Collection$2.Provider,{scope:e,children:jsxRuntimeExports.jsx(SelectNativeOptionsProvider,{scope:s.__scopeSelect,onNativeOptionAdd:reactExports.useCallback(Q=>{re(z=>new Set(z).add(Q))},[]),onNativeOptionRemove:reactExports.useCallback(Q=>{re(z=>{const N=new Set(z);return N.delete(Q),N})},[]),children:t})}),ee?jsxRuntimeExports.jsxs(SelectBubbleInput,{"aria-hidden":!0,required:v,tabIndex:-1,name:u,autoComplete:f,value:F,onChange:Q=>W(Q.target.value),disabled:m,form:g,children:[F===void 0?jsxRuntimeExports.jsx("option",{value:""}):null,Array.from(te)]},ie):null]})})};Select$1.displayName=SELECT_NAME;var TRIGGER_NAME$4="SelectTrigger",SelectTrigger$1=reactExports.forwardRef((s,e)=>{const{__scopeSelect:t,disabled:n=!1,...i}=s,o=usePopperScope$1(t),a=useSelectContext(TRIGGER_NAME$4,t),l=a.disabled||n,h=useComposedRefs(e,a.onTriggerChange),d=useCollection$2(t),u=reactExports.useRef("touch"),[f,m,v]=useTypeaheadSearch(x=>{const E=d().filter(S=>!S.disabled),b=E.find(S=>S.value===a.value),_=findNextItem(E,x,b);_!==void 0&&a.onValueChange(_.value)}),g=x=>{l||(a.onOpenChange(!0),v()),x&&(a.triggerPointerDownPosRef.current={x:Math.round(x.pageX),y:Math.round(x.pageY)})};return jsxRuntimeExports.jsx(Anchor,{asChild:!0,...o,children:jsxRuntimeExports.jsx(Primitive.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":shouldShowPlaceholder(a.value)?"":void 0,...i,ref:h,onClick:composeEventHandlers$1(i.onClick,x=>{x.currentTarget.focus(),u.current!=="mouse"&&g(x)}),onPointerDown:composeEventHandlers$1(i.onPointerDown,x=>{u.current=x.pointerType;const E=x.target;E.hasPointerCapture(x.pointerId)&&E.releasePointerCapture(x.pointerId),x.button===0&&x.ctrlKey===!1&&x.pointerType==="mouse"&&(g(x),x.preventDefault())}),onKeyDown:composeEventHandlers$1(i.onKeyDown,x=>{const E=f.current!=="";!(x.ctrlKey||x.altKey||x.metaKey)&&x.key.length===1&&m(x.key),!(E&&x.key===" ")&&OPEN_KEYS.includes(x.key)&&(g(),x.preventDefault())})})})});SelectTrigger$1.displayName=TRIGGER_NAME$4;var VALUE_NAME="SelectValue",SelectValue$1=reactExports.forwardRef((s,e)=>{const{__scopeSelect:t,className:n,style:i,children:o,placeholder:a="",...l}=s,h=useSelectContext(VALUE_NAME,t),{onValueNodeHasChildrenChange:d}=h,u=o!==void 0,f=useComposedRefs(e,h.onValueNodeChange);return useLayoutEffect2(()=>{d(u)},[d,u]),jsxRuntimeExports.jsx(Primitive.span,{...l,ref:f,style:{pointerEvents:"none"},children:shouldShowPlaceholder(h.value)?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:a}):o})});SelectValue$1.displayName=VALUE_NAME;var ICON_NAME="SelectIcon",SelectIcon=reactExports.forwardRef((s,e)=>{const{__scopeSelect:t,children:n,...i}=s;return jsxRuntimeExports.jsx(Primitive.span,{"aria-hidden":!0,...i,ref:e,children:n||""})});SelectIcon.displayName=ICON_NAME;var PORTAL_NAME$4="SelectPortal",SelectPortal=s=>jsxRuntimeExports.jsx(Portal$3,{asChild:!0,...s});SelectPortal.displayName=PORTAL_NAME$4;var CONTENT_NAME$5="SelectContent",SelectContent$1=reactExports.forwardRef((s,e)=>{const t=useSelectContext(CONTENT_NAME$5,s.__scopeSelect),[n,i]=reactExports.useState();if(useLayoutEffect2(()=>{i(new DocumentFragment)},[]),!t.open){const o=n;return o?reactDomExports.createPortal(jsxRuntimeExports.jsx(SelectContentProvider,{scope:s.__scopeSelect,children:jsxRuntimeExports.jsx(Collection$2.Slot,{scope:s.__scopeSelect,children:jsxRuntimeExports.jsx("div",{children:s.children})})}),o):null}return jsxRuntimeExports.jsx(SelectContentImpl,{...s,ref:e})});SelectContent$1.displayName=CONTENT_NAME$5;var CONTENT_MARGIN=10,[SelectContentProvider,useSelectContentContext]=createSelectContext(CONTENT_NAME$5),CONTENT_IMPL_NAME="SelectContentImpl",Slot$2=createSlot("SelectContent.RemoveScroll"),SelectContentImpl=reactExports.forwardRef((s,e)=>{const{__scopeSelect:t,position:n="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:o,onPointerDownOutside:a,side:l,sideOffset:h,align:d,alignOffset:u,arrowPadding:f,collisionBoundary:m,collisionPadding:v,sticky:g,hideWhenDetached:x,avoidCollisions:E,...b}=s,_=useSelectContext(CONTENT_NAME$5,t),[S,C]=reactExports.useState(null),[A,R]=reactExports.useState(null),L=useComposedRefs(e,O=>C(O)),[j,F]=reactExports.useState(null),[W,K]=reactExports.useState(null),ee=useCollection$2(t),[te,re]=reactExports.useState(!1),ie=reactExports.useRef(!1);reactExports.useEffect(()=>{if(S)return hideOthers(S)},[S]),useFocusGuards();const Q=reactExports.useCallback(O=>{const[B,...G]=ee().map(Z=>Z.ref.current),[Y]=G.slice(-1),J=document.activeElement;for(const Z of O)if(Z===J||(Z?.scrollIntoView({block:"nearest"}),Z===B&&A&&(A.scrollTop=0),Z===Y&&A&&(A.scrollTop=A.scrollHeight),Z?.focus(),document.activeElement!==J))return},[ee,A]),z=reactExports.useCallback(()=>Q([j,S]),[Q,j,S]);reactExports.useEffect(()=>{te&&z()},[te,z]);const{onOpenChange:N,triggerPointerDownPosRef:k}=_;reactExports.useEffect(()=>{if(S){let O={x:0,y:0};const B=Y=>{O={x:Math.abs(Math.round(Y.pageX)-(k.current?.x??0)),y:Math.abs(Math.round(Y.pageY)-(k.current?.y??0))}},G=Y=>{O.x<=10&&O.y<=10?Y.preventDefault():S.contains(Y.target)||N(!1),document.removeEventListener("pointermove",B),k.current=null};return k.current!==null&&(document.addEventListener("pointermove",B),document.addEventListener("pointerup",G,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",B),document.removeEventListener("pointerup",G,{capture:!0})}}},[S,N,k]),reactExports.useEffect(()=>{const O=()=>N(!1);return window.addEventListener("blur",O),window.addEventListener("resize",O),()=>{window.removeEventListener("blur",O),window.removeEventListener("resize",O)}},[N]);const[I,D]=useTypeaheadSearch(O=>{const B=ee().filter(J=>!J.disabled),G=B.find(J=>J.ref.current===document.activeElement),Y=findNextItem(B,O,G);Y&&setTimeout(()=>Y.ref.current.focus())}),U=reactExports.useCallback((O,B,G)=>{const Y=!ie.current&&!G;(_.value!==void 0&&_.value===B||Y)&&(F(O),Y&&(ie.current=!0))},[_.value]),$=reactExports.useCallback(()=>S?.focus(),[S]),q=reactExports.useCallback((O,B,G)=>{const Y=!ie.current&&!G;(_.value!==void 0&&_.value===B||Y)&&K(O)},[_.value]),V=n==="popper"?SelectPopperPosition:SelectItemAlignedPosition,P=V===SelectPopperPosition?{side:l,sideOffset:h,align:d,alignOffset:u,arrowPadding:f,collisionBoundary:m,collisionPadding:v,sticky:g,hideWhenDetached:x,avoidCollisions:E}:{};return jsxRuntimeExports.jsx(SelectContentProvider,{scope:t,content:S,viewport:A,onViewportChange:R,itemRefCallback:U,selectedItem:j,onItemLeave:$,itemTextRefCallback:q,focusSelectedItem:z,selectedItemText:W,position:n,isPositioned:te,searchRef:I,children:jsxRuntimeExports.jsx(ReactRemoveScroll,{as:Slot$2,allowPinchZoom:!0,children:jsxRuntimeExports.jsx(FocusScope,{asChild:!0,trapped:_.open,onMountAutoFocus:O=>{O.preventDefault()},onUnmountAutoFocus:composeEventHandlers$1(i,O=>{_.trigger?.focus({preventScroll:!0}),O.preventDefault()}),children:jsxRuntimeExports.jsx(DismissableLayer,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:o,onPointerDownOutside:a,onFocusOutside:O=>O.preventDefault(),onDismiss:()=>_.onOpenChange(!1),children:jsxRuntimeExports.jsx(V,{role:"listbox",id:_.contentId,"data-state":_.open?"open":"closed",dir:_.dir,onContextMenu:O=>O.preventDefault(),...b,...P,onPlaced:()=>re(!0),ref:L,style:{display:"flex",flexDirection:"column",outline:"none",...b.style},onKeyDown:composeEventHandlers$1(b.onKeyDown,O=>{const B=O.ctrlKey||O.altKey||O.metaKey;if(O.key==="Tab"&&O.preventDefault(),!B&&O.key.length===1&&D(O.key),["ArrowUp","ArrowDown","Home","End"].includes(O.key)){let Y=ee().filter(J=>!J.disabled).map(J=>J.ref.current);if(["ArrowUp","End"].includes(O.key)&&(Y=Y.slice().reverse()),["ArrowUp","ArrowDown"].includes(O.key)){const J=O.target,Z=Y.indexOf(J);Y=Y.slice(Z+1)}setTimeout(()=>Q(Y)),O.preventDefault()}})})})})})})});SelectContentImpl.displayName=CONTENT_IMPL_NAME;var ITEM_ALIGNED_POSITION_NAME="SelectItemAlignedPosition",SelectItemAlignedPosition=reactExports.forwardRef((s,e)=>{const{__scopeSelect:t,onPlaced:n,...i}=s,o=useSelectContext(CONTENT_NAME$5,t),a=useSelectContentContext(CONTENT_NAME$5,t),[l,h]=reactExports.useState(null),[d,u]=reactExports.useState(null),f=useComposedRefs(e,L=>u(L)),m=useCollection$2(t),v=reactExports.useRef(!1),g=reactExports.useRef(!0),{viewport:x,selectedItem:E,selectedItemText:b,focusSelectedItem:_}=a,S=reactExports.useCallback(()=>{if(o.trigger&&o.valueNode&&l&&d&&x&&E&&b){const L=o.trigger.getBoundingClientRect(),j=d.getBoundingClientRect(),F=o.valueNode.getBoundingClientRect(),W=b.getBoundingClientRect();if(o.dir!=="rtl"){const J=W.left-j.left,Z=F.left-J,oe=L.left-Z,ve=L.width+oe,ce=Math.max(ve,j.width),ue=window.innerWidth-CONTENT_MARGIN,de=clamp$2(Z,[CONTENT_MARGIN,Math.max(CONTENT_MARGIN,ue-ce)]);l.style.minWidth=ve+"px",l.style.left=de+"px"}else{const J=j.right-W.right,Z=window.innerWidth-F.right-J,oe=window.innerWidth-L.right-Z,ve=L.width+oe,ce=Math.max(ve,j.width),ue=window.innerWidth-CONTENT_MARGIN,de=clamp$2(Z,[CONTENT_MARGIN,Math.max(CONTENT_MARGIN,ue-ce)]);l.style.minWidth=ve+"px",l.style.right=de+"px"}const K=m(),ee=window.innerHeight-CONTENT_MARGIN*2,te=x.scrollHeight,re=window.getComputedStyle(d),ie=parseInt(re.borderTopWidth,10),Q=parseInt(re.paddingTop,10),z=parseInt(re.borderBottomWidth,10),N=parseInt(re.paddingBottom,10),k=ie+Q+te+N+z,I=Math.min(E.offsetHeight*5,k),D=window.getComputedStyle(x),U=parseInt(D.paddingTop,10),$=parseInt(D.paddingBottom,10),q=L.top+L.height/2-CONTENT_MARGIN,V=ee-q,P=E.offsetHeight/2,O=E.offsetTop+P,B=ie+Q+O,G=k-B;if(B<=q){const J=K.length>0&&E===K[K.length-1].ref.current;l.style.bottom="0px";const Z=d.clientHeight-x.offsetTop-x.offsetHeight,oe=Math.max(V,P+(J?$:0)+Z+z),ve=B+oe;l.style.height=ve+"px"}else{const J=K.length>0&&E===K[0].ref.current;l.style.top="0px";const oe=Math.max(q,ie+x.offsetTop+(J?U:0)+P)+G;l.style.height=oe+"px",x.scrollTop=B-q+x.offsetTop}l.style.margin=`${CONTENT_MARGIN}px 0`,l.style.minHeight=I+"px",l.style.maxHeight=ee+"px",n?.(),requestAnimationFrame(()=>v.current=!0)}},[m,o.trigger,o.valueNode,l,d,x,E,b,o.dir,n]);useLayoutEffect2(()=>S(),[S]);const[C,A]=reactExports.useState();useLayoutEffect2(()=>{d&&A(window.getComputedStyle(d).zIndex)},[d]);const R=reactExports.useCallback(L=>{L&&g.current===!0&&(S(),_?.(),g.current=!1)},[S,_]);return jsxRuntimeExports.jsx(SelectViewportProvider,{scope:t,contentWrapper:l,shouldExpandOnScrollRef:v,onScrollButtonChange:R,children:jsxRuntimeExports.jsx("div",{ref:h,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:C},children:jsxRuntimeExports.jsx(Primitive.div,{...i,ref:f,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});SelectItemAlignedPosition.displayName=ITEM_ALIGNED_POSITION_NAME;var POPPER_POSITION_NAME="SelectPopperPosition",SelectPopperPosition=reactExports.forwardRef((s,e)=>{const{__scopeSelect:t,align:n="start",collisionPadding:i=CONTENT_MARGIN,...o}=s,a=usePopperScope$1(t);return jsxRuntimeExports.jsx(Content$2,{...a,...o,ref:e,align:n,collisionPadding:i,style:{boxSizing:"border-box",...o.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});SelectPopperPosition.displayName=POPPER_POSITION_NAME;var[SelectViewportProvider,useSelectViewportContext]=createSelectContext(CONTENT_NAME$5,{}),VIEWPORT_NAME$1="SelectViewport",SelectViewport=reactExports.forwardRef((s,e)=>{const{__scopeSelect:t,nonce:n,...i}=s,o=useSelectContentContext(VIEWPORT_NAME$1,t),a=useSelectViewportContext(VIEWPORT_NAME$1,t),l=useComposedRefs(e,o.onViewportChange),h=reactExports.useRef(0);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),jsxRuntimeExports.jsx(Collection$2.Slot,{scope:t,children:jsxRuntimeExports.jsx(Primitive.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:composeEventHandlers$1(i.onScroll,d=>{const u=d.currentTarget,{contentWrapper:f,shouldExpandOnScrollRef:m}=a;if(m?.current&&f){const v=Math.abs(h.current-u.scrollTop);if(v>0){const g=window.innerHeight-CONTENT_MARGIN*2,x=parseFloat(f.style.minHeight),E=parseFloat(f.style.height),b=Math.max(x,E);if(b<g){const _=b+v,S=Math.min(g,_),C=_-S;f.style.height=S+"px",f.style.bottom==="0px"&&(u.scrollTop=C>0?C:0,f.style.justifyContent="flex-end")}}}h.current=u.scrollTop})})})]})});SelectViewport.displayName=VIEWPORT_NAME$1;var GROUP_NAME$3="SelectGroup",[SelectGroupContextProvider,useSelectGroupContext]=createSelectContext(GROUP_NAME$3),SelectGroup=reactExports.forwardRef((s,e)=>{const{__scopeSelect:t,...n}=s,i=useId$1();return jsxRuntimeExports.jsx(SelectGroupContextProvider,{scope:t,id:i,children:jsxRuntimeExports.jsx(Primitive.div,{role:"group","aria-labelledby":i,...n,ref:e})})});SelectGroup.displayName=GROUP_NAME$3;var LABEL_NAME$2="SelectLabel",SelectLabel=reactExports.forwardRef((s,e)=>{const{__scopeSelect:t,...n}=s,i=useSelectGroupContext(LABEL_NAME$2,t);return jsxRuntimeExports.jsx(Primitive.div,{id:i.id,...n,ref:e})});SelectLabel.displayName=LABEL_NAME$2;var ITEM_NAME$3="SelectItem",[SelectItemContextProvider,useSelectItemContext]=createSelectContext(ITEM_NAME$3),SelectItem$1=reactExports.forwardRef((s,e)=>{const{__scopeSelect:t,value:n,disabled:i=!1,textValue:o,...a}=s,l=useSelectContext(ITEM_NAME$3,t),h=useSelectContentContext(ITEM_NAME$3,t),d=l.value===n,[u,f]=reactExports.useState(o??""),[m,v]=reactExports.useState(!1),g=useComposedRefs(e,_=>h.itemRefCallback?.(_,n,i)),x=useId$1(),E=reactExports.useRef("touch"),b=()=>{i||(l.onValueChange(n),l.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return jsxRuntimeExports.jsx(SelectItemContextProvider,{scope:t,value:n,disabled:i,textId:x,isSelected:d,onItemTextChange:reactExports.useCallback(_=>{f(S=>S||(_?.textContent??"").trim())},[]),children:jsxRuntimeExports.jsx(Collection$2.ItemSlot,{scope:t,value:n,disabled:i,textValue:u,children:jsxRuntimeExports.jsx(Primitive.div,{role:"option","aria-labelledby":x,"data-highlighted":m?"":void 0,"aria-selected":d&&m,"data-state":d?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...a,ref:g,onFocus:composeEventHandlers$1(a.onFocus,()=>v(!0)),onBlur:composeEventHandlers$1(a.onBlur,()=>v(!1)),onClick:composeEventHandlers$1(a.onClick,()=>{E.current!=="mouse"&&b()}),onPointerUp:composeEventHandlers$1(a.onPointerUp,()=>{E.current==="mouse"&&b()}),onPointerDown:composeEventHandlers$1(a.onPointerDown,_=>{E.current=_.pointerType}),onPointerMove:composeEventHandlers$1(a.onPointerMove,_=>{E.current=_.pointerType,i?h.onItemLeave?.():E.current==="mouse"&&_.currentTarget.focus({preventScroll:!0})}),onPointerLeave:composeEventHandlers$1(a.onPointerLeave,_=>{_.currentTarget===document.activeElement&&h.onItemLeave?.()}),onKeyDown:composeEventHandlers$1(a.onKeyDown,_=>{h.searchRef?.current!==""&&_.key===" "||(SELECTION_KEYS$1.includes(_.key)&&b(),_.key===" "&&_.preventDefault())})})})})});SelectItem$1.displayName=ITEM_NAME$3;var ITEM_TEXT_NAME="SelectItemText",SelectItemText=reactExports.forwardRef((s,e)=>{const{__scopeSelect:t,className:n,style:i,...o}=s,a=useSelectContext(ITEM_TEXT_NAME,t),l=useSelectContentContext(ITEM_TEXT_NAME,t),h=useSelectItemContext(ITEM_TEXT_NAME,t),d=useSelectNativeOptionsContext(ITEM_TEXT_NAME,t),[u,f]=reactExports.useState(null),m=useComposedRefs(e,b=>f(b),h.onItemTextChange,b=>l.itemTextRefCallback?.(b,h.value,h.disabled)),v=u?.textContent,g=reactExports.useMemo(()=>jsxRuntimeExports.jsx("option",{value:h.value,disabled:h.disabled,children:v},h.value),[h.disabled,h.value,v]),{onNativeOptionAdd:x,onNativeOptionRemove:E}=d;return useLayoutEffect2(()=>(x(g),()=>E(g)),[x,E,g]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(Primitive.span,{id:h.textId,...o,ref:m}),h.isSelected&&a.valueNode&&!a.valueNodeHasChildren?reactDomExports.createPortal(o.children,a.valueNode):null]})});SelectItemText.displayName=ITEM_TEXT_NAME;var ITEM_INDICATOR_NAME$1="SelectItemIndicator",SelectItemIndicator=reactExports.forwardRef((s,e)=>{const{__scopeSelect:t,...n}=s;return useSelectItemContext(ITEM_INDICATOR_NAME$1,t).isSelected?jsxRuntimeExports.jsx(Primitive.span,{"aria-hidden":!0,...n,ref:e}):null});SelectItemIndicator.displayName=ITEM_INDICATOR_NAME$1;var SCROLL_UP_BUTTON_NAME="SelectScrollUpButton",SelectScrollUpButton$1=reactExports.forwardRef((s,e)=>{const t=useSelectContentContext(SCROLL_UP_BUTTON_NAME,s.__scopeSelect),n=useSelectViewportContext(SCROLL_UP_BUTTON_NAME,s.__scopeSelect),[i,o]=reactExports.useState(!1),a=useComposedRefs(e,n.onScrollButtonChange);return useLayoutEffect2(()=>{if(t.viewport&&t.isPositioned){let l=function(){const d=h.scrollTop>0;o(d)};const h=t.viewport;return l(),h.addEventListener("scroll",l),()=>h.removeEventListener("scroll",l)}},[t.viewport,t.isPositioned]),i?jsxRuntimeExports.jsx(SelectScrollButtonImpl,{...s,ref:a,onAutoScroll:()=>{const{viewport:l,selectedItem:h}=t;l&&h&&(l.scrollTop=l.scrollTop-h.offsetHeight)}}):null});SelectScrollUpButton$1.displayName=SCROLL_UP_BUTTON_NAME;var SCROLL_DOWN_BUTTON_NAME="SelectScrollDownButton",SelectScrollDownButton$1=reactExports.forwardRef((s,e)=>{const t=useSelectContentContext(SCROLL_DOWN_BUTTON_NAME,s.__scopeSelect),n=useSelectViewportContext(SCROLL_DOWN_BUTTON_NAME,s.__scopeSelect),[i,o]=reactExports.useState(!1),a=useComposedRefs(e,n.onScrollButtonChange);return useLayoutEffect2(()=>{if(t.viewport&&t.isPositioned){let l=function(){const d=h.scrollHeight-h.clientHeight,u=Math.ceil(h.scrollTop)<d;o(u)};const h=t.viewport;return l(),h.addEventListener("scroll",l),()=>h.removeEventListener("scroll",l)}},[t.viewport,t.isPositioned]),i?jsxRuntimeExports.jsx(SelectScrollButtonImpl,{...s,ref:a,onAutoScroll:()=>{const{viewport:l,selectedItem:h}=t;l&&h&&(l.scrollTop=l.scrollTop+h.offsetHeight)}}):null});SelectScrollDownButton$1.displayName=SCROLL_DOWN_BUTTON_NAME;var SelectScrollButtonImpl=reactExports.forwardRef((s,e)=>{const{__scopeSelect:t,onAutoScroll:n,...i}=s,o=useSelectContentContext("SelectScrollButton",t),a=reactExports.useRef(null),l=useCollection$2(t),h=reactExports.useCallback(()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null)},[]);return reactExports.useEffect(()=>()=>h(),[h]),useLayoutEffect2(()=>{l().find(u=>u.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[l]),jsxRuntimeExports.jsx(Primitive.div,{"aria-hidden":!0,...i,ref:e,style:{flexShrink:0,...i.style},onPointerDown:composeEventHandlers$1(i.onPointerDown,()=>{a.current===null&&(a.current=window.setInterval(n,50))}),onPointerMove:composeEventHandlers$1(i.onPointerMove,()=>{o.onItemLeave?.(),a.current===null&&(a.current=window.setInterval(n,50))}),onPointerLeave:composeEventHandlers$1(i.onPointerLeave,()=>{h()})})}),SEPARATOR_NAME$2="SelectSeparator",SelectSeparator$1=reactExports.forwardRef((s,e)=>{const{__scopeSelect:t,...n}=s;return jsxRuntimeExports.jsx(Primitive.div,{"aria-hidden":!0,...n,ref:e})});SelectSeparator$1.displayName=SEPARATOR_NAME$2;var ARROW_NAME$2="SelectArrow",SelectArrow=reactExports.forwardRef((s,e)=>{const{__scopeSelect:t,...n}=s,i=usePopperScope$1(t),o=useSelectContext(ARROW_NAME$2,t),a=useSelectContentContext(ARROW_NAME$2,t);return o.open&&a.position==="popper"?jsxRuntimeExports.jsx(Arrow,{...i,...n,ref:e}):null});SelectArrow.displayName=ARROW_NAME$2;var BUBBLE_INPUT_NAME="SelectBubbleInput",SelectBubbleInput=reactExports.forwardRef(({__scopeSelect:s,value:e,...t},n)=>{const i=reactExports.useRef(null),o=useComposedRefs(n,i),a=usePrevious(e);return reactExports.useEffect(()=>{const l=i.current;if(!l)return;const h=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(h,"value").set;if(a!==e&&u){const f=new Event("change",{bubbles:!0});u.call(l,e),l.dispatchEvent(f)}},[a,e]),jsxRuntimeExports.jsx(Primitive.select,{...t,style:{...VISUALLY_HIDDEN_STYLES,...t.style},ref:o,defaultValue:e})});SelectBubbleInput.displayName=BUBBLE_INPUT_NAME;function shouldShowPlaceholder(s){return s===""||s===void 0}function useTypeaheadSearch(s){const e=useCallbackRef$1(s),t=reactExports.useRef(""),n=reactExports.useRef(0),i=reactExports.useCallback(a=>{const l=t.current+a;e(l),(function h(d){t.current=d,window.clearTimeout(n.current),d!==""&&(n.current=window.setTimeout(()=>h(""),1e3))})(l)},[e]),o=reactExports.useCallback(()=>{t.current="",window.clearTimeout(n.current)},[]);return reactExports.useEffect(()=>()=>window.clearTimeout(n.current),[]),[t,i,o]}function findNextItem(s,e,t){const i=e.length>1&&Array.from(e).every(d=>d===e[0])?e[0]:e,o=t?s.indexOf(t):-1;let a=wrapArray$2(s,Math.max(o,0));i.length===1&&(a=a.filter(d=>d!==t));const h=a.find(d=>d.textValue.toLowerCase().startsWith(i.toLowerCase()));return h!==t?h:void 0}function wrapArray$2(s,e){return s.map((t,n)=>s[(e+n)%s.length])}var Root2$3=Select$1,Trigger$3=SelectTrigger$1,Value=SelectValue$1,Icon=SelectIcon,Portal$2=SelectPortal,Content2$3=SelectContent$1,Viewport$1=SelectViewport,Item$1=SelectItem$1,ItemText=SelectItemText,ItemIndicator$1=SelectItemIndicator,ScrollUpButton=SelectScrollUpButton$1,ScrollDownButton=SelectScrollDownButton$1,Separator$1=SelectSeparator$1;function r(s){var e,t,n="";if(typeof s=="string"||typeof s=="number")n+=s;else if(typeof s=="object")if(Array.isArray(s)){var i=s.length;for(e=0;e<i;e++)s[e]&&(t=r(s[e]))&&(n&&(n+=" "),n+=t)}else for(t in s)s[t]&&(n&&(n+=" "),n+=t);return n}function clsx(){for(var s,e,t=0,n="",i=arguments.length;t<i;t++)(s=arguments[t])&&(e=r(s))&&(n&&(n+=" "),n+=e);return n}const CLASS_PART_SEPARATOR="-",createClassGroupUtils=s=>{const e=createClassMap(s),{conflictingClassGroups:t,conflictingClassGroupModifiers:n}=s;return{getClassGroupId:a=>{const l=a.split(CLASS_PART_SEPARATOR);return l[0]===""&&l.length!==1&&l.shift(),getGroupRecursive(l,e)||getGroupIdForArbitraryProperty(a)},getConflictingClassGroupIds:(a,l)=>{const h=t[a]||[];return l&&n[a]?[...h,...n[a]]:h}}},getGroupRecursive=(s,e)=>{if(s.length===0)return e.classGroupId;const t=s[0],n=e.nextPart.get(t),i=n?getGroupRecursive(s.slice(1),n):void 0;if(i)return i;if(e.validators.length===0)return;const o=s.join(CLASS_PART_SEPARATOR);return e.validators.find(({validator:a})=>a(o))?.classGroupId},arbitraryPropertyRegex=/^\[(.+)\]$/,getGroupIdForArbitraryProperty=s=>{if(arbitraryPropertyRegex.test(s)){const e=arbitraryPropertyRegex.exec(s)[1],t=e?.substring(0,e.indexOf(":"));if(t)return"arbitrary.."+t}},createClassMap=s=>{const{theme:e,prefix:t}=s,n={nextPart:new Map,validators:[]};return getPrefixedClassGroupEntries(Object.entries(s.classGroups),t).forEach(([o,a])=>{processClassesRecursively(a,n,o,e)}),n},processClassesRecursively=(s,e,t,n)=>{s.forEach(i=>{if(typeof i=="string"){const o=i===""?e:getPart(e,i);o.classGroupId=t;return}if(typeof i=="function"){if(isThemeGetter(i)){processClassesRecursively(i(n),e,t,n);return}e.validators.push({validator:i,classGroupId:t});return}Object.entries(i).forEach(([o,a])=>{processClassesRecursively(a,getPart(e,o),t,n)})})},getPart=(s,e)=>{let t=s;return e.split(CLASS_PART_SEPARATOR).forEach(n=>{t.nextPart.has(n)||t.nextPart.set(n,{nextPart:new Map,validators:[]}),t=t.nextPart.get(n)}),t},isThemeGetter=s=>s.isThemeGetter,getPrefixedClassGroupEntries=(s,e)=>e?s.map(([t,n])=>{const i=n.map(o=>typeof o=="string"?e+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(([a,l])=>[e+a,l])):o);return[t,i]}):s,createLruCache=s=>{if(s<1)return{get:()=>{},set:()=>{}};let e=0,t=new Map,n=new Map;const i=(o,a)=>{t.set(o,a),e++,e>s&&(e=0,n=t,t=new Map)};return{get(o){let a=t.get(o);if(a!==void 0)return a;if((a=n.get(o))!==void 0)return i(o,a),a},set(o,a){t.has(o)?t.set(o,a):i(o,a)}}},IMPORTANT_MODIFIER="!",createParseClassName=s=>{const{separator:e,experimentalParseClassName:t}=s,n=e.length===1,i=e[0],o=e.length,a=l=>{const h=[];let d=0,u=0,f;for(let E=0;E<l.length;E++){let b=l[E];if(d===0){if(b===i&&(n||l.slice(E,E+o)===e)){h.push(l.slice(u,E)),u=E+o;continue}if(b==="/"){f=E;continue}}b==="["?d++:b==="]"&&d--}const m=h.length===0?l:l.substring(u),v=m.startsWith(IMPORTANT_MODIFIER),g=v?m.substring(1):m,x=f&&f>u?f-u:void 0;return{modifiers:h,hasImportantModifier:v,baseClassName:g,maybePostfixModifierPosition:x}};return t?l=>t({className:l,parseClassName:a}):a},sortModifiers=s=>{if(s.length<=1)return s;const e=[];let t=[];return s.forEach(n=>{n[0]==="["?(e.push(...t.sort(),n),t=[]):t.push(n)}),e.push(...t.sort()),e},createConfigUtils=s=>({cache:createLruCache(s.cacheSize),parseClassName:createParseClassName(s),...createClassGroupUtils(s)}),SPLIT_CLASSES_REGEX=/\s+/,mergeClassList=(s,e)=>{const{parseClassName:t,getClassGroupId:n,getConflictingClassGroupIds:i}=e,o=[],a=s.trim().split(SPLIT_CLASSES_REGEX);let l="";for(let h=a.length-1;h>=0;h-=1){const d=a[h],{modifiers:u,hasImportantModifier:f,baseClassName:m,maybePostfixModifierPosition:v}=t(d);let g=!!v,x=n(g?m.substring(0,v):m);if(!x){if(!g){l=d+(l.length>0?" "+l:l);continue}if(x=n(m),!x){l=d+(l.length>0?" "+l:l);continue}g=!1}const E=sortModifiers(u).join(":"),b=f?E+IMPORTANT_MODIFIER:E,_=b+x;if(o.includes(_))continue;o.push(_);const S=i(x,g);for(let C=0;C<S.length;++C){const A=S[C];o.push(b+A)}l=d+(l.length>0?" "+l:l)}return l};function twJoin(){let s=0,e,t,n="";for(;s<arguments.length;)(e=arguments[s++])&&(t=toValue(e))&&(n&&(n+=" "),n+=t);return n}const toValue=s=>{if(typeof s=="string")return s;let e,t="";for(let n=0;n<s.length;n++)s[n]&&(e=toValue(s[n]))&&(t&&(t+=" "),t+=e);return t};function createTailwindMerge(s,...e){let t,n,i,o=a;function a(h){const d=e.reduce((u,f)=>f(u),s());return t=createConfigUtils(d),n=t.cache.get,i=t.cache.set,o=l,l(h)}function l(h){const d=n(h);if(d)return d;const u=mergeClassList(h,t);return i(h,u),u}return function(){return o(twJoin.apply(null,arguments))}}const fromTheme=s=>{const e=t=>t[s]||[];return e.isThemeGetter=!0,e},arbitraryValueRegex=/^\[(?:([a-z-]+):)?(.+)\]$/i,fractionRegex=/^\d+\/\d+$/,stringLengths=new Set(["px","full","screen"]),tshirtUnitRegex=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,lengthUnitRegex=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,colorFunctionRegex=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,shadowRegex=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,imageRegex=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,isLength=s=>isNumber(s)||stringLengths.has(s)||fractionRegex.test(s),isArbitraryLength=s=>getIsArbitraryValue(s,"length",isLengthOnly),isNumber=s=>!!s&&!Number.isNaN(Number(s)),isArbitraryNumber=s=>getIsArbitraryValue(s,"number",isNumber),isInteger=s=>!!s&&Number.isInteger(Number(s)),isPercent=s=>s.endsWith("%")&&isNumber(s.slice(0,-1)),isArbitraryValue=s=>arbitraryValueRegex.test(s),isTshirtSize=s=>tshirtUnitRegex.test(s),sizeLabels=new Set(["length","size","percentage"]),isArbitrarySize=s=>getIsArbitraryValue(s,sizeLabels,isNever),isArbitraryPosition=s=>getIsArbitraryValue(s,"position",isNever),imageLabels=new Set(["image","url"]),isArbitraryImage=s=>getIsArbitraryValue(s,imageLabels,isImage),isArbitraryShadow=s=>getIsArbitraryValue(s,"",isShadow),isAny=()=>!0,getIsArbitraryValue=(s,e,t)=>{const n=arbitraryValueRegex.exec(s);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):t(n[2]):!1},isLengthOnly=s=>lengthUnitRegex.test(s)&&!colorFunctionRegex.test(s),isNever=()=>!1,isShadow=s=>shadowRegex.test(s),isImage=s=>imageRegex.test(s),getDefaultConfig=()=>{const s=fromTheme("colors"),e=fromTheme("spacing"),t=fromTheme("blur"),n=fromTheme("brightness"),i=fromTheme("borderColor"),o=fromTheme("borderRadius"),a=fromTheme("borderSpacing"),l=fromTheme("borderWidth"),h=fromTheme("contrast"),d=fromTheme("grayscale"),u=fromTheme("hueRotate"),f=fromTheme("invert"),m=fromTheme("gap"),v=fromTheme("gradientColorStops"),g=fromTheme("gradientColorStopPositions"),x=fromTheme("inset"),E=fromTheme("margin"),b=fromTheme("opacity"),_=fromTheme("padding"),S=fromTheme("saturate"),C=fromTheme("scale"),A=fromTheme("sepia"),R=fromTheme("skew"),L=fromTheme("space"),j=fromTheme("translate"),F=()=>["auto","contain","none"],W=()=>["auto","hidden","clip","visible","scroll"],K=()=>["auto",isArbitraryValue,e],ee=()=>[isArbitraryValue,e],te=()=>["",isLength,isArbitraryLength],re=()=>["auto",isNumber,isArbitraryValue],ie=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Q=()=>["solid","dashed","dotted","double","none"],z=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],N=()=>["start","end","center","between","around","evenly","stretch"],k=()=>["","0",isArbitraryValue],I=()=>["auto","avoid","all","avoid-page","page","left","right","column"],D=()=>[isNumber,isArbitraryValue];return{cacheSize:500,separator:":",theme:{colors:[isAny],spacing:[isLength,isArbitraryLength],blur:["none","",isTshirtSize,isArbitraryValue],brightness:D(),borderColor:[s],borderRadius:["none","","full",isTshirtSize,isArbitraryValue],borderSpacing:ee(),borderWidth:te(),contrast:D(),grayscale:k(),hueRotate:D(),invert:k(),gap:ee(),gradientColorStops:[s],gradientColorStopPositions:[isPercent,isArbitraryLength],inset:K(),margin:K(),opacity:D(),padding:ee(),saturate:D(),scale:D(),sepia:k(),skew:D(),space:ee(),translate:ee()},classGroups:{aspect:[{aspect:["auto","square","video",isArbitraryValue]}],container:["container"],columns:[{columns:[isTshirtSize]}],"break-after":[{"break-after":I()}],"break-before":[{"break-before":I()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...ie(),isArbitraryValue]}],overflow:[{overflow:W()}],"overflow-x":[{"overflow-x":W()}],"overflow-y":[{"overflow-y":W()}],overscroll:[{overscroll:F()}],"overscroll-x":[{"overscroll-x":F()}],"overscroll-y":[{"overscroll-y":F()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",isInteger,isArbitraryValue]}],basis:[{basis:K()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",isArbitraryValue]}],grow:[{grow:k()}],shrink:[{shrink:k()}],order:[{order:["first","last","none",isInteger,isArbitraryValue]}],"grid-cols":[{"grid-cols":[isAny]}],"col-start-end":[{col:["auto",{span:["full",isInteger,isArbitraryValue]},isArbitraryValue]}],"col-start":[{"col-start":re()}],"col-end":[{"col-end":re()}],"grid-rows":[{"grid-rows":[isAny]}],"row-start-end":[{row:["auto",{span:[isInteger,isArbitraryValue]},isArbitraryValue]}],"row-start":[{"row-start":re()}],"row-end":[{"row-end":re()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",isArbitraryValue]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",isArbitraryValue]}],gap:[{gap:[m]}],"gap-x":[{"gap-x":[m]}],"gap-y":[{"gap-y":[m]}],"justify-content":[{justify:["normal",...N()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...N(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...N(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[_]}],px:[{px:[_]}],py:[{py:[_]}],ps:[{ps:[_]}],pe:[{pe:[_]}],pt:[{pt:[_]}],pr:[{pr:[_]}],pb:[{pb:[_]}],pl:[{pl:[_]}],m:[{m:[E]}],mx:[{mx:[E]}],my:[{my:[E]}],ms:[{ms:[E]}],me:[{me:[E]}],mt:[{mt:[E]}],mr:[{mr:[E]}],mb:[{mb:[E]}],ml:[{ml:[E]}],"space-x":[{"space-x":[L]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[L]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",isArbitraryValue,e]}],"min-w":[{"min-w":[isArbitraryValue,e,"min","max","fit"]}],"max-w":[{"max-w":[isArbitraryValue,e,"none","full","min","max","fit","prose",{screen:[isTshirtSize]},isTshirtSize]}],h:[{h:[isArbitraryValue,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[isArbitraryValue,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[isArbitraryValue,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[isArbitraryValue,e,"auto","min","max","fit"]}],"font-size":[{text:["base",isTshirtSize,isArbitraryLength]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",isArbitraryNumber]}],"font-family":[{font:[isAny]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",isArbitraryValue]}],"line-clamp":[{"line-clamp":["none",isNumber,isArbitraryNumber]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",isLength,isArbitraryValue]}],"list-image":[{"list-image":["none",isArbitraryValue]}],"list-style-type":[{list:["none","disc","decimal",isArbitraryValue]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[s]}],"placeholder-opacity":[{"placeholder-opacity":[b]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[s]}],"text-opacity":[{"text-opacity":[b]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Q(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",isLength,isArbitraryLength]}],"underline-offset":[{"underline-offset":["auto",isLength,isArbitraryValue]}],"text-decoration-color":[{decoration:[s]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:ee()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",isArbitraryValue]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",isArbitraryValue]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[b]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...ie(),isArbitraryPosition]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",isArbitrarySize]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},isArbitraryImage]}],"bg-color":[{bg:[s]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[v]}],"gradient-via":[{via:[v]}],"gradient-to":[{to:[v]}],rounded:[{rounded:[o]}],"rounded-s":[{"rounded-s":[o]}],"rounded-e":[{"rounded-e":[o]}],"rounded-t":[{"rounded-t":[o]}],"rounded-r":[{"rounded-r":[o]}],"rounded-b":[{"rounded-b":[o]}],"rounded-l":[{"rounded-l":[o]}],"rounded-ss":[{"rounded-ss":[o]}],"rounded-se":[{"rounded-se":[o]}],"rounded-ee":[{"rounded-ee":[o]}],"rounded-es":[{"rounded-es":[o]}],"rounded-tl":[{"rounded-tl":[o]}],"rounded-tr":[{"rounded-tr":[o]}],"rounded-br":[{"rounded-br":[o]}],"rounded-bl":[{"rounded-bl":[o]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[b]}],"border-style":[{border:[...Q(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[b]}],"divide-style":[{divide:Q()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...Q()]}],"outline-offset":[{"outline-offset":[isLength,isArbitraryValue]}],"outline-w":[{outline:[isLength,isArbitraryLength]}],"outline-color":[{outline:[s]}],"ring-w":[{ring:te()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[s]}],"ring-opacity":[{"ring-opacity":[b]}],"ring-offset-w":[{"ring-offset":[isLength,isArbitraryLength]}],"ring-offset-color":[{"ring-offset":[s]}],shadow:[{shadow:["","inner","none",isTshirtSize,isArbitraryShadow]}],"shadow-color":[{shadow:[isAny]}],opacity:[{opacity:[b]}],"mix-blend":[{"mix-blend":[...z(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":z()}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[n]}],contrast:[{contrast:[h]}],"drop-shadow":[{"drop-shadow":["","none",isTshirtSize,isArbitraryValue]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[f]}],saturate:[{saturate:[S]}],sepia:[{sepia:[A]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[h]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[b]}],"backdrop-saturate":[{"backdrop-saturate":[S]}],"backdrop-sepia":[{"backdrop-sepia":[A]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",isArbitraryValue]}],duration:[{duration:D()}],ease:[{ease:["linear","in","out","in-out",isArbitraryValue]}],delay:[{delay:D()}],animate:[{animate:["none","spin","ping","pulse","bounce",isArbitraryValue]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[C]}],"scale-x":[{"scale-x":[C]}],"scale-y":[{"scale-y":[C]}],rotate:[{rotate:[isInteger,isArbitraryValue]}],"translate-x":[{"translate-x":[j]}],"translate-y":[{"translate-y":[j]}],"skew-x":[{"skew-x":[R]}],"skew-y":[{"skew-y":[R]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",isArbitraryValue]}],accent:[{accent:["auto",s]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",isArbitraryValue]}],"caret-color":[{caret:[s]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":ee()}],"scroll-mx":[{"scroll-mx":ee()}],"scroll-my":[{"scroll-my":ee()}],"scroll-ms":[{"scroll-ms":ee()}],"scroll-me":[{"scroll-me":ee()}],"scroll-mt":[{"scroll-mt":ee()}],"scroll-mr":[{"scroll-mr":ee()}],"scroll-mb":[{"scroll-mb":ee()}],"scroll-ml":[{"scroll-ml":ee()}],"scroll-p":[{"scroll-p":ee()}],"scroll-px":[{"scroll-px":ee()}],"scroll-py":[{"scroll-py":ee()}],"scroll-ps":[{"scroll-ps":ee()}],"scroll-pe":[{"scroll-pe":ee()}],"scroll-pt":[{"scroll-pt":ee()}],"scroll-pr":[{"scroll-pr":ee()}],"scroll-pb":[{"scroll-pb":ee()}],"scroll-pl":[{"scroll-pl":ee()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",isArbitraryValue]}],fill:[{fill:[s,"none"]}],"stroke-w":[{stroke:[isLength,isArbitraryLength,isArbitraryNumber]}],stroke:[{stroke:[s,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},twMerge=createTailwindMerge(getDefaultConfig);function cn(...s){return twMerge(clsx(s))}function Select({...s}){return jsxRuntimeExports.jsx(Root2$3,{"data-slot":"select",...s})}function SelectValue({...s}){return jsxRuntimeExports.jsx(Value,{"data-slot":"select-value",...s})}function SelectTrigger({className:s,size:e="default",children:t,...n}){return jsxRuntimeExports.jsxs(Trigger$3,{"data-slot":"select-trigger","data-size":e,className:cn("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-full items-center justify-between gap-2 rounded-md border bg-input-background px-3 py-2 text-sm whitespace-nowrap transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...n,children:[t,jsxRuntimeExports.jsx(Icon,{asChild:!0,children:jsxRuntimeExports.jsx(ChevronDown,{className:"size-4 opacity-50"})})]})}function SelectContent({className:s,children:e,position:t="popper",...n}){return jsxRuntimeExports.jsx(Portal$2,{children:jsxRuntimeExports.jsxs(Content2$3,{"data-slot":"select-content",className:cn("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",t==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:t,...n,children:[jsxRuntimeExports.jsx(SelectScrollUpButton,{}),jsxRuntimeExports.jsx(Viewport$1,{className:cn("p-1",t==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:e}),jsxRuntimeExports.jsx(SelectScrollDownButton,{})]})})}function SelectItem({className:s,children:e,...t}){return jsxRuntimeExports.jsxs(Item$1,{"data-slot":"select-item",className:cn("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",s),...t,children:[jsxRuntimeExports.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:jsxRuntimeExports.jsx(ItemIndicator$1,{children:jsxRuntimeExports.jsx(Check,{className:"size-4"})})}),jsxRuntimeExports.jsx(ItemText,{children:e})]})}function SelectSeparator({className:s,...e}){return jsxRuntimeExports.jsx(Separator$1,{"data-slot":"select-separator",className:cn("bg-border pointer-events-none -mx-1 my-1 h-px",s),...e})}function SelectScrollUpButton({className:s,...e}){return jsxRuntimeExports.jsx(ScrollUpButton,{"data-slot":"select-scroll-up-button",className:cn("flex cursor-default items-center justify-center py-1",s),...e,children:jsxRuntimeExports.jsx(ChevronUp,{className:"size-4"})})}function SelectScrollDownButton({className:s,...e}){return jsxRuntimeExports.jsx(ScrollDownButton,{"data-slot":"select-scroll-down-button",className:cn("flex cursor-default items-center justify-center py-1",s),...e,children:jsxRuntimeExports.jsx(ChevronDown,{className:"size-4"})})}const scriptRel="modulepreload",assetsURL=function(s){return"/"+s},seen={},__vitePreload=function(e,t,n){let i=Promise.resolve();if(t&&t.length>0){let a=function(d){return Promise.all(d.map(u=>Promise.resolve(u).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),h=l?.nonce||l?.getAttribute("nonce");i=a(t.map(d=>{if(d=assetsURL(d),d in seen)return;seen[d]=!0;const u=d.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${f}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":scriptRel,u||(m.as="script"),m.crossOrigin="",m.href=d,h&&m.setAttribute("nonce",h),document.head.appendChild(m),u)return new Promise((v,g)=>{m.addEventListener("load",v),m.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${d}`)))})}))}function o(a){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=a,window.dispatchEvent(l),!l.defaultPrevented)throw a}return i.then(a=>{for(const l of a||[])l.status==="rejected"&&o(l.reason);return e().catch(o)})},resolveFetch$3=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>__vitePreload(async()=>{const{default:n}=await Promise.resolve().then(()=>browser);return{default:n}},[]).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)};class FunctionsError extends Error{constructor(e,t="FunctionsError",n){super(e),this.name=t,this.context=n}}class FunctionsFetchError extends FunctionsError{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class FunctionsRelayError extends FunctionsError{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class FunctionsHttpError extends FunctionsError{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var FunctionRegion;(function(s){s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2"})(FunctionRegion||(FunctionRegion={}));var __awaiter$a=function(s,e,t,n){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function l(u){try{d(n.next(u))}catch(f){a(f)}}function h(u){try{d(n.throw(u))}catch(f){a(f)}}function d(u){u.done?o(u.value):i(u.value).then(l,h)}d((n=n.apply(s,e||[])).next())})};class FunctionsClient{constructor(e,{headers:t={},customFetch:n,region:i=FunctionRegion.Any}={}){this.url=e,this.headers=t,this.region=i,this.fetch=resolveFetch$3(n)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return __awaiter$a(this,arguments,void 0,function*(t,n={}){var i;try{const{headers:o,method:a,body:l,signal:h}=n;let d={},{region:u}=n;u||(u=this.region);const f=new URL(`${this.url}/${t}`);u&&u!=="any"&&(d["x-region"]=u,f.searchParams.set("forceFunctionRegion",u));let m;l&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&(typeof Blob<"u"&&l instanceof Blob||l instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",m=l):typeof l=="string"?(d["Content-Type"]="text/plain",m=l):typeof FormData<"u"&&l instanceof FormData?m=l:(d["Content-Type"]="application/json",m=JSON.stringify(l)));const v=yield this.fetch(f.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),o),body:m,signal:h}).catch(b=>{throw b.name==="AbortError"?b:new FunctionsFetchError(b)}),g=v.headers.get("x-relay-error");if(g&&g==="true")throw new FunctionsRelayError(v);if(!v.ok)throw new FunctionsHttpError(v);let x=((i=v.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),E;return x==="application/json"?E=yield v.json():x==="application/octet-stream"?E=yield v.blob():x==="text/event-stream"?E=v:x==="multipart/form-data"?E=yield v.formData():E=yield v.text(),{data:E,error:null,response:v}}catch(o){return o instanceof Error&&o.name==="AbortError"?{data:null,error:new FunctionsFetchError(o)}:{data:null,error:o,response:o instanceof FunctionsHttpError||o instanceof FunctionsRelayError?o.context:void 0}}})}}var cjs={},PostgrestClient$1={},PostgrestQueryBuilder$1={},PostgrestFilterBuilder$1={},PostgrestTransformBuilder$1={},PostgrestBuilder$1={},getGlobal=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},globalObject=getGlobal();const fetch$1=globalObject.fetch,nodeFetch=globalObject.fetch.bind(globalObject),Headers$1=globalObject.Headers,Request=globalObject.Request,Response$1=globalObject.Response,browser=Object.freeze(Object.defineProperty({__proto__:null,Headers:Headers$1,Request,Response:Response$1,default:nodeFetch,fetch:fetch$1},Symbol.toStringTag,{value:"Module"})),require$$0=getAugmentedNamespace(browser);var PostgrestError$1={},hasRequiredPostgrestError;function requirePostgrestError(){if(hasRequiredPostgrestError)return PostgrestError$1;hasRequiredPostgrestError=1,Object.defineProperty(PostgrestError$1,"__esModule",{value:!0});class s extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return PostgrestError$1.default=s,PostgrestError$1}var hasRequiredPostgrestBuilder;function requirePostgrestBuilder(){if(hasRequiredPostgrestBuilder)return PostgrestBuilder$1;hasRequiredPostgrestBuilder=1;var s=PostgrestBuilder$1&&PostgrestBuilder$1.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(PostgrestBuilder$1,"__esModule",{value:!0});const e=s(require$$0),t=s(requirePostgrestError());class n{constructor(o){var a,l;this.shouldThrowOnError=!1,this.method=o.method,this.url=o.url,this.headers=new Headers(o.headers),this.schema=o.schema,this.body=o.body,this.shouldThrowOnError=(a=o.shouldThrowOnError)!==null&&a!==void 0?a:!1,this.signal=o.signal,this.isMaybeSingle=(l=o.isMaybeSingle)!==null&&l!==void 0?l:!1,o.fetch?this.fetch=o.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(o,a){return this.headers=new Headers(this.headers),this.headers.set(o,a),this}then(o,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const l=this.fetch;let h=l(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async d=>{var u,f,m,v;let g=null,x=null,E=null,b=d.status,_=d.statusText;if(d.ok){if(this.method!=="HEAD"){const R=await d.text();R===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((u=this.headers.get("Accept"))===null||u===void 0)&&u.includes("application/vnd.pgrst.plan+text"))?x=R:x=JSON.parse(R))}const C=(f=this.headers.get("Prefer"))===null||f===void 0?void 0:f.match(/count=(exact|planned|estimated)/),A=(m=d.headers.get("content-range"))===null||m===void 0?void 0:m.split("/");C&&A&&A.length>1&&(E=parseInt(A[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(x)&&(x.length>1?(g={code:"PGRST116",details:`Results contain ${x.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},x=null,E=null,b=406,_="Not Acceptable"):x.length===1?x=x[0]:x=null)}else{const C=await d.text();try{g=JSON.parse(C),Array.isArray(g)&&d.status===404&&(x=[],g=null,b=200,_="OK")}catch{d.status===404&&C===""?(b=204,_="No Content"):g={message:C}}if(g&&this.isMaybeSingle&&(!((v=g?.details)===null||v===void 0)&&v.includes("0 rows"))&&(g=null,b=200,_="OK"),g&&this.shouldThrowOnError)throw new t.default(g)}return{error:g,data:x,count:E,status:b,statusText:_}});return this.shouldThrowOnError||(h=h.catch(d=>{var u,f,m;return{error:{message:`${(u=d?.name)!==null&&u!==void 0?u:"FetchError"}: ${d?.message}`,details:`${(f=d?.stack)!==null&&f!==void 0?f:""}`,hint:"",code:`${(m=d?.code)!==null&&m!==void 0?m:""}`},data:null,count:null,status:0,statusText:""}})),h.then(o,a)}returns(){return this}overrideTypes(){return this}}return PostgrestBuilder$1.default=n,PostgrestBuilder$1}var hasRequiredPostgrestTransformBuilder;function requirePostgrestTransformBuilder(){if(hasRequiredPostgrestTransformBuilder)return PostgrestTransformBuilder$1;hasRequiredPostgrestTransformBuilder=1;var s=PostgrestTransformBuilder$1&&PostgrestTransformBuilder$1.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(PostgrestTransformBuilder$1,"__esModule",{value:!0});const e=s(requirePostgrestBuilder());class t extends e.default{select(i){let o=!1;const a=(i??"*").split("").map(l=>/\s/.test(l)&&!o?"":(l==='"'&&(o=!o),l)).join("");return this.url.searchParams.set("select",a),this.headers.append("Prefer","return=representation"),this}order(i,{ascending:o=!0,nullsFirst:a,foreignTable:l,referencedTable:h=l}={}){const d=h?`${h}.order`:"order",u=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${u?`${u},`:""}${i}.${o?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(i,{foreignTable:o,referencedTable:a=o}={}){const l=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(l,`${i}`),this}range(i,o,{foreignTable:a,referencedTable:l=a}={}){const h=typeof l>"u"?"offset":`${l}.offset`,d=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(h,`${i}`),this.url.searchParams.set(d,`${o-i+1}`),this}abortSignal(i){return this.signal=i,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:i=!1,verbose:o=!1,settings:a=!1,buffers:l=!1,wal:h=!1,format:d="text"}={}){var u;const f=[i?"analyze":null,o?"verbose":null,a?"settings":null,l?"buffers":null,h?"wal":null].filter(Boolean).join("|"),m=(u=this.headers.get("Accept"))!==null&&u!==void 0?u:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${m}"; options=${f};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(i){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${i}`),this}}return PostgrestTransformBuilder$1.default=t,PostgrestTransformBuilder$1}var hasRequiredPostgrestFilterBuilder;function requirePostgrestFilterBuilder(){if(hasRequiredPostgrestFilterBuilder)return PostgrestFilterBuilder$1;hasRequiredPostgrestFilterBuilder=1;var s=PostgrestFilterBuilder$1&&PostgrestFilterBuilder$1.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(PostgrestFilterBuilder$1,"__esModule",{value:!0});const e=s(requirePostgrestTransformBuilder());class t extends e.default{eq(i,o){return this.url.searchParams.append(i,`eq.${o}`),this}neq(i,o){return this.url.searchParams.append(i,`neq.${o}`),this}gt(i,o){return this.url.searchParams.append(i,`gt.${o}`),this}gte(i,o){return this.url.searchParams.append(i,`gte.${o}`),this}lt(i,o){return this.url.searchParams.append(i,`lt.${o}`),this}lte(i,o){return this.url.searchParams.append(i,`lte.${o}`),this}like(i,o){return this.url.searchParams.append(i,`like.${o}`),this}likeAllOf(i,o){return this.url.searchParams.append(i,`like(all).{${o.join(",")}}`),this}likeAnyOf(i,o){return this.url.searchParams.append(i,`like(any).{${o.join(",")}}`),this}ilike(i,o){return this.url.searchParams.append(i,`ilike.${o}`),this}ilikeAllOf(i,o){return this.url.searchParams.append(i,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(i,o){return this.url.searchParams.append(i,`ilike(any).{${o.join(",")}}`),this}is(i,o){return this.url.searchParams.append(i,`is.${o}`),this}in(i,o){const a=Array.from(new Set(o)).map(l=>typeof l=="string"&&new RegExp("[,()]").test(l)?`"${l}"`:`${l}`).join(",");return this.url.searchParams.append(i,`in.(${a})`),this}contains(i,o){return typeof o=="string"?this.url.searchParams.append(i,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(i,`cs.{${o.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(o)}`),this}containedBy(i,o){return typeof o=="string"?this.url.searchParams.append(i,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(i,`cd.{${o.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(o)}`),this}rangeGt(i,o){return this.url.searchParams.append(i,`sr.${o}`),this}rangeGte(i,o){return this.url.searchParams.append(i,`nxl.${o}`),this}rangeLt(i,o){return this.url.searchParams.append(i,`sl.${o}`),this}rangeLte(i,o){return this.url.searchParams.append(i,`nxr.${o}`),this}rangeAdjacent(i,o){return this.url.searchParams.append(i,`adj.${o}`),this}overlaps(i,o){return typeof o=="string"?this.url.searchParams.append(i,`ov.${o}`):this.url.searchParams.append(i,`ov.{${o.join(",")}}`),this}textSearch(i,o,{config:a,type:l}={}){let h="";l==="plain"?h="pl":l==="phrase"?h="ph":l==="websearch"&&(h="w");const d=a===void 0?"":`(${a})`;return this.url.searchParams.append(i,`${h}fts${d}.${o}`),this}match(i){return Object.entries(i).forEach(([o,a])=>{this.url.searchParams.append(o,`eq.${a}`)}),this}not(i,o,a){return this.url.searchParams.append(i,`not.${o}.${a}`),this}or(i,{foreignTable:o,referencedTable:a=o}={}){const l=a?`${a}.or`:"or";return this.url.searchParams.append(l,`(${i})`),this}filter(i,o,a){return this.url.searchParams.append(i,`${o}.${a}`),this}}return PostgrestFilterBuilder$1.default=t,PostgrestFilterBuilder$1}var hasRequiredPostgrestQueryBuilder;function requirePostgrestQueryBuilder(){if(hasRequiredPostgrestQueryBuilder)return PostgrestQueryBuilder$1;hasRequiredPostgrestQueryBuilder=1;var s=PostgrestQueryBuilder$1&&PostgrestQueryBuilder$1.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(PostgrestQueryBuilder$1,"__esModule",{value:!0});const e=s(requirePostgrestFilterBuilder());class t{constructor(i,{headers:o={},schema:a,fetch:l}){this.url=i,this.headers=new Headers(o),this.schema=a,this.fetch=l}select(i,o){const{head:a=!1,count:l}=o??{},h=a?"HEAD":"GET";let d=!1;const u=(i??"*").split("").map(f=>/\s/.test(f)&&!d?"":(f==='"'&&(d=!d),f)).join("");return this.url.searchParams.set("select",u),l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(i,{count:o,defaultToNull:a=!0}={}){var l;const h="POST";if(o&&this.headers.append("Prefer",`count=${o}`),a||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const d=i.reduce((u,f)=>u.concat(Object.keys(f)),[]);if(d.length>0){const u=[...new Set(d)].map(f=>`"${f}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(i,{onConflict:o,ignoreDuplicates:a=!1,count:l,defaultToNull:h=!0}={}){var d;const u="POST";if(this.headers.append("Prefer",`resolution=${a?"ignore":"merge"}-duplicates`),o!==void 0&&this.url.searchParams.set("on_conflict",o),l&&this.headers.append("Prefer",`count=${l}`),h||this.headers.append("Prefer","missing=default"),Array.isArray(i)){const f=i.reduce((m,v)=>m.concat(Object.keys(v)),[]);if(f.length>0){const m=[...new Set(f)].map(v=>`"${v}"`);this.url.searchParams.set("columns",m.join(","))}}return new e.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}update(i,{count:o}={}){var a;const l="PATCH";return o&&this.headers.append("Prefer",`count=${o}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:i,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}delete({count:i}={}){var o;const a="DELETE";return i&&this.headers.append("Prefer",`count=${i}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}}return PostgrestQueryBuilder$1.default=t,PostgrestQueryBuilder$1}var hasRequiredPostgrestClient;function requirePostgrestClient(){if(hasRequiredPostgrestClient)return PostgrestClient$1;hasRequiredPostgrestClient=1;var s=PostgrestClient$1&&PostgrestClient$1.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(PostgrestClient$1,"__esModule",{value:!0});const e=s(requirePostgrestQueryBuilder()),t=s(requirePostgrestFilterBuilder());class n{constructor(o,{headers:a={},schema:l,fetch:h}={}){this.url=o,this.headers=new Headers(a),this.schemaName=l,this.fetch=h}from(o){const a=new URL(`${this.url}/${o}`);return new e.default(a,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(o){return new n(this.url,{headers:this.headers,schema:o,fetch:this.fetch})}rpc(o,a={},{head:l=!1,get:h=!1,count:d}={}){var u;let f;const m=new URL(`${this.url}/rpc/${o}`);let v;l||h?(f=l?"HEAD":"GET",Object.entries(a).filter(([x,E])=>E!==void 0).map(([x,E])=>[x,Array.isArray(E)?`{${E.join(",")}}`:`${E}`]).forEach(([x,E])=>{m.searchParams.append(x,E)})):(f="POST",v=a);const g=new Headers(this.headers);return d&&g.set("Prefer",`count=${d}`),new t.default({method:f,url:m,headers:g,schema:this.schemaName,body:v,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}}return PostgrestClient$1.default=n,PostgrestClient$1}var hasRequiredCjs;function requireCjs(){if(hasRequiredCjs)return cjs;hasRequiredCjs=1;var s=cjs&&cjs.__importDefault||function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(cjs,"__esModule",{value:!0}),cjs.PostgrestError=cjs.PostgrestBuilder=cjs.PostgrestTransformBuilder=cjs.PostgrestFilterBuilder=cjs.PostgrestQueryBuilder=cjs.PostgrestClient=void 0;const e=s(requirePostgrestClient());cjs.PostgrestClient=e.default;const t=s(requirePostgrestQueryBuilder());cjs.PostgrestQueryBuilder=t.default;const n=s(requirePostgrestFilterBuilder());cjs.PostgrestFilterBuilder=n.default;const i=s(requirePostgrestTransformBuilder());cjs.PostgrestTransformBuilder=i.default;const o=s(requirePostgrestBuilder());cjs.PostgrestBuilder=o.default;const a=s(requirePostgrestError());return cjs.PostgrestError=a.default,cjs.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:n.default,PostgrestTransformBuilder:i.default,PostgrestBuilder:o.default,PostgrestError:a.default},cjs}var cjsExports=requireCjs();const index=getDefaultExportFromCjs(cjsExports),{PostgrestClient,PostgrestQueryBuilder,PostgrestFilterBuilder,PostgrestTransformBuilder,PostgrestBuilder,PostgrestError}=index;class WebSocketFactory{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const t=process.versions;if(t&&t.node){const n=t.node,i=parseInt(n.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const n=this.getWebSocketConstructor();return new n(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const version$4="2.74.0",DEFAULT_VERSION=`realtime-js/${version$4}`,VSN="1.0.0",DEFAULT_TIMEOUT=1e4,WS_CLOSE_NORMAL=1e3,MAX_PUSH_BUFFER_SIZE=100;var SOCKET_STATES;(function(s){s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed"})(SOCKET_STATES||(SOCKET_STATES={}));var CHANNEL_STATES;(function(s){s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving"})(CHANNEL_STATES||(CHANNEL_STATES={}));var CHANNEL_EVENTS;(function(s){s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token"})(CHANNEL_EVENTS||(CHANNEL_EVENTS={}));var TRANSPORTS;(function(s){s.websocket="websocket"})(TRANSPORTS||(TRANSPORTS={}));var CONNECTION_STATE;(function(s){s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed"})(CONNECTION_STATE||(CONNECTION_STATE={}));class Serializer{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),n=new TextDecoder;return this._decodeBroadcast(e,t,n)}_decodeBroadcast(e,t,n){const i=t.getUint8(1),o=t.getUint8(2);let a=this.HEADER_LENGTH+2;const l=n.decode(e.slice(a,a+i));a=a+i;const h=n.decode(e.slice(a,a+o));a=a+o;const d=JSON.parse(n.decode(e.slice(a,e.byteLength)));return{ref:null,topic:l,event:h,payload:d}}}class Timer{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var PostgresTypes;(function(s){s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange"})(PostgresTypes||(PostgresTypes={}));const convertChangeData=(s,e,t={})=>{var n;const i=(n=t.skipTypes)!==null&&n!==void 0?n:[];return e?Object.keys(e).reduce((o,a)=>(o[a]=convertColumn(a,s,e,i),o),{}):{}},convertColumn=(s,e,t,n)=>{const i=e.find(l=>l.name===s),o=i?.type,a=t[s];return o&&!n.includes(o)?convertCell(o,a):noop$3(a)},convertCell=(s,e)=>{if(s.charAt(0)==="_"){const t=s.slice(1,s.length);return toArray(e,t)}switch(s){case PostgresTypes.bool:return toBoolean(e);case PostgresTypes.float4:case PostgresTypes.float8:case PostgresTypes.int2:case PostgresTypes.int4:case PostgresTypes.int8:case PostgresTypes.numeric:case PostgresTypes.oid:return toNumber(e);case PostgresTypes.json:case PostgresTypes.jsonb:return toJson(e);case PostgresTypes.timestamp:return toTimestampString(e);case PostgresTypes.abstime:case PostgresTypes.date:case PostgresTypes.daterange:case PostgresTypes.int4range:case PostgresTypes.int8range:case PostgresTypes.money:case PostgresTypes.reltime:case PostgresTypes.text:case PostgresTypes.time:case PostgresTypes.timestamptz:case PostgresTypes.timetz:case PostgresTypes.tsrange:case PostgresTypes.tstzrange:return noop$3(e);default:return noop$3(e)}},noop$3=s=>s,toBoolean=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},toNumber=s=>{if(typeof s=="string"){const e=parseFloat(s);if(!Number.isNaN(e))return e}return s},toJson=s=>{if(typeof s=="string")try{return JSON.parse(s)}catch(e){return console.log(`JSON parse error: ${e}`),s}return s},toArray=(s,e)=>{if(typeof s!="string")return s;const t=s.length-1,n=s[t];if(s[0]==="{"&&n==="}"){let o;const a=s.slice(1,t);try{o=JSON.parse("["+a+"]")}catch{o=a?a.split(","):[]}return o.map(l=>convertCell(e,l))}return s},toTimestampString=s=>typeof s=="string"?s.replace(" ","T"):s,httpEndpointURL=s=>{let e=s;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")+"/api/broadcast"};class Push{constructor(e,t,n={},i=DEFAULT_TIMEOUT){this.channel=e,this.event=t,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var n;return this._hasReceived(e)&&t((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(n=>n.status===e).forEach(n=>n.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var REALTIME_PRESENCE_LISTEN_EVENTS;(function(s){s.SYNC="sync",s.JOIN="join",s.LEAVE="leave"})(REALTIME_PRESENCE_LISTEN_EVENTS||(REALTIME_PRESENCE_LISTEN_EVENTS={}));class RealtimePresence{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:o,onLeave:a,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=RealtimePresence.syncState(this.state,i,o,a),this.pendingDiffs.forEach(h=>{this.state=RealtimePresence.syncDiff(this.state,h,o,a)}),this.pendingDiffs=[],l()}),this.channel._on(n.diff,{},i=>{const{onJoin:o,onLeave:a,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=RealtimePresence.syncDiff(this.state,i,o,a),l())}),this.onJoin((i,o,a)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:o,newPresences:a})}),this.onLeave((i,o,a)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:o,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,n,i){const o=this.cloneDeep(e),a=this.transformState(t),l={},h={};return this.map(o,(d,u)=>{a[d]||(h[d]=u)}),this.map(a,(d,u)=>{const f=o[d];if(f){const m=u.map(E=>E.presence_ref),v=f.map(E=>E.presence_ref),g=u.filter(E=>v.indexOf(E.presence_ref)<0),x=f.filter(E=>m.indexOf(E.presence_ref)<0);g.length>0&&(l[d]=g),x.length>0&&(h[d]=x)}else l[d]=u}),this.syncDiff(o,{joins:l,leaves:h},n,i)}static syncDiff(e,t,n,i){const{joins:o,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(o,(l,h)=>{var d;const u=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(h),u.length>0){const f=e[l].map(v=>v.presence_ref),m=u.filter(v=>f.indexOf(v.presence_ref)<0);e[l].unshift(...m)}n(l,u,h)}),this.map(a,(l,h)=>{let d=e[l];if(!d)return;const u=h.map(f=>f.presence_ref);d=d.filter(f=>u.indexOf(f.presence_ref)<0),e[l]=d,i(l,d,h),d.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const i=e[n];return"metas"in i?t[n]=i.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):t[n]=i,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var REALTIME_POSTGRES_CHANGES_LISTEN_EVENT;(function(s){s.ALL="*",s.INSERT="INSERT",s.UPDATE="UPDATE",s.DELETE="DELETE"})(REALTIME_POSTGRES_CHANGES_LISTEN_EVENT||(REALTIME_POSTGRES_CHANGES_LISTEN_EVENT={}));var REALTIME_LISTEN_TYPES;(function(s){s.BROADCAST="broadcast",s.PRESENCE="presence",s.POSTGRES_CHANGES="postgres_changes",s.SYSTEM="system"})(REALTIME_LISTEN_TYPES||(REALTIME_LISTEN_TYPES={}));var REALTIME_SUBSCRIBE_STATES;(function(s){s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR"})(REALTIME_SUBSCRIBE_STATES||(REALTIME_SUBSCRIBE_STATES={}));class RealtimeChannel{constructor(e,t={config:{}},n){var i,o;if(this.topic=e,this.params=t,this.socket=n,this.bindings={},this.state=CHANNEL_STATES.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Push(this,CHANNEL_EVENTS.join,this.params,this.timeout),this.rejoinTimer=new Timer(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=CHANNEL_STATES.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=CHANNEL_STATES.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=CHANNEL_STATES.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=CHANNEL_STATES.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=CHANNEL_STATES.errored,this.rejoinTimer.scheduleTimeout())}),this._on(CHANNEL_EVENTS.reply,{},(a,l)=>{this._trigger(this._replyEventName(l),a)}),this.presence=new RealtimePresence(this),this.broadcastEndpointURL=httpEndpointURL(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((o=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||o===void 0)&&o.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var n,i,o;if(this.socket.isConnected()||this.socket.connect(),this.state==CHANNEL_STATES.closed){const{config:{broadcast:a,presence:l,private:h}}=this.params,d=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(v=>v.filter))!==null&&i!==void 0?i:[],u=!!this.bindings[REALTIME_LISTEN_TYPES.PRESENCE]&&this.bindings[REALTIME_LISTEN_TYPES.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,f={},m={broadcast:a,presence:Object.assign(Object.assign({},l),{enabled:u}),postgres_changes:d,private:h};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(v=>e?.(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR,v)),this._onClose(()=>e?.(REALTIME_SUBSCRIBE_STATES.CLOSED)),this.updateJoinPayload(Object.assign({config:m},f)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:v})=>{var g;if(this.socket.setAuth(),v===void 0){e?.(REALTIME_SUBSCRIBE_STATES.SUBSCRIBED);return}else{const x=this.bindings.postgres_changes,E=(g=x?.length)!==null&&g!==void 0?g:0,b=[];for(let _=0;_<E;_++){const S=x[_],{filter:{event:C,schema:A,table:R,filter:L}}=S,j=v&&v[_];if(j&&j.event===C&&j.schema===A&&j.table===R&&j.filter===L)b.push(Object.assign(Object.assign({},S),{id:j.id}));else{this.unsubscribe(),this.state=CHANNEL_STATES.errored,e?.(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=b,e&&e(REALTIME_SUBSCRIBE_STATES.SUBSCRIBED);return}}).receive("error",v=>{this.state=CHANNEL_STATES.errored,e?.(REALTIME_SUBSCRIBE_STATES.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(v).join(", ")||"error")))}).receive("timeout",()=>{e?.(REALTIME_SUBSCRIBE_STATES.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,n){return this.state===CHANNEL_STATES.joined&&e===REALTIME_LISTEN_TYPES.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,n)}async send(e,t={}){var n,i;if(!this._canPush()&&e.type==="broadcast"){const{event:o,payload:a}=e,h={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:o,payload:a,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(n=t.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=d.body)===null||i===void 0?void 0:i.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(o=>{var a,l,h;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((h=(l=(a=this.params)===null||a===void 0?void 0:a.config)===null||l===void 0?void 0:l.broadcast)===null||h===void 0)&&h.ack)&&o("ok"),d.receive("ok",()=>o("ok")),d.receive("error",()=>o("error")),d.receive("timeout",()=>o("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=CHANNEL_STATES.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(CHANNEL_EVENTS.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new Push(this,CHANNEL_EVENTS.leave,{},e),n.receive("ok",()=>{t(),i("ok")}).receive("timeout",()=>{t(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=CHANNEL_STATES.closed,this.bindings={}}async _fetchWithTimeout(e,t,n){const i=new AbortController,o=setTimeout(()=>i.abort(),n),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(o),a}_push(e,t,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Push(this,e,t,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>MAX_PUSH_BUFFER_SIZE){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,n){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,n){var i,o;const a=e.toLocaleLowerCase(),{close:l,error:h,leave:d,join:u}=CHANNEL_EVENTS;if(n&&[l,h,d,u].indexOf(a)>=0&&n!==this._joinRef())return;let m=this._onMessage(a,t,n);if(t&&!m)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(v=>{var g,x,E;return((g=v.filter)===null||g===void 0?void 0:g.event)==="*"||((E=(x=v.filter)===null||x===void 0?void 0:x.event)===null||E===void 0?void 0:E.toLocaleLowerCase())===a}).map(v=>v.callback(m,n)):(o=this.bindings[a])===null||o===void 0||o.filter(v=>{var g,x,E,b,_,S;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in v){const C=v.id,A=(g=v.filter)===null||g===void 0?void 0:g.event;return C&&((x=t.ids)===null||x===void 0?void 0:x.includes(C))&&(A==="*"||A?.toLocaleLowerCase()===((E=t.data)===null||E===void 0?void 0:E.type.toLocaleLowerCase()))}else{const C=(_=(b=v?.filter)===null||b===void 0?void 0:b.event)===null||_===void 0?void 0:_.toLocaleLowerCase();return C==="*"||C===((S=t?.event)===null||S===void 0?void 0:S.toLocaleLowerCase())}else return v.type.toLocaleLowerCase()===a}).map(v=>{if(typeof m=="object"&&"ids"in m){const g=m.data,{schema:x,table:E,commit_timestamp:b,type:_,errors:S}=g;m=Object.assign(Object.assign({},{schema:x,table:E,commit_timestamp:b,eventType:_,new:{},old:{},errors:S}),this._getPayloadRecords(g))}v.callback(m,n)})}_isClosed(){return this.state===CHANNEL_STATES.closed}_isJoined(){return this.state===CHANNEL_STATES.joined}_isJoining(){return this.state===CHANNEL_STATES.joining}_isLeaving(){return this.state===CHANNEL_STATES.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,n){const i=e.toLocaleLowerCase(),o={type:i,filter:t,callback:n};return this.bindings[i]?this.bindings[i].push(o):this.bindings[i]=[o],this}_off(e,t){const n=e.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var o;return!(((o=i.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===n&&RealtimeChannel.isEqual(i.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(CHANNEL_EVENTS.close,{},e)}_onError(e){this._on(CHANNEL_EVENTS.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=CHANNEL_STATES.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=convertChangeData(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=convertChangeData(e.columns,e.old_record)),t}}const noop$2=()=>{},CONNECTION_TIMEOUTS={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},RECONNECT_INTERVALS=[1e3,2e3,5e3,1e4],DEFAULT_RECONNECT_FALLBACK=1e4,WORKER_SCRIPT=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class RealtimeClient{constructor(e,t){var n;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=DEFAULT_TIMEOUT,this.transport=null,this.heartbeatIntervalMs=CONNECTION_TIMEOUTS.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=noop$2,this.ref=0,this.reconnectTimer=null,this.logger=noop$2,this.conn=null,this.sendBuffer=[],this.serializer=new Serializer,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=i=>{let o;return i?o=i:typeof fetch>"u"?o=(...a)=>__vitePreload(async()=>{const{default:l}=await Promise.resolve().then(()=>browser);return{default:l}},void 0).then(({default:l})=>l(...a)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):o=fetch,(...a)=>o(...a)},!(!((n=t?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${TRANSPORTS.websocket}`,this.httpEndpoint=httpEndpointURL(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=WebSocketFactory.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:VSN}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},e?this.conn.close(e,t??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,n){this.logger(e,t,n)}connectionState(){switch(this.conn&&this.conn.readyState){case SOCKET_STATES.connecting:return CONNECTION_STATE.Connecting;case SOCKET_STATES.open:return CONNECTION_STATE.Open;case SOCKET_STATES.closing:return CONNECTION_STATE.Closing;default:return CONNECTION_STATE.Closed}}isConnected(){return this.connectionState()===CONNECTION_STATE.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const n=`realtime:${e}`,i=this.getChannels().find(o=>o.topic===n);if(i)return i;{const o=new RealtimeChannel(`realtime:${e}`,t,this);return this.channels.push(o),o}}push(e){const{topic:t,event:n,payload:i,ref:o}=e,a=()=>{this.encode(e,l=>{var h;(h=this.conn)===null||h===void 0||h.send(l)})};this.log("push",`${t} ${n} (${o})`,i),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(WS_CLOSE_NORMAL,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},CONNECTION_TIMEOUTS.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(n=>n.topic===e&&(n._isJoined()||n._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply")try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:n,event:i,payload:o,ref:a}=t,l=a?`(${a})`:"",h=o.status||"";this.log("receive",`${h} ${n} ${i} ${l}`.trim(),o),this.channels.filter(d=>d._isMember(n)).forEach(d=>d._trigger(i,o,a)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(CHANNEL_EVENTS.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const n=e.match(/\?/)?"&":"?",i=new URLSearchParams(t);return`${e}${n}${i}`}_workerObjectUrl(e){let t;if(e)t=e;else{const n=new Blob([WORKER_SCRIPT],{type:"application/javascript"});t=URL.createObjectURL(n)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(n=>{const i={access_token:t,version:DEFAULT_VERSION};t&&n.updateJoinPayload(i),n.joinedOnce&&n._isJoined()&&n._push(CHANNEL_EVENTS.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(n=>{try{n(t)}catch(i){this.log("error",`error in ${e} callback`,i)}})}catch(n){this.log("error",`error triggering ${e} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Timer(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},CONNECTION_TIMEOUTS.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,n,i,o,a,l,h,d,u;if(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(n=e?.timeout)!==null&&n!==void 0?n:DEFAULT_TIMEOUT,this.heartbeatIntervalMs=(i=e?.heartbeatIntervalMs)!==null&&i!==void 0?i:CONNECTION_TIMEOUTS.HEARTBEAT_INTERVAL,this.worker=(o=e?.worker)!==null&&o!==void 0?o:!1,this.accessToken=(a=e?.accessToken)!==null&&a!==void 0?a:null,this.heartbeatCallback=(l=e?.heartbeatCallback)!==null&&l!==void 0?l:noop$2,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=e?.reconnectAfterMs)!==null&&h!==void 0?h:(f=>RECONNECT_INTERVALS[f-1]||DEFAULT_RECONNECT_FALLBACK),this.encode=(d=e?.encode)!==null&&d!==void 0?d:((f,m)=>m(JSON.stringify(f))),this.decode=(u=e?.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class StorageError extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function isStorageError(s){return typeof s=="object"&&s!==null&&"__isStorageError"in s}class StorageApiError extends StorageError{constructor(e,t,n){super(e),this.name="StorageApiError",this.status=t,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class StorageUnknownError extends StorageError{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var __awaiter$9=function(s,e,t,n){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function l(u){try{d(n.next(u))}catch(f){a(f)}}function h(u){try{d(n.throw(u))}catch(f){a(f)}}function d(u){u.done?o(u.value):i(u.value).then(l,h)}d((n=n.apply(s,e||[])).next())})};const resolveFetch$2=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>__vitePreload(async()=>{const{default:n}=await Promise.resolve().then(()=>browser);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},resolveResponse=()=>__awaiter$9(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield __vitePreload(()=>Promise.resolve().then(()=>browser),void 0)).Response:Response}),recursiveToCamel=s=>{if(Array.isArray(s))return s.map(t=>recursiveToCamel(t));if(typeof s=="function"||s!==Object(s))return s;const e={};return Object.entries(s).forEach(([t,n])=>{const i=t.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));e[i]=recursiveToCamel(n)}),e},isPlainObject=s=>{if(typeof s!="object"||s===null)return!1;const e=Object.getPrototypeOf(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in s)&&!(Symbol.iterator in s)};var __awaiter$8=function(s,e,t,n){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function l(u){try{d(n.next(u))}catch(f){a(f)}}function h(u){try{d(n.throw(u))}catch(f){a(f)}}function d(u){u.done?o(u.value):i(u.value).then(l,h)}d((n=n.apply(s,e||[])).next())})};const _getErrorMessage$1=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),handleError$1=(s,e,t)=>__awaiter$8(void 0,void 0,void 0,function*(){const n=yield resolveResponse();s instanceof n&&!t?.noResolveJson?s.json().then(i=>{const o=s.status||500,a=i?.statusCode||o+"";e(new StorageApiError(_getErrorMessage$1(i),o,a))}).catch(i=>{e(new StorageUnknownError(_getErrorMessage$1(i),i))}):e(new StorageUnknownError(_getErrorMessage$1(s),s))}),_getRequestParams$1=(s,e,t,n)=>{const i={method:s,headers:e?.headers||{}};return s==="GET"||!n?i:(isPlainObject(n)?(i.headers=Object.assign({"Content-Type":"application/json"},e?.headers),i.body=JSON.stringify(n)):i.body=n,e?.duplex&&(i.duplex=e.duplex),Object.assign(Object.assign({},i),t))};function _handleRequest$1(s,e,t,n,i,o){return __awaiter$8(this,void 0,void 0,function*(){return new Promise((a,l)=>{s(t,_getRequestParams$1(e,n,i,o)).then(h=>{if(!h.ok)throw h;return n?.noResolveJson?h:h.json()}).then(h=>a(h)).catch(h=>handleError$1(h,l,n))})})}function get(s,e,t,n){return __awaiter$8(this,void 0,void 0,function*(){return _handleRequest$1(s,"GET",e,t,n)})}function post(s,e,t,n,i){return __awaiter$8(this,void 0,void 0,function*(){return _handleRequest$1(s,"POST",e,n,i,t)})}function put(s,e,t,n,i){return __awaiter$8(this,void 0,void 0,function*(){return _handleRequest$1(s,"PUT",e,n,i,t)})}function head(s,e,t,n){return __awaiter$8(this,void 0,void 0,function*(){return _handleRequest$1(s,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),n)})}function remove(s,e,t,n,i){return __awaiter$8(this,void 0,void 0,function*(){return _handleRequest$1(s,"DELETE",e,n,i,t)})}var __awaiter$7=function(s,e,t,n){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function l(u){try{d(n.next(u))}catch(f){a(f)}}function h(u){try{d(n.throw(u))}catch(f){a(f)}}function d(u){u.done?o(u.value):i(u.value).then(l,h)}d((n=n.apply(s,e||[])).next())})};class StreamDownloadBuilder{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}execute(){return __awaiter$7(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}})}}var __awaiter$6=function(s,e,t,n){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function l(u){try{d(n.next(u))}catch(f){a(f)}}function h(u){try{d(n.throw(u))}catch(f){a(f)}}function d(u){u.done?o(u.value):i(u.value).then(l,h)}d((n=n.apply(s,e||[])).next())})};class BlobDownloadBuilder{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}asStream(){return new StreamDownloadBuilder(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.execute().then(e,t)}execute(){return __awaiter$6(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}})}}var __awaiter$5=function(s,e,t,n){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function l(u){try{d(n.next(u))}catch(f){a(f)}}function h(u){try{d(n.throw(u))}catch(f){a(f)}}function d(u){u.done?o(u.value):i(u.value).then(l,h)}d((n=n.apply(s,e||[])).next())})};const DEFAULT_SEARCH_OPTIONS={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},DEFAULT_FILE_OPTIONS={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class StorageFileApi{constructor(e,t={},n,i){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=n,this.fetch=resolveFetch$2(i)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,n,i){return __awaiter$5(this,void 0,void 0,function*(){try{let o;const a=Object.assign(Object.assign({},DEFAULT_FILE_OPTIONS),i);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const h=a.metadata;typeof Blob<"u"&&n instanceof Blob?(o=new FormData,o.append("cacheControl",a.cacheControl),h&&o.append("metadata",this.encodeMetadata(h)),o.append("",n)):typeof FormData<"u"&&n instanceof FormData?(o=n,o.append("cacheControl",a.cacheControl),h&&o.append("metadata",this.encodeMetadata(h))):(o=n,l["cache-control"]=`max-age=${a.cacheControl}`,l["content-type"]=a.contentType,h&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(h)))),i?.headers&&(l=Object.assign(Object.assign({},l),i.headers));const d=this._removeEmptyFolders(t),u=this._getFinalPath(d),f=yield(e=="PUT"?put:post)(this.fetch,`${this.url}/object/${u}`,o,Object.assign({headers:l},a?.duplex?{duplex:a.duplex}:{}));return{data:{path:d,id:f.Id,fullPath:f.Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(isStorageError(o))return{data:null,error:o};throw o}})}upload(e,t,n){return __awaiter$5(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,n)})}uploadToSignedUrl(e,t,n,i){return __awaiter$5(this,void 0,void 0,function*(){const o=this._removeEmptyFolders(e),a=this._getFinalPath(o),l=new URL(this.url+`/object/upload/sign/${a}`);l.searchParams.set("token",t);try{let h;const d=Object.assign({upsert:DEFAULT_FILE_OPTIONS.upsert},i),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&n instanceof Blob?(h=new FormData,h.append("cacheControl",d.cacheControl),h.append("",n)):typeof FormData<"u"&&n instanceof FormData?(h=n,h.append("cacheControl",d.cacheControl)):(h=n,u["cache-control"]=`max-age=${d.cacheControl}`,u["content-type"]=d.contentType);const f=yield put(this.fetch,l.toString(),h,{headers:u});return{data:{path:o,fullPath:f.Key},error:null}}catch(h){if(this.shouldThrowOnError)throw h;if(isStorageError(h))return{data:null,error:h};throw h}})}createSignedUploadUrl(e,t){return __awaiter$5(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e);const i=Object.assign({},this.headers);t?.upsert&&(i["x-upsert"]="true");const o=yield post(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:i}),a=new URL(this.url+o.url),l=a.searchParams.get("token");if(!l)throw new StorageError("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:l},error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(isStorageError(n))return{data:null,error:n};throw n}})}update(e,t,n){return __awaiter$5(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,n)})}move(e,t,n){return __awaiter$5(this,void 0,void 0,function*(){try{return{data:yield post(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n?.destinationBucket},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(isStorageError(i))return{data:null,error:i};throw i}})}copy(e,t,n){return __awaiter$5(this,void 0,void 0,function*(){try{return{data:{path:(yield post(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(isStorageError(i))return{data:null,error:i};throw i}})}createSignedUrl(e,t,n){return __awaiter$5(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),o=yield post(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:t},n?.transform?{transform:n.transform}:{}),{headers:this.headers});const a=n?.download?`&download=${n.download===!0?"":n.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${a}`)},{data:o,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(isStorageError(i))return{data:null,error:i};throw i}})}createSignedUrls(e,t,n){return __awaiter$5(this,void 0,void 0,function*(){try{const i=yield post(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),o=n?.download?`&download=${n.download===!0?"":n.download}`:"";return{data:i.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${o}`):null})),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(isStorageError(i))return{data:null,error:i};throw i}})}download(e,t){const i=typeof t?.transform<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString(t?.transform||{}),a=o?`?${o}`:"",l=this._getFinalPath(e),h=()=>get(this.fetch,`${this.url}/${i}/${l}${a}`,{headers:this.headers,noResolveJson:!0});return new BlobDownloadBuilder(h,this.shouldThrowOnError)}info(e){return __awaiter$5(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const n=yield get(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:recursiveToCamel(n),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(isStorageError(n))return{data:null,error:n};throw n}})}exists(e){return __awaiter$5(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield head(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(isStorageError(n)&&n instanceof StorageUnknownError){const i=n.originalError;if([400,404].includes(i?.status))return{data:!1,error:n}}throw n}})}getPublicUrl(e,t){const n=this._getFinalPath(e),i=[],o=t?.download?`download=${t.download===!0?"":t.download}`:"";o!==""&&i.push(o);const l=typeof t?.transform<"u"?"render/image":"object",h=this.transformOptsToQueryString(t?.transform||{});h!==""&&i.push(h);let d=i.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${n}${d}`)}}}remove(e){return __awaiter$5(this,void 0,void 0,function*(){try{return{data:yield remove(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(isStorageError(t))return{data:null,error:t};throw t}})}list(e,t,n){return __awaiter$5(this,void 0,void 0,function*(){try{const i=Object.assign(Object.assign(Object.assign({},DEFAULT_SEARCH_OPTIONS),t),{prefix:e||""});return{data:yield post(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},n),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(isStorageError(i))return{data:null,error:i};throw i}})}listV2(e,t){return __awaiter$5(this,void 0,void 0,function*(){try{const n=Object.assign({},e);return{data:yield post(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,n,{headers:this.headers},t),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(isStorageError(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const version$3="2.74.0",DEFAULT_HEADERS$2={"X-Client-Info":`storage-js/${version$3}`};var __awaiter$4=function(s,e,t,n){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function l(u){try{d(n.next(u))}catch(f){a(f)}}function h(u){try{d(n.throw(u))}catch(f){a(f)}}function d(u){u.done?o(u.value):i(u.value).then(l,h)}d((n=n.apply(s,e||[])).next())})};class StorageBucketApi{constructor(e,t={},n,i){this.shouldThrowOnError=!1;const o=new URL(e);i?.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},DEFAULT_HEADERS$2),t),this.fetch=resolveFetch$2(n)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(){return __awaiter$4(this,void 0,void 0,function*(){try{return{data:yield get(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(isStorageError(e))return{data:null,error:e};throw e}})}getBucket(e){return __awaiter$4(this,void 0,void 0,function*(){try{return{data:yield get(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(isStorageError(t))return{data:null,error:t};throw t}})}createBucket(e){return __awaiter$4(this,arguments,void 0,function*(t,n={public:!1}){try{return{data:yield post(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(isStorageError(i))return{data:null,error:i};throw i}})}updateBucket(e,t){return __awaiter$4(this,void 0,void 0,function*(){try{return{data:yield put(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(this.shouldThrowOnError)throw n;if(isStorageError(n))return{data:null,error:n};throw n}})}emptyBucket(e){return __awaiter$4(this,void 0,void 0,function*(){try{return{data:yield post(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(isStorageError(t))return{data:null,error:t};throw t}})}deleteBucket(e){return __awaiter$4(this,void 0,void 0,function*(){try{return{data:yield remove(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(isStorageError(t))return{data:null,error:t};throw t}})}}class StorageClient extends StorageBucketApi{constructor(e,t={},n,i){super(e,t,n,i)}from(e){return new StorageFileApi(this.url,this.headers,e,this.fetch)}}const version$2="2.74.0";let JS_ENV="";typeof Deno<"u"?JS_ENV="deno":typeof document<"u"?JS_ENV="web":typeof navigator<"u"&&navigator.product==="ReactNative"?JS_ENV="react-native":JS_ENV="node";const DEFAULT_HEADERS$1={"X-Client-Info":`supabase-js-${JS_ENV}/${version$2}`},DEFAULT_GLOBAL_OPTIONS={headers:DEFAULT_HEADERS$1},DEFAULT_DB_OPTIONS={schema:"public"},DEFAULT_AUTH_OPTIONS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},DEFAULT_REALTIME_OPTIONS={};var __awaiter$3=function(s,e,t,n){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function l(u){try{d(n.next(u))}catch(f){a(f)}}function h(u){try{d(n.throw(u))}catch(f){a(f)}}function d(u){u.done?o(u.value):i(u.value).then(l,h)}d((n=n.apply(s,e||[])).next())})};const resolveFetch$1=s=>{let e;return s?e=s:typeof fetch>"u"?e=nodeFetch:e=fetch,(...t)=>e(...t)},resolveHeadersConstructor=()=>typeof Headers>"u"?Headers$1:Headers,fetchWithAuth=(s,e,t)=>{const n=resolveFetch$1(t),i=resolveHeadersConstructor();return(o,a)=>__awaiter$3(void 0,void 0,void 0,function*(){var l;const h=(l=yield e())!==null&&l!==void 0?l:s;let d=new i(a?.headers);return d.has("apikey")||d.set("apikey",s),d.has("Authorization")||d.set("Authorization",`Bearer ${h}`),n(o,Object.assign(Object.assign({},a),{headers:d}))})};var __awaiter$2=function(s,e,t,n){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function l(u){try{d(n.next(u))}catch(f){a(f)}}function h(u){try{d(n.throw(u))}catch(f){a(f)}}function d(u){u.done?o(u.value):i(u.value).then(l,h)}d((n=n.apply(s,e||[])).next())})};function ensureTrailingSlash(s){return s.endsWith("/")?s:s+"/"}function applySettingDefaults(s,e){var t,n;const{db:i,auth:o,realtime:a,global:l}=s,{db:h,auth:d,realtime:u,global:f}=e,m={db:Object.assign(Object.assign({},h),i),auth:Object.assign(Object.assign({},d),o),realtime:Object.assign(Object.assign({},u),a),storage:{},global:Object.assign(Object.assign(Object.assign({},f),l),{headers:Object.assign(Object.assign({},(t=f?.headers)!==null&&t!==void 0?t:{}),(n=l?.headers)!==null&&n!==void 0?n:{})}),accessToken:()=>__awaiter$2(this,void 0,void 0,function*(){return""})};return s.accessToken?m.accessToken=s.accessToken:delete m.accessToken,m}function validateSupabaseUrl(s){const e=s?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(ensureTrailingSlash(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const version$1="2.74.0",AUTO_REFRESH_TICK_DURATION_MS=30*1e3,AUTO_REFRESH_TICK_THRESHOLD=3,EXPIRY_MARGIN_MS=AUTO_REFRESH_TICK_THRESHOLD*AUTO_REFRESH_TICK_DURATION_MS,GOTRUE_URL="http://localhost:9999",STORAGE_KEY="supabase.auth.token",DEFAULT_HEADERS={"X-Client-Info":`gotrue-js/${version$1}`},API_VERSION_HEADER_NAME="X-Supabase-Api-Version",API_VERSIONS={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},BASE64URL_REGEX=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,JWKS_TTL=600*1e3;class AuthError extends Error{constructor(e,t,n){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=n}}function isAuthError(s){return typeof s=="object"&&s!==null&&"__isAuthError"in s}class AuthApiError extends AuthError{constructor(e,t,n){super(e,t,n),this.name="AuthApiError",this.status=t,this.code=n}}function isAuthApiError(s){return isAuthError(s)&&s.name==="AuthApiError"}class AuthUnknownError extends AuthError{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class CustomAuthError extends AuthError{constructor(e,t,n,i){super(e,n,i),this.name=t,this.status=n}}class AuthSessionMissingError extends CustomAuthError{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function isAuthSessionMissingError(s){return isAuthError(s)&&s.name==="AuthSessionMissingError"}class AuthInvalidTokenResponseError extends CustomAuthError{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class AuthInvalidCredentialsError extends CustomAuthError{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class AuthImplicitGrantRedirectError extends CustomAuthError{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function isAuthImplicitGrantRedirectError(s){return isAuthError(s)&&s.name==="AuthImplicitGrantRedirectError"}class AuthPKCEGrantCodeExchangeError extends CustomAuthError{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class AuthRetryableFetchError extends CustomAuthError{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function isAuthRetryableFetchError(s){return isAuthError(s)&&s.name==="AuthRetryableFetchError"}class AuthWeakPasswordError extends CustomAuthError{constructor(e,t,n){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=n}}class AuthInvalidJwtError extends CustomAuthError{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const TO_BASE64URL="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),IGNORE_BASE64URL=` 	
\r=`.split(""),FROM_BASE64URL=(()=>{const s=new Array(128);for(let e=0;e<s.length;e+=1)s[e]=-1;for(let e=0;e<IGNORE_BASE64URL.length;e+=1)s[IGNORE_BASE64URL[e].charCodeAt(0)]=-2;for(let e=0;e<TO_BASE64URL.length;e+=1)s[TO_BASE64URL[e].charCodeAt(0)]=e;return s})();function byteToBase64URL(s,e,t){if(s!==null)for(e.queue=e.queue<<8|s,e.queuedBits+=8;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(TO_BASE64URL[n]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const n=e.queue>>e.queuedBits-6&63;t(TO_BASE64URL[n]),e.queuedBits-=6}}function byteFromBase64URL(s,e,t){const n=FROM_BASE64URL[s];if(n>-1)for(e.queue=e.queue<<6|n,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(s)}"`)}}function stringFromBase64URL(s){const e=[],t=a=>{e.push(String.fromCodePoint(a))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},o=a=>{stringFromUTF8(a,n,t)};for(let a=0;a<s.length;a+=1)byteFromBase64URL(s.charCodeAt(a),i,o);return e.join("")}function codepointToUTF8(s,e){if(s<=127){e(s);return}else if(s<=2047){e(192|s>>6),e(128|s&63);return}else if(s<=65535){e(224|s>>12),e(128|s>>6&63),e(128|s&63);return}else if(s<=1114111){e(240|s>>18),e(128|s>>12&63),e(128|s>>6&63),e(128|s&63);return}throw new Error(`Unrecognized Unicode codepoint: ${s.toString(16)}`)}function stringToUTF8(s,e){for(let t=0;t<s.length;t+=1){let n=s.charCodeAt(t);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(s.charCodeAt(t+1)-56320&65535|i)+65536,t+=1}codepointToUTF8(n,e)}}function stringFromUTF8(s,e,t){if(e.utf8seq===0){if(s<=127){t(s);return}for(let n=1;n<6;n+=1)if((s>>7-n&1)===0){e.utf8seq=n;break}if(e.utf8seq===2)e.codepoint=s&31;else if(e.utf8seq===3)e.codepoint=s&15;else if(e.utf8seq===4)e.codepoint=s&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(s<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|s&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function base64UrlToUint8Array(s){const e=[],t={queue:0,queuedBits:0},n=i=>{e.push(i)};for(let i=0;i<s.length;i+=1)byteFromBase64URL(s.charCodeAt(i),t,n);return new Uint8Array(e)}function stringToUint8Array(s){const e=[];return stringToUTF8(s,t=>e.push(t)),new Uint8Array(e)}function bytesToBase64URL(s){const e=[],t={queue:0,queuedBits:0},n=i=>{e.push(i)};return s.forEach(i=>byteToBase64URL(i,t,n)),byteToBase64URL(null,t,n),e.join("")}function expiresAt(s){return Math.round(Date.now()/1e3)+s}function uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){const e=Math.random()*16|0;return(s=="x"?e:e&3|8).toString(16)})}const isBrowser$2=()=>typeof window<"u"&&typeof document<"u",localStorageWriteTests={tested:!1,writable:!1},supportsLocalStorage=()=>{if(!isBrowser$2())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(localStorageWriteTests.tested)return localStorageWriteTests.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),localStorageWriteTests.tested=!0,localStorageWriteTests.writable=!0}catch{localStorageWriteTests.tested=!0,localStorageWriteTests.writable=!1}return localStorageWriteTests.writable};function parseParametersFromURL(s){const e={},t=new URL(s);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((i,o)=>{e[o]=i})}catch{}return t.searchParams.forEach((n,i)=>{e[i]=n}),e}const resolveFetch=s=>{let e;return s?e=s:typeof fetch>"u"?e=(...t)=>__vitePreload(async()=>{const{default:n}=await Promise.resolve().then(()=>browser);return{default:n}},void 0).then(({default:n})=>n(...t)):e=fetch,(...t)=>e(...t)},looksLikeFetchResponse=s=>typeof s=="object"&&s!==null&&"status"in s&&"ok"in s&&"json"in s&&typeof s.json=="function",setItemAsync=async(s,e,t)=>{await s.setItem(e,JSON.stringify(t))},getItemAsync=async(s,e)=>{const t=await s.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},removeItemAsync=async(s,e)=>{await s.removeItem(e)};class Deferred{constructor(){this.promise=new Deferred.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Deferred.promiseConstructor=Promise;function decodeJWT(s){const e=s.split(".");if(e.length!==3)throw new AuthInvalidJwtError("Invalid JWT structure");for(let n=0;n<e.length;n++)if(!BASE64URL_REGEX.test(e[n]))throw new AuthInvalidJwtError("JWT not in base64url format");return{header:JSON.parse(stringFromBase64URL(e[0])),payload:JSON.parse(stringFromBase64URL(e[1])),signature:base64UrlToUint8Array(e[2]),raw:{header:e[0],payload:e[1]}}}async function sleep(s){return await new Promise(e=>{setTimeout(()=>e(null),s)})}function retryable(s,e){return new Promise((n,i)=>{(async()=>{for(let o=0;o<1/0;o++)try{const a=await s(o);if(!e(o,null,a)){n(a);return}}catch(a){if(!e(o,a)){i(a);return}}})()})}function dec2hex(s){return("0"+s.toString(16)).substr(-2)}function generatePKCEVerifier(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=t.length;let i="";for(let o=0;o<56;o++)i+=t.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(e),Array.from(e,dec2hex).join("")}async function sha256(s){const t=new TextEncoder().encode(s),n=await crypto.subtle.digest("SHA-256",t),i=new Uint8Array(n);return Array.from(i).map(o=>String.fromCharCode(o)).join("")}async function generatePKCEChallenge(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),s;const t=await sha256(s);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function getCodeChallengeAndMethod(s,e,t=!1){const n=generatePKCEVerifier();let i=n;t&&(i+="/PASSWORD_RECOVERY"),await setItemAsync(s,`${e}-code-verifier`,i);const o=await generatePKCEChallenge(n);return[o,n===o?"plain":"s256"]}const API_VERSION_REGEX=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function parseResponseAPIVersion(s){const e=s.headers.get(API_VERSION_HEADER_NAME);if(!e||!e.match(API_VERSION_REGEX))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function validateExp(s){if(!s)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(s<=e)throw new Error("JWT has expired")}function getAlgorithm(s){switch(s){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const UUID_REGEX=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function validateUUID(s){if(!UUID_REGEX.test(s))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function userNotAvailableProxy(){const s={};return new Proxy(s,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const n=t.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function deepClone(s){return JSON.parse(JSON.stringify(s))}var __rest$4=function(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(s);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(s,n[i])&&(t[n[i]]=s[n[i]]);return t};const _getErrorMessage=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),NETWORK_ERROR_CODES=[502,503,504];async function handleError(s){var e;if(!looksLikeFetchResponse(s))throw new AuthRetryableFetchError(_getErrorMessage(s),0);if(NETWORK_ERROR_CODES.includes(s.status))throw new AuthRetryableFetchError(_getErrorMessage(s),s.status);let t;try{t=await s.json()}catch(o){throw new AuthUnknownError(_getErrorMessage(o),o)}let n;const i=parseResponseAPIVersion(s);if(i&&i.getTime()>=API_VERSIONS["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?n=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(n=t.error_code),n){if(n==="weak_password")throw new AuthWeakPasswordError(_getErrorMessage(t),s.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(n==="session_not_found")throw new AuthSessionMissingError}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((o,a)=>o&&typeof a=="string",!0))throw new AuthWeakPasswordError(_getErrorMessage(t),s.status,t.weak_password.reasons);throw new AuthApiError(_getErrorMessage(t),s.status||500,n)}const _getRequestParams=(s,e,t,n)=>{const i={method:s,headers:e?.headers||{}};return s==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),t))};async function _request(s,e,t,n){var i;const o=Object.assign({},n?.headers);o[API_VERSION_HEADER_NAME]||(o[API_VERSION_HEADER_NAME]=API_VERSIONS["2024-01-01"].name),n?.jwt&&(o.Authorization=`Bearer ${n.jwt}`);const a=(i=n?.query)!==null&&i!==void 0?i:{};n?.redirectTo&&(a.redirect_to=n.redirectTo);const l=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",h=await _handleRequest(s,e,t+l,{headers:o,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(h):{data:Object.assign({},h),error:null}}async function _handleRequest(s,e,t,n,i,o){const a=_getRequestParams(e,n,i,o);let l;try{l=await s(t,Object.assign({},a))}catch(h){throw console.error(h),new AuthRetryableFetchError(_getErrorMessage(h),0)}if(l.ok||await handleError(l),n?.noResolveJson)return l;try{return await l.json()}catch(h){await handleError(h)}}function _sessionResponse(s){var e;let t=null;hasSession(s)&&(t=Object.assign({},s),s.expires_at||(t.expires_at=expiresAt(s.expires_in)));const n=(e=s.user)!==null&&e!==void 0?e:s;return{data:{session:t,user:n},error:null}}function _sessionResponsePassword(s){const e=_sessionResponse(s);return!e.error&&s.weak_password&&typeof s.weak_password=="object"&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&typeof s.weak_password.message=="string"&&s.weak_password.reasons.reduce((t,n)=>t&&typeof n=="string",!0)&&(e.data.weak_password=s.weak_password),e}function _userResponse(s){var e;return{data:{user:(e=s.user)!==null&&e!==void 0?e:s},error:null}}function _ssoResponse(s){return{data:s,error:null}}function _generateLinkResponse(s){const{action_link:e,email_otp:t,hashed_token:n,redirect_to:i,verification_type:o}=s,a=__rest$4(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:n,redirect_to:i,verification_type:o},h=Object.assign({},a);return{data:{properties:l,user:h},error:null}}function _noResolveJsonResponse(s){return s}function hasSession(s){return s.access_token&&s.refresh_token&&s.expires_in}const SIGN_OUT_SCOPES=["global","local","others"];var __rest$3=function(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(s);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(s,n[i])&&(t[n[i]]=s[n[i]]);return t};class GoTrueAdminApi{constructor({url:e="",headers:t={},fetch:n}){this.url=e,this.headers=t,this.fetch=resolveFetch(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=SIGN_OUT_SCOPES[0]){if(SIGN_OUT_SCOPES.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${SIGN_OUT_SCOPES.join(", ")}`);try{return await _request(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(n){if(isAuthError(n))return{data:null,error:n};throw n}}async inviteUserByEmail(e,t={}){try{return await _request(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:_userResponse})}catch(n){if(isAuthError(n))return{data:{user:null},error:n};throw n}}async generateLink(e){try{const{options:t}=e,n=__rest$3(e,["options"]),i=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(i.new_email=n?.newEmail,delete i.newEmail),await _request(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:_generateLinkResponse,redirectTo:t?.redirectTo})}catch(t){if(isAuthError(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await _request(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:_userResponse})}catch(t){if(isAuthError(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,n,i,o,a,l,h;try{const d={nextPage:null,lastPage:0,total:0},u=await _request(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(o=(i=e?.perPage)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""},xform:_noResolveJsonResponse});if(u.error)throw u.error;const f=await u.json(),m=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,v=(h=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&h!==void 0?h:[];return v.length>0&&(v.forEach(g=>{const x=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(g.split(";")[1].split("=")[1]);d[`${E}Page`]=x}),d.total=parseInt(m)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(isAuthError(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){validateUUID(e);try{return await _request(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:_userResponse})}catch(t){if(isAuthError(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){validateUUID(e);try{return await _request(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:_userResponse})}catch(n){if(isAuthError(n))return{data:{user:null},error:n};throw n}}async deleteUser(e,t=!1){validateUUID(e);try{return await _request(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:_userResponse})}catch(n){if(isAuthError(n))return{data:{user:null},error:n};throw n}}async _listFactors(e){validateUUID(e.userId);try{const{data:t,error:n}=await _request(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:t,error:n}}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}}async _deleteFactor(e){validateUUID(e.userId),validateUUID(e.id);try{return{data:await _request(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,n,i,o,a,l,h;try{const d={nextPage:null,lastPage:0,total:0},u=await _request(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:"",per_page:(o=(i=e?.perPage)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""},xform:_noResolveJsonResponse});if(u.error)throw u.error;const f=await u.json(),m=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,v=(h=(l=u.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&h!==void 0?h:[];return v.length>0&&(v.forEach(g=>{const x=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(g.split(";")[1].split("=")[1]);d[`${E}Page`]=x}),d.total=parseInt(m)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(isAuthError(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(e){try{return await _request(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await _request(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}}async _deleteOAuthClient(e){try{return await _request(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await _request(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}}}function memoryLocalStorageAdapter(s={}){return{getItem:e=>s[e]||null,setItem:(e,t)=>{s[e]=t},removeItem:e=>{delete s[e]}}}const internals={debug:!!(globalThis&&supportsLocalStorage()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class LockAcquireTimeoutError extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class NavigatorLockAcquireTimeoutError extends LockAcquireTimeoutError{}async function navigatorLock(s,e,t){internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",s,e);const n=new globalThis.AbortController;return e>0&&setTimeout(()=>{n.abort(),internals.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",s)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(s,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",s,i.name);try{return await t()}finally{internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",s,i.name)}}else{if(e===0)throw internals.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",s),new NavigatorLockAcquireTimeoutError(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if(internals.debug)try{const o=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function polyfillGlobalThis(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function getAddress(s){if(!/^0x[a-fA-F0-9]{40}$/.test(s))throw new Error(`@supabase/auth-js: Address "${s}" is invalid.`);return s.toLowerCase()}function fromHex(s){return parseInt(s,16)}function toHex(s){const e=new TextEncoder().encode(s);return"0x"+Array.from(e,n=>n.toString(16).padStart(2,"0")).join("")}function createSiweMessage(s){var e;const{chainId:t,domain:n,expirationTime:i,issuedAt:o=new Date,nonce:a,notBefore:l,requestId:h,resources:d,scheme:u,uri:f,version:m}=s;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(a&&a.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${a}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(m!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${m}`);if(!((e=s.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${s.statement}`)}const v=getAddress(s.address),g=u?`${u}://${n}`:n,x=s.statement?`${s.statement}
`:"",E=`${g} wants you to sign in with your Ethereum account:
${v}

${x}`;let b=`URI: ${f}
Version: ${m}
Chain ID: ${t}${a?`
Nonce: ${a}`:""}
Issued At: ${o.toISOString()}`;if(i&&(b+=`
Expiration Time: ${i.toISOString()}`),l&&(b+=`
Not Before: ${l.toISOString()}`),h&&(b+=`
Request ID: ${h}`),d){let _=`
Resources:`;for(const S of d){if(!S||typeof S!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${S}`);_+=`
- ${S}`}b+=_}return`${E}
${b}`}class WebAuthnError extends Error{constructor({message:e,code:t,cause:n,name:i}){var o;super(e,{cause:n}),this.__isWebAuthnError=!0,this.name=(o=i??(n instanceof Error?n.name:void 0))!==null&&o!==void 0?o:"Unknown Error",this.code=t}}class WebAuthnUnknownError extends WebAuthnError{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function identifyRegistrationError({error:s,options:e}){var t,n,i;const{publicKey:o}=e;if(!o)throw Error("options was missing required publicKey property");if(s.name==="AbortError"){if(e.signal instanceof AbortSignal)return new WebAuthnError({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:s})}else if(s.name==="ConstraintError"){if(((t=o.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new WebAuthnError({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:s});if(e.mediation==="conditional"&&((n=o.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new WebAuthnError({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:s});if(((i=o.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new WebAuthnError({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:s})}else{if(s.name==="InvalidStateError")return new WebAuthnError({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:s});if(s.name==="NotAllowedError")return new WebAuthnError({message:s.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s});if(s.name==="NotSupportedError")return o.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new WebAuthnError({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:s}):new WebAuthnError({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:s});if(s.name==="SecurityError"){const a=window.location.hostname;if(isValidDomain(a)){if(o.rp.id!==a)return new WebAuthnError({message:`The RP ID "${o.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:s})}else return new WebAuthnError({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:s})}else if(s.name==="TypeError"){if(o.user.id.byteLength<1||o.user.id.byteLength>64)return new WebAuthnError({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:s})}else if(s.name==="UnknownError")return new WebAuthnError({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:s})}return new WebAuthnError({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s})}function identifyAuthenticationError({error:s,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(s.name==="AbortError"){if(e.signal instanceof AbortSignal)return new WebAuthnError({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:s})}else{if(s.name==="NotAllowedError")return new WebAuthnError({message:s.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s});if(s.name==="SecurityError"){const n=window.location.hostname;if(isValidDomain(n)){if(t.rpId!==n)return new WebAuthnError({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:s})}else return new WebAuthnError({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:s})}else if(s.name==="UnknownError")return new WebAuthnError({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:s})}return new WebAuthnError({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:s})}var __rest$2=function(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(s);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(s,n[i])&&(t[n[i]]=s[n[i]]);return t};class WebAuthnAbortService{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const webAuthnAbortService=new WebAuthnAbortService;function deserializeCredentialCreationOptions(s){if(!s)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(s);const{challenge:e,user:t,excludeCredentials:n}=s,i=__rest$2(s,["challenge","user","excludeCredentials"]),o=base64UrlToUint8Array(e).buffer,a=Object.assign(Object.assign({},t),{id:base64UrlToUint8Array(t.id).buffer}),l=Object.assign(Object.assign({},i),{challenge:o,user:a});if(n&&n.length>0){l.excludeCredentials=new Array(n.length);for(let h=0;h<n.length;h++){const d=n[h];l.excludeCredentials[h]=Object.assign(Object.assign({},d),{id:base64UrlToUint8Array(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function deserializeCredentialRequestOptions(s){if(!s)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(s);const{challenge:e,allowCredentials:t}=s,n=__rest$2(s,["challenge","allowCredentials"]),i=base64UrlToUint8Array(e).buffer,o=Object.assign(Object.assign({},n),{challenge:i});if(t&&t.length>0){o.allowCredentials=new Array(t.length);for(let a=0;a<t.length;a++){const l=t[a];o.allowCredentials[a]=Object.assign(Object.assign({},l),{id:base64UrlToUint8Array(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return o}function serializeCredentialCreationResponse(s){var e;if("toJSON"in s&&typeof s.toJSON=="function")return s.toJSON();const t=s;return{id:s.id,rawId:s.id,response:{attestationObject:bytesToBase64URL(new Uint8Array(s.response.attestationObject)),clientDataJSON:bytesToBase64URL(new Uint8Array(s.response.clientDataJSON))},type:"public-key",clientExtensionResults:s.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function serializeCredentialRequestResponse(s){var e;if("toJSON"in s&&typeof s.toJSON=="function")return s.toJSON();const t=s,n=s.getClientExtensionResults(),i=s.response;return{id:s.id,rawId:s.id,response:{authenticatorData:bytesToBase64URL(new Uint8Array(i.authenticatorData)),clientDataJSON:bytesToBase64URL(new Uint8Array(i.clientDataJSON)),signature:bytesToBase64URL(new Uint8Array(i.signature)),userHandle:i.userHandle?bytesToBase64URL(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function isValidDomain(s){return s==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(s)}function browserSupportsWebAuthn(){var s,e;return!!(isBrowser$2()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((s=navigator?.credentials)===null||s===void 0?void 0:s.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function createCredential(s){try{const e=await navigator.credentials.create(s);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new WebAuthnUnknownError("Browser returned unexpected credential type",e)}:{data:null,error:new WebAuthnUnknownError("Empty credential response",e)}}catch(e){return{data:null,error:identifyRegistrationError({error:e,options:s})}}}async function getCredential(s){try{const e=await navigator.credentials.get(s);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new WebAuthnUnknownError("Browser returned unexpected credential type",e)}:{data:null,error:new WebAuthnUnknownError("Empty credential response",e)}}catch(e){return{data:null,error:identifyAuthenticationError({error:e,options:s})}}}const DEFAULT_CREATION_OPTIONS={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},DEFAULT_REQUEST_OPTIONS={userVerification:"preferred",hints:["security-key"]};function deepMerge(...s){const e=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),t=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),n={};for(const i of s)if(i)for(const o in i){const a=i[o];if(a!==void 0)if(Array.isArray(a))n[o]=a;else if(t(a))n[o]=a;else if(e(a)){const l=n[o];e(l)?n[o]=deepMerge(l,a):n[o]=deepMerge(a)}else n[o]=a}return n}function mergeCredentialCreationOptions(s,e){return deepMerge(DEFAULT_CREATION_OPTIONS,s,e||{})}function mergeCredentialRequestOptions(s,e){return deepMerge(DEFAULT_REQUEST_OPTIONS,s,e||{})}class WebAuthnApi{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:n,signal:i},o){try{const{data:a,error:l}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!a)return{data:null,error:l};const h=i??webAuthnAbortService.createNewAbortSignal();if(a.webauthn.type==="create"){const{user:d}=a.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${n}`),d.displayName||(d.displayName=d.name)}switch(a.webauthn.type){case"create":{const d=mergeCredentialCreationOptions(a.webauthn.credential_options.publicKey,o?.create),{data:u,error:f}=await createCredential({publicKey:d,signal:h});return u?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:u}},error:null}:{data:null,error:f}}case"request":{const d=mergeCredentialRequestOptions(a.webauthn.credential_options.publicKey,o?.request),{data:u,error:f}=await getCredential(Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:d,signal:h}));return u?{data:{factorId:e,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:u}},error:null}:{data:null,error:f}}}}catch(a){return isAuthError(a)?{data:null,error:a}:{data:null,error:new AuthUnknownError("Unexpected error in challenge",a)}}}async _verify({challengeId:e,factorId:t,webauthn:n}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:n})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}},o){if(!t)return{data:null,error:new AuthError("rpId is required for WebAuthn authentication")};try{if(!browserSupportsWebAuthn())return{data:null,error:new AuthUnknownError("Browser does not support WebAuthn",null)};const{data:a,error:l}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:n},signal:i},{request:o});if(!a)return{data:null,error:l};const{webauthn:h}=a;return this._verify({factorId:e,challengeId:a.challengeId,webauthn:{type:h.type,rpId:t,rpOrigins:n,credential_response:h.credential_response}})}catch(a){return isAuthError(a)?{data:null,error:a}:{data:null,error:new AuthUnknownError("Unexpected error in authenticate",a)}}}async _register({friendlyName:e,rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i},o){if(!t)return{data:null,error:new AuthError("rpId is required for WebAuthn registration")};try{if(!browserSupportsWebAuthn())return{data:null,error:new AuthUnknownError("Browser does not support WebAuthn",null)};const{data:a,error:l}=await this._enroll({friendlyName:e});if(!a)return await this.client.mfa.listFactors().then(u=>{var f;return(f=u.data)===null||f===void 0?void 0:f.all.find(m=>m.factor_type==="webauthn"&&m.friendly_name===e&&m.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u?.id}):void 0),{data:null,error:l};const{data:h,error:d}=await this._challenge({factorId:a.id,friendlyName:a.friendly_name,webauthn:{rpId:t,rpOrigins:n},signal:i},{create:o});return h?this._verify({factorId:a.id,challengeId:h.challengeId,webauthn:{rpId:t,rpOrigins:n,type:h.webauthn.type,credential_response:h.webauthn.credential_response}}):{data:null,error:d}}catch(a){return isAuthError(a)?{data:null,error:a}:{data:null,error:new AuthUnknownError("Unexpected error in register",a)}}}}polyfillGlobalThis();const DEFAULT_OPTIONS={url:GOTRUE_URL,storageKey:STORAGE_KEY,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:DEFAULT_HEADERS,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function lockNoOp(s,e,t){return await t()}const GLOBAL_JWKS={};class GoTrueClient{get jwks(){var e,t;return(t=(e=GLOBAL_JWKS[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){GLOBAL_JWKS[this.storageKey]=Object.assign(Object.assign({},GLOBAL_JWKS[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=GLOBAL_JWKS[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){GLOBAL_JWKS[this.storageKey]=Object.assign(Object.assign({},GLOBAL_JWKS[this.storageKey]),{cachedAt:e})}constructor(e){var t,n;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=GoTrueClient.nextInstanceID,GoTrueClient.nextInstanceID+=1,this.instanceID>0&&isBrowser$2()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const i=Object.assign(Object.assign({},DEFAULT_OPTIONS),e);if(this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new GoTrueAdminApi({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=resolveFetch(i.fetch),this.lock=i.lock||lockNoOp,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,i.lock?this.lock=i.lock:isBrowser$2()&&(!((t=globalThis?.navigator)===null||t===void 0)&&t.locks)?this.lock=navigatorLock:this.lock=lockNoOp,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new WebAuthnApi(this)},this.persistSession?(i.storage?this.storage=i.storage:supportsLocalStorage()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=memoryLocalStorageAdapter(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=memoryLocalStorageAdapter(this.memoryStorage)),isBrowser$2()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${version$1}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=parseParametersFromURL(window.location.href);let n="none";if(this._isImplicitGrantCallback(t)?n="implicit":await this._isPKCECallback(t)&&(n="pkce"),isBrowser$2()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:o}=await this._getSessionFromURL(t,n);if(o){if(this._debug("#_initialize()","error detecting session from URL",o),isAuthImplicitGrantRedirectError(o)){const h=(e=o.details)===null||e===void 0?void 0:e.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:o}}return await this._removeSession(),{error:o}}const{session:a,redirectType:l}=i;return this._debug("#_initialize()","detected session in URL",a,"redirect type",l),await this._saveSession(a),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return isAuthError(t)?{error:t}:{error:new AuthUnknownError("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,n,i;try{const o=await _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=e?.options)===null||i===void 0?void 0:i.captchaToken}},xform:_sessionResponse}),{data:a,error:l}=o;if(l||!a)return{data:{user:null,session:null},error:l};const h=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",h)),{data:{user:d,session:h},error:null}}catch(o){if(isAuthError(o))return{data:{user:null,session:null},error:o};throw o}}async signUp(e){var t,n,i;try{let o;if("email"in e){const{email:u,password:f,options:m}=e;let v=null,g=null;this.flowType==="pkce"&&([v,g]=await getCodeChallengeAndMethod(this.storage,this.storageKey)),o=await _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:m?.emailRedirectTo,body:{email:u,password:f,data:(t=m?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:m?.captchaToken},code_challenge:v,code_challenge_method:g},xform:_sessionResponse})}else if("phone"in e){const{phone:u,password:f,options:m}=e;o=await _request(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:f,data:(n=m?.data)!==null&&n!==void 0?n:{},channel:(i=m?.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:m?.captchaToken}},xform:_sessionResponse})}else throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a password");const{data:a,error:l}=o;if(l||!a)return{data:{user:null,session:null},error:l};const h=a.session,d=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",h)),{data:{user:d,session:h},error:null}}catch(o){if(isAuthError(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithPassword(e){try{let t;if("email"in e){const{email:o,password:a,options:l}=e;t=await _request(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:o,password:a,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:_sessionResponsePassword})}else if("phone"in e){const{phone:o,password:a,options:l}=e;t=await _request(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:o,password:a,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:_sessionResponsePassword})}else throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a password");const{data:n,error:i}=t;return i?{data:{user:null,session:null},error:i}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(t){if(isAuthError(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,n,i,o;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(n=e.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=e.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(o=e.options)===null||o===void 0?void 0:o.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,n,i,o,a,l,h,d,u,f,m;let v,g;if("message"in e)v=e.message,g=e.signature;else{const{chain:x,wallet:E,statement:b,options:_}=e;let S;if(isBrowser$2())if(typeof E=="object")S=E;else{const F=window;if("ethereum"in F&&typeof F.ethereum=="object"&&"request"in F.ethereum&&typeof F.ethereum.request=="function")S=F.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof E!="object"||!_?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=E}const C=new URL((t=_?.url)!==null&&t!==void 0?t:window.location.href),A=await S.request({method:"eth_requestAccounts"}).then(F=>F).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!A||A.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const R=getAddress(A[0]);let L=(n=_?.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!L){const F=await S.request({method:"eth_chainId"});L=fromHex(F)}const j={domain:C.host,address:R,statement:b,uri:C.href,version:"1",chainId:L,nonce:(i=_?.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(a=(o=_?.signInWithEthereum)===null||o===void 0?void 0:o.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(l=_?.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(h=_?.signInWithEthereum)===null||h===void 0?void 0:h.notBefore,requestId:(d=_?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(u=_?.signInWithEthereum)===null||u===void 0?void 0:u.resources};v=createSiweMessage(j),g=await S.request({method:"personal_sign",params:[toHex(v),R]})}try{const{data:x,error:E}=await _request(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:v,signature:g},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(m=e.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:_sessionResponse});if(E)throw E;return!x||!x.session||!x.user?{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}:(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("SIGNED_IN",x.session)),{data:Object.assign({},x),error:E})}catch(x){if(isAuthError(x))return{data:{user:null,session:null},error:x};throw x}}async signInWithSolana(e){var t,n,i,o,a,l,h,d,u,f,m,v;let g,x;if("message"in e)g=e.message,x=e.signature;else{const{chain:E,wallet:b,statement:_,options:S}=e;let C;if(isBrowser$2())if(typeof b=="object")C=b;else{const R=window;if("solana"in R&&typeof R.solana=="object"&&("signIn"in R.solana&&typeof R.solana.signIn=="function"||"signMessage"in R.solana&&typeof R.solana.signMessage=="function"))C=R.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!S?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=b}const A=new URL((t=S?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in C&&C.signIn){const R=await C.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},S?.signInWithSolana),{version:"1",domain:A.host,uri:A.href}),_?{statement:_}:null));let L;if(Array.isArray(R)&&R[0]&&typeof R[0]=="object")L=R[0];else if(R&&typeof R=="object"&&"signedMessage"in R&&"signature"in R)L=R;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in L&&"signature"in L&&(typeof L.signedMessage=="string"||L.signedMessage instanceof Uint8Array)&&L.signature instanceof Uint8Array)g=typeof L.signedMessage=="string"?L.signedMessage:new TextDecoder().decode(L.signedMessage),x=L.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in C)||typeof C.signMessage!="function"||!("publicKey"in C)||typeof C!="object"||!C.publicKey||!("toBase58"in C.publicKey)||typeof C.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${A.host} wants you to sign in with your Solana account:`,C.publicKey.toBase58(),..._?["",_,""]:[""],"Version: 1",`URI: ${A.href}`,`Issued At: ${(i=(n=S?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((o=S?.signInWithSolana)===null||o===void 0)&&o.notBefore?[`Not Before: ${S.signInWithSolana.notBefore}`]:[],...!((a=S?.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${S.signInWithSolana.expirationTime}`]:[],...!((l=S?.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${S.signInWithSolana.chainId}`]:[],...!((h=S?.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${S.signInWithSolana.nonce}`]:[],...!((d=S?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${S.signInWithSolana.requestId}`]:[],...!((f=(u=S?.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||f===void 0)&&f.length?["Resources",...S.signInWithSolana.resources.map(L=>`- ${L}`)]:[]].join(`
`);const R=await C.signMessage(new TextEncoder().encode(g),"utf8");if(!R||!(R instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");x=R}}try{const{data:E,error:b}=await _request(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:bytesToBase64URL(x)},!((m=e.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(v=e.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:_sessionResponse});if(b)throw b;return!E||!E.session||!E.user?{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}:(E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("SIGNED_IN",E.session)),{data:Object.assign({},E),error:b})}catch(E){if(isAuthError(E))return{data:{user:null,session:null},error:E};throw E}}async _exchangeCodeForSession(e){const t=await getItemAsync(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(t??"").split("/");try{const{data:o,error:a}=await _request(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:n},xform:_sessionResponse});if(await removeItemAsync(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!o||!o.session||!o.user?{data:{user:null,session:null,redirectType:null},error:new AuthInvalidTokenResponseError}:(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:Object.assign(Object.assign({},o),{redirectType:i??null}),error:a})}catch(o){if(isAuthError(o))return{data:{user:null,session:null,redirectType:null},error:o};throw o}}async signInWithIdToken(e){try{const{options:t,provider:n,token:i,access_token:o,nonce:a}=e,l=await _request(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:o,nonce:a,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:_sessionResponse}),{data:h,error:d}=l;return d?{data:{user:null,session:null},error:d}:!h||!h.session||!h.user?{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}:(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),{data:h,error:d})}catch(t){if(isAuthError(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,n,i,o,a;try{if("email"in e){const{email:l,options:h}=e;let d=null,u=null;this.flowType==="pkce"&&([d,u]=await getCodeChallengeAndMethod(this.storage,this.storageKey));const{error:f}=await _request(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=h?.data)!==null&&t!==void 0?t:{},create_user:(n=h?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},code_challenge:d,code_challenge_method:u},redirectTo:h?.emailRedirectTo});return{data:{user:null,session:null},error:f}}if("phone"in e){const{phone:l,options:h}=e,{data:d,error:u}=await _request(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(i=h?.data)!==null&&i!==void 0?i:{},create_user:(o=h?.shouldCreateUser)!==null&&o!==void 0?o:!0,gotrue_meta_security:{captcha_token:h?.captchaToken},channel:(a=h?.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:d?.message_id},error:u}}throw new AuthInvalidCredentialsError("You must provide either an email or phone number.")}catch(l){if(isAuthError(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(e){var t,n;try{let i,o;"options"in e&&(i=(t=e.options)===null||t===void 0?void 0:t.redirectTo,o=(n=e.options)===null||n===void 0?void 0:n.captchaToken);const{data:a,error:l}=await _request(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:o}}),redirectTo:i,xform:_sessionResponse});if(l)throw l;if(!a)throw new Error("An error occurred on token verification.");const h=a.session,d=a.user;return h?.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),{data:{user:d,session:h},error:null}}catch(i){if(isAuthError(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithSSO(e){var t,n,i;try{let o=null,a=null;return this.flowType==="pkce"&&([o,a]=await getCodeChallengeAndMethod(this.storage,this.storageKey)),await _request(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(n=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=e?.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:a}),headers:this.headers,xform:_ssoResponse})}catch(o){if(isAuthError(o))return{data:null,error:o};throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:n}=e;if(n)throw n;if(!t)throw new AuthSessionMissingError;const{error:i}=await _request(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(isAuthError(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:n,type:i,options:o}=e,{error:a}=await _request(this.fetch,"POST",t,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:o?.captchaToken}},redirectTo:o?.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:n,type:i,options:o}=e,{data:a,error:l}=await _request(this.fetch,"POST",t,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:o?.captchaToken}}});return{data:{user:null,session:null,messageId:a?.message_id},error:l}}throw new AuthInvalidCredentialsError("You must provide either an email or phone number and a type")}catch(t){if(isAuthError(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await t()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=t();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await getItemAsync(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const n=e.expires_at?e.expires_at*1e3-Date.now()<EXPIRY_MARGIN_MS:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",e.expires_at),!n){if(this.userStorage){const a=await getItemAsync(this.userStorage,this.storageKey+"-user");a?.user?e.user=a.user:e.user=userNotAvailableProxy()}if(this.storage.isServer&&e.user){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(h,d,u)=>(!a&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(h,d,u))})}return{data:{session:e},error:null}}const{data:i,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{session:null},error:o}:{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await _request(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:_userResponse}):await this._useSession(async t=>{var n,i,o;const{data:a,error:l}=t;if(l)throw l;return!(!((n=a.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new AuthSessionMissingError}:await _request(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(o=(i=a.session)===null||i===void 0?void 0:i.access_token)!==null&&o!==void 0?o:void 0,xform:_userResponse})})}catch(t){if(isAuthError(t))return isAuthSessionMissingError(t)&&(await this._removeSession(),await removeItemAsync(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async n=>{const{data:i,error:o}=n;if(o)throw o;if(!i.session)throw new AuthSessionMissingError;const a=i.session;let l=null,h=null;this.flowType==="pkce"&&e.email!=null&&([l,h]=await getCodeChallengeAndMethod(this.storage,this.storageKey));const{data:d,error:u}=await _request(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:h}),jwt:a.access_token,xform:_userResponse});if(u)throw u;return a.user=d.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(n){if(isAuthError(n))return{data:{user:null},error:n};throw n}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new AuthSessionMissingError;const t=Date.now()/1e3;let n=t,i=!0,o=null;const{payload:a}=decodeJWT(e.access_token);if(a.exp&&(n=a.exp,i=n<=t),i){const{data:l,error:h}=await this._callRefreshToken(e.refresh_token);if(h)return{data:{user:null,session:null},error:h};if(!l)return{data:{user:null,session:null},error:null};o=l}else{const{data:l,error:h}=await this._getUser(e.access_token);if(h)throw h;o={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:n-t,expires_at:n},await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)}return{data:{user:o.user,session:o},error:null}}catch(t){if(isAuthError(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var n;if(!e){const{data:a,error:l}=t;if(l)throw l;e=(n=a.session)!==null&&n!==void 0?n:void 0}if(!e?.refresh_token)throw new AuthSessionMissingError;const{data:i,error:o}=await this._callRefreshToken(e.refresh_token);return o?{data:{user:null,session:null},error:o}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(isAuthError(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!isBrowser$2())throw new AuthImplicitGrantRedirectError("No browser detected.");if(e.error||e.error_description||e.error_code)throw new AuthImplicitGrantRedirectError(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new AuthPKCEGrantCodeExchangeError("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new AuthImplicitGrantRedirectError("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new AuthPKCEGrantCodeExchangeError("No code detected.");const{data:_,error:S}=await this._exchangeCodeForSession(e.code);if(S)throw S;const C=new URL(window.location.href);return C.searchParams.delete("code"),window.history.replaceState(window.history.state,"",C.toString()),{data:{session:_.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:o,refresh_token:a,expires_in:l,expires_at:h,token_type:d}=e;if(!o||!l||!a||!d)throw new AuthImplicitGrantRedirectError("No session defined in URL");const u=Math.round(Date.now()/1e3),f=parseInt(l);let m=u+f;h&&(m=parseInt(h));const v=m-u;v*1e3<=AUTO_REFRESH_TICK_DURATION_MS&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${v}s, should have been closer to ${f}s`);const g=m-f;u-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,m,u):u-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,m,u);const{data:x,error:E}=await this._getUser(o);if(E)throw E;const b={provider_token:n,provider_refresh_token:i,access_token:o,expires_in:f,expires_at:m,refresh_token:a,token_type:d,user:x.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:b,redirectType:e.type},error:null}}catch(n){if(isAuthError(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await getItemAsync(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var n;const{data:i,error:o}=t;if(o)return{error:o};const a=(n=i.session)===null||n===void 0?void 0:n.access_token;if(a){const{error:l}=await this.admin.signOut(a,e);if(l&&!(isAuthApiError(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return e!=="others"&&(await this._removeSession(),await removeItemAsync(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=uuid(),n={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:n}}}async _emitInitialSession(e){return await this._useSession(async t=>{var n,i;try{const{data:{session:o},error:a}=t;if(a)throw a;await((n=this.stateChangeEmitters.get(e))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",o)),this._debug("INITIAL_SESSION","callback id",e,"session",o)}catch(o){await((i=this.stateChangeEmitters.get(e))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",o),console.error(o)}})}async resetPasswordForEmail(e,t={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await getCodeChallengeAndMethod(this.storage,this.storageKey,!0));try{return await _request(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(o){if(isAuthError(o))return{data:null,error:o};throw o}}async getUserIdentities(){var e;try{const{data:t,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:n,error:i}=await this._useSession(async o=>{var a,l,h,d,u;const{data:f,error:m}=o;if(m)throw m;const v=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(h=e.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await _request(this.fetch,"GET",v,{headers:this.headers,jwt:(u=(d=f.session)===null||d===void 0?void 0:d.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return isBrowser$2()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(n?.url),{data:{provider:e.provider,url:n?.url},error:null}}catch(n){if(isAuthError(n))return{data:{provider:e.provider,url:null},error:n};throw n}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var n;try{const{error:i,data:{session:o}}=t;if(i)throw i;const{options:a,provider:l,token:h,access_token:d,nonce:u}=e,f=await _request(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=o?.access_token)!==null&&n!==void 0?n:void 0,body:{provider:l,id_token:h,access_token:d,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:_sessionResponse}),{data:m,error:v}=f;return v?{data:{user:null,session:null},error:v}:!m||!m.session||!m.user?{data:{user:null,session:null},error:new AuthInvalidTokenResponseError}:(m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("USER_UPDATED",m.session)),{data:m,error:v})}catch(i){if(isAuthError(i))return{data:{user:null,session:null},error:i};throw i}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var n,i;const{data:o,error:a}=t;if(a)throw a;return await _request(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(i=(n=o.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const n=Date.now();return await retryable(async i=>(i>0&&await sleep(200*Math.pow(2,i-1)),this._debug(t,"refreshing attempt",i),await _request(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:_sessionResponse})),(i,o)=>{const a=200*Math.pow(2,i);return o&&isAuthRetryableFetchError(o)&&Date.now()+a-n<AUTO_REFRESH_TICK_DURATION_MS})}catch(n){if(this._debug(t,"error",n),isAuthError(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const n=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",n),isBrowser$2()&&!t.skipBrowserRedirect&&window.location.assign(n),{data:{provider:e,url:n},error:null}}async _recoverAndRefresh(){var e,t;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await getItemAsync(this.storage,this.storageKey);if(i&&this.userStorage){let a=await getItemAsync(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:i.user},await setItemAsync(this.userStorage,this.storageKey+"-user",a)),i.user=(e=a?.user)!==null&&e!==void 0?e:userNotAvailableProxy()}else if(i&&!i.user&&!i.user){const a=await getItemAsync(this.storage,this.storageKey+"-user");a&&a?.user?(i.user=a.user,await removeItemAsync(this.storage,this.storageKey+"-user"),await setItemAsync(this.storage,this.storageKey,i)):i.user=userNotAvailableProxy()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const o=((t=i.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<EXPIRY_MARGIN_MS;if(this._debug(n,`session has${o?"":" not"} expired with margin of ${EXPIRY_MARGIN_MS}s`),o){if(this.autoRefreshToken&&i.refresh_token){const{error:a}=await this._callRefreshToken(i.refresh_token);a&&(console.error(a),isAuthRetryableFetchError(a)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:a,error:l}=await this._getUser(i.access_token);!l&&a?.user?(i.user=a.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(n,"error getting user data, skipping SIGNED_IN notification",a)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var t,n;if(!e)throw new AuthSessionMissingError;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Deferred;const{data:o,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!o.session)throw new AuthSessionMissingError;await this._saveSession(o.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",o.session);const l={data:o.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(o){if(this._debug(i,"error",o),isAuthError(o)){const a={data:null,error:o};return isAuthRetryableFetchError(o)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(o),o}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,t,n=!0){const i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",t,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:e,session:t});const o=[],a=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,t)}catch(h){o.push(h)}});if(await Promise.all(a),o.length>0){for(let l=0;l<o.length;l+=1)console.error(o[l]);throw o[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),n=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&t.user&&await setItemAsync(this.userStorage,this.storageKey+"-user",{user:t.user});const i=Object.assign({},t);delete i.user;const o=deepClone(i);await setItemAsync(this.storage,this.storageKey,o)}else{const i=deepClone(t);await setItemAsync(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),await removeItemAsync(this.storage,this.storageKey),await removeItemAsync(this.storage,this.storageKey+"-code-verifier"),await removeItemAsync(this.storage,this.storageKey+"-user"),this.userStorage&&await removeItemAsync(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&isBrowser$2()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),AUTO_REFRESH_TICK_DURATION_MS);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:n}}=t;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-e)/AUTO_REFRESH_TICK_DURATION_MS);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${AUTO_REFRESH_TICK_DURATION_MS}ms, refresh threshold is ${AUTO_REFRESH_TICK_THRESHOLD} ticks`),i<=AUTO_REFRESH_TICK_THRESHOLD&&await this._callRefreshToken(n.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof LockAcquireTimeoutError)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!isBrowser$2()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,n){const i=[`provider=${encodeURIComponent(t)}`];if(n?.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[o,a]=await getCodeChallengeAndMethod(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(o)}`,code_challenge_method:`${encodeURIComponent(a)}`});i.push(l.toString())}if(n?.queryParams){const o=new URLSearchParams(n.queryParams);i.push(o.toString())}return n?.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var n;const{data:i,error:o}=t;return o?{data:null,error:o}:await _request(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token})})}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var n,i;const{data:o,error:a}=t;if(a)return{data:null,error:a};const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:h,error:d}=await _request(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(n=o?.session)===null||n===void 0?void 0:n.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&h.type==="totp"&&(!((i=h?.totp)===null||i===void 0)&&i.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),{data:h,error:null})})}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:i,error:o}=t;if(o)return{data:null,error:o};const a=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?serializeCredentialCreationResponse(e.webauthn.credential_response):serializeCredentialRequestResponse(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:h}=await _request(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:a,headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token});return h?{data:null,error:h}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),{data:l,error:h})})}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var n;const{data:i,error:o}=t;if(o)return{data:null,error:o};const a=await _request(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token});if(a.error)return a;const{data:l}=a;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:deserializeCredentialCreationOptions(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:deserializeCredentialRequestOptions(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(isAuthError(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:n}=await this._challenge({factorId:e.factorId});return n?{data:null,error:n}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const o of(e=t?.factors)!==null&&e!==void 0?e:[])i.all.push(o),o.status==="verified"&&i[o.factor_type].push(o);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,n;const{data:{session:i},error:o}=e;if(o)return{data:null,error:o};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=decodeJWT(i.access_token);let l=null;a.aal&&(l=a.aal);let h=l;((n=(t=i.user.factors)===null||t===void 0?void 0:t.filter(f=>f.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(h="aal2");const u=a.amr||[];return{data:{currentLevel:l,nextLevel:h,currentAuthenticationMethods:u},error:null}}))}async fetchJwk(e,t={keys:[]}){let n=t.keys.find(l=>l.kid===e);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(l=>l.kid===e),n&&this.jwks_cached_at+JWKS_TTL>i)return n;const{data:o,error:a}=await _request(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(a)throw a;return!o.keys||o.keys.length===0||(this.jwks=o,this.jwks_cached_at=i,n=o.keys.find(l=>l.kid===e),!n)?null:n}async getClaims(e,t={}){try{let n=e;if(!n){const{data:v,error:g}=await this.getSession();if(g||!v.session)return{data:null,error:g};n=v.session.access_token}const{header:i,payload:o,signature:a,raw:{header:l,payload:h}}=decodeJWT(n);t?.allowExpired||validateExp(o.exp);const d=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!d){const{error:v}=await this.getUser(n);if(v)throw v;return{data:{claims:o,header:i,signature:a},error:null}}const u=getAlgorithm(i.alg),f=await crypto.subtle.importKey("jwk",d,u,!0,["verify"]);if(!await crypto.subtle.verify(u,f,a,stringToUint8Array(`${l}.${h}`)))throw new AuthInvalidJwtError("Invalid JWT signature");return{data:{claims:o,header:i,signature:a},error:null}}catch(n){if(isAuthError(n))return{data:null,error:n};throw n}}}GoTrueClient.nextInstanceID=0;const AuthClient=GoTrueClient;class SupabaseAuthClient extends AuthClient{constructor(e){super(e)}}var __awaiter$1=function(s,e,t,n){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function l(u){try{d(n.next(u))}catch(f){a(f)}}function h(u){try{d(n.throw(u))}catch(f){a(f)}}function d(u){u.done?o(u.value):i(u.value).then(l,h)}d((n=n.apply(s,e||[])).next())})};class SupabaseClient{constructor(e,t,n){var i,o,a;this.supabaseUrl=e,this.supabaseKey=t;const l=validateSupabaseUrl(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const h=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:DEFAULT_DB_OPTIONS,realtime:DEFAULT_REALTIME_OPTIONS,auth:Object.assign(Object.assign({},DEFAULT_AUTH_OPTIONS),{storageKey:h}),global:DEFAULT_GLOBAL_OPTIONS},u=applySettingDefaults(n??{},d);this.storageKey=(i=u.auth.storageKey)!==null&&i!==void 0?i:"",this.headers=(o=u.global.headers)!==null&&o!==void 0?o:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(f,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=u.auth)!==null&&a!==void 0?a:{},this.headers,u.global.fetch),this.fetch=fetchWithAuth(t,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new PostgrestClient(new URL("rest/v1",l).href,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),this.storage=new StorageClient(this.storageUrl.href,this.headers,this.fetch,n?.storage),u.accessToken||this._listenForAuthEvents()}get functions(){return new FunctionsClient(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},n={}){return this.rest.rpc(e,t,n)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){return __awaiter$1(this,void 0,void 0,function*(){var e,t;if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(t=(e=n.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:i,userStorage:o,storageKey:a,flowType:l,lock:h,debug:d},u,f){const m={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new SupabaseAuthClient({url:this.authUrl.href,headers:Object.assign(Object.assign({},m),u),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:i,userStorage:o,flowType:l,lock:h,debug:d,fetch:f,hasCustomAuthorizationHeader:Object.keys(this.headers).some(v=>v.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new RealtimeClient(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,n)=>{this._handleTokenChanged(t,"CLIENT",n?.access_token)})}_handleTokenChanged(e,t,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const createClient=(s,e,t)=>new SupabaseClient(s,e,t);function shouldShowDeprecationWarning(){if(typeof window<"u"||typeof process>"u")return!1;const s=process.version;if(s==null)return!1;const e=s.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}shouldShowDeprecationWarning()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const supabaseUrl="https://reecfmvwsimswxdmyuqh.supabase.co",supabaseAnonKey="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJlZWNmbXZ3c2ltc3d4ZG15dXFoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTk5NTA0MzQsImV4cCI6MjA3NTUyNjQzNH0.t2zQipbxcWm_DzTUOu2APi448jKpQHWId7JePDHU000",supabase=createClient(supabaseUrl,supabaseAnonKey,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0}});async function isUserWhitelisted(s){const{data:e,error:t}=await supabase.from("allowed_users").select("email").eq("email",s.toLowerCase()).single();return t?(console.error("[Whitelist Check]",t),!1):!!e}const AuthContext=reactExports.createContext(void 0);function AuthProvider({children:s}){const[e,t]=reactExports.useState(null),[n,i]=reactExports.useState(null),[o,a]=reactExports.useState(!0),[l,h]=reactExports.useState(!1),d=async v=>{const g=await isUserWhitelisted(v);return h(g),g};reactExports.useEffect(()=>{supabase.auth.getSession().then(async({data:{session:g}})=>{i(g),t(g?.user??null),g?.user?.email&&await d(g.user.email),a(!1)});const{data:{subscription:v}}=supabase.auth.onAuthStateChange(async(g,x)=>{i(x),t(x?.user??null),x?.user?.email?await d(x.user.email):h(!1)});return()=>v.unsubscribe()},[]);const u=async(v,g)=>{try{if(!await isUserWhitelisted(v))return{success:!1,error:"Your email is not authorized. Please contact the administrator for access."};const{data:E,error:b}=await supabase.auth.signInWithPassword({email:v,password:g});if(b)throw b;return E.user?(h(!0),toast.success("Welcome back!"),{success:!0}):{success:!1,error:"Login failed"}}catch(x){const E=x;return console.error("[Auth] Sign in error:",E),{success:!1,error:E.message||"Failed to sign in"}}},f=async(v,g)=>{try{if(!await isUserWhitelisted(v))return{success:!1,error:"Your email is not authorized. Please contact the administrator for access."};const{data:E,error:b}=await supabase.auth.signUp({email:v,password:g,options:{emailRedirectTo:`${window.location.origin}/auth/callback`}});if(b)throw b;if(E.user){const{error:_}=await supabase.from("user_preferences").insert({user_id:E.user.id,learning_goals:"",target_level:"intermediate",preferred_summary_style:"concise"});return _&&console.error("[Auth] Failed to create user preferences:",_),toast.success("Account created! Please check your email to confirm."),{success:!0}}return{success:!1,error:"Signup failed"}}catch(x){const E=x;return console.error("[Auth] Sign up error:",E),{success:!1,error:E.message||"Failed to sign up"}}},m=async()=>{try{const{error:v}=await supabase.auth.signOut();if(v)throw v;h(!1),toast.success("Signed out successfully")}catch(v){console.error("[Auth] Sign out error:",v),toast.error("Failed to sign out")}};return jsxRuntimeExports.jsx(AuthContext.Provider,{value:{user:e,session:n,loading:o,signIn:u,signUp:f,signOut:m,isWhitelisted:l},children:s})}function useAuth(){const s=reactExports.useContext(AuthContext);if(s===void 0)throw new Error("useAuth must be used within an AuthProvider");return s}const TextbookContext=reactExports.createContext(void 0);function TextbookProvider({children:s}){const{user:e}=useAuth(),[t,n]=reactExports.useState(null),[i,o]=reactExports.useState([]),[a,l]=reactExports.useState(1),[h,d]=reactExports.useState(null),[u,f]=reactExports.useState(null),[m,v]=reactExports.useState(!1),g=reactExports.useRef(null),x=async()=>{if(e)try{const{data:j,error:F}=await supabase.from("textbooks").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});if(F)throw F;o(j||[])}catch(j){console.error("[Textbook] Failed to load textbooks:",j),toast.error("Failed to load textbooks")}},E=async j=>{try{v(!0);const{data:F,error:W}=await supabase.from("textbooks").select("*").eq("id",j).single();if(W)throw W;n(F),l(1)}catch(F){console.error("[Textbook] Failed to load textbook:",F),toast.error("Failed to load textbook")}finally{v(!1)}},b=async()=>{if(t)try{v(!0);const{data:j,error:F}=await supabase.from("pages").select("*").eq("textbook_id",t.id).eq("page_number",a).single();if(F)throw F;if(d(j),j){const{data:W,error:K}=await supabase.from("ai_processed_content").select("*").eq("page_id",j.id).single();K&&K.code!=="PGRST116"&&console.error("[Textbook] Failed to load AI content:",K),f(W||null)}}catch(j){console.error("[Textbook] Failed to load page data:",j),toast.error("Failed to load page")}finally{v(!1)}},_=j=>{const F=setInterval(async()=>{const{data:W,error:K}=await supabase.from("textbooks").select("ai_processing_status, ai_processing_progress, ai_processing_error").eq("id",j).single();if(K){console.error("[AI Polling] Error:",K);return}W.ai_processing_status==="completed"?(clearInterval(F),toast.success("Your textbook is ready to read!",{duration:3e3}),await x(),await E(j)):W.ai_processing_status==="failed"?(clearInterval(F),toast.error(`AI processing failed: ${W.ai_processing_error||"Unknown error"}`),await x()):W.ai_processing_status==="processing"&&o(ee=>ee.map(te=>te.id===j?{...te,ai_processing_progress:W.ai_processing_progress||0}:te))},3e3)},S=async j=>{try{const F=await fetch("/api/process-pdf-ai",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({textbookId:j})});if(!F.ok){const W=await F.json();throw new Error(W.error||"Failed to start AI processing")}console.log("[AI Processing] Started successfully")}catch(F){console.error("[AI Processing] Failed to trigger:",F),toast.error("Failed to start AI processing")}},C=async(j,F)=>{try{console.log("[Background] Starting SERVER-SIDE text extraction for:",j);const W=await fetch("/api/extract-pdf-text",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({textbookId:j,filePath:F})});if(!W.ok){const ee=await W.json();throw new Error(ee.error||"Server-side extraction failed")}const{pages:K}=await W.json();console.log("[Background] Server-side extraction complete:",K,"pages"),console.log("[Background] Text extraction complete, detecting chapters...");try{const ee=await fetch("/api/detect-chapters",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({textbookId:j})});if(ee.ok){const{count:te}=await ee.json();console.log(`[Background] Detected ${te} chapters`),toast.success(`Detected ${te} chapters! Starting AI analysis...`)}}catch(ee){console.error("[Background] Chapter detection failed:",ee)}await S(j),_(j),await x()}catch(W){console.error("[Background] Processing failed:",W),await supabase.from("textbooks").update({processing_status:"failed",processing_error:W instanceof Error?W.message:"Unknown error"}).eq("id",j),toast.error("Background processing failed. You can still read the PDF.")}},A=async(j,F,W)=>{if(!e)throw new Error("User not authenticated");try{const K=crypto.randomUUID();W?.(30,"uploading");const ee=`${e.id}/${K}.pdf`,{error:te}=await supabase.storage.from("textbook-pdfs").upload(ee,j);if(te)throw te;const{data:re}=supabase.storage.from("textbook-pdfs").getPublicUrl(ee),ie=re.publicUrl;W?.(60,"saving");const{error:Q}=await supabase.from("textbooks").insert({id:K,user_id:e.id,title:F.title,pdf_url:ie,total_pages:1,processing_status:"pending",processing_progress:0,ai_processing_status:"pending",ai_processing_progress:0,metadata:{subject:F.subject,learning_goal:F.learningGoal,original_filename:j.name}});if(Q)throw Q;return W?.(90,"done"),await x(),await E(K),W?.(100,"done"),toast.success("PDF uploaded! You can read it now. Processing text in background...",{duration:5e3}),C(K,ee),K}catch(K){throw console.error("[Textbook Upload] Error:",K),toast.error("Failed to upload textbook"),K}};reactExports.useEffect(()=>()=>{g.current&&clearInterval(g.current)},[]);const R=()=>{t&&a<t.total_pages&&l(a+1)},L=()=>{a>1&&l(a-1)};return reactExports.useEffect(()=>{t&&b()},[a,t]),reactExports.useEffect(()=>{e&&x()},[e]),jsxRuntimeExports.jsx(TextbookContext.Provider,{value:{currentTextbook:t,textbooks:i,currentPage:a,currentPageData:h,currentAIContent:u,loading:m,setCurrentPage:l,loadTextbook:E,loadTextbooks:x,uploadTextbook:A,nextPage:R,prevPage:L},children:s})}function useTextbook(){const s=reactExports.useContext(TextbookContext);if(s===void 0)throw new Error("useTextbook must be used within a TextbookProvider");return s}var propTypes={exports:{}},ReactPropTypesSecret_1,hasRequiredReactPropTypesSecret;function requireReactPropTypesSecret(){if(hasRequiredReactPropTypesSecret)return ReactPropTypesSecret_1;hasRequiredReactPropTypesSecret=1;var s="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ReactPropTypesSecret_1=s,ReactPropTypesSecret_1}var factoryWithThrowingShims,hasRequiredFactoryWithThrowingShims;function requireFactoryWithThrowingShims(){if(hasRequiredFactoryWithThrowingShims)return factoryWithThrowingShims;hasRequiredFactoryWithThrowingShims=1;var s=requireReactPropTypesSecret();function e(){}function t(){}return t.resetWarningCache=e,factoryWithThrowingShims=function(){function n(a,l,h,d,u,f){if(f!==s){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}n.isRequired=n;function i(){return n}var o={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:i,element:n,elementType:n,instanceOf:i,node:n,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:t,resetWarningCache:e};return o.PropTypes=o,o},factoryWithThrowingShims}var hasRequiredPropTypes;function requirePropTypes(){return hasRequiredPropTypes||(hasRequiredPropTypes=1,propTypes.exports=requireFactoryWithThrowingShims()()),propTypes.exports}var propTypesExports=requirePropTypes();const PropTypes=getDefaultExportFromCjs(propTypesExports),COMMON_MIME_TYPES=new Map([["1km","application/vnd.1000minds.decision-model+xml"],["3dml","text/vnd.in3d.3dml"],["3ds","image/x-3ds"],["3g2","video/3gpp2"],["3gp","video/3gp"],["3gpp","video/3gpp"],["3mf","model/3mf"],["7z","application/x-7z-compressed"],["7zip","application/x-7z-compressed"],["123","application/vnd.lotus-1-2-3"],["aab","application/x-authorware-bin"],["aac","audio/x-acc"],["aam","application/x-authorware-map"],["aas","application/x-authorware-seg"],["abw","application/x-abiword"],["ac","application/vnd.nokia.n-gage.ac+xml"],["ac3","audio/ac3"],["acc","application/vnd.americandynamics.acc"],["ace","application/x-ace-compressed"],["acu","application/vnd.acucobol"],["acutc","application/vnd.acucorp"],["adp","audio/adpcm"],["aep","application/vnd.audiograph"],["afm","application/x-font-type1"],["afp","application/vnd.ibm.modcap"],["ahead","application/vnd.ahead.space"],["ai","application/pdf"],["aif","audio/x-aiff"],["aifc","audio/x-aiff"],["aiff","audio/x-aiff"],["air","application/vnd.adobe.air-application-installer-package+zip"],["ait","application/vnd.dvb.ait"],["ami","application/vnd.amiga.ami"],["amr","audio/amr"],["apk","application/vnd.android.package-archive"],["apng","image/apng"],["appcache","text/cache-manifest"],["application","application/x-ms-application"],["apr","application/vnd.lotus-approach"],["arc","application/x-freearc"],["arj","application/x-arj"],["asc","application/pgp-signature"],["asf","video/x-ms-asf"],["asm","text/x-asm"],["aso","application/vnd.accpac.simply.aso"],["asx","video/x-ms-asf"],["atc","application/vnd.acucorp"],["atom","application/atom+xml"],["atomcat","application/atomcat+xml"],["atomdeleted","application/atomdeleted+xml"],["atomsvc","application/atomsvc+xml"],["atx","application/vnd.antix.game-component"],["au","audio/x-au"],["avi","video/x-msvideo"],["avif","image/avif"],["aw","application/applixware"],["azf","application/vnd.airzip.filesecure.azf"],["azs","application/vnd.airzip.filesecure.azs"],["azv","image/vnd.airzip.accelerator.azv"],["azw","application/vnd.amazon.ebook"],["b16","image/vnd.pco.b16"],["bat","application/x-msdownload"],["bcpio","application/x-bcpio"],["bdf","application/x-font-bdf"],["bdm","application/vnd.syncml.dm+wbxml"],["bdoc","application/x-bdoc"],["bed","application/vnd.realvnc.bed"],["bh2","application/vnd.fujitsu.oasysprs"],["bin","application/octet-stream"],["blb","application/x-blorb"],["blorb","application/x-blorb"],["bmi","application/vnd.bmi"],["bmml","application/vnd.balsamiq.bmml+xml"],["bmp","image/bmp"],["book","application/vnd.framemaker"],["box","application/vnd.previewsystems.box"],["boz","application/x-bzip2"],["bpk","application/octet-stream"],["bpmn","application/octet-stream"],["bsp","model/vnd.valve.source.compiled-map"],["btif","image/prs.btif"],["buffer","application/octet-stream"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["c","text/x-c"],["c4d","application/vnd.clonk.c4group"],["c4f","application/vnd.clonk.c4group"],["c4g","application/vnd.clonk.c4group"],["c4p","application/vnd.clonk.c4group"],["c4u","application/vnd.clonk.c4group"],["c11amc","application/vnd.cluetrust.cartomobile-config"],["c11amz","application/vnd.cluetrust.cartomobile-config-pkg"],["cab","application/vnd.ms-cab-compressed"],["caf","audio/x-caf"],["cap","application/vnd.tcpdump.pcap"],["car","application/vnd.curl.car"],["cat","application/vnd.ms-pki.seccat"],["cb7","application/x-cbr"],["cba","application/x-cbr"],["cbr","application/x-cbr"],["cbt","application/x-cbr"],["cbz","application/x-cbr"],["cc","text/x-c"],["cco","application/x-cocoa"],["cct","application/x-director"],["ccxml","application/ccxml+xml"],["cdbcmsg","application/vnd.contact.cmsg"],["cda","application/x-cdf"],["cdf","application/x-netcdf"],["cdfx","application/cdfx+xml"],["cdkey","application/vnd.mediastation.cdkey"],["cdmia","application/cdmi-capability"],["cdmic","application/cdmi-container"],["cdmid","application/cdmi-domain"],["cdmio","application/cdmi-object"],["cdmiq","application/cdmi-queue"],["cdr","application/cdr"],["cdx","chemical/x-cdx"],["cdxml","application/vnd.chemdraw+xml"],["cdy","application/vnd.cinderella"],["cer","application/pkix-cert"],["cfs","application/x-cfs-compressed"],["cgm","image/cgm"],["chat","application/x-chat"],["chm","application/vnd.ms-htmlhelp"],["chrt","application/vnd.kde.kchart"],["cif","chemical/x-cif"],["cii","application/vnd.anser-web-certificate-issue-initiation"],["cil","application/vnd.ms-artgalry"],["cjs","application/node"],["cla","application/vnd.claymore"],["class","application/octet-stream"],["clkk","application/vnd.crick.clicker.keyboard"],["clkp","application/vnd.crick.clicker.palette"],["clkt","application/vnd.crick.clicker.template"],["clkw","application/vnd.crick.clicker.wordbank"],["clkx","application/vnd.crick.clicker"],["clp","application/x-msclip"],["cmc","application/vnd.cosmocaller"],["cmdf","chemical/x-cmdf"],["cml","chemical/x-cml"],["cmp","application/vnd.yellowriver-custom-menu"],["cmx","image/x-cmx"],["cod","application/vnd.rim.cod"],["coffee","text/coffeescript"],["com","application/x-msdownload"],["conf","text/plain"],["cpio","application/x-cpio"],["cpp","text/x-c"],["cpt","application/mac-compactpro"],["crd","application/x-mscardfile"],["crl","application/pkix-crl"],["crt","application/x-x509-ca-cert"],["crx","application/x-chrome-extension"],["cryptonote","application/vnd.rig.cryptonote"],["csh","application/x-csh"],["csl","application/vnd.citationstyles.style+xml"],["csml","chemical/x-csml"],["csp","application/vnd.commonspace"],["csr","application/octet-stream"],["css","text/css"],["cst","application/x-director"],["csv","text/csv"],["cu","application/cu-seeme"],["curl","text/vnd.curl"],["cww","application/prs.cww"],["cxt","application/x-director"],["cxx","text/x-c"],["dae","model/vnd.collada+xml"],["daf","application/vnd.mobius.daf"],["dart","application/vnd.dart"],["dataless","application/vnd.fdsn.seed"],["davmount","application/davmount+xml"],["dbf","application/vnd.dbf"],["dbk","application/docbook+xml"],["dcr","application/x-director"],["dcurl","text/vnd.curl.dcurl"],["dd2","application/vnd.oma.dd2+xml"],["ddd","application/vnd.fujixerox.ddd"],["ddf","application/vnd.syncml.dmddf+xml"],["dds","image/vnd.ms-dds"],["deb","application/x-debian-package"],["def","text/plain"],["deploy","application/octet-stream"],["der","application/x-x509-ca-cert"],["dfac","application/vnd.dreamfactory"],["dgc","application/x-dgc-compressed"],["dic","text/x-c"],["dir","application/x-director"],["dis","application/vnd.mobius.dis"],["disposition-notification","message/disposition-notification"],["dist","application/octet-stream"],["distz","application/octet-stream"],["djv","image/vnd.djvu"],["djvu","image/vnd.djvu"],["dll","application/octet-stream"],["dmg","application/x-apple-diskimage"],["dmn","application/octet-stream"],["dmp","application/vnd.tcpdump.pcap"],["dms","application/octet-stream"],["dna","application/vnd.dna"],["doc","application/msword"],["docm","application/vnd.ms-word.template.macroEnabled.12"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["dot","application/msword"],["dotm","application/vnd.ms-word.template.macroEnabled.12"],["dotx","application/vnd.openxmlformats-officedocument.wordprocessingml.template"],["dp","application/vnd.osgi.dp"],["dpg","application/vnd.dpgraph"],["dra","audio/vnd.dra"],["drle","image/dicom-rle"],["dsc","text/prs.lines.tag"],["dssc","application/dssc+der"],["dtb","application/x-dtbook+xml"],["dtd","application/xml-dtd"],["dts","audio/vnd.dts"],["dtshd","audio/vnd.dts.hd"],["dump","application/octet-stream"],["dvb","video/vnd.dvb.file"],["dvi","application/x-dvi"],["dwd","application/atsc-dwd+xml"],["dwf","model/vnd.dwf"],["dwg","image/vnd.dwg"],["dxf","image/vnd.dxf"],["dxp","application/vnd.spotfire.dxp"],["dxr","application/x-director"],["ear","application/java-archive"],["ecelp4800","audio/vnd.nuera.ecelp4800"],["ecelp7470","audio/vnd.nuera.ecelp7470"],["ecelp9600","audio/vnd.nuera.ecelp9600"],["ecma","application/ecmascript"],["edm","application/vnd.novadigm.edm"],["edx","application/vnd.novadigm.edx"],["efif","application/vnd.picsel"],["ei6","application/vnd.pg.osasli"],["elc","application/octet-stream"],["emf","image/emf"],["eml","message/rfc822"],["emma","application/emma+xml"],["emotionml","application/emotionml+xml"],["emz","application/x-msmetafile"],["eol","audio/vnd.digital-winds"],["eot","application/vnd.ms-fontobject"],["eps","application/postscript"],["epub","application/epub+zip"],["es","application/ecmascript"],["es3","application/vnd.eszigno3+xml"],["esa","application/vnd.osgi.subsystem"],["esf","application/vnd.epson.esf"],["et3","application/vnd.eszigno3+xml"],["etx","text/x-setext"],["eva","application/x-eva"],["evy","application/x-envoy"],["exe","application/octet-stream"],["exi","application/exi"],["exp","application/express"],["exr","image/aces"],["ext","application/vnd.novadigm.ext"],["ez","application/andrew-inset"],["ez2","application/vnd.ezpix-album"],["ez3","application/vnd.ezpix-package"],["f","text/x-fortran"],["f4v","video/mp4"],["f77","text/x-fortran"],["f90","text/x-fortran"],["fbs","image/vnd.fastbidsheet"],["fcdt","application/vnd.adobe.formscentral.fcdt"],["fcs","application/vnd.isac.fcs"],["fdf","application/vnd.fdf"],["fdt","application/fdt+xml"],["fe_launch","application/vnd.denovo.fcselayout-link"],["fg5","application/vnd.fujitsu.oasysgp"],["fgd","application/x-director"],["fh","image/x-freehand"],["fh4","image/x-freehand"],["fh5","image/x-freehand"],["fh7","image/x-freehand"],["fhc","image/x-freehand"],["fig","application/x-xfig"],["fits","image/fits"],["flac","audio/x-flac"],["fli","video/x-fli"],["flo","application/vnd.micrografx.flo"],["flv","video/x-flv"],["flw","application/vnd.kde.kivio"],["flx","text/vnd.fmi.flexstor"],["fly","text/vnd.fly"],["fm","application/vnd.framemaker"],["fnc","application/vnd.frogans.fnc"],["fo","application/vnd.software602.filler.form+xml"],["for","text/x-fortran"],["fpx","image/vnd.fpx"],["frame","application/vnd.framemaker"],["fsc","application/vnd.fsc.weblaunch"],["fst","image/vnd.fst"],["ftc","application/vnd.fluxtime.clip"],["fti","application/vnd.anser-web-funds-transfer-initiation"],["fvt","video/vnd.fvt"],["fxp","application/vnd.adobe.fxp"],["fxpl","application/vnd.adobe.fxp"],["fzs","application/vnd.fuzzysheet"],["g2w","application/vnd.geoplan"],["g3","image/g3fax"],["g3w","application/vnd.geospace"],["gac","application/vnd.groove-account"],["gam","application/x-tads"],["gbr","application/rpki-ghostbusters"],["gca","application/x-gca-compressed"],["gdl","model/vnd.gdl"],["gdoc","application/vnd.google-apps.document"],["geo","application/vnd.dynageo"],["geojson","application/geo+json"],["gex","application/vnd.geometry-explorer"],["ggb","application/vnd.geogebra.file"],["ggt","application/vnd.geogebra.tool"],["ghf","application/vnd.groove-help"],["gif","image/gif"],["gim","application/vnd.groove-identity-message"],["glb","model/gltf-binary"],["gltf","model/gltf+json"],["gml","application/gml+xml"],["gmx","application/vnd.gmx"],["gnumeric","application/x-gnumeric"],["gpg","application/gpg-keys"],["gph","application/vnd.flographit"],["gpx","application/gpx+xml"],["gqf","application/vnd.grafeq"],["gqs","application/vnd.grafeq"],["gram","application/srgs"],["gramps","application/x-gramps-xml"],["gre","application/vnd.geometry-explorer"],["grv","application/vnd.groove-injector"],["grxml","application/srgs+xml"],["gsf","application/x-font-ghostscript"],["gsheet","application/vnd.google-apps.spreadsheet"],["gslides","application/vnd.google-apps.presentation"],["gtar","application/x-gtar"],["gtm","application/vnd.groove-tool-message"],["gtw","model/vnd.gtw"],["gv","text/vnd.graphviz"],["gxf","application/gxf"],["gxt","application/vnd.geonext"],["gz","application/gzip"],["gzip","application/gzip"],["h","text/x-c"],["h261","video/h261"],["h263","video/h263"],["h264","video/h264"],["hal","application/vnd.hal+xml"],["hbci","application/vnd.hbci"],["hbs","text/x-handlebars-template"],["hdd","application/x-virtualbox-hdd"],["hdf","application/x-hdf"],["heic","image/heic"],["heics","image/heic-sequence"],["heif","image/heif"],["heifs","image/heif-sequence"],["hej2","image/hej2k"],["held","application/atsc-held+xml"],["hh","text/x-c"],["hjson","application/hjson"],["hlp","application/winhlp"],["hpgl","application/vnd.hp-hpgl"],["hpid","application/vnd.hp-hpid"],["hps","application/vnd.hp-hps"],["hqx","application/mac-binhex40"],["hsj2","image/hsj2"],["htc","text/x-component"],["htke","application/vnd.kenameaapp"],["htm","text/html"],["html","text/html"],["hvd","application/vnd.yamaha.hv-dic"],["hvp","application/vnd.yamaha.hv-voice"],["hvs","application/vnd.yamaha.hv-script"],["i2g","application/vnd.intergeo"],["icc","application/vnd.iccprofile"],["ice","x-conference/x-cooltalk"],["icm","application/vnd.iccprofile"],["ico","image/x-icon"],["ics","text/calendar"],["ief","image/ief"],["ifb","text/calendar"],["ifm","application/vnd.shana.informed.formdata"],["iges","model/iges"],["igl","application/vnd.igloader"],["igm","application/vnd.insors.igm"],["igs","model/iges"],["igx","application/vnd.micrografx.igx"],["iif","application/vnd.shana.informed.interchange"],["img","application/octet-stream"],["imp","application/vnd.accpac.simply.imp"],["ims","application/vnd.ms-ims"],["in","text/plain"],["ini","text/plain"],["ink","application/inkml+xml"],["inkml","application/inkml+xml"],["install","application/x-install-instructions"],["iota","application/vnd.astraea-software.iota"],["ipfix","application/ipfix"],["ipk","application/vnd.shana.informed.package"],["irm","application/vnd.ibm.rights-management"],["irp","application/vnd.irepository.package+xml"],["iso","application/x-iso9660-image"],["itp","application/vnd.shana.informed.formtemplate"],["its","application/its+xml"],["ivp","application/vnd.immervision-ivp"],["ivu","application/vnd.immervision-ivu"],["jad","text/vnd.sun.j2me.app-descriptor"],["jade","text/jade"],["jam","application/vnd.jam"],["jar","application/java-archive"],["jardiff","application/x-java-archive-diff"],["java","text/x-java-source"],["jhc","image/jphc"],["jisp","application/vnd.jisp"],["jls","image/jls"],["jlt","application/vnd.hp-jlyt"],["jng","image/x-jng"],["jnlp","application/x-java-jnlp-file"],["joda","application/vnd.joost.joda-archive"],["jp2","image/jp2"],["jpe","image/jpeg"],["jpeg","image/jpeg"],["jpf","image/jpx"],["jpg","image/jpeg"],["jpg2","image/jp2"],["jpgm","video/jpm"],["jpgv","video/jpeg"],["jph","image/jph"],["jpm","video/jpm"],["jpx","image/jpx"],["js","application/javascript"],["json","application/json"],["json5","application/json5"],["jsonld","application/ld+json"],["jsonl","application/jsonl"],["jsonml","application/jsonml+json"],["jsx","text/jsx"],["jxr","image/jxr"],["jxra","image/jxra"],["jxrs","image/jxrs"],["jxs","image/jxs"],["jxsc","image/jxsc"],["jxsi","image/jxsi"],["jxss","image/jxss"],["kar","audio/midi"],["karbon","application/vnd.kde.karbon"],["kdb","application/octet-stream"],["kdbx","application/x-keepass2"],["key","application/x-iwork-keynote-sffkey"],["kfo","application/vnd.kde.kformula"],["kia","application/vnd.kidspiration"],["kml","application/vnd.google-earth.kml+xml"],["kmz","application/vnd.google-earth.kmz"],["kne","application/vnd.kinar"],["knp","application/vnd.kinar"],["kon","application/vnd.kde.kontour"],["kpr","application/vnd.kde.kpresenter"],["kpt","application/vnd.kde.kpresenter"],["kpxx","application/vnd.ds-keypoint"],["ksp","application/vnd.kde.kspread"],["ktr","application/vnd.kahootz"],["ktx","image/ktx"],["ktx2","image/ktx2"],["ktz","application/vnd.kahootz"],["kwd","application/vnd.kde.kword"],["kwt","application/vnd.kde.kword"],["lasxml","application/vnd.las.las+xml"],["latex","application/x-latex"],["lbd","application/vnd.llamagraphics.life-balance.desktop"],["lbe","application/vnd.llamagraphics.life-balance.exchange+xml"],["les","application/vnd.hhe.lesson-player"],["less","text/less"],["lgr","application/lgr+xml"],["lha","application/octet-stream"],["link66","application/vnd.route66.link66+xml"],["list","text/plain"],["list3820","application/vnd.ibm.modcap"],["listafp","application/vnd.ibm.modcap"],["litcoffee","text/coffeescript"],["lnk","application/x-ms-shortcut"],["log","text/plain"],["lostxml","application/lost+xml"],["lrf","application/octet-stream"],["lrm","application/vnd.ms-lrm"],["ltf","application/vnd.frogans.ltf"],["lua","text/x-lua"],["luac","application/x-lua-bytecode"],["lvp","audio/vnd.lucent.voice"],["lwp","application/vnd.lotus-wordpro"],["lzh","application/octet-stream"],["m1v","video/mpeg"],["m2a","audio/mpeg"],["m2v","video/mpeg"],["m3a","audio/mpeg"],["m3u","text/plain"],["m3u8","application/vnd.apple.mpegurl"],["m4a","audio/x-m4a"],["m4p","application/mp4"],["m4s","video/iso.segment"],["m4u","application/vnd.mpegurl"],["m4v","video/x-m4v"],["m13","application/x-msmediaview"],["m14","application/x-msmediaview"],["m21","application/mp21"],["ma","application/mathematica"],["mads","application/mads+xml"],["maei","application/mmt-aei+xml"],["mag","application/vnd.ecowin.chart"],["maker","application/vnd.framemaker"],["man","text/troff"],["manifest","text/cache-manifest"],["map","application/json"],["mar","application/octet-stream"],["markdown","text/markdown"],["mathml","application/mathml+xml"],["mb","application/mathematica"],["mbk","application/vnd.mobius.mbk"],["mbox","application/mbox"],["mc1","application/vnd.medcalcdata"],["mcd","application/vnd.mcd"],["mcurl","text/vnd.curl.mcurl"],["md","text/markdown"],["mdb","application/x-msaccess"],["mdi","image/vnd.ms-modi"],["mdx","text/mdx"],["me","text/troff"],["mesh","model/mesh"],["meta4","application/metalink4+xml"],["metalink","application/metalink+xml"],["mets","application/mets+xml"],["mfm","application/vnd.mfmp"],["mft","application/rpki-manifest"],["mgp","application/vnd.osgeo.mapguide.package"],["mgz","application/vnd.proteus.magazine"],["mid","audio/midi"],["midi","audio/midi"],["mie","application/x-mie"],["mif","application/vnd.mif"],["mime","message/rfc822"],["mj2","video/mj2"],["mjp2","video/mj2"],["mjs","application/javascript"],["mk3d","video/x-matroska"],["mka","audio/x-matroska"],["mkd","text/x-markdown"],["mks","video/x-matroska"],["mkv","video/x-matroska"],["mlp","application/vnd.dolby.mlp"],["mmd","application/vnd.chipnuts.karaoke-mmd"],["mmf","application/vnd.smaf"],["mml","text/mathml"],["mmr","image/vnd.fujixerox.edmics-mmr"],["mng","video/x-mng"],["mny","application/x-msmoney"],["mobi","application/x-mobipocket-ebook"],["mods","application/mods+xml"],["mov","video/quicktime"],["movie","video/x-sgi-movie"],["mp2","audio/mpeg"],["mp2a","audio/mpeg"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mp4a","audio/mp4"],["mp4s","application/mp4"],["mp4v","video/mp4"],["mp21","application/mp21"],["mpc","application/vnd.mophun.certificate"],["mpd","application/dash+xml"],["mpe","video/mpeg"],["mpeg","video/mpeg"],["mpg","video/mpeg"],["mpg4","video/mp4"],["mpga","audio/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["mpm","application/vnd.blueice.multipass"],["mpn","application/vnd.mophun.application"],["mpp","application/vnd.ms-project"],["mpt","application/vnd.ms-project"],["mpy","application/vnd.ibm.minipay"],["mqy","application/vnd.mobius.mqy"],["mrc","application/marc"],["mrcx","application/marcxml+xml"],["ms","text/troff"],["mscml","application/mediaservercontrol+xml"],["mseed","application/vnd.fdsn.mseed"],["mseq","application/vnd.mseq"],["msf","application/vnd.epson.msf"],["msg","application/vnd.ms-outlook"],["msh","model/mesh"],["msi","application/x-msdownload"],["msl","application/vnd.mobius.msl"],["msm","application/octet-stream"],["msp","application/octet-stream"],["msty","application/vnd.muvee.style"],["mtl","model/mtl"],["mts","model/vnd.mts"],["mus","application/vnd.musician"],["musd","application/mmt-usd+xml"],["musicxml","application/vnd.recordare.musicxml+xml"],["mvb","application/x-msmediaview"],["mvt","application/vnd.mapbox-vector-tile"],["mwf","application/vnd.mfer"],["mxf","application/mxf"],["mxl","application/vnd.recordare.musicxml"],["mxmf","audio/mobile-xmf"],["mxml","application/xv+xml"],["mxs","application/vnd.triscape.mxs"],["mxu","video/vnd.mpegurl"],["n-gage","application/vnd.nokia.n-gage.symbian.install"],["n3","text/n3"],["nb","application/mathematica"],["nbp","application/vnd.wolfram.player"],["nc","application/x-netcdf"],["ncx","application/x-dtbncx+xml"],["nfo","text/x-nfo"],["ngdat","application/vnd.nokia.n-gage.data"],["nitf","application/vnd.nitf"],["nlu","application/vnd.neurolanguage.nlu"],["nml","application/vnd.enliven"],["nnd","application/vnd.noblenet-directory"],["nns","application/vnd.noblenet-sealer"],["nnw","application/vnd.noblenet-web"],["npx","image/vnd.net-fpx"],["nq","application/n-quads"],["nsc","application/x-conference"],["nsf","application/vnd.lotus-notes"],["nt","application/n-triples"],["ntf","application/vnd.nitf"],["numbers","application/x-iwork-numbers-sffnumbers"],["nzb","application/x-nzb"],["oa2","application/vnd.fujitsu.oasys2"],["oa3","application/vnd.fujitsu.oasys3"],["oas","application/vnd.fujitsu.oasys"],["obd","application/x-msbinder"],["obgx","application/vnd.openblox.game+xml"],["obj","model/obj"],["oda","application/oda"],["odb","application/vnd.oasis.opendocument.database"],["odc","application/vnd.oasis.opendocument.chart"],["odf","application/vnd.oasis.opendocument.formula"],["odft","application/vnd.oasis.opendocument.formula-template"],["odg","application/vnd.oasis.opendocument.graphics"],["odi","application/vnd.oasis.opendocument.image"],["odm","application/vnd.oasis.opendocument.text-master"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogex","model/vnd.opengex"],["ogg","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["omdoc","application/omdoc+xml"],["onepkg","application/onenote"],["onetmp","application/onenote"],["onetoc","application/onenote"],["onetoc2","application/onenote"],["opf","application/oebps-package+xml"],["opml","text/x-opml"],["oprc","application/vnd.palm"],["opus","audio/ogg"],["org","text/x-org"],["osf","application/vnd.yamaha.openscoreformat"],["osfpvg","application/vnd.yamaha.openscoreformat.osfpvg+xml"],["osm","application/vnd.openstreetmap.data+xml"],["otc","application/vnd.oasis.opendocument.chart-template"],["otf","font/otf"],["otg","application/vnd.oasis.opendocument.graphics-template"],["oth","application/vnd.oasis.opendocument.text-web"],["oti","application/vnd.oasis.opendocument.image-template"],["otp","application/vnd.oasis.opendocument.presentation-template"],["ots","application/vnd.oasis.opendocument.spreadsheet-template"],["ott","application/vnd.oasis.opendocument.text-template"],["ova","application/x-virtualbox-ova"],["ovf","application/x-virtualbox-ovf"],["owl","application/rdf+xml"],["oxps","application/oxps"],["oxt","application/vnd.openofficeorg.extension"],["p","text/x-pascal"],["p7a","application/x-pkcs7-signature"],["p7b","application/x-pkcs7-certificates"],["p7c","application/pkcs7-mime"],["p7m","application/pkcs7-mime"],["p7r","application/x-pkcs7-certreqresp"],["p7s","application/pkcs7-signature"],["p8","application/pkcs8"],["p10","application/x-pkcs10"],["p12","application/x-pkcs12"],["pac","application/x-ns-proxy-autoconfig"],["pages","application/x-iwork-pages-sffpages"],["pas","text/x-pascal"],["paw","application/vnd.pawaafile"],["pbd","application/vnd.powerbuilder6"],["pbm","image/x-portable-bitmap"],["pcap","application/vnd.tcpdump.pcap"],["pcf","application/x-font-pcf"],["pcl","application/vnd.hp-pcl"],["pclxl","application/vnd.hp-pclxl"],["pct","image/x-pict"],["pcurl","application/vnd.curl.pcurl"],["pcx","image/x-pcx"],["pdb","application/x-pilot"],["pde","text/x-processing"],["pdf","application/pdf"],["pem","application/x-x509-user-cert"],["pfa","application/x-font-type1"],["pfb","application/x-font-type1"],["pfm","application/x-font-type1"],["pfr","application/font-tdpfr"],["pfx","application/x-pkcs12"],["pgm","image/x-portable-graymap"],["pgn","application/x-chess-pgn"],["pgp","application/pgp"],["php","application/x-httpd-php"],["php3","application/x-httpd-php"],["php4","application/x-httpd-php"],["phps","application/x-httpd-php-source"],["phtml","application/x-httpd-php"],["pic","image/x-pict"],["pkg","application/octet-stream"],["pki","application/pkixcmp"],["pkipath","application/pkix-pkipath"],["pkpass","application/vnd.apple.pkpass"],["pl","application/x-perl"],["plb","application/vnd.3gpp.pic-bw-large"],["plc","application/vnd.mobius.plc"],["plf","application/vnd.pocketlearn"],["pls","application/pls+xml"],["pm","application/x-perl"],["pml","application/vnd.ctc-posml"],["png","image/png"],["pnm","image/x-portable-anymap"],["portpkg","application/vnd.macports.portpkg"],["pot","application/vnd.ms-powerpoint"],["potm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["potx","application/vnd.openxmlformats-officedocument.presentationml.template"],["ppa","application/vnd.ms-powerpoint"],["ppam","application/vnd.ms-powerpoint.addin.macroEnabled.12"],["ppd","application/vnd.cups-ppd"],["ppm","image/x-portable-pixmap"],["pps","application/vnd.ms-powerpoint"],["ppsm","application/vnd.ms-powerpoint.slideshow.macroEnabled.12"],["ppsx","application/vnd.openxmlformats-officedocument.presentationml.slideshow"],["ppt","application/powerpoint"],["pptm","application/vnd.ms-powerpoint.presentation.macroEnabled.12"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["pqa","application/vnd.palm"],["prc","application/x-pilot"],["pre","application/vnd.lotus-freelance"],["prf","application/pics-rules"],["provx","application/provenance+xml"],["ps","application/postscript"],["psb","application/vnd.3gpp.pic-bw-small"],["psd","application/x-photoshop"],["psf","application/x-font-linux-psf"],["pskcxml","application/pskc+xml"],["pti","image/prs.pti"],["ptid","application/vnd.pvi.ptid1"],["pub","application/x-mspublisher"],["pvb","application/vnd.3gpp.pic-bw-var"],["pwn","application/vnd.3m.post-it-notes"],["pya","audio/vnd.ms-playready.media.pya"],["pyv","video/vnd.ms-playready.media.pyv"],["qam","application/vnd.epson.quickanime"],["qbo","application/vnd.intu.qbo"],["qfx","application/vnd.intu.qfx"],["qps","application/vnd.publishare-delta-tree"],["qt","video/quicktime"],["qwd","application/vnd.quark.quarkxpress"],["qwt","application/vnd.quark.quarkxpress"],["qxb","application/vnd.quark.quarkxpress"],["qxd","application/vnd.quark.quarkxpress"],["qxl","application/vnd.quark.quarkxpress"],["qxt","application/vnd.quark.quarkxpress"],["ra","audio/x-realaudio"],["ram","audio/x-pn-realaudio"],["raml","application/raml+yaml"],["rapd","application/route-apd+xml"],["rar","application/x-rar"],["ras","image/x-cmu-raster"],["rcprofile","application/vnd.ipunplugged.rcprofile"],["rdf","application/rdf+xml"],["rdz","application/vnd.data-vision.rdz"],["relo","application/p2p-overlay+xml"],["rep","application/vnd.businessobjects"],["res","application/x-dtbresource+xml"],["rgb","image/x-rgb"],["rif","application/reginfo+xml"],["rip","audio/vnd.rip"],["ris","application/x-research-info-systems"],["rl","application/resource-lists+xml"],["rlc","image/vnd.fujixerox.edmics-rlc"],["rld","application/resource-lists-diff+xml"],["rm","audio/x-pn-realaudio"],["rmi","audio/midi"],["rmp","audio/x-pn-realaudio-plugin"],["rms","application/vnd.jcp.javame.midlet-rms"],["rmvb","application/vnd.rn-realmedia-vbr"],["rnc","application/relax-ng-compact-syntax"],["rng","application/xml"],["roa","application/rpki-roa"],["roff","text/troff"],["rp9","application/vnd.cloanto.rp9"],["rpm","audio/x-pn-realaudio-plugin"],["rpss","application/vnd.nokia.radio-presets"],["rpst","application/vnd.nokia.radio-preset"],["rq","application/sparql-query"],["rs","application/rls-services+xml"],["rsa","application/x-pkcs7"],["rsat","application/atsc-rsat+xml"],["rsd","application/rsd+xml"],["rsheet","application/urc-ressheet+xml"],["rss","application/rss+xml"],["rtf","text/rtf"],["rtx","text/richtext"],["run","application/x-makeself"],["rusd","application/route-usd+xml"],["rv","video/vnd.rn-realvideo"],["s","text/x-asm"],["s3m","audio/s3m"],["saf","application/vnd.yamaha.smaf-audio"],["sass","text/x-sass"],["sbml","application/sbml+xml"],["sc","application/vnd.ibm.secure-container"],["scd","application/x-msschedule"],["scm","application/vnd.lotus-screencam"],["scq","application/scvp-cv-request"],["scs","application/scvp-cv-response"],["scss","text/x-scss"],["scurl","text/vnd.curl.scurl"],["sda","application/vnd.stardivision.draw"],["sdc","application/vnd.stardivision.calc"],["sdd","application/vnd.stardivision.impress"],["sdkd","application/vnd.solent.sdkm+xml"],["sdkm","application/vnd.solent.sdkm+xml"],["sdp","application/sdp"],["sdw","application/vnd.stardivision.writer"],["sea","application/octet-stream"],["see","application/vnd.seemail"],["seed","application/vnd.fdsn.seed"],["sema","application/vnd.sema"],["semd","application/vnd.semd"],["semf","application/vnd.semf"],["senmlx","application/senml+xml"],["sensmlx","application/sensml+xml"],["ser","application/java-serialized-object"],["setpay","application/set-payment-initiation"],["setreg","application/set-registration-initiation"],["sfd-hdstx","application/vnd.hydrostatix.sof-data"],["sfs","application/vnd.spotfire.sfs"],["sfv","text/x-sfv"],["sgi","image/sgi"],["sgl","application/vnd.stardivision.writer-global"],["sgm","text/sgml"],["sgml","text/sgml"],["sh","application/x-sh"],["shar","application/x-shar"],["shex","text/shex"],["shf","application/shf+xml"],["shtml","text/html"],["sid","image/x-mrsid-image"],["sieve","application/sieve"],["sig","application/pgp-signature"],["sil","audio/silk"],["silo","model/mesh"],["sis","application/vnd.symbian.install"],["sisx","application/vnd.symbian.install"],["sit","application/x-stuffit"],["sitx","application/x-stuffitx"],["siv","application/sieve"],["skd","application/vnd.koan"],["skm","application/vnd.koan"],["skp","application/vnd.koan"],["skt","application/vnd.koan"],["sldm","application/vnd.ms-powerpoint.slide.macroenabled.12"],["sldx","application/vnd.openxmlformats-officedocument.presentationml.slide"],["slim","text/slim"],["slm","text/slim"],["sls","application/route-s-tsid+xml"],["slt","application/vnd.epson.salt"],["sm","application/vnd.stepmania.stepchart"],["smf","application/vnd.stardivision.math"],["smi","application/smil"],["smil","application/smil"],["smv","video/x-smv"],["smzip","application/vnd.stepmania.package"],["snd","audio/basic"],["snf","application/x-font-snf"],["so","application/octet-stream"],["spc","application/x-pkcs7-certificates"],["spdx","text/spdx"],["spf","application/vnd.yamaha.smaf-phrase"],["spl","application/x-futuresplash"],["spot","text/vnd.in3d.spot"],["spp","application/scvp-vp-response"],["spq","application/scvp-vp-request"],["spx","audio/ogg"],["sql","application/x-sql"],["src","application/x-wais-source"],["srt","application/x-subrip"],["sru","application/sru+xml"],["srx","application/sparql-results+xml"],["ssdl","application/ssdl+xml"],["sse","application/vnd.kodak-descriptor"],["ssf","application/vnd.epson.ssf"],["ssml","application/ssml+xml"],["sst","application/octet-stream"],["st","application/vnd.sailingtracker.track"],["stc","application/vnd.sun.xml.calc.template"],["std","application/vnd.sun.xml.draw.template"],["stf","application/vnd.wt.stf"],["sti","application/vnd.sun.xml.impress.template"],["stk","application/hyperstudio"],["stl","model/stl"],["stpx","model/step+xml"],["stpxz","model/step-xml+zip"],["stpz","model/step+zip"],["str","application/vnd.pg.format"],["stw","application/vnd.sun.xml.writer.template"],["styl","text/stylus"],["stylus","text/stylus"],["sub","text/vnd.dvb.subtitle"],["sus","application/vnd.sus-calendar"],["susp","application/vnd.sus-calendar"],["sv4cpio","application/x-sv4cpio"],["sv4crc","application/x-sv4crc"],["svc","application/vnd.dvb.service"],["svd","application/vnd.svd"],["svg","image/svg+xml"],["svgz","image/svg+xml"],["swa","application/x-director"],["swf","application/x-shockwave-flash"],["swi","application/vnd.aristanetworks.swi"],["swidtag","application/swid+xml"],["sxc","application/vnd.sun.xml.calc"],["sxd","application/vnd.sun.xml.draw"],["sxg","application/vnd.sun.xml.writer.global"],["sxi","application/vnd.sun.xml.impress"],["sxm","application/vnd.sun.xml.math"],["sxw","application/vnd.sun.xml.writer"],["t","text/troff"],["t3","application/x-t3vm-image"],["t38","image/t38"],["taglet","application/vnd.mynfc"],["tao","application/vnd.tao.intent-module-archive"],["tap","image/vnd.tencent.tap"],["tar","application/x-tar"],["tcap","application/vnd.3gpp2.tcap"],["tcl","application/x-tcl"],["td","application/urc-targetdesc+xml"],["teacher","application/vnd.smart.teacher"],["tei","application/tei+xml"],["teicorpus","application/tei+xml"],["tex","application/x-tex"],["texi","application/x-texinfo"],["texinfo","application/x-texinfo"],["text","text/plain"],["tfi","application/thraud+xml"],["tfm","application/x-tex-tfm"],["tfx","image/tiff-fx"],["tga","image/x-tga"],["tgz","application/x-tar"],["thmx","application/vnd.ms-officetheme"],["tif","image/tiff"],["tiff","image/tiff"],["tk","application/x-tcl"],["tmo","application/vnd.tmobile-livetv"],["toml","application/toml"],["torrent","application/x-bittorrent"],["tpl","application/vnd.groove-tool-template"],["tpt","application/vnd.trid.tpt"],["tr","text/troff"],["tra","application/vnd.trueapp"],["trig","application/trig"],["trm","application/x-msterminal"],["ts","video/mp2t"],["tsd","application/timestamped-data"],["tsv","text/tab-separated-values"],["ttc","font/collection"],["ttf","font/ttf"],["ttl","text/turtle"],["ttml","application/ttml+xml"],["twd","application/vnd.simtech-mindmapper"],["twds","application/vnd.simtech-mindmapper"],["txd","application/vnd.genomatix.tuxedo"],["txf","application/vnd.mobius.txf"],["txt","text/plain"],["u8dsn","message/global-delivery-status"],["u8hdr","message/global-headers"],["u8mdn","message/global-disposition-notification"],["u8msg","message/global"],["u32","application/x-authorware-bin"],["ubj","application/ubjson"],["udeb","application/x-debian-package"],["ufd","application/vnd.ufdl"],["ufdl","application/vnd.ufdl"],["ulx","application/x-glulx"],["umj","application/vnd.umajin"],["unityweb","application/vnd.unity"],["uoml","application/vnd.uoml+xml"],["uri","text/uri-list"],["uris","text/uri-list"],["urls","text/uri-list"],["usdz","model/vnd.usdz+zip"],["ustar","application/x-ustar"],["utz","application/vnd.uiq.theme"],["uu","text/x-uuencode"],["uva","audio/vnd.dece.audio"],["uvd","application/vnd.dece.data"],["uvf","application/vnd.dece.data"],["uvg","image/vnd.dece.graphic"],["uvh","video/vnd.dece.hd"],["uvi","image/vnd.dece.graphic"],["uvm","video/vnd.dece.mobile"],["uvp","video/vnd.dece.pd"],["uvs","video/vnd.dece.sd"],["uvt","application/vnd.dece.ttml+xml"],["uvu","video/vnd.uvvu.mp4"],["uvv","video/vnd.dece.video"],["uvva","audio/vnd.dece.audio"],["uvvd","application/vnd.dece.data"],["uvvf","application/vnd.dece.data"],["uvvg","image/vnd.dece.graphic"],["uvvh","video/vnd.dece.hd"],["uvvi","image/vnd.dece.graphic"],["uvvm","video/vnd.dece.mobile"],["uvvp","video/vnd.dece.pd"],["uvvs","video/vnd.dece.sd"],["uvvt","application/vnd.dece.ttml+xml"],["uvvu","video/vnd.uvvu.mp4"],["uvvv","video/vnd.dece.video"],["uvvx","application/vnd.dece.unspecified"],["uvvz","application/vnd.dece.zip"],["uvx","application/vnd.dece.unspecified"],["uvz","application/vnd.dece.zip"],["vbox","application/x-virtualbox-vbox"],["vbox-extpack","application/x-virtualbox-vbox-extpack"],["vcard","text/vcard"],["vcd","application/x-cdlink"],["vcf","text/x-vcard"],["vcg","application/vnd.groove-vcard"],["vcs","text/x-vcalendar"],["vcx","application/vnd.vcx"],["vdi","application/x-virtualbox-vdi"],["vds","model/vnd.sap.vds"],["vhd","application/x-virtualbox-vhd"],["vis","application/vnd.visionary"],["viv","video/vnd.vivo"],["vlc","application/videolan"],["vmdk","application/x-virtualbox-vmdk"],["vob","video/x-ms-vob"],["vor","application/vnd.stardivision.writer"],["vox","application/x-authorware-bin"],["vrml","model/vrml"],["vsd","application/vnd.visio"],["vsf","application/vnd.vsf"],["vss","application/vnd.visio"],["vst","application/vnd.visio"],["vsw","application/vnd.visio"],["vtf","image/vnd.valve.source.texture"],["vtt","text/vtt"],["vtu","model/vnd.vtu"],["vxml","application/voicexml+xml"],["w3d","application/x-director"],["wad","application/x-doom"],["wadl","application/vnd.sun.wadl+xml"],["war","application/java-archive"],["wasm","application/wasm"],["wav","audio/x-wav"],["wax","audio/x-ms-wax"],["wbmp","image/vnd.wap.wbmp"],["wbs","application/vnd.criticaltools.wbs+xml"],["wbxml","application/wbxml"],["wcm","application/vnd.ms-works"],["wdb","application/vnd.ms-works"],["wdp","image/vnd.ms-photo"],["weba","audio/webm"],["webapp","application/x-web-app-manifest+json"],["webm","video/webm"],["webmanifest","application/manifest+json"],["webp","image/webp"],["wg","application/vnd.pmi.widget"],["wgt","application/widget"],["wks","application/vnd.ms-works"],["wm","video/x-ms-wm"],["wma","audio/x-ms-wma"],["wmd","application/x-ms-wmd"],["wmf","image/wmf"],["wml","text/vnd.wap.wml"],["wmlc","application/wmlc"],["wmls","text/vnd.wap.wmlscript"],["wmlsc","application/vnd.wap.wmlscriptc"],["wmv","video/x-ms-wmv"],["wmx","video/x-ms-wmx"],["wmz","application/x-msmetafile"],["woff","font/woff"],["woff2","font/woff2"],["word","application/msword"],["wpd","application/vnd.wordperfect"],["wpl","application/vnd.ms-wpl"],["wps","application/vnd.ms-works"],["wqd","application/vnd.wqd"],["wri","application/x-mswrite"],["wrl","model/vrml"],["wsc","message/vnd.wfa.wsc"],["wsdl","application/wsdl+xml"],["wspolicy","application/wspolicy+xml"],["wtb","application/vnd.webturbo"],["wvx","video/x-ms-wvx"],["x3d","model/x3d+xml"],["x3db","model/x3d+fastinfoset"],["x3dbz","model/x3d+binary"],["x3dv","model/x3d-vrml"],["x3dvz","model/x3d+vrml"],["x3dz","model/x3d+xml"],["x32","application/x-authorware-bin"],["x_b","model/vnd.parasolid.transmit.binary"],["x_t","model/vnd.parasolid.transmit.text"],["xaml","application/xaml+xml"],["xap","application/x-silverlight-app"],["xar","application/vnd.xara"],["xav","application/xcap-att+xml"],["xbap","application/x-ms-xbap"],["xbd","application/vnd.fujixerox.docuworks.binder"],["xbm","image/x-xbitmap"],["xca","application/xcap-caps+xml"],["xcs","application/calendar+xml"],["xdf","application/xcap-diff+xml"],["xdm","application/vnd.syncml.dm+xml"],["xdp","application/vnd.adobe.xdp+xml"],["xdssc","application/dssc+xml"],["xdw","application/vnd.fujixerox.docuworks"],["xel","application/xcap-el+xml"],["xenc","application/xenc+xml"],["xer","application/patch-ops-error+xml"],["xfdf","application/vnd.adobe.xfdf"],["xfdl","application/vnd.xfdl"],["xht","application/xhtml+xml"],["xhtml","application/xhtml+xml"],["xhvml","application/xv+xml"],["xif","image/vnd.xiff"],["xl","application/excel"],["xla","application/vnd.ms-excel"],["xlam","application/vnd.ms-excel.addin.macroEnabled.12"],["xlc","application/vnd.ms-excel"],["xlf","application/xliff+xml"],["xlm","application/vnd.ms-excel"],["xls","application/vnd.ms-excel"],["xlsb","application/vnd.ms-excel.sheet.binary.macroEnabled.12"],["xlsm","application/vnd.ms-excel.sheet.macroEnabled.12"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xlt","application/vnd.ms-excel"],["xltm","application/vnd.ms-excel.template.macroEnabled.12"],["xltx","application/vnd.openxmlformats-officedocument.spreadsheetml.template"],["xlw","application/vnd.ms-excel"],["xm","audio/xm"],["xml","application/xml"],["xns","application/xcap-ns+xml"],["xo","application/vnd.olpc-sugar"],["xop","application/xop+xml"],["xpi","application/x-xpinstall"],["xpl","application/xproc+xml"],["xpm","image/x-xpixmap"],["xpr","application/vnd.is-xpr"],["xps","application/vnd.ms-xpsdocument"],["xpw","application/vnd.intercon.formnet"],["xpx","application/vnd.intercon.formnet"],["xsd","application/xml"],["xsl","application/xml"],["xslt","application/xslt+xml"],["xsm","application/vnd.syncml+xml"],["xspf","application/xspf+xml"],["xul","application/vnd.mozilla.xul+xml"],["xvm","application/xv+xml"],["xvml","application/xv+xml"],["xwd","image/x-xwindowdump"],["xyz","chemical/x-xyz"],["xz","application/x-xz"],["yaml","text/yaml"],["yang","application/yang"],["yin","application/yin+xml"],["yml","text/yaml"],["ymp","text/x-suse-ymp"],["z","application/x-compress"],["z1","application/x-zmachine"],["z2","application/x-zmachine"],["z3","application/x-zmachine"],["z4","application/x-zmachine"],["z5","application/x-zmachine"],["z6","application/x-zmachine"],["z7","application/x-zmachine"],["z8","application/x-zmachine"],["zaz","application/vnd.zzazz.deck+xml"],["zip","application/zip"],["zir","application/vnd.zul"],["zirz","application/vnd.zul"],["zmm","application/vnd.handheld-entertainment+xml"],["zsh","text/x-scriptzsh"]]);function toFileWithPath(s,e,t){const n=withMimeType(s),{webkitRelativePath:i}=s,o=typeof e=="string"?e:typeof i=="string"&&i.length>0?i:`./${s.name}`;return typeof n.path!="string"&&setObjProp(n,"path",o),setObjProp(n,"relativePath",o),n}function withMimeType(s){const{name:e}=s;if(e&&e.lastIndexOf(".")!==-1&&!s.type){const n=e.split(".").pop().toLowerCase(),i=COMMON_MIME_TYPES.get(n);i&&Object.defineProperty(s,"type",{value:i,writable:!1,configurable:!1,enumerable:!0})}return s}function setObjProp(s,e,t){Object.defineProperty(s,e,{value:t,writable:!1,configurable:!1,enumerable:!0})}const FILES_TO_IGNORE=[".DS_Store","Thumbs.db"];function fromEvent(s){return __awaiter$b(this,void 0,void 0,function*(){return isObject(s)&&isDataTransfer(s.dataTransfer)?getDataTransferFiles(s.dataTransfer,s.type):isChangeEvt(s)?getInputFiles(s):Array.isArray(s)&&s.every(e=>"getFile"in e&&typeof e.getFile=="function")?getFsHandleFiles(s):[]})}function isDataTransfer(s){return isObject(s)}function isChangeEvt(s){return isObject(s)&&isObject(s.target)}function isObject(s){return typeof s=="object"&&s!==null}function getInputFiles(s){return fromList(s.target.files).map(e=>toFileWithPath(e))}function getFsHandleFiles(s){return __awaiter$b(this,void 0,void 0,function*(){return(yield Promise.all(s.map(t=>t.getFile()))).map(t=>toFileWithPath(t))})}function getDataTransferFiles(s,e){return __awaiter$b(this,void 0,void 0,function*(){if(s.items){const t=fromList(s.items).filter(i=>i.kind==="file");if(e!=="drop")return t;const n=yield Promise.all(t.map(toFilePromises));return noIgnoredFiles(flatten(n))}return noIgnoredFiles(fromList(s.files).map(t=>toFileWithPath(t)))})}function noIgnoredFiles(s){return s.filter(e=>FILES_TO_IGNORE.indexOf(e.name)===-1)}function fromList(s){if(s===null)return[];const e=[];for(let t=0;t<s.length;t++){const n=s[t];e.push(n)}return e}function toFilePromises(s){if(typeof s.webkitGetAsEntry!="function")return fromDataTransferItem(s);const e=s.webkitGetAsEntry();return e&&e.isDirectory?fromDirEntry(e):fromDataTransferItem(s,e)}function flatten(s){return s.reduce((e,t)=>[...e,...Array.isArray(t)?flatten(t):[t]],[])}function fromDataTransferItem(s,e){return __awaiter$b(this,void 0,void 0,function*(){var t;if(globalThis.isSecureContext&&typeof s.getAsFileSystemHandle=="function"){const o=yield s.getAsFileSystemHandle();if(o===null)throw new Error(`${s} is not a File`);if(o!==void 0){const a=yield o.getFile();return a.handle=o,toFileWithPath(a)}}const n=s.getAsFile();if(!n)throw new Error(`${s} is not a File`);return toFileWithPath(n,(t=e?.fullPath)!==null&&t!==void 0?t:void 0)})}function fromEntry(s){return __awaiter$b(this,void 0,void 0,function*(){return s.isDirectory?fromDirEntry(s):fromFileEntry(s)})}function fromDirEntry(s){const e=s.createReader();return new Promise((t,n)=>{const i=[];function o(){e.readEntries(a=>__awaiter$b(this,void 0,void 0,function*(){if(a.length){const l=Promise.all(a.map(fromEntry));i.push(l),o()}else try{const l=yield Promise.all(i);t(l)}catch(l){n(l)}}),a=>{n(a)})}o()})}function fromFileEntry(s){return __awaiter$b(this,void 0,void 0,function*(){return new Promise((e,t)=>{s.file(n=>{const i=toFileWithPath(n,s.fullPath);e(i)},n=>{t(n)})})})}var es={},hasRequiredEs;function requireEs(){return hasRequiredEs||(hasRequiredEs=1,es.__esModule=!0,es.default=function(s,e){if(s&&e){var t=Array.isArray(e)?e:e.split(",");if(t.length===0)return!0;var n=s.name||"",i=(s.type||"").toLowerCase(),o=i.replace(/\/.*$/,"");return t.some(function(a){var l=a.trim().toLowerCase();return l.charAt(0)==="."?n.toLowerCase().endsWith(l):l.endsWith("/*")?o===l.replace(/\/.*$/,""):i===l})}return!0}),es}var esExports=requireEs();const _accepts=getDefaultExportFromCjs(esExports);function _toConsumableArray$1(s){return _arrayWithoutHoles$1(s)||_iterableToArray$1(s)||_unsupportedIterableToArray$1(s)||_nonIterableSpread$1()}function _nonIterableSpread$1(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArray$1(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function _arrayWithoutHoles$1(s){if(Array.isArray(s))return _arrayLikeToArray$1(s)}function ownKeys$1(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(s,i).enumerable})),t.push.apply(t,n)}return t}function _objectSpread$1(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ownKeys$1(Object(t),!0).forEach(function(n){_defineProperty$1(s,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):ownKeys$1(Object(t)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(t,n))})}return s}function _defineProperty$1(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function _slicedToArray$1(s,e){return _arrayWithHoles$1(s)||_iterableToArrayLimit$1(s,e)||_unsupportedIterableToArray$1(s,e)||_nonIterableRest$1()}function _nonIterableRest$1(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray$1(s,e){if(s){if(typeof s=="string")return _arrayLikeToArray$1(s,e);var t=Object.prototype.toString.call(s).slice(8,-1);if(t==="Object"&&s.constructor&&(t=s.constructor.name),t==="Map"||t==="Set")return Array.from(s);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return _arrayLikeToArray$1(s,e)}}function _arrayLikeToArray$1(s,e){(e==null||e>s.length)&&(e=s.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=s[t];return n}function _iterableToArrayLimit$1(s,e){var t=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(t!=null){var n=[],i=!0,o=!1,a,l;try{for(t=t.call(s);!(i=(a=t.next()).done)&&(n.push(a.value),!(e&&n.length===e));i=!0);}catch(h){o=!0,l=h}finally{try{!i&&t.return!=null&&t.return()}finally{if(o)throw l}}return n}}function _arrayWithHoles$1(s){if(Array.isArray(s))return s}var accepts=typeof _accepts=="function"?_accepts:_accepts.default,FILE_INVALID_TYPE="file-invalid-type",FILE_TOO_LARGE="file-too-large",FILE_TOO_SMALL="file-too-small",TOO_MANY_FILES="too-many-files",getInvalidTypeRejectionErr=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",t=e.split(","),n=t.length>1?"one of ".concat(t.join(", ")):t[0];return{code:FILE_INVALID_TYPE,message:"File type must be ".concat(n)}},getTooLargeRejectionErr=function(e){return{code:FILE_TOO_LARGE,message:"File is larger than ".concat(e," ").concat(e===1?"byte":"bytes")}},getTooSmallRejectionErr=function(e){return{code:FILE_TOO_SMALL,message:"File is smaller than ".concat(e," ").concat(e===1?"byte":"bytes")}},TOO_MANY_FILES_REJECTION={code:TOO_MANY_FILES,message:"Too many files"};function fileAccepted(s,e){var t=s.type==="application/x-moz-file"||accepts(s,e);return[t,t?null:getInvalidTypeRejectionErr(e)]}function fileMatchSize(s,e,t){if(isDefined$1(s.size))if(isDefined$1(e)&&isDefined$1(t)){if(s.size>t)return[!1,getTooLargeRejectionErr(t)];if(s.size<e)return[!1,getTooSmallRejectionErr(e)]}else{if(isDefined$1(e)&&s.size<e)return[!1,getTooSmallRejectionErr(e)];if(isDefined$1(t)&&s.size>t)return[!1,getTooLargeRejectionErr(t)]}return[!0,null]}function isDefined$1(s){return s!=null}function allFilesAccepted(s){var e=s.files,t=s.accept,n=s.minSize,i=s.maxSize,o=s.multiple,a=s.maxFiles,l=s.validator;return!o&&e.length>1||o&&a>=1&&e.length>a?!1:e.every(function(h){var d=fileAccepted(h,t),u=_slicedToArray$1(d,1),f=u[0],m=fileMatchSize(h,n,i),v=_slicedToArray$1(m,1),g=v[0],x=l?l(h):null;return f&&g&&!x})}function isPropagationStopped(s){return typeof s.isPropagationStopped=="function"?s.isPropagationStopped():typeof s.cancelBubble<"u"?s.cancelBubble:!1}function isEvtWithFiles(s){return s.dataTransfer?Array.prototype.some.call(s.dataTransfer.types,function(e){return e==="Files"||e==="application/x-moz-file"}):!!s.target&&!!s.target.files}function onDocumentDragOver(s){s.preventDefault()}function isIe(s){return s.indexOf("MSIE")!==-1||s.indexOf("Trident/")!==-1}function isEdge(s){return s.indexOf("Edge/")!==-1}function isIeOrEdge(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return isIe(s)||isEdge(s)}function composeEventHandlers(){for(var s=arguments.length,e=new Array(s),t=0;t<s;t++)e[t]=arguments[t];return function(n){for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];return e.some(function(l){return!isPropagationStopped(n)&&l&&l.apply(void 0,[n].concat(o)),isPropagationStopped(n)})}}function canUseFileSystemAccessAPI(){return"showOpenFilePicker"in window}function pickerOptionsFromAccept(s){if(isDefined$1(s)){var e=Object.entries(s).filter(function(t){var n=_slicedToArray$1(t,2),i=n[0],o=n[1],a=!0;return isMIMEType(i)||(console.warn('Skipped "'.concat(i,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),a=!1),(!Array.isArray(o)||!o.every(isExt))&&(console.warn('Skipped "'.concat(i,'" because an invalid file extension was provided.')),a=!1),a}).reduce(function(t,n){var i=_slicedToArray$1(n,2),o=i[0],a=i[1];return _objectSpread$1(_objectSpread$1({},t),{},_defineProperty$1({},o,a))},{});return[{description:"Files",accept:e}]}return s}function acceptPropAsAcceptAttr(s){if(isDefined$1(s))return Object.entries(s).reduce(function(e,t){var n=_slicedToArray$1(t,2),i=n[0],o=n[1];return[].concat(_toConsumableArray$1(e),[i],_toConsumableArray$1(o))},[]).filter(function(e){return isMIMEType(e)||isExt(e)}).join(",")}function isAbort(s){return s instanceof DOMException&&(s.name==="AbortError"||s.code===s.ABORT_ERR)}function isSecurityError(s){return s instanceof DOMException&&(s.name==="SecurityError"||s.code===s.SECURITY_ERR)}function isMIMEType(s){return s==="audio/*"||s==="video/*"||s==="image/*"||s==="text/*"||s==="application/*"||/\w+\/[-+.\w]+/g.test(s)}function isExt(s){return/^.*\.[\w]+$/.test(s)}var _excluded=["children"],_excluded2=["open"],_excluded3=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],_excluded4=["refKey","onChange","onClick"];function _toConsumableArray(s){return _arrayWithoutHoles(s)||_iterableToArray(s)||_unsupportedIterableToArray(s)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _iterableToArray(s){if(typeof Symbol<"u"&&s[Symbol.iterator]!=null||s["@@iterator"]!=null)return Array.from(s)}function _arrayWithoutHoles(s){if(Array.isArray(s))return _arrayLikeToArray(s)}function _slicedToArray(s,e){return _arrayWithHoles(s)||_iterableToArrayLimit(s,e)||_unsupportedIterableToArray(s,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _unsupportedIterableToArray(s,e){if(s){if(typeof s=="string")return _arrayLikeToArray(s,e);var t=Object.prototype.toString.call(s).slice(8,-1);if(t==="Object"&&s.constructor&&(t=s.constructor.name),t==="Map"||t==="Set")return Array.from(s);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return _arrayLikeToArray(s,e)}}function _arrayLikeToArray(s,e){(e==null||e>s.length)&&(e=s.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=s[t];return n}function _iterableToArrayLimit(s,e){var t=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(t!=null){var n=[],i=!0,o=!1,a,l;try{for(t=t.call(s);!(i=(a=t.next()).done)&&(n.push(a.value),!(e&&n.length===e));i=!0);}catch(h){o=!0,l=h}finally{try{!i&&t.return!=null&&t.return()}finally{if(o)throw l}}return n}}function _arrayWithHoles(s){if(Array.isArray(s))return s}function ownKeys(s,e){var t=Object.keys(s);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(s);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(s,i).enumerable})),t.push.apply(t,n)}return t}function _objectSpread(s){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?ownKeys(Object(t),!0).forEach(function(n){_defineProperty(s,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(n){Object.defineProperty(s,n,Object.getOwnPropertyDescriptor(t,n))})}return s}function _defineProperty(s,e,t){return e in s?Object.defineProperty(s,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):s[e]=t,s}function _objectWithoutProperties(s,e){if(s==null)return{};var t=_objectWithoutPropertiesLoose(s,e),n,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(s);for(i=0;i<o.length;i++)n=o[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(s,n)&&(t[n]=s[n])}return t}function _objectWithoutPropertiesLoose(s,e){if(s==null)return{};var t={},n=Object.keys(s),i,o;for(o=0;o<n.length;o++)i=n[o],!(e.indexOf(i)>=0)&&(t[i]=s[i]);return t}var Dropzone=reactExports.forwardRef(function(s,e){var t=s.children,n=_objectWithoutProperties(s,_excluded),i=useDropzone(n),o=i.open,a=_objectWithoutProperties(i,_excluded2);return reactExports.useImperativeHandle(e,function(){return{open:o}},[o]),React.createElement(reactExports.Fragment,null,t(_objectSpread(_objectSpread({},a),{},{open:o})))});Dropzone.displayName="Dropzone";var defaultProps={disabled:!1,getFilesFromEvent:fromEvent,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!1,autoFocus:!1};Dropzone.defaultProps=defaultProps;Dropzone.propTypes={children:PropTypes.func,accept:PropTypes.objectOf(PropTypes.arrayOf(PropTypes.string)),multiple:PropTypes.bool,preventDropOnDocument:PropTypes.bool,noClick:PropTypes.bool,noKeyboard:PropTypes.bool,noDrag:PropTypes.bool,noDragEventsBubbling:PropTypes.bool,minSize:PropTypes.number,maxSize:PropTypes.number,maxFiles:PropTypes.number,disabled:PropTypes.bool,getFilesFromEvent:PropTypes.func,onFileDialogCancel:PropTypes.func,onFileDialogOpen:PropTypes.func,useFsAccessApi:PropTypes.bool,autoFocus:PropTypes.bool,onDragEnter:PropTypes.func,onDragLeave:PropTypes.func,onDragOver:PropTypes.func,onDrop:PropTypes.func,onDropAccepted:PropTypes.func,onDropRejected:PropTypes.func,onError:PropTypes.func,validator:PropTypes.func};var initialState={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function useDropzone(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=_objectSpread(_objectSpread({},defaultProps),s),t=e.accept,n=e.disabled,i=e.getFilesFromEvent,o=e.maxSize,a=e.minSize,l=e.multiple,h=e.maxFiles,d=e.onDragEnter,u=e.onDragLeave,f=e.onDragOver,m=e.onDrop,v=e.onDropAccepted,g=e.onDropRejected,x=e.onFileDialogCancel,E=e.onFileDialogOpen,b=e.useFsAccessApi,_=e.autoFocus,S=e.preventDropOnDocument,C=e.noClick,A=e.noKeyboard,R=e.noDrag,L=e.noDragEventsBubbling,j=e.onError,F=e.validator,W=reactExports.useMemo(function(){return acceptPropAsAcceptAttr(t)},[t]),K=reactExports.useMemo(function(){return pickerOptionsFromAccept(t)},[t]),ee=reactExports.useMemo(function(){return typeof E=="function"?E:noop$1},[E]),te=reactExports.useMemo(function(){return typeof x=="function"?x:noop$1},[x]),re=reactExports.useRef(null),ie=reactExports.useRef(null),Q=reactExports.useReducer(reducer$1,initialState),z=_slicedToArray(Q,2),N=z[0],k=z[1],I=N.isFocused,D=N.isFileDialogActive,U=reactExports.useRef(typeof window<"u"&&window.isSecureContext&&b&&canUseFileSystemAccessAPI()),$=function(){!U.current&&D&&setTimeout(function(){if(ie.current){var Te=ie.current.files;Te.length||(k({type:"closeDialog"}),te())}},300)};reactExports.useEffect(function(){return window.addEventListener("focus",$,!1),function(){window.removeEventListener("focus",$,!1)}},[ie,D,te,U]);var q=reactExports.useRef([]),V=function(Te){re.current&&re.current.contains(Te.target)||(Te.preventDefault(),q.current=[])};reactExports.useEffect(function(){return S&&(document.addEventListener("dragover",onDocumentDragOver,!1),document.addEventListener("drop",V,!1)),function(){S&&(document.removeEventListener("dragover",onDocumentDragOver),document.removeEventListener("drop",V))}},[re,S]),reactExports.useEffect(function(){return!n&&_&&re.current&&re.current.focus(),function(){}},[re,_,n]);var P=reactExports.useCallback(function(xe){j?j(xe):console.error(xe)},[j]),O=reactExports.useCallback(function(xe){xe.preventDefault(),xe.persist(),Ae(xe),q.current=[].concat(_toConsumableArray(q.current),[xe.target]),isEvtWithFiles(xe)&&Promise.resolve(i(xe)).then(function(Te){if(!(isPropagationStopped(xe)&&!L)){var $e=Te.length,Ue=$e>0&&allFilesAccepted({files:Te,accept:W,minSize:a,maxSize:o,multiple:l,maxFiles:h,validator:F}),qe=$e>0&&!Ue;k({isDragAccept:Ue,isDragReject:qe,isDragActive:!0,type:"setDraggedFiles"}),d&&d(xe)}}).catch(function(Te){return P(Te)})},[i,d,P,L,W,a,o,l,h,F]),B=reactExports.useCallback(function(xe){xe.preventDefault(),xe.persist(),Ae(xe);var Te=isEvtWithFiles(xe);if(Te&&xe.dataTransfer)try{xe.dataTransfer.dropEffect="copy"}catch{}return Te&&f&&f(xe),!1},[f,L]),G=reactExports.useCallback(function(xe){xe.preventDefault(),xe.persist(),Ae(xe);var Te=q.current.filter(function(Ue){return re.current&&re.current.contains(Ue)}),$e=Te.indexOf(xe.target);$e!==-1&&Te.splice($e,1),q.current=Te,!(Te.length>0)&&(k({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),isEvtWithFiles(xe)&&u&&u(xe))},[re,u,L]),Y=reactExports.useCallback(function(xe,Te){var $e=[],Ue=[];xe.forEach(function(qe){var Ke=fileAccepted(qe,W),Ge=_slicedToArray(Ke,2),xt=Ge[0],ut=Ge[1],Ot=fileMatchSize(qe,a,o),be=_slicedToArray(Ot,2),he=be[0],le=be[1],Re=F?F(qe):null;if(xt&&he&&!Re)$e.push(qe);else{var ze=[ut,le];Re&&(ze=ze.concat(Re)),Ue.push({file:qe,errors:ze.filter(function(He){return He})})}}),(!l&&$e.length>1||l&&h>=1&&$e.length>h)&&($e.forEach(function(qe){Ue.push({file:qe,errors:[TOO_MANY_FILES_REJECTION]})}),$e.splice(0)),k({acceptedFiles:$e,fileRejections:Ue,isDragReject:Ue.length>0,type:"setFiles"}),m&&m($e,Ue,Te),Ue.length>0&&g&&g(Ue,Te),$e.length>0&&v&&v($e,Te)},[k,l,W,a,o,h,m,v,g,F]),J=reactExports.useCallback(function(xe){xe.preventDefault(),xe.persist(),Ae(xe),q.current=[],isEvtWithFiles(xe)&&Promise.resolve(i(xe)).then(function(Te){isPropagationStopped(xe)&&!L||Y(Te,xe)}).catch(function(Te){return P(Te)}),k({type:"reset"})},[i,Y,P,L]),Z=reactExports.useCallback(function(){if(U.current){k({type:"openDialog"}),ee();var xe={multiple:l,types:K};window.showOpenFilePicker(xe).then(function(Te){return i(Te)}).then(function(Te){Y(Te,null),k({type:"closeDialog"})}).catch(function(Te){isAbort(Te)?(te(Te),k({type:"closeDialog"})):isSecurityError(Te)?(U.current=!1,ie.current?(ie.current.value=null,ie.current.click()):P(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):P(Te)});return}ie.current&&(k({type:"openDialog"}),ee(),ie.current.value=null,ie.current.click())},[k,ee,te,b,Y,P,K,l]),oe=reactExports.useCallback(function(xe){!re.current||!re.current.isEqualNode(xe.target)||(xe.key===" "||xe.key==="Enter"||xe.keyCode===32||xe.keyCode===13)&&(xe.preventDefault(),Z())},[re,Z]),ve=reactExports.useCallback(function(){k({type:"focus"})},[]),ce=reactExports.useCallback(function(){k({type:"blur"})},[]),ue=reactExports.useCallback(function(){C||(isIeOrEdge()?setTimeout(Z,0):Z())},[C,Z]),de=function(Te){return n?null:Te},pe=function(Te){return A?null:de(Te)},ye=function(Te){return R?null:de(Te)},Ae=function(Te){L&&Te.stopPropagation()},Ce=reactExports.useMemo(function(){return function(){var xe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Te=xe.refKey,$e=Te===void 0?"ref":Te,Ue=xe.role,qe=xe.onKeyDown,Ke=xe.onFocus,Ge=xe.onBlur,xt=xe.onClick,ut=xe.onDragEnter,Ot=xe.onDragOver,be=xe.onDragLeave,he=xe.onDrop,le=_objectWithoutProperties(xe,_excluded3);return _objectSpread(_objectSpread(_defineProperty({onKeyDown:pe(composeEventHandlers(qe,oe)),onFocus:pe(composeEventHandlers(Ke,ve)),onBlur:pe(composeEventHandlers(Ge,ce)),onClick:de(composeEventHandlers(xt,ue)),onDragEnter:ye(composeEventHandlers(ut,O)),onDragOver:ye(composeEventHandlers(Ot,B)),onDragLeave:ye(composeEventHandlers(be,G)),onDrop:ye(composeEventHandlers(he,J)),role:typeof Ue=="string"&&Ue!==""?Ue:"presentation"},$e,re),!n&&!A?{tabIndex:0}:{}),le)}},[re,oe,ve,ce,ue,O,B,G,J,A,R,n]),Pe=reactExports.useCallback(function(xe){xe.stopPropagation()},[]),Oe=reactExports.useMemo(function(){return function(){var xe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Te=xe.refKey,$e=Te===void 0?"ref":Te,Ue=xe.onChange,qe=xe.onClick,Ke=_objectWithoutProperties(xe,_excluded4),Ge=_defineProperty({accept:W,multiple:l,type:"file",style:{border:0,clip:"rect(0, 0, 0, 0)",clipPath:"inset(50%)",height:"1px",margin:"0 -1px -1px 0",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap"},onChange:de(composeEventHandlers(Ue,J)),onClick:de(composeEventHandlers(qe,Pe)),tabIndex:-1},$e,ie);return _objectSpread(_objectSpread({},Ge),Ke)}},[ie,t,l,J,n]);return _objectSpread(_objectSpread({},N),{},{isFocused:I&&!n,getRootProps:Ce,getInputProps:Oe,rootRef:re,inputRef:ie,open:de(Z)})}function reducer$1(s,e){switch(e.type){case"focus":return _objectSpread(_objectSpread({},s),{},{isFocused:!0});case"blur":return _objectSpread(_objectSpread({},s),{},{isFocused:!1});case"openDialog":return _objectSpread(_objectSpread({},initialState),{},{isFileDialogActive:!0});case"closeDialog":return _objectSpread(_objectSpread({},s),{},{isFileDialogActive:!1});case"setDraggedFiles":return _objectSpread(_objectSpread({},s),{},{isDragActive:e.isDragActive,isDragAccept:e.isDragAccept,isDragReject:e.isDragReject});case"setFiles":return _objectSpread(_objectSpread({},s),{},{acceptedFiles:e.acceptedFiles,fileRejections:e.fileRejections,isDragReject:e.isDragReject});case"reset":return _objectSpread({},initialState);default:return s}}function noop$1(){}const isNodeJS=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),FONT_IDENTITY_MATRIX=[.001,0,0,.001,0,0],LINE_FACTOR=1.35,RenderingIntentFlag={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},AnnotationMode={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},AnnotationEditorPrefix="pdfjs_internal_editor_",AnnotationEditorType={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},AnnotationEditorParamsType={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},PermissionFlag={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},TextRenderingMode={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},util_ImageKind={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},AnnotationType={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},AnnotationBorderStyleType={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},VerbosityLevel={ERRORS:0,WARNINGS:1,INFOS:5},OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},DrawOPS={moveTo:0,lineTo:1,curveTo:2,closePath:3},PasswordResponses$1={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let verbosity=VerbosityLevel.WARNINGS;function setVerbosityLevel(s){Number.isInteger(s)&&(verbosity=s)}function getVerbosityLevel(){return verbosity}function info(s){verbosity>=VerbosityLevel.INFOS&&console.info(`Info: ${s}`)}function warn(s){verbosity>=VerbosityLevel.WARNINGS&&console.warn(`Warning: ${s}`)}function unreachable(s){throw new Error(s)}function assert$1(s,e){s||unreachable(e)}function _isValidProtocol(s){switch(s?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function createValidAbsoluteUrl(s,e=null,t=null){if(!s)return null;if(t&&typeof s=="string"&&(t.addDefaultProtocol&&s.startsWith("www.")&&s.match(/\./g)?.length>=2&&(s=`http://${s}`),t.tryConvertEncoding))try{s=stringToUTF8String(s)}catch{}const n=e?URL.parse(s,e):URL.parse(s);return _isValidProtocol(n)?n:null}function updateUrlHash(s,e,t=!1){const n=URL.parse(s);return n?(n.hash=e,n.href):t&&createValidAbsoluteUrl(s,"http://example.com")?s.split("#",1)[0]+`${e?`#${e}`:""}`:""}function shadow(s,e,t,n=!1){return Object.defineProperty(s,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}const BaseException=(function(){function e(t,n){this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e})();class PasswordException extends BaseException{constructor(e,t){super(e,"PasswordException"),this.code=t}}class UnknownErrorException extends BaseException{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class InvalidPDFException extends BaseException{constructor(e){super(e,"InvalidPDFException")}}class ResponseException extends BaseException{constructor(e,t,n){super(e,"ResponseException"),this.status=t,this.missing=n}}class FormatError extends BaseException{constructor(e){super(e,"FormatError")}}class AbortException extends BaseException{constructor(e){super(e,"AbortException")}}function bytesToString(s){(typeof s!="object"||s?.length===void 0)&&unreachable("Invalid argument for bytesToString");const e=s.length,t=8192;if(e<t)return String.fromCharCode.apply(null,s);const n=[];for(let i=0;i<e;i+=t){const o=Math.min(i+t,e),a=s.subarray(i,o);n.push(String.fromCharCode.apply(null,a))}return n.join("")}function stringToBytes(s){typeof s!="string"&&unreachable("Invalid argument for stringToBytes");const e=s.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=s.charCodeAt(n)&255;return t}function string32(s){return String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255)}function isLittleEndian(){const s=new Uint8Array(4);return s[0]=1,new Uint32Array(s.buffer,0,1)[0]===1}function isEvalSupported(){try{return new Function(""),!0}catch{return!1}}class util_FeatureTest{static get isLittleEndian(){return shadow(this,"isLittleEndian",isLittleEndian())}static get isEvalSupported(){return shadow(this,"isEvalSupported",isEvalSupported())}static get isOffscreenCanvasSupported(){return shadow(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return shadow(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return shadow(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){return shadow(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const hexNumbers=Array.from(Array(256).keys(),s=>s.toString(16).padStart(2,"0"));class Util{static makeHexColor(e,t,n){return`#${hexNumbers[e]}${hexNumbers[t]}${hexNumbers[n]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,n=0){const i=e[n],o=e[n+1];e[n]=i*t[0]+o*t[2]+t[4],e[n+1]=i*t[1]+o*t[3]+t[5]}static applyTransformToBezier(e,t,n=0){const i=t[0],o=t[1],a=t[2],l=t[3],h=t[4],d=t[5];for(let u=0;u<6;u+=2){const f=e[n+u],m=e[n+u+1];e[n+u]=f*i+m*a+h,e[n+u+1]=f*o+m*l+d}}static applyInverseTransform(e,t){const n=e[0],i=e[1],o=t[0]*t[3]-t[1]*t[2];e[0]=(n*t[3]-i*t[2]+t[2]*t[5]-t[4]*t[3])/o,e[1]=(-n*t[1]+i*t[0]+t[4]*t[1]-t[5]*t[0])/o}static axialAlignedBoundingBox(e,t,n){const i=t[0],o=t[1],a=t[2],l=t[3],h=t[4],d=t[5],u=e[0],f=e[1],m=e[2],v=e[3];let g=i*u+h,x=g,E=i*m+h,b=E,_=l*f+d,S=_,C=l*v+d,A=C;if(o!==0||a!==0){const R=o*u,L=o*m,j=a*f,F=a*v;g+=j,b+=j,E+=F,x+=F,_+=R,A+=R,C+=L,S+=L}n[0]=Math.min(n[0],g,E,x,b),n[1]=Math.min(n[1],_,C,S,A),n[2]=Math.max(n[2],g,E,x,b),n[3]=Math.max(n[3],_,C,S,A)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const n=e[0],i=e[1],o=e[2],a=e[3],l=n**2+i**2,h=n*o+i*a,d=o**2+a**2,u=(l+d)/2,f=Math.sqrt(u**2-(l*d-h**2));t[0]=Math.sqrt(u+f||1),t[1]=Math.sqrt(u-f||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),i=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>i)return null;const o=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),a=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return o>a?null:[n,o,i,a]}static pointBoundingBox(e,t,n){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}static rectBoundingBox(e,t,n,i,o){o[0]=Math.min(o[0],e,n),o[1]=Math.min(o[1],t,i),o[2]=Math.max(o[2],e,n),o[3]=Math.max(o[3],t,i)}static#e(e,t,n,i,o,a,l,h,d,u){if(d<=0||d>=1)return;const f=1-d,m=d*d,v=m*d,g=f*(f*(f*e+3*d*t)+3*m*n)+v*i,x=f*(f*(f*o+3*d*a)+3*m*l)+v*h;u[0]=Math.min(u[0],g),u[1]=Math.min(u[1],x),u[2]=Math.max(u[2],g),u[3]=Math.max(u[3],x)}static#t(e,t,n,i,o,a,l,h,d,u,f,m){if(Math.abs(d)<1e-12){Math.abs(u)>=1e-12&&this.#e(e,t,n,i,o,a,l,h,-f/u,m);return}const v=u**2-4*f*d;if(v<0)return;const g=Math.sqrt(v),x=2*d;this.#e(e,t,n,i,o,a,l,h,(-u+g)/x,m),this.#e(e,t,n,i,o,a,l,h,(-u-g)/x,m)}static bezierBoundingBox(e,t,n,i,o,a,l,h,d){d[0]=Math.min(d[0],e,l),d[1]=Math.min(d[1],t,h),d[2]=Math.max(d[2],e,l),d[3]=Math.max(d[3],t,h),this.#t(e,n,o,l,t,i,a,h,3*(-e+3*(n-o)+l),6*(e-2*n+o),3*(n-e),d),this.#t(e,n,o,l,t,i,a,h,3*(-t+3*(i-a)+h),6*(t-2*i+a),3*(i-t),d)}}function stringToUTF8String(s){return decodeURIComponent(escape(s))}let NormalizeRegex=null,NormalizationMap=null;function normalizeUnicode(s){return NormalizeRegex||(NormalizeRegex=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,NormalizationMap=new Map([["","t"]])),s.replaceAll(NormalizeRegex,(e,t,n)=>t?t.normalize("NFKC"):NormalizationMap.get(n))}function getUuid(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const s=new Uint8Array(32);return crypto.getRandomValues(s),bytesToString(s)}const AnnotationPrefix="pdfjs_internal_id_";function _isValidExplicitDest(s,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[n,i,...o]=t;if(!s(n)&&!Number.isInteger(n)||!e(i))return!1;const a=o.length;let l=!0;switch(i.name){case"XYZ":if(a<2||a>3)return!1;break;case"Fit":case"FitB":return a===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(a>1)return!1;break;case"FitR":if(a!==4)return!1;l=!1;break;default:return!1}for(const h of o)if(!(typeof h=="number"||l&&h===null))return!1;return!0}function MathClamp(s,e,t){return Math.min(Math.max(s,e),t)}function toBase64Util(s){return Uint8Array.prototype.toBase64?s.toBase64():btoa(bytesToString(s))}function fromBase64Util(s){return Uint8Array.fromBase64?Uint8Array.fromBase64(s):stringToBytes(atob(s))}typeof Promise.try!="function"&&(Promise.try=function(s,...e){return new Promise(t=>{t(s(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(s){return s.reduce((e,t)=>e+t,0)});class XfaText{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};function i(o){if(!o)return;let a=null;const l=o.name;if(l==="#text")a=o.value;else if(XfaText.shouldBuildText(l))o?.attributes?.textContent?a=o.attributes.textContent:o.value&&(a=o.value);else return;if(a!==null&&t.push({str:a}),!!o.children)for(const h of o.children)i(h)}return i(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class XfaLayer{static setupStorage(e,t,n,i,o){const a=i.getValue(t,{value:null});switch(n.name){case"textarea":if(a.value!==null&&(e.textContent=a.value),o==="print")break;e.addEventListener("input",l=>{i.setValue(t,{value:l.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(a.value===n.attributes.xfaOn?e.setAttribute("checked",!0):a.value===n.attributes.xfaOff&&e.removeAttribute("checked"),o==="print")break;e.addEventListener("change",l=>{i.setValue(t,{value:l.target.checked?l.target.getAttribute("xfaOn"):l.target.getAttribute("xfaOff")})})}else{if(a.value!==null&&e.setAttribute("value",a.value),o==="print")break;e.addEventListener("input",l=>{i.setValue(t,{value:l.target.value})})}break;case"select":if(a.value!==null){e.setAttribute("value",a.value);for(const l of n.children)l.attributes.value===a.value?l.attributes.selected=!0:l.attributes.hasOwnProperty("selected")&&delete l.attributes.selected}e.addEventListener("input",l=>{const h=l.target.options,d=h.selectedIndex===-1?"":h[h.selectedIndex].value;i.setValue(t,{value:d})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:i,linkService:o}){const{attributes:a}=t,l=e instanceof HTMLAnchorElement;a.type==="radio"&&(a.name=`${a.name}-${i}`);for(const[h,d]of Object.entries(a))if(d!=null)switch(h){case"class":d.length&&e.setAttribute(h,d.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",d);break;case"style":Object.assign(e.style,d);break;case"textContent":e.textContent=d;break;default:(!l||h!=="href"&&h!=="newWindow")&&e.setAttribute(h,d)}l&&o.addLinkAttributes(e,a.href,a.newWindow),n&&a.dataId&&this.setupStorage(e,a.dataId,t,n)}static render(e){const t=e.annotationStorage,n=e.linkService,i=e.xfaHtml,o=e.intent||"display",a=document.createElement(i.name);i.attributes&&this.setAttributes({html:a,element:i,intent:o,linkService:n});const l=o!=="richText",h=e.div;if(h.append(a),e.viewport){const f=`matrix(${e.viewport.transform.join(",")})`;h.style.transform=f}l&&h.setAttribute("class","xfaLayer xfaFont");const d=[];if(i.children.length===0){if(i.value){const f=document.createTextNode(i.value);a.append(f),l&&XfaText.shouldBuildText(i.name)&&d.push(f)}return{textDivs:d}}const u=[[i,-1,a]];for(;u.length>0;){const[f,m,v]=u.at(-1);if(m+1===f.children.length){u.pop();continue}const g=f.children[++u.at(-1)[1]];if(g===null)continue;const{name:x}=g;if(x==="#text"){const b=document.createTextNode(g.value);d.push(b),v.append(b);continue}const E=g?.attributes?.xmlns?document.createElementNS(g.attributes.xmlns,x):document.createElement(x);if(v.append(E),g.attributes&&this.setAttributes({html:E,element:g,storage:t,intent:o,linkService:n}),g.children?.length>0)u.push([g,-1,E]);else if(g.value){const b=document.createTextNode(g.value);l&&XfaText.shouldBuildText(x)&&d.push(b),E.append(b)}}for(const f of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))f.setAttribute("readOnly",!0);return{textDivs:d}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const SVG_NS="http://www.w3.org/2000/svg";class PixelsPerInch{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function fetchData(s,e="text"){if(isValidFetchUrl(s,document.baseURI)){const t=await fetch(s);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{const i=new XMLHttpRequest;i.open("GET",s,!0),i.responseType=e,i.onreadystatechange=()=>{if(i.readyState===XMLHttpRequest.DONE){if(i.status===200||i.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(i.response);return}t(i.responseText);return}n(new Error(i.statusText))}},i.send(null)})}class PageViewport{constructor({viewBox:e,userUnit:t,scale:n,rotation:i,offsetX:o=0,offsetY:a=0,dontFlip:l=!1}){this.viewBox=e,this.userUnit=t,this.scale=n,this.rotation=i,this.offsetX=o,this.offsetY=a,n*=t;const h=(e[2]+e[0])/2,d=(e[3]+e[1])/2;let u,f,m,v;switch(i%=360,i<0&&(i+=360),i){case 180:u=-1,f=0,m=0,v=1;break;case 90:u=0,f=1,m=1,v=0;break;case 270:u=0,f=-1,m=-1,v=0;break;case 0:u=1,f=0,m=0,v=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}l&&(m=-m,v=-v);let g,x,E,b;u===0?(g=Math.abs(d-e[1])*n+o,x=Math.abs(h-e[0])*n+a,E=(e[3]-e[1])*n,b=(e[2]-e[0])*n):(g=Math.abs(h-e[0])*n+o,x=Math.abs(d-e[1])*n+a,E=(e[2]-e[0])*n,b=(e[3]-e[1])*n),this.transform=[u*n,f*n,m*n,v*n,g-u*n*h-m*n*d,x-f*n*h-v*n*d],this.width=E,this.height=b}get rawDims(){const e=this.viewBox;return shadow(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:i=this.offsetY,dontFlip:o=!1}={}){return new PageViewport({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:o})}convertToViewportPoint(e,t){const n=[e,t];return Util.applyTransform(n,this.transform),n}convertToViewportRectangle(e){const t=[e[0],e[1]];Util.applyTransform(t,this.transform);const n=[e[2],e[3]];return Util.applyTransform(n,this.transform),[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){const n=[e,t];return Util.applyInverseTransform(n,this.transform),n}}class RenderingCancelledException extends BaseException{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function isDataScheme(s){const e=s.length;let t=0;for(;t<e&&s[t].trim()==="";)t++;return s.substring(t,t+5).toLowerCase()==="data:"}function isPdfFile(s){return typeof s=="string"&&/\.pdf$/i.test(s)}function getFilenameFromUrl(s){return[s]=s.split(/[#?]/,1),s.substring(s.lastIndexOf("/")+1)}function getPdfFilenameFromUrl(s,e="document.pdf"){if(typeof s!="string")return e;if(isDataScheme(s))return warn('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const n=(l=>{try{return new URL(l)}catch{try{return new URL(decodeURIComponent(l))}catch{try{return new URL(l,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(l),"https://foo.bar")}catch{return null}}}}})(s);if(!n)return e;const i=l=>{try{let h=decodeURIComponent(l);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:l):h}catch{return l}},o=/\.pdf$/i,a=n.pathname.split("/").at(-1);if(o.test(a))return i(a);if(n.searchParams.size>0){const l=Array.from(n.searchParams.values()).reverse();for(const d of l)if(o.test(d))return i(d);const h=Array.from(n.searchParams.keys()).reverse();for(const d of h)if(o.test(d))return i(d)}if(n.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(h)return i(h[0])}return e}class StatTimer{started=Object.create(null);times=[];time(e){e in this.started&&warn(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||warn(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:i,end:o}of this.times)e.push(`${n.padEnd(t)} ${o-i}ms
`);return e.join("")}}function isValidFetchUrl(s,e){const t=e?URL.parse(s,e):URL.parse(s);return t?.protocol==="http:"||t?.protocol==="https:"}function noContextMenu(s){s.preventDefault()}function stopEvent(s){s.preventDefault(),s.stopPropagation()}function deprecated(s){console.log("Deprecated API usage: "+s)}class PDFDateString{static#e;static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=this.#e.exec(e);if(!t)return null;const n=parseInt(t[1],10);let i=parseInt(t[2],10);i=i>=1&&i<=12?i-1:0;let o=parseInt(t[3],10);o=o>=1&&o<=31?o:1;let a=parseInt(t[4],10);a=a>=0&&a<=23?a:0;let l=parseInt(t[5],10);l=l>=0&&l<=59?l:0;let h=parseInt(t[6],10);h=h>=0&&h<=59?h:0;const d=t[7]||"Z";let u=parseInt(t[8],10);u=u>=0&&u<=23?u:0;let f=parseInt(t[9],10)||0;return f=f>=0&&f<=59?f:0,d==="-"?(a+=u,l+=f):d==="+"&&(a-=u,l-=f),new Date(Date.UTC(n,i,o,a,l,h))}}function getXfaPageViewport(s,{scale:e=1,rotation:t=0}){const{width:n,height:i}=s.attributes.style,o=[0,0,parseInt(n),parseInt(i)];return new PageViewport({viewBox:o,userUnit:1,scale:e,rotation:t})}function getRGB(s){if(s.startsWith("#")){const e=parseInt(s.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return s.startsWith("rgb(")?s.slice(4,-1).split(",").map(e=>parseInt(e)):s.startsWith("rgba(")?s.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(warn(`Not a valid color format: "${s}"`),[0,0,0])}function getColorValues(s){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of s.keys()){e.style.color=t;const n=window.getComputedStyle(e).color;s.set(t,getRGB(n))}e.remove()}function getCurrentTransform(s){const{a:e,b:t,c:n,d:i,e:o,f:a}=s.getTransform();return[e,t,n,i,o,a]}function getCurrentTransformInverse(s){const{a:e,b:t,c:n,d:i,e:o,f:a}=s.getTransform().invertSelf();return[e,t,n,i,o,a]}function setLayerDimensions(s,e,t=!1,n=!0){if(e instanceof PageViewport){const{pageWidth:i,pageHeight:o}=e.rawDims,{style:a}=s,l=util_FeatureTest.isCSSRoundSupported,h=`var(--total-scale-factor) * ${i}px`,d=`var(--total-scale-factor) * ${o}px`,u=l?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,f=l?`round(down, ${d}, var(--scale-round-y))`:`calc(${d})`;!t||e.rotation%180===0?(a.width=u,a.height=f):(a.width=f,a.height=u)}n&&s.setAttribute("data-main-rotation",e.rotation)}class OutputScale{constructor(){const{pixelRatio:e}=OutputScale;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,n,i,o=-1){let a=1/0,l=1/0,h=1/0;n=OutputScale.capPixels(n,o),n>0&&(a=Math.sqrt(n/(e*t))),i!==-1&&(l=i/e,h=i/t);const d=Math.min(a,l,h);return this.sx>d||this.sy>d?(this.sx=d,this.sy=d,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,n):n}return e}}const SupportedImageMimeTypes=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class ColorScheme{static get isDarkMode(){return shadow(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class CSSConstants{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:n}=window.getComputedStyle(e);return e.remove(),shadow(this,"commentForegroundColor",getRGB(n))}}function applyOpacity(s,e,t,n){n=Math.min(Math.max(n??1,0),1);const i=255*(1-n);return s=Math.round(s*n+i),e=Math.round(e*n+i),t=Math.round(t*n+i),[s,e,t]}function RGBToHSL(s,e){const t=s[0]/255,n=s[1]/255,i=s[2]/255,o=Math.max(t,n,i),a=Math.min(t,n,i),l=(o+a)/2;if(o===a)e[0]=e[1]=0;else{const h=o-a;switch(e[1]=l<.5?h/(o+a):h/(2-o-a),o){case t:e[0]=((n-i)/h+(n<i?6:0))*60;break;case n:e[0]=((i-t)/h+2)*60;break;case i:e[0]=((t-n)/h+4)*60;break}}e[2]=l}function HSLToRGB(s,e){const t=s[0],n=s[1],i=s[2],o=(1-Math.abs(2*i-1))*n,a=o*(1-Math.abs(t/60%2-1)),l=i-o/2;switch(Math.floor(t/60)){case 0:e[0]=o+l,e[1]=a+l,e[2]=l;break;case 1:e[0]=a+l,e[1]=o+l,e[2]=l;break;case 2:e[0]=l,e[1]=o+l,e[2]=a+l;break;case 3:e[0]=l,e[1]=a+l,e[2]=o+l;break;case 4:e[0]=a+l,e[1]=l,e[2]=o+l;break;case 5:case 6:e[0]=o+l,e[1]=l,e[2]=a+l;break}}function computeLuminance(s){return s<=.03928?s/12.92:((s+.055)/1.055)**2.4}function contrastRatio(s,e,t){HSLToRGB(s,t),t.map(computeLuminance);const n=.2126*t[0]+.7152*t[1]+.0722*t[2];HSLToRGB(e,t),t.map(computeLuminance);const i=.2126*t[0]+.7152*t[1]+.0722*t[2];return n>i?(n+.05)/(i+.05):(i+.05)/(n+.05)}const contrastCache=new Map;function findContrastColor(s,e){const t=s[0]+s[1]*256+s[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let n=contrastCache.get(t);if(n)return n;const i=new Float32Array(9),o=i.subarray(0,3),a=i.subarray(3,6);RGBToHSL(s,a);const l=i.subarray(6,9);RGBToHSL(e,l);const h=l[2]<.5,d=h?12:4.5;if(a[2]=h?Math.sqrt(a[2]):1-Math.sqrt(1-a[2]),contrastRatio(a,l,o)<d){let u,f;h?(u=a[2],f=1):(u=0,f=a[2]);const m=.005;for(;f-u>m;){const v=a[2]=(u+f)/2;h===contrastRatio(a,l,o)<d?u=v:f=v}a[2]=h?f:u}return HSLToRGB(a,o),n=Util.makeHexColor(Math.round(o[0]*255),Math.round(o[1]*255),Math.round(o[2]*255)),contrastCache.set(t,n),n}function renderRichText({html:s,dir:e,className:t},n){const i=document.createDocumentFragment();if(typeof s=="string"){const o=document.createElement("p");o.dir=e||"auto";const a=s.split(/(?:\r\n?|\n)/);for(let l=0,h=a.length;l<h;++l){const d=a[l];o.append(document.createTextNode(d)),l<h-1&&o.append(document.createElement("br"))}i.append(o)}else XfaLayer.render({xfaHtml:s,div:i,intent:"richText"});i.firstChild.classList.add("richText",t),n.append(i)}class EditorToolbar{#e=null;#t=null;#n;#r=null;#s=null;#o=null;#i=null;#a=null;static#c=null;constructor(e){this.#n=e,EditorToolbar.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=this.#n._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",noContextMenu,{signal:t}),e.addEventListener("pointerdown",EditorToolbar.#l,{signal:t}));const n=this.#r=document.createElement("div");n.className="buttons",e.append(n);const i=this.#n.toolbarPosition;if(i){const{style:o}=e,a=this.#n._uiManager.direction==="ltr"?1-i[0]:i[0];o.insetInlineEnd=`${100*a}%`,o.top=`calc(${100*i[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return this.#e}static#l(e){e.stopPropagation()}#h(e){this.#n._focusEventsAllowed=!1,stopEvent(e)}#d(e){this.#n._focusEventsAllowed=!0,stopEvent(e)}#f(e){const t=this.#n._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",this.#h.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#d.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",noContextMenu,{signal:t}),!0)}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#s?.shown(),this.#o?.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=this.#n,n=document.createElement("button");n.classList.add("basic","deleteButton"),n.tabIndex=0,n.setAttribute("data-l10n-id",EditorToolbar.#c[e]),this.#f(n)&&n.addEventListener("click",i=>{t.delete()},{signal:t._signal}),this.#r.append(n)}get#g(){const e=document.createElement("div");return e.className="divider",e}async addAltText(e){const t=await e.render();this.#f(t),this.#r.append(t,this.#g),this.#s=e}addComment(e,t=null){if(this.#o)return;const n=e.renderForToolbar();if(!n)return;this.#f(n);const i=this.#i=this.#g;t?(this.#r.insertBefore(n,t),this.#r.insertBefore(i,t)):this.#r.append(n,i),this.#o=e,e.toolbar=this}addColorPicker(e){if(this.#t)return;this.#t=e;const t=e.renderButton();this.#f(t),this.#r.append(t,this.#g)}async addEditSignatureButton(e){const t=this.#a=await e.renderEditButton(this.#n);this.#f(t),this.#r.append(t,this.#g)}removeButton(e){switch(e){case"comment":this.#o?.removeToolbarCommentButton(),this.#o=null,this.#i?.remove(),this.#i=null;break}}async addButton(e,t){switch(e){case"colorPicker":this.addColorPicker(t);break;case"altText":await this.addAltText(t);break;case"editSignature":await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(t);break}}async addButtonBefore(e,t,n){const i=this.#r.querySelector(n);i&&e==="comment"&&this.addComment(t,i)}updateEditSignatureButton(e){this.#a&&(this.#a.title=e)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}}class FloatingToolbar{#e=null;#t=null;#n;constructor(e){this.#n=e}#r(){const e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar");const t=this.#n._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",noContextMenu,{signal:t});const n=this.#e=document.createElement("div");return n.className="buttons",e.append(n),this.#n.hasCommentManager()&&this.#o("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#n.commentSelection("floating_button")}),this.#o("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#n.highlightSelection("floating_button")}),e}#s(e,t){let n=0,i=0;for(const o of e){const a=o.y+o.height;if(a<n)continue;const l=o.x+(t?o.width:0);if(a>n){i=l,n=a;continue}t?l>i&&(i=l):l<i&&(i=l)}return[t?1-i:i,n]}show(e,t,n){const[i,o]=this.#s(t,n),{style:a}=this.#t||=this.#r();e.append(this.#t),a.insetInlineEnd=`${100*i}%`,a.top=`calc(${100*o}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#o(e,t,n,i){const o=document.createElement("button");o.classList.add("basic",e),o.tabIndex=0,o.setAttribute("data-l10n-id",t);const a=document.createElement("span");o.append(a),a.className="visuallyHidden",a.setAttribute("data-l10n-id",n);const l=this.#n._signal;l instanceof AbortSignal&&!l.aborted&&(o.addEventListener("contextmenu",noContextMenu,{signal:l}),o.addEventListener("click",i,{signal:l})),this.#e.append(o)}}function bindEvents(s,e,t){for(const n of t)e.addEventListener(n,s[n].bind(s))}class IdManager{#e=0;get id(){return`${AnnotationEditorPrefix}${this.#e++}`}}class ImageManager{#e=getUuid();#t=0;#n=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),i=new Image;i.src=e;const o=i.decode().then(()=>(n.drawImage(i,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return shadow(this,"_isSVGFittingCanvas",o)}async#r(e,t){this.#n||=new Map;let n=this.#n.get(e);if(n===null)return null;if(n?.bitmap)return n.refCounter+=1,n;try{n||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let i;if(typeof t=="string"?(n.url=t,i=await fetchData(t,"blob")):t instanceof File?i=n.file=t:t instanceof Blob&&(i=t),i.type==="image/svg+xml"){const o=ImageManager._isSVGFittingCanvas,a=new FileReader,l=new Image,h=new Promise((d,u)=>{l.onload=()=>{n.bitmap=l,n.isSvg=!0,d()},a.onload=async()=>{const f=n.svgUrl=a.result;l.src=await o?`${f}#svgView(preserveAspectRatio(none))`:f},l.onerror=a.onerror=u});a.readAsDataURL(i),await h}else n.bitmap=await createImageBitmap(i);n.refCounter=1}catch(i){warn(i),n=null}return this.#n.set(e,n),n&&this.#n.set(n.id,n),n}async getFromFile(e){const{lastModified:t,name:n,size:i,type:o}=e;return this.#r(`${t}_${n}_${i}_${o}`,e)}async getFromUrl(e){return this.#r(e,e)}async getFromBlob(e,t){const n=await t;return this.#r(e,n)}async getFromId(e){this.#n||=new Map;const t=this.#n.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:n}=t;return delete t.blobPromise,this.getFromBlob(t.id,n)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#n||=new Map;let n=this.#n.get(e);if(n?.bitmap)return n.refCounter+=1,n;const i=new OffscreenCanvas(t.width,t.height);return i.getContext("2d").drawImage(t,0,0),n={bitmap:i.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#n.set(e,n),this.#n.set(n.id,n),n}getSvgUrl(e){const t=this.#n.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#n||=new Map;const t=this.#n.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:n}=t;if(!t.url&&!t.file){const i=new OffscreenCanvas(n.width,n.height);i.getContext("bitmaprenderer").transferFromImageBitmap(n),t.blobPromise=i.convertToBlob()}n.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}}class CommandManager{#e=[];#t=!1;#n;#r=-1;constructor(e=128){this.#n=e}add({cmd:e,undo:t,post:n,mustExec:i,type:o=NaN,overwriteIfSameType:a=!1,keepUndo:l=!1}){if(i&&e(),this.#t)return;const h={cmd:e,undo:t,post:n,type:o};if(this.#r===-1){this.#e.length>0&&(this.#e.length=0),this.#r=0,this.#e.push(h);return}if(a&&this.#e[this.#r].type===o){l&&(h.undo=this.#e[this.#r].undo),this.#e[this.#r]=h;return}const d=this.#r+1;d===this.#n?this.#e.splice(0,1):(this.#r=d,d<this.#e.length&&this.#e.splice(d)),this.#e.push(h)}undo(){if(this.#r===-1)return;this.#t=!0;const{undo:e,post:t}=this.#e[this.#r];e(),t?.(),this.#t=!1,this.#r-=1}redo(){if(this.#r<this.#e.length-1){this.#r+=1,this.#t=!0;const{cmd:e,post:t}=this.#e[this.#r];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#r!==-1}hasSomethingToRedo(){return this.#r<this.#e.length-1}cleanType(e){if(this.#r!==-1){for(let t=this.#r;t>=0;t--)if(this.#e[t].type!==e){this.#e.splice(t+1,this.#r-t),this.#r=t;return}this.#e.length=0,this.#r=-1}}destroy(){this.#e=null}}class KeyboardManager{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=util_FeatureTest.platform;for(const[n,i,o={}]of e)for(const a of n){const l=a.startsWith("mac+");t&&l?(this.callbacks.set(a.slice(4),{callback:i,options:o}),this.allKeys.add(a.split("+").at(-1))):!t&&!l&&(this.callbacks.set(a,{callback:i,options:o}),this.allKeys.add(a.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(this.#e(t));if(!n)return;const{callback:i,options:{bubbles:o=!1,args:a=[],checker:l=null}}=n;l&&!l(e,t)||(i.bind(e,...a,t)(),o||stopEvent(t))}}class ColorManager{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return getColorValues(e),shadow(this,"_colors",e)}convert(e){const t=getRGB(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,i]of this._colors)if(i.every((o,a)=>o===t[a]))return ColorManager._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?Util.makeHexColor(...t):e}}class AnnotationEditorUIManager{#e=new AbortController;#t=null;#n=null;#r=new Map;#s=new Map;#o=null;#i=null;#a=null;#c=new CommandManager;#l=null;#h=null;#d=null;#f=0;#g=new Set;#m=null;#u=null;#p=new Set;_editorUndoBar=null;#v=!1;#y=!1;#x=!1;#A=null;#w=null;#b=null;#P=null;#_=!1;#S=null;#T=new IdManager;#k=!1;#M=!1;#N=!1;#R=null;#D=null;#I=null;#L=null;#z=null;#C=AnnotationEditorType.NONE;#E=new Set;#O=null;#F=null;#j=null;#B=null;#H=null;#K={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#W=[0,0];#$=null;#V=null;#X=null;#Z=null;#G=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=AnnotationEditorUIManager.prototype,t=a=>a.#V.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&a.hasSomethingToControl(),n=(a,{target:l})=>{if(l instanceof HTMLInputElement){const{type:h}=l;return h!=="text"&&h!=="number"}return!0},i=this.TRANSLATE_SMALL,o=this.TRANSLATE_BIG;return shadow(this,"_keyboardManager",new KeyboardManager([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(a,{target:l})=>!(l instanceof HTMLButtonElement)&&a.#V.contains(l)&&!a.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(a,{target:l})=>!(l instanceof HTMLButtonElement)&&a.#V.contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-i,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-o,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[i,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[o,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-i],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-o],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,i],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,o],checker:t}]]))}constructor(e,t,n,i,o,a,l,h,d,u,f,m,v,g,x,E){const b=this._signal=this.#e.signal;this.#V=e,this.#X=t,this.#Z=n,this.#o=i,this.#l=o,this.#F=a,this.#H=h,this._eventBus=l,l._on("editingaction",this.onEditingAction.bind(this),{signal:b}),l._on("pagechanging",this.onPageChanging.bind(this),{signal:b}),l._on("scalechanging",this.onScaleChanging.bind(this),{signal:b}),l._on("rotationchanging",this.onRotationChanging.bind(this),{signal:b}),l._on("setpreference",this.onSetPreference.bind(this),{signal:b}),l._on("switchannotationeditorparams",_=>this.updateParams(_.type,_.value),{signal:b}),window.addEventListener("pointerdown",()=>{this.#M=!0},{capture:!0,signal:b}),window.addEventListener("pointerup",()=>{this.#M=!1},{capture:!0,signal:b}),this.#le(),this.#he(),this.#te(),this.#i=h.annotationStorage,this.#A=h.filterFactory,this.#j=d,this.#P=u||null,this.#v=f,this.#y=m,this.#x=v,this.#z=g||null,this.viewParameters={realScale:PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=x||null,this._supportsPinchToZoom=E!==!1,o?.setSidebarUiManager(this)}destroy(){this.#G?.resolve(),this.#G=null,this.#e?.abort(),this.#e=null,this._signal=null;for(const e of this.#s.values())e.destroy();this.#s.clear(),this.#r.clear(),this.#p.clear(),this.#L?.clear(),this.#t=null,this.#E.clear(),this.#c.destroy(),this.#o?.destroy(),this.#l?.destroy(),this.#F?.destroy(),this.#S?.hide(),this.#S=null,this.#I?.destroy(),this.#I=null,this.#n=null,this.#w&&(clearTimeout(this.#w),this.#w=null),this.#$&&(clearTimeout(this.#$),this.#$=null),this._editorUndoBar?.destroy(),this.#H=null}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#z}get useNewAltTextFlow(){return this.#y}get useNewAltTextWhenAddingImage(){return this.#x}get hcmFilter(){return shadow(this,"hcmFilter",this.#j?this.#A.addHCMFilter(this.#j.foreground,this.#j.background):"none")}get direction(){return shadow(this,"direction",getComputedStyle(this.#V).direction)}get _highlightColors(){return shadow(this,"_highlightColors",this.#P?new Map(this.#P.split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return shadow(this,"highlightColors",null);const t=new Map,n=!!this.#j;for(const[i,o]of e){const a=i.endsWith("_HCM");if(n&&a){t.set(i.replace("_HCM",""),o);continue}!n&&!a&&t.set(i,o)}return shadow(this,"highlightColors",t)}get highlightColorNames(){return shadow(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#d=e}setMainHighlightColorPicker(e){this.#I=e}editAltText(e,t=!1){this.#o?.editAltText(this,e,t)}hasCommentManager(){return!!this.#l}editComment(e,t,n,i){this.#l?.showDialog(this,e,t,n,i)}selectComment(e,t){this.#s.get(e)?.getEditorByUID(t)?.toggleComment(!0,!0)}updateComment(e){this.#l?.updateComment(e.getData())}updatePopupColor(e){this.#l?.updatePopupColor(e)}removeComment(e){this.#l?.removeComments([e.uid])}toggleComment(e,t,n=void 0){this.#l?.toggleCommentPopup(e,t,n)}makeCommentColor(e,t){return e&&this.#l?.makeCommentColor(e,t)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(e){if(this.#s.has(e-1))return;const{resolve:t,promise:n}=Promise.withResolvers(),i=o=>{o.pageNumber===e&&(this._eventBus._off("editorsrendered",i),t())};this._eventBus.on("editorsrendered",i),await n}getSignature(e){this.#F?.getSignature({uiManager:this,editor:e})}get signatureManager(){return this.#F}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":this.#x=t;break}}onPageChanging({pageNumber:e}){this.#f=e-1}focusMainContainer(){this.#V.focus()}findParent(e,t){for(const n of this.#s.values()){const{x:i,y:o,width:a,height:l}=n.div.getBoundingClientRect();if(e>=i&&e<=i+a&&t>=o&&t<=o+l)return n}return null}disableUserSelect(e=!1){this.#X.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#p.add(e)}removeShouldRescale(e){this.#p.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*PixelsPerInch.PDF_TO_CSS_UNITS;for(const t of this.#p)t.onScaleChanging();this.#d?.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}#Q({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e}#ee(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of this.#s.values())if(n.hasTextLayer(e))return n;return null}highlightSelection(e="",t=!1){const n=document.getSelection();if(!n||n.isCollapsed)return;const{anchorNode:i,anchorOffset:o,focusNode:a,focusOffset:l}=n,h=n.toString(),u=this.#Q(n).closest(".textLayer"),f=this.getSelectionBoxes(u);if(!f)return;n.empty();const m=this.#ee(u),v=this.#C===AnnotationEditorType.NONE,g=()=>{const x=m?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:f,anchorNode:i,anchorOffset:o,focusNode:a,focusOffset:l,text:h});v&&this.showAllEditors("highlight",!0,!0),t&&x?.editComment()};if(v){this.switchToMode(AnnotationEditorType.HIGHLIGHT,g);return}g()}commentSelection(e=""){this.highlightSelection(e,!0)}#oe(){const e=document.getSelection();if(!e||e.isCollapsed)return;const n=this.#Q(e).closest(".textLayer"),i=this.getSelectionBoxes(n);i&&(this.#S||=new FloatingToolbar(this),this.#S.show(n,i,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(e){if(!this.#i)return null;const t=`${AnnotationEditorPrefix}${e}`,n=this.#i.getRawValue(t);return n&&this.#i.remove(t),n}addToAnnotationStorage(e){!e.isEmpty()&&this.#i&&!this.#i.has(e.id)&&this.#i.setValue(e.id,e)}a11yAlert(e,t=null){const n=this.#Z;n&&(n.setAttribute("data-l10n-id",e),t?n.setAttribute("data-l10n-args",JSON.stringify(t)):n.removeAttribute("data-l10n-args"))}#ae(){const e=document.getSelection();if(!e||e.isCollapsed){this.#O&&(this.#S?.hide(),this.#O=null,this.#U({hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===this.#O)return;const i=this.#Q(e).closest(".textLayer");if(!i){this.#O&&(this.#S?.hide(),this.#O=null,this.#U({hasSelectedText:!1}));return}if(this.#S?.hide(),this.#O=t,this.#U({hasSelectedText:!0}),!(this.#C!==AnnotationEditorType.HIGHLIGHT&&this.#C!==AnnotationEditorType.NONE)&&(this.#C===AnnotationEditorType.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#_=this.isShiftKeyDown,!this.isShiftKeyDown)){const o=this.#C===AnnotationEditorType.HIGHLIGHT?this.#ee(i):null;if(o?.toggleDrawing(),this.#M){const a=new AbortController,l=this.combinedSignal(a),h=d=>{d.type==="pointerup"&&d.button!==0||(a.abort(),o?.toggleDrawing(!0),d.type==="pointerup"&&this.#Y("main_toolbar"))};window.addEventListener("pointerup",h,{signal:l}),window.addEventListener("blur",h,{signal:l})}else o?.toggleDrawing(!0),this.#Y("main_toolbar")}}#Y(e=""){this.#C===AnnotationEditorType.HIGHLIGHT?this.highlightSelection(e):this.#v&&this.#oe()}#le(){document.addEventListener("selectionchange",this.#ae.bind(this),{signal:this._signal})}#ce(){if(this.#b)return;this.#b=new AbortController;const e=this.combinedSignal(this.#b);window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}#ue(){this.#b?.abort(),this.#b=null}blur(){if(this.isShiftKeyDown=!1,this.#_&&(this.#_=!1,this.#Y("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#E)if(t.div.contains(e)){this.#D=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#D)return;const[e,t]=this.#D;this.#D=null,t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}#te(){if(this.#R)return;this.#R=new AbortController;const e=this.combinedSignal(this.#R);window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}#de(){this.#R?.abort(),this.#R=null}#ne(){if(this.#h)return;this.#h=new AbortController;const e=this.combinedSignal(this.#h);document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}#re(){this.#h?.abort(),this.#h=null}#he(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#te(),this.#ne()}removeEditListeners(){this.#de(),this.#re()}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of this.#u)if(n.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const n of this.#u)if(n.isHandlingMimeForPasting(t.type)){n.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const n of this.#E){const i=n.serialize(!0);i&&t.push(i)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const o of t.items)for(const a of this.#u)if(a.isHandlingMimeForPasting(o.type)){a.paste(o,this.currentLayer);return}let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(o){warn(`paste: "${o.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const i=this.currentLayer;try{const o=[];for(const h of n){const d=await i.deserialize(h);if(!d)return;o.push(d)}const a=()=>{for(const h of o)this.#se(h);this.#ie(o)},l=()=>{for(const h of o)h.remove()};this.addCommands({cmd:a,undo:l,mustExec:!0})}catch(o){warn(`paste: "${o.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),this.#C!==AnnotationEditorType.NONE&&!this.isEditorHandlingKeyboard&&AnnotationEditorUIManager._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,this.#_&&(this.#_=!1,this.#Y("main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#U(e){Object.entries(e).some(([n,i])=>this.#K[n]!==i)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#K,e)}),this.#C===AnnotationEditorType.HIGHLIGHT&&e.hasSelectedEditor===!1&&this.#q([[AnnotationEditorParamsType.HIGHLIGHT_FREE,!0]]))}#q(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#ce(),this.#ne(),this.#U({isEditing:this.#C!==AnnotationEditorType.NONE,isEmpty:this.#J(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ue(),this.#re(),this.#U({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#u){this.#u=e;for(const t of this.#u)this.#q(t.defaultPropertiesToUpdate)}}getId(){return this.#T.id}get currentLayer(){return this.#s.get(this.#f)}getLayer(e){return this.#s.get(e)}get currentPageIndex(){return this.#f}addLayer(e){this.#s.set(e.pageIndex,e),this.#k?e.enable():e.disable()}removeLayer(e){this.#s.delete(e.pageIndex)}async updateMode(e,t=null,n=!1,i=!1,o=!1){if(this.#C!==e&&!(this.#G&&(await this.#G.promise,!this.#G))){if(this.#G=Promise.withResolvers(),this.#d?.commitOrRemove(),this.#C===AnnotationEditorType.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#C=e,e===AnnotationEditorType.NONE){this.setEditingState(!1),this.#pe();for(const a of this.#r.values())a.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#G.resolve();return}for(const a of this.#r.values())a.addStandaloneCommentButton();e===AnnotationEditorType.SIGNATURE&&await this.#F?.loadSignatures(),this.setEditingState(!0),await this.#fe(),this.unselectAll();for(const a of this.#s.values())a.updateMode(e);if(e===AnnotationEditorType.POPUP){this.#n||=await this.#H.getAnnotationsByType(new Set(this.#u.map(h=>h._editorType)));const a=new Set,l=[];for(const h of this.#r.values()){const{annotationElementId:d,hasComment:u,deleted:f}=h;d&&a.add(d),u&&!f&&l.push(h.getData())}for(const h of this.#n){const{id:d,popupRef:u,contentsObj:f}=h;u&&f?.str&&!a.has(d)&&!this.#g.has(d)&&l.push(h)}this.#l?.showSidebar(l)}if(!t){n&&this.addNewEditorFromKeyboard(),this.#G.resolve();return}for(const a of this.#r.values())a.uid===t?(this.setSelected(a),o?a.editComment():i?a.enterInEditMode():a.focus()):a.unselect();this.#G.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==this.#C&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(this.#u){switch(e){case AnnotationEditorParamsType.CREATE:this.currentLayer.addNewEditor(t);return;case AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#B||=new Map).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const n of this.#E)n.updateParams(e,t);else for(const n of this.#u)n.updateDefaultParams(e,t)}}showAllEditors(e,t,n=!1){for(const o of this.#r.values())o.editorType===e&&o.show(t);(this.#B?.get(AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#q([[AnnotationEditorParamsType.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(this.#N!==e){this.#N=e;for(const t of this.#s.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}async#fe(){if(!this.#k){this.#k=!0;const e=[];for(const t of this.#s.values())e.push(t.enable());await Promise.all(e);for(const t of this.#r.values())t.enable()}}#pe(){if(this.unselectAll(),this.#k){this.#k=!1;for(const e of this.#s.values())e.disable();for(const e of this.#r.values())e.disable()}}*getEditors(e){for(const t of this.#r.values())t.pageIndex===e&&(yield t)}getEditor(e){return this.#r.get(e)}addEditor(e){this.#r.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#w&&clearTimeout(this.#w),this.#w=setTimeout(()=>{this.focusMainContainer(),this.#w=null},0)),this.#r.delete(e.id),e.annotationElementId&&this.#L?.delete(e.annotationElementId),this.unselect(e),(!e.annotationElementId||!this.#g.has(e.annotationElementId))&&this.#i?.remove(e.id)}addDeletedAnnotationElement(e){this.#g.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#g.has(e)}removeDeletedAnnotationElement(e){this.#g.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#se(e){const t=this.#s.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#q(e.propertiesToUpdate))}get#me(){let e=null;for(e of this.#E);return e}updateUI(e){this.#me===e&&this.#q(e.propertiesToUpdate)}updateUIForDefaultProperties(e){this.#q(e.defaultPropertiesToUpdate)}toggleSelected(e){if(this.#E.has(e)){this.#E.delete(e),e.unselect(),this.#U({hasSelectedEditor:this.hasSelection});return}this.#E.add(e),e.select(),this.#q(e.propertiesToUpdate),this.#U({hasSelectedEditor:!0})}setSelected(e){this.updateToolbar({mode:e.mode,editId:e.id}),this.#d?.commitOrRemove();for(const t of this.#E)t!==e&&t.unselect();this.#E.clear(),this.#E.add(e),e.select(),this.#q(e.propertiesToUpdate),this.#U({hasSelectedEditor:!0})}isSelected(e){return this.#E.has(e)}get firstSelectedEditor(){return this.#E.values().next().value}unselect(e){e.unselect(),this.#E.delete(e),this.#U({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#E.size!==0}get isEnterHandled(){return this.#E.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#U({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#J()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#U({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#J()})}addCommands(e){this.#c.add(e),this.#U({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#J()})}cleanUndoStack(e){this.#c.cleanType(e)}#J(){if(this.#r.size===0)return!0;if(this.#r.size===1)for(const e of this.#r.values())return e.isEmpty();return!1}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...this.#E],n=()=>{this._editorUndoBar?.show(i,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},i=()=>{for(const o of t)this.#se(o)};this.addCommands({cmd:n,undo:i,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#ie(e){for(const t of this.#E)t.unselect();this.#E.clear();for(const t of e)t.isEmpty()||(this.#E.add(t),t.select());this.#U({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#E)e.commit();this.#ie(this.#r.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#C!==AnnotationEditorType.NONE))&&!this.#d?.commitOrRemove()&&this.hasSelection){for(const e of this.#E)e.unselect();this.#E.clear(),this.#U({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#W[0]+=e,this.#W[1]+=t;const[i,o]=this.#W,a=[...this.#E],l=1e3;this.#$&&clearTimeout(this.#$),this.#$=setTimeout(()=>{this.#$=null,this.#W[0]=this.#W[1]=0,this.addCommands({cmd:()=>{for(const h of a)this.#r.has(h.id)&&(h.translateInPage(i,o),h.translationDone())},undo:()=>{for(const h of a)this.#r.has(h.id)&&(h.translateInPage(-i,-o),h.translationDone())},mustExec:!1})},l);for(const h of a)h.translateInPage(e,t),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#m=new Map;for(const e of this.#E)this.#m.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#m)return!1;this.disableUserSelect(!1);const e=this.#m;this.#m=null;let t=!1;for(const[{x:i,y:o,pageIndex:a},l]of e)l.newX=i,l.newY=o,l.newPageIndex=a,t||=i!==l.savedX||o!==l.savedY||a!==l.savedPageIndex;if(!t)return!1;const n=(i,o,a,l)=>{if(this.#r.has(i.id)){const h=this.#s.get(l);h?i._setParentAndPosition(h,o,a):(i.pageIndex=l,i.x=o,i.y=a)}};return this.addCommands({cmd:()=>{for(const[i,{newX:o,newY:a,newPageIndex:l}]of e)n(i,o,a,l)},undo:()=>{for(const[i,{savedX:o,savedY:a,savedPageIndex:l}]of e)n(i,o,a,l)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#m)for(const n of this.#m.keys())n.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#E.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#C}isEditingMode(){return this.#C!==AnnotationEditorType.NONE}get imageManager(){return shadow(this,"imageManager",new ImageManager)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let d=0,u=t.rangeCount;d<u;d++)if(!e.contains(t.getRangeAt(d).commonAncestorContainer))return null;const{x:n,y:i,width:o,height:a}=e.getBoundingClientRect();let l;switch(e.getAttribute("data-main-rotation")){case"90":l=(d,u,f,m)=>({x:(u-i)/a,y:1-(d+f-n)/o,width:m/a,height:f/o});break;case"180":l=(d,u,f,m)=>({x:1-(d+f-n)/o,y:1-(u+m-i)/a,width:f/o,height:m/a});break;case"270":l=(d,u,f,m)=>({x:1-(u+m-i)/a,y:(d-n)/o,width:m/a,height:f/o});break;default:l=(d,u,f,m)=>({x:(d-n)/o,y:(u-i)/a,width:f/o,height:m/a});break}const h=[];for(let d=0,u=t.rangeCount;d<u;d++){const f=t.getRangeAt(d);if(!f.collapsed)for(const{x:m,y:v,width:g,height:x}of f.getClientRects())g===0||x===0||h.push(l(m,v,g,x))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:e,id:t}){(this.#a||=new Map).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){this.#a?.delete(e)}renderAnnotationElement(e){const t=this.#a?.get(e.data.id);if(!t)return;const n=this.#i.getRawValue(t);n&&(this.#C===AnnotationEditorType.NONE&&!n.hasBeenModified||n.renderAnnotationElement(e))}setMissingCanvas(e,t,n){const i=this.#L?.get(e);i&&(i.setCanvas(t,n),this.#L.delete(e))}addMissingCanvas(e,t){(this.#L||=new Map).set(e,t)}}class AltText{#e=null;#t=!1;#n=null;#r=null;#s=null;#o=null;#i=!1;#a=null;#c=null;#l=null;#h=null;#d=!1;static#f=null;static _l10n=null;constructor(e){this.#c=e,this.#d=e._uiManager.useNewAltTextFlow,AltText.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(e){AltText._l10n??=e}async render(){const e=this.#n=document.createElement("button");e.className="altText",e.tabIndex="0";const t=this.#r=document.createElement("span");e.append(t),this.#d?(e.classList.add("new"),e.setAttribute("data-l10n-id",AltText.#f.missing),t.setAttribute("data-l10n-id",AltText.#f["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=this.#c._uiManager._signal;e.addEventListener("contextmenu",noContextMenu,{signal:n}),e.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:n});const i=o=>{o.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#d&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#g}})};return e.addEventListener("click",i,{capture:!0,signal:n}),e.addEventListener("keydown",o=>{o.target===e&&o.key==="Enter"&&(this.#i=!0,i(o))},{signal:n}),await this.#m(),e}get#g(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#n&&(this.#n.focus({focusVisible:this.#i}),this.#i=!1)}isEmpty(){return this.#d?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#d?this.#e!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(e){this.#e===null&&(this.#l=e,this.#h=await AltText._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e}),this.#m())}toggleAltTextBadge(e=!1){if(!this.#d||this.#e){this.#a?.remove(),this.#a=null;return}if(!this.#a){const t=this.#a=document.createElement("div");t.className="noAltTextBadge",this.#c.div.append(t)}this.#a.classList.toggle("hidden",!e)}serialize(e){let t=this.#e;return!e&&this.#l===t&&(t=this.#h),{altText:t,decorative:this.#t,guessedText:this.#l,textWithDisclaimer:this.#h}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:e,decorative:t,guessedText:n,textWithDisclaimer:i,cancel:o=!1}){n&&(this.#l=n,this.#h=i),!(this.#e===e&&this.#t===t)&&(o||(this.#e=e,this.#t=t),this.#m())}toggle(e=!1){this.#n&&(!e&&this.#o&&(clearTimeout(this.#o),this.#o=null),this.#n.disabled=!e)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#g}})}destroy(){this.#n?.remove(),this.#n=null,this.#r=null,this.#s=null,this.#a?.remove(),this.#a=null}async#m(){const e=this.#n;if(!e)return;if(this.#d){if(e.classList.toggle("done",!!this.#e),e.setAttribute("data-l10n-id",AltText.#f[this.#g]),this.#r?.setAttribute("data-l10n-id",AltText.#f[`${this.#g}-label`]),!this.#e){this.#s?.remove();return}}else{if(!this.#e&&!this.#t){e.classList.remove("done"),this.#s?.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=this.#s;if(!t){this.#s=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${this.#c.id}`;const i=100,o=this.#c._uiManager._signal;o.addEventListener("abort",()=>{clearTimeout(this.#o),this.#o=null},{once:!0}),e.addEventListener("mouseenter",()=>{this.#o=setTimeout(()=>{this.#o=null,this.#s.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},i)},{signal:o}),e.addEventListener("mouseleave",()=>{this.#o&&(clearTimeout(this.#o),this.#o=null),this.#s?.classList.remove("show")},{signal:o})}this.#t?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=this.#e),t.parentNode||e.append(t),this.#c.getElementForAltText()?.setAttribute("aria-describedby",t.id)}}class Comment{#e=null;#t=null;#n=!1;#r=null;#s=null;#o=null;#i=null;#a=null;#c=!1;#l=null;constructor(e){this.#r=e}renderForToolbar(){const e=this.#t=document.createElement("button");return e.className="comment",this.#h(e,!1)}renderForStandalone(){const e=this.#e=document.createElement("button");e.className="annotationCommentButton";const t=this.#r.commentButtonPosition;if(t){const{style:n}=e;n.insetInlineEnd=`calc(${100*(this.#r._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,n.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const i=this.#r.commentButtonColor;i&&(n.backgroundColor=i)}return this.#h(e,!0)}focusButton(){setTimeout(()=>{(this.#e??this.#t)?.focus()},0)}onUpdatedColor(){if(!this.#e)return;const e=this.#r.commentButtonColor;e&&(this.#e.style.backgroundColor=e),this.#r._uiManager.updatePopupColor(this.#r)}get commentButtonWidth(){return(this.#e?.getBoundingClientRect().width??0)/this.#r.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#e)return null;const{x:e,y:t,height:n}=this.#e.getBoundingClientRect(),{x:i,y:o,width:a,height:l}=this.#r.parent.boundingClientRect;return[(e-i)/a,(t+n-o)/l]}set commentPopupPositionInLayer(e){this.#l=e}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#e?.remove(),this.#e=null}removeToolbarCommentButton(){this.#t?.remove(),this.#t=null}setCommentButtonStates({selected:e,hasPopup:t}){this.#e&&(this.#e.classList.toggle("selected",e),this.#e.ariaExpanded=t)}#h(e,t){if(!this.#r._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[this.#r._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button"));const n=this.#r._uiManager._signal;if(!(n instanceof AbortSignal)||n.aborted)return e;e.addEventListener("contextmenu",noContextMenu,{signal:n}),t&&(e.addEventListener("focusin",o=>{this.#r._focusEventsAllowed=!1,stopEvent(o)},{capture:!0,signal:n}),e.addEventListener("focusout",o=>{this.#r._focusEventsAllowed=!0,stopEvent(o)},{capture:!0,signal:n})),e.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:n});const i=o=>{o.preventDefault(),e===this.#t?this.edit():this.#r.toggleComment(!0)};return e.addEventListener("click",i,{capture:!0,signal:n}),e.addEventListener("keydown",o=>{o.target===e&&o.key==="Enter"&&(this.#n=!0,i(o))},{signal:n}),e.addEventListener("pointerenter",()=>{this.#r.toggleComment(!1,!0)},{signal:n}),e.addEventListener("pointerleave",()=>{this.#r.toggleComment(!1,!1)},{signal:n}),e}edit(e){const t=this.commentPopupPositionInLayer;let n,i;if(t)[n,i]=t;else{[n,i]=this.#r.commentButtonPosition;const{width:u,height:f,x:m,y:v}=this.#r;n=m+n*u,i=v+i*f}const o=this.#r.parent.boundingClientRect,{x:a,y:l,width:h,height:d}=o;this.#r._uiManager.editComment(this.#r,a+n*h,l+i*d,{...e,parentDimensions:o})}finish(){this.#t&&(this.#t.focus({focusVisible:this.#n}),this.#n=!1)}isDeleted(){return this.#c||this.#i===""}isEmpty(){return this.#i===null}hasBeenEdited(){return this.isDeleted()||this.#i!==this.#s}serialize(){return this.data}get data(){return{text:this.#i,richText:this.#o,date:this.#a,deleted:this.isDeleted()}}set data(e){if(e!==this.#i&&(this.#o=null),e===null){this.#i="",this.#c=!0;return}this.#i=e,this.#a=new Date,this.#c=!1}setInitialText(e,t=null){this.#s=e,this.data=e,this.#a=null,this.#o=t}shown(){}destroy(){this.#t?.remove(),this.#t=null,this.#e?.remove(),this.#e=null,this.#i="",this.#o=null,this.#a=null,this.#r=null,this.#n=!1,this.#c=!1}}class TouchManager{#e;#t=!1;#n=null;#r;#s;#o;#i;#a=null;#c;#l=null;#h;#d=null;constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:n=null,onPinchStart:i=null,onPinching:o=null,onPinchEnd:a=null,signal:l}){this.#e=e,this.#n=n,this.#r=t,this.#s=i,this.#o=o,this.#i=a,this.#h=new AbortController,this.#c=AbortSignal.any([l,this.#h.signal]),e.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/OutputScale.pixelRatio}#f(e){if(this.#r?.())return;if(e.touches.length===1){if(this.#a)return;const i=this.#a=new AbortController,o=AbortSignal.any([this.#c,i.signal]),a=this.#e,l={capture:!0,signal:o,passive:!1},h=d=>{d.pointerType==="touch"&&(this.#a?.abort(),this.#a=null)};a.addEventListener("pointerdown",d=>{d.pointerType==="touch"&&(stopEvent(d),h(d))},l),a.addEventListener("pointerup",h,l),a.addEventListener("pointercancel",h,l);return}if(!this.#d){this.#d=new AbortController;const i=AbortSignal.any([this.#c,this.#d.signal]),o=this.#e,a={signal:i,capture:!1,passive:!1};o.addEventListener("touchmove",this.#g.bind(this),a);const l=this.#m.bind(this);o.addEventListener("touchend",l,a),o.addEventListener("touchcancel",l,a),a.capture=!0,o.addEventListener("pointerdown",stopEvent,a),o.addEventListener("pointermove",stopEvent,a),o.addEventListener("pointercancel",stopEvent,a),o.addEventListener("pointerup",stopEvent,a),this.#s?.()}if(stopEvent(e),e.touches.length!==2||this.#n?.()){this.#l=null;return}let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]),this.#l={touch0X:t.screenX,touch0Y:t.screenY,touch1X:n.screenX,touch1Y:n.screenY}}#g(e){if(!this.#l||e.touches.length!==2)return;stopEvent(e);let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]);const{screenX:i,screenY:o}=t,{screenX:a,screenY:l}=n,h=this.#l,{touch0X:d,touch0Y:u,touch1X:f,touch1Y:m}=h,v=f-d,g=m-u,x=a-i,E=l-o,b=Math.hypot(x,E)||1,_=Math.hypot(v,g)||1;if(!this.#t&&Math.abs(_-b)<=TouchManager.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=i,h.touch0Y=o,h.touch1X=a,h.touch1Y=l,!this.#t){this.#t=!0;return}const S=[(i+a)/2,(o+l)/2];this.#o?.(S,_,b)}#m(e){e.touches.length>=2||(this.#d&&(this.#d.abort(),this.#d=null,this.#i?.()),this.#l&&(stopEvent(e),this.#l=null,this.#t=!1))}destroy(){this.#h?.abort(),this.#h=null,this.#a?.abort(),this.#a=null}}class AnnotationEditor{#e=null;#t=null;#n=null;#r=null;#s=null;#o=!1;#i=null;#a="";#c=null;#l=null;#h=null;#d=null;#f=null;#g="";#m=!1;#u=null;#p=!1;#v=!1;#y=!1;#x=null;#A=0;#w=0;#b=null;#P=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#_=!1;#S=AnnotationEditor._zIndex++;static _borderLineWidth=-1;static _colorManager=new ColorManager;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=AnnotationEditor.prototype._resizeWithKeyboard,t=AnnotationEditorUIManager.TRANSLATE_SMALL,n=AnnotationEditorUIManager.TRANSLATE_BIG;return shadow(this,"_resizerKeyboardManager",new KeyboardManager([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],AnnotationEditor.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null;const{rotation:t,rawDims:{pageWidth:n,pageHeight:i,pageX:o,pageY:a}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,i],this.pageTranslation=[o,a];const[l,h]=this.parentDimensions;this.x=e.x/l,this.y=e.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return shadow(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new FakeEditor({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(AnnotationEditor._l10n??=e,AnnotationEditor._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),AnnotationEditor._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);AnnotationEditor._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){unreachable("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#_}set _isDraggable(e){this.#_=e,this.div?.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#S}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(this.#$(),this.#d?.remove(),this.#d=null),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#m?this.#m=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,i){const[o,a]=this.parentDimensions;[n,i]=this.screenToPageTranslation(n,i),this.x=(e+n)/o,this.y=(t+i)/a,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[n,i]=this.parentDimensions;this.setAt(e*n,t*i,this.width*n,this.height*i),this._onTranslated()}#T([e,t],n,i){[n,i]=this.screenToPageTranslation(n,i),this.x+=n/e,this.y+=i/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#T(this.parentDimensions,e,t)}translateInPage(e,t){this.#u||=[this.x,this.y,this.width,this.height],this.#T(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){this.#u||=[this.x,this.y,this.width,this.height];const{div:n,parentDimensions:[i,o]}=this;if(this.x+=e/i,this.y+=t/o,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:f,y:m}=this.div.getBoundingClientRect();this.parent.findNewParent(this,f,m)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:a,y:l}=this;const[h,d]=this.getBaseTranslation();a+=h,l+=d;const{style:u}=n;u.left=`${(100*a).toFixed(2)}%`,u.top=`${(100*l).toFixed(2)}%`,this._onTranslating(a,l),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=AnnotationEditor,i=n/e,o=n/t;switch(this.rotation){case 90:return[-i,o];case 180:return[i,o];case 270:return[i,-o];default:return[-i,-o]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[n,i]}=this;let{x:o,y:a,width:l,height:h}=this;if(l*=n,h*=i,o*=n,a*=i,this._mustFixPosition)switch(e){case 0:o=MathClamp(o,0,n-l),a=MathClamp(a,0,i-h);break;case 90:o=MathClamp(o,0,n-h),a=MathClamp(a,l,i);break;case 180:o=MathClamp(o,l,n),a=MathClamp(a,h,i);break;case 270:o=MathClamp(o,h,n),a=MathClamp(a,0,i-l);break}this.x=o/=n,this.y=a/=i;const[d,u]=this.getBaseTranslation();o+=d,a+=u,t.left=`${(100*o).toFixed(2)}%`,t.top=`${(100*a).toFixed(2)}%`,this.moveInDOM()}static#k(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return AnnotationEditor.#k(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return AnnotationEditor.#k(e,t,360-this.parentRotation)}#M(e){switch(e){case 90:{const[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(){const{div:{style:e},width:t,height:n}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*n).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#N(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const i=document.createElement("div");this.#c.append(i),i.classList.add("resizer",n),i.setAttribute("data-resizer-name",n),i.addEventListener("pointerdown",this.#R.bind(this,n),{signal:t}),i.addEventListener("contextmenu",noContextMenu,{signal:t}),i.tabIndex=-1}this.div.prepend(this.#c)}#R(e,t){t.preventDefault();const{isMac:n}=util_FeatureTest.platform;if(t.button!==0||t.ctrlKey&&n)return;this.#n?.toggle(!1);const i=this._isDraggable;this._isDraggable=!1,this.#l=[t.screenX,t.screenY];const o=new AbortController,a=this._uiManager.combinedSignal(o);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#L.bind(this,e),{passive:!0,capture:!0,signal:a}),window.addEventListener("touchmove",stopEvent,{passive:!1,signal:a}),window.addEventListener("contextmenu",noContextMenu,{signal:a}),this.#h={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const l=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const d=()=>{o.abort(),this.parent.togglePointerEvents(!0),this.#n?.toggle(!0),this._isDraggable=i,this.parent.div.style.cursor=l,this.div.style.cursor=h,this.#I()};window.addEventListener("pointerup",d,{signal:a}),window.addEventListener("blur",d,{signal:a})}#D(e,t,n,i){this.width=n,this.height=i,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#I(){if(!this.#h)return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:i}=this.#h;this.#h=null;const o=this.x,a=this.y,l=this.width,h=this.height;o===e&&a===t&&l===n&&h===i||this.addCommands({cmd:this.#D.bind(this,o,a,l,h),undo:this.#D.bind(this,e,t,n,i),mustExec:!0})}static _round(e){return Math.round(e*1e4)/1e4}#L(e,t){const[n,i]=this.parentDimensions,o=this.x,a=this.y,l=this.width,h=this.height,d=AnnotationEditor.MIN_SIZE/n,u=AnnotationEditor.MIN_SIZE/i,f=this.#M(this.rotation),m=(Q,z)=>[f[0]*Q+f[2]*z,f[1]*Q+f[3]*z],v=this.#M(360-this.rotation),g=(Q,z)=>[v[0]*Q+v[2]*z,v[1]*Q+v[3]*z];let x,E,b=!1,_=!1;switch(e){case"topLeft":b=!0,x=(Q,z)=>[0,0],E=(Q,z)=>[Q,z];break;case"topMiddle":x=(Q,z)=>[Q/2,0],E=(Q,z)=>[Q/2,z];break;case"topRight":b=!0,x=(Q,z)=>[Q,0],E=(Q,z)=>[0,z];break;case"middleRight":_=!0,x=(Q,z)=>[Q,z/2],E=(Q,z)=>[0,z/2];break;case"bottomRight":b=!0,x=(Q,z)=>[Q,z],E=(Q,z)=>[0,0];break;case"bottomMiddle":x=(Q,z)=>[Q/2,z],E=(Q,z)=>[Q/2,0];break;case"bottomLeft":b=!0,x=(Q,z)=>[0,z],E=(Q,z)=>[Q,0];break;case"middleLeft":_=!0,x=(Q,z)=>[0,z/2],E=(Q,z)=>[Q,z/2];break}const S=x(l,h),C=E(l,h);let A=m(...C);const R=AnnotationEditor._round(o+A[0]),L=AnnotationEditor._round(a+A[1]);let j=1,F=1,W,K;if(t.fromKeyboard)({deltaX:W,deltaY:K}=t);else{const{screenX:Q,screenY:z}=t,[N,k]=this.#l;[W,K]=this.screenToPageTranslation(Q-N,z-k),this.#l[0]=Q,this.#l[1]=z}if([W,K]=g(W/n,K/i),b){const Q=Math.hypot(l,h);j=F=Math.max(Math.min(Math.hypot(C[0]-S[0]-W,C[1]-S[1]-K)/Q,1/l,1/h),d/l,u/h)}else _?j=MathClamp(Math.abs(C[0]-S[0]-W),d,1)/l:F=MathClamp(Math.abs(C[1]-S[1]-K),u,1)/h;const ee=AnnotationEditor._round(l*j),te=AnnotationEditor._round(h*F);A=m(...E(ee,te));const re=R-A[0],ie=L-A[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=ee,this.height=te,this.x=re,this.y=ie,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#n?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#v)return this._editToolbar;this._editToolbar=new EditorToolbar(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,n]of e)await this._editToolbar.addButton(t,n);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#n?.destroy()}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#n||(AltText.initialize(AnnotationEditor._l10n),this.#n=new AltText(this),this.#e&&(this.#n.data=this.#e,this.#e=null)),this.#n}get altTextData(){return this.#n?.data}set altTextData(e){this.#n&&(this.#n.data=e)}get guessedAltText(){return this.#n?.guessedText}async setGuessedAltText(e){await this.#n?.setGuessedText(e)}serializeAltText(e){return this.#n?.serialize(e)}hasAltText(){return!!this.#n&&!this.#n.isEmpty()}hasAltTextData(){return this.#n?.hasData()??!1}focusCommentButton(){this.#r?.focusButton()}addCommentButton(){return this.#r||=new Comment(this)}addStandaloneCommentButton(){if(this.#s){this._uiManager.isEditingMode()&&this.#s.classList.remove("hidden");return}this.hasComment&&(this.#s=this.#r.renderForStandalone(),this.div.append(this.#s))}removeStandaloneCommentButton(){this.#r.removeStandaloneCommentButton(),this.#s=null}hideStandaloneCommentButton(){this.#s?.classList.add("hidden")}get comment(){const{data:{richText:e,text:t,date:n,deleted:i}}=this.#r;return{text:t,richText:e,date:n,deleted:i,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){this.#r||=new Comment(this),this.#r.data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:n}){if(!t||(this.#r||=new Comment(this),this.#r.setInitialText(e,n),!this.annotationElementId))return;const i=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);i&&this.updateFromAnnotationLayer(i)}get hasEditedComment(){return this.#r?.hasBeenEdited()}get hasDeletedComment(){return this.#r?.isDeleted()}get hasComment(){return!!this.#r&&!this.#r.isEmpty()&&!this.#r.isDeleted()}async editComment(e){this.#r||=new Comment(this),this.#r.edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){this.#r.setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,i]=e.rect,[o]=this.pageDimensions,[a]=this.pageTranslation,l=a+o+1,h=i-100,d=l+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[l,h,d,i]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){this.#r.data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=this.#o?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),this.#j();const[t,n]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*n/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/n).toFixed(2)}%`);const[i,o]=this.getInitialTranslation();return this.translate(i,o),bindEvents(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#P||=new TouchManager({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#z.bind(this),onPinching:this.#C.bind(this),onPinchEnd:this.#E.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),e}#z(){this.#h={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#n?.toggle(!1),this.parent.togglePointerEvents(!1)}#C(e,t,n){let o=.7*(n/t)+1-.7;if(o===1)return;const a=this.#M(this.rotation),l=(R,L)=>[a[0]*R+a[2]*L,a[1]*R+a[3]*L],[h,d]=this.parentDimensions,u=this.x,f=this.y,m=this.width,v=this.height,g=AnnotationEditor.MIN_SIZE/h,x=AnnotationEditor.MIN_SIZE/d;o=Math.max(Math.min(o,1/m,1/v),g/m,x/v);const E=AnnotationEditor._round(m*o),b=AnnotationEditor._round(v*o);if(E===m&&b===v)return;this.#u||=[u,f,m,v];const _=l(m/2,v/2),S=AnnotationEditor._round(u+_[0]),C=AnnotationEditor._round(f+_[1]),A=l(E/2,b/2);this.x=S-A[0],this.y=C-A[1],this.width=E,this.height=b,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#E(){this.#n?.toggle(!0),this.parent.togglePointerEvents(!0),this.#I()}pointerdown(e){const{isMac:t}=util_FeatureTest.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#m=!0,this._isDraggable){this.#F(e);return}this.#O(e)}#O(e){const{isMac:t}=util_FeatureTest.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#F(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const i=new AbortController,o=this._uiManager.combinedSignal(i),a={capture:!0,passive:!1,signal:o},l=d=>{i.abort(),this.#i=null,this.#m=!1,this._uiManager.endDragSession()||this.#O(d),n&&this._onStopDragging()};t&&(this.#A=e.clientX,this.#w=e.clientY,this.#i=e.pointerId,this.#a=e.pointerType,window.addEventListener("pointermove",d=>{n||(n=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:u,clientY:f,pointerId:m}=d;if(m!==this.#i){stopEvent(d);return}const[v,g]=this.screenToPageTranslation(u-this.#A,f-this.#w);this.#A=u,this.#w=f,this._uiManager.dragSelectedEditors(v,g)},a),window.addEventListener("touchmove",stopEvent,a),window.addEventListener("pointerdown",d=>{d.pointerType===this.#a&&(this.#P||d.isPrimary)&&l(d),stopEvent(d)},a));const h=d=>{if(!this.#i||this.#i===d.pointerId){l(d);return}stopEvent(d)};window.addEventListener("pointerup",h,{signal:o}),window.addEventListener("blur",h,{signal:o})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#x&&clearTimeout(this.#x),this.#x=setTimeout(()=>{this.#x=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,n=this.rotation){const i=this.parentScale,[o,a]=this.pageDimensions,[l,h]=this.pageTranslation,d=e/i,u=t/i,f=this.x*o,m=this.y*a,v=this.width*o,g=this.height*a;switch(n){case 0:return[f+d+l,a-m-u-g+h,f+d+v+l,a-m-u+h];case 90:return[f+u+l,a-m+d+h,f+u+g+l,a-m+d+v+h];case 180:return[f-d-v+l,a-m+u+h,f-d+l,a-m+u+g+h];case 270:return[f-u-g+l,a-m-d-v+h,f-u+l,a-m-d+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,i,o,a]=e,l=o-n,h=a-i;switch(this.rotation){case 0:return[n,t-a,l,h];case 90:return[n,t-i,h,l];case 180:return[o,t-i,l,h];case 270:return[o,t-a,h,l];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&AnnotationEditor._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#r?.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:n,opacity:i,deleted:o,richText:a},uid:l,pageIndex:h,creationDate:d,modificationDate:u}=this;return{id:l,pageIndex:h,rect:this.getPDFRect(),richText:a,contentsObj:{str:e},creationDate:d,modificationDate:n||u,popupRef:!o,color:t,opacity:i}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#v=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#v=!1,!0):!1}isInEditMode(){return this.#v}shouldGetKeyboardEvents(){return this.#y}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:i}=this.getClientDimensions(),{innerHeight:o,innerWidth:a}=window;return t<a&&i>0&&e<o&&n>0}#j(){if(this.#f||!this.div)return;this.#f=new AbortController;const e=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#j()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(e,t,n){const i=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});i.rotation=e.rotation,i.#e=e.accessibilityData,i._isCopy=e.isCopy||!1;const[o,a]=i.pageDimensions,[l,h,d,u]=i.getRectInCurrentCoords(e.rect,a);return i.x=l/o,i.y=h/a,i.width=d/o,i.height=u/a,i}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#x&&(clearTimeout(this.#x),this.#x=null),this.#$(),this.removeEditToolbar(),this.#b){for(const e of this.#b.values())clearTimeout(e);this.#b=null}this.parent=null,this.#P?.destroy(),this.#P=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#N(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[n,i,o,a]=this.getPDFRect();return[AnnotationEditor._round(n+(o-n)*e),AnnotationEditor._round(i+(a-i)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#r.commentPopupPositionInLayer}set commentPopupPosition(e){this.#r.commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return this.#r.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#r.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){this.#r.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#h={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#c.children;if(!this.#t){this.#t=Array.from(t);const a=this.#B.bind(this),l=this.#H.bind(this),h=this._uiManager._signal;for(const d of this.#t){const u=d.getAttribute("data-resizer-name");d.setAttribute("role","spinbutton"),d.addEventListener("keydown",a,{signal:h}),d.addEventListener("blur",l,{signal:h}),d.addEventListener("focus",this.#K.bind(this,u),{signal:h}),d.setAttribute("data-l10n-id",AnnotationEditor._l10nResizer[u])}}const n=this.#t[0];let i=0;for(const a of t){if(a===n)break;i++}const o=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(o!==i){if(o<i)for(let l=0;l<i-o;l++)this.#c.append(this.#c.firstChild);else if(o>i)for(let l=0;l<o-i;l++)this.#c.firstChild.before(this.#c.lastChild);let a=0;for(const l of t){const d=this.#t[a++].getAttribute("data-resizer-name");l.setAttribute("data-l10n-id",AnnotationEditor._l10nResizer[d])}}this.#W(0),this.#y=!0,this.#c.firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#B(e){AnnotationEditor._resizerKeyboardManager.exec(this,e)}#H(e){this.#y&&e.relatedTarget?.parentNode!==this.#c&&this.#$()}#K(e){this.#g=this.#y?e:""}#W(e){if(this.#t)for(const t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#y&&this.#L(this.#g,{deltaX:e,deltaY:t,fromKeyboard:!0})}#$(){this.#y=!1,this.#W(-1),this.#I()}_stopResizingWithKeyboard(){this.#$(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#n?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#n?.toggleAltTextBadge(!0),this.hasComment&&this._uiManager.toggleComment(this,!1,!1))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(e){this.#p=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#b||=new Map;const{action:n}=e;let i=this.#b.get(n);i&&clearTimeout(i),i=setTimeout(()=>{this._reportTelemetry(e),this.#b.delete(n),this.#b.size===0&&(this.#b=null)},AnnotationEditor._telemetryTimeout),this.#b.set(n,i);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#o=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#o=!0}updateFakeAnnotationElement(e){if(!this.#d&&!this.deleted){this.#d=e.addFakeAnnotation(this);return}if(this.deleted){this.#d.remove(),this.#d=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#d.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}}class FakeEditor extends AnnotationEditor{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const SEED=3285377520,MASK_HIGH=4294901760,MASK_LOW=65535;class MurmurHash3_64{constructor(e){this.h1=e?e&4294967295:SEED,this.h2=e?e&4294967295:SEED}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let x=0,E=e.length;x<E;x++){const b=e.charCodeAt(x);b<=255?t[n++]=b:(t[n++]=b>>>8,t[n++]=b&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const i=n>>2,o=n-i*4,a=new Uint32Array(t.buffer,0,i);let l=0,h=0,d=this.h1,u=this.h2;const f=3432918353,m=461845907,v=f&MASK_LOW,g=m&MASK_LOW;for(let x=0;x<i;x++)x&1?(l=a[x],l=l*f&MASK_HIGH|l*v&MASK_LOW,l=l<<15|l>>>17,l=l*m&MASK_HIGH|l*g&MASK_LOW,d^=l,d=d<<13|d>>>19,d=d*5+3864292196):(h=a[x],h=h*f&MASK_HIGH|h*v&MASK_LOW,h=h<<15|h>>>17,h=h*m&MASK_HIGH|h*g&MASK_LOW,u^=h,u=u<<13|u>>>19,u=u*5+3864292196);switch(l=0,o){case 3:l^=t[i*4+2]<<16;case 2:l^=t[i*4+1]<<8;case 1:l^=t[i*4],l=l*f&MASK_HIGH|l*v&MASK_LOW,l=l<<15|l>>>17,l=l*m&MASK_HIGH|l*g&MASK_LOW,i&1?d^=l:u^=l}this.h1=d,this.h2=u}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&MASK_HIGH|e*36045&MASK_LOW,t=t*4283543511&MASK_HIGH|((t<<16|e>>>16)*2950163797&MASK_HIGH)>>>16,e^=t>>>1,e=e*444984403&MASK_HIGH|e*60499&MASK_LOW,t=t*3301882366&MASK_HIGH|((t<<16|e>>>16)*3120437893&MASK_HIGH)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const SerializableEmpty=Object.freeze({map:null,hash:"",transfer:void 0});class AnnotationStorage{#e=!1;#t=null;#n=null;#r=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=this.#r.get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return this.#r.get(e)}remove(e){const t=this.#r.get(e);if(t!==void 0&&(t instanceof AnnotationEditor&&this.#n.delete(t.annotationElementId),this.#r.delete(e),this.#r.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const n of this.#r.values())if(n instanceof AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=this.#r.get(e);let i=!1;if(n!==void 0)for(const[o,a]of Object.entries(t))n[o]!==a&&(i=!0,n[o]=a);else i=!0,this.#r.set(e,t);i&&this.#s(),t instanceof AnnotationEditor&&((this.#n||=new Map).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return this.#r.has(e)}get size(){return this.#r.size}#s(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new PrintAnnotationStorage(this)}get serializable(){if(this.#r.size===0)return SerializableEmpty;const e=new Map,t=new MurmurHash3_64,n=[],i=Object.create(null);let o=!1;for(const[a,l]of this.#r){const h=l instanceof AnnotationEditor?l.serialize(!1,i):l;h&&(e.set(a,h),t.update(`${a}:${JSON.stringify(h)}`),o||=!!h.bitmap)}if(o)for(const a of e.values())a.bitmap&&n.push(a.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:SerializableEmpty}get editorStats(){let e=null;const t=new Map;let n=0,i=0;for(const o of this.#r.values()){if(!(o instanceof AnnotationEditor)){o.popup&&(o.popup.deleted?i+=1:n+=1);continue}o.isCommentDeleted?i+=1:o.hasEditedComment&&(n+=1);const a=o.telemetryFinalData;if(!a)continue;const{type:l}=a;t.has(l)||t.set(l,Object.getPrototypeOf(o).constructor),e||=Object.create(null);const h=e[l]||=new Map;for(const[d,u]of Object.entries(a)){if(d==="type")continue;let f=h.get(d);f||(f=new Map,h.set(d,f));const m=f.get(u)??0;f.set(u,m+1)}}if((i>0||n>0)&&(e||=Object.create(null),e.comments={deleted:i,edited:n}),!e)return null;for(const[o,a]of t)e[o]=a.computeTelemetryFinalData(e[o]);return e}resetModifiedIds(){this.#t=null}updateEditor(e,t){const n=this.#n?.get(e);return n?(n.updateFromAnnotationLayer(t),!0):!1}getEditor(e){return this.#n?.get(e)||null}get modifiedIds(){if(this.#t)return this.#t;const e=[];if(this.#n)for(const t of this.#n.values())t.serialize()&&e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}[Symbol.iterator](){return this.#r.entries()}}class PrintAnnotationStorage extends AnnotationStorage{#e;constructor(e){super();const{map:t,hash:n,transfer:i}=e.serializable,o=structuredClone(t,i?{transfer:i}:null);this.#e={map:o,hash:n,transfer:i}}get print(){unreachable("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return shadow(this,"modifiedIds",{ids:new Set,hash:""})}}class FontLoader{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:n}){if(!(!e||this.#e.has(e.loadedName))){if(assert$1(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:o,style:a}=e,l=new FontFace(i,o,a);this.addNativeFontFace(l);try{await l.load(),this.#e.add(i),n?.(e)}catch{warn(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(l)}return}unreachable("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(i){throw warn(`Failed to load font '${n.family}': '${i}'.`),e.disableFontFace=!0,i}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const i=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,i)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return shadow(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return shadow(this,"isSyncFontLoadingSupported",isNodeJS||util_FeatureTest.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(assert$1(!i.done,"completeRequest() cannot be called twice."),i.done=!0;n.length>0&&n[0].done;){const o=n.shift();setTimeout(o.callback,0)}}const{loadingRequests:n}=this,i={done:!1,complete:t,callback:e};return n.push(i),i}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return shadow(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(C,A){return C.charCodeAt(A)<<24|C.charCodeAt(A+1)<<16|C.charCodeAt(A+2)<<8|C.charCodeAt(A+3)&255}function i(C,A,R,L){const j=C.substring(0,A),F=C.substring(A+R);return j+L+F}let o,a;const l=this._document.createElement("canvas");l.width=1,l.height=1;const h=l.getContext("2d");let d=0;function u(C,A){if(++d>30){warn("Load test font never loaded."),A();return}if(h.font="30px "+C,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){A();return}setTimeout(u.bind(null,C,A))}const f=`lt${Date.now()}${this.loadTestFontId++}`;let m=this._loadTestFont;m=i(m,976,f.length,f);const g=16,x=1482184792;let E=n(m,g);for(o=0,a=f.length-3;o<a;o+=4)E=E-x+n(f,o)|0;o<f.length&&(E=E-x+n(f+"XXX",o)|0),m=i(m,g,4,string32(E));const b=`url(data:font/opentype;base64,${btoa(m)});`,_=`@font-face {font-family:"${f}";src:${b}}`;this.insertRule(_);const S=this._document.createElement("div");S.style.visibility="hidden",S.style.width=S.style.height="10px",S.style.position="absolute",S.style.top=S.style.left="0px";for(const C of[e.loadedName,f]){const A=this._document.createElement("span");A.textContent="Hi",A.style.fontFamily=C,S.append(A)}this._document.body.append(S),u(f,()=>{S.remove(),t.complete()})}}class FontFaceObject{#e;constructor(e,t=null,n,i){this.compiledGlyphs=Object.create(null),this.#e=e,this._inspectFont=t,n&&Object.assign(this,n),i&&(this.charProcOperatorList=i)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${toBase64Util(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const n=this.loadedName+"_path_"+t;let i;try{i=e.get(n)}catch(a){warn(`getPathGenerator - ignoring character: "${a}".`)}const o=new Path2D(i||"");return this.fontExtraProperties||e.delete(n),this.compiledGlyphs[t]=o}get black(){return this.#e.black}get bold(){return this.#e.bold}get disableFontFace(){return this.#e.disableFontFace??!1}get fontExtraProperties(){return this.#e.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#e.isInvalidPDFjsFont}get isType3Font(){return this.#e.isType3Font}get italic(){return this.#e.italic}get missingFile(){return this.#e.missingFile}get remeasure(){return this.#e.remeasure}get vertical(){return this.#e.vertical}get ascent(){return this.#e.ascent}get defaultWidth(){return this.#e.defaultWidth}get descent(){return this.#e.descent}get bbox(){return this.#e.bbox}get fontMatrix(){return this.#e.fontMatrix}get fallbackName(){return this.#e.fallbackName}get loadedName(){return this.#e.loadedName}get mimetype(){return this.#e.mimetype}get name(){return this.#e.name}get data(){return this.#e.data}clearData(){this.#e.clearData()}get cssFontInfo(){return this.#e.cssFontInfo}get systemFontInfo(){return this.#e.systemFontInfo}get defaultVMetrics(){return this.#e.defaultVMetrics}}function getUrlProp(s){if(s instanceof URL)return s.href;if(typeof s=="string"){if(isNodeJS)return s;const e=URL.parse(s,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(s){if(isNodeJS&&typeof Buffer<"u"&&s instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength)return s;if(typeof s=="string")return stringToBytes(s);if(s instanceof ArrayBuffer||ArrayBuffer.isView(s)||typeof s=="object"&&!isNaN(s?.length))return new Uint8Array(s);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function getFactoryUrlProp(s){if(typeof s!="string")return null;if(s.endsWith("/"))return s;throw new Error(`Invalid factory url: "${s}" must include trailing slash.`)}const isRefProxy=s=>typeof s=="object"&&Number.isInteger(s?.num)&&s.num>=0&&Number.isInteger(s?.gen)&&s.gen>=0,isNameProxy=s=>typeof s=="object"&&typeof s?.name=="string",isValidExplicitDest=_isValidExplicitDest.bind(null,isRefProxy,isNameProxy);class LoopbackPort{#e=new Map;#t=Promise.resolve();postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(const[i]of this.#e)i.call(this,n)})}addEventListener(e,t,n=null){let i=null;if(n?.signal instanceof AbortSignal){const{signal:o}=n;if(o.aborted){warn("LoopbackPort - cannot use an `aborted` signal.");return}const a=()=>this.removeEventListener(e,t);i=()=>o.removeEventListener("abort",a),o.addEventListener("abort",a)}this.#e.set(t,i)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(const[,e]of this.#e)e?.();this.#e.clear()}}const CallbackKind={DATA:1,ERROR:2},StreamKind={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function onFn(){}function wrapReason(s){if(s instanceof AbortException||s instanceof InvalidPDFException||s instanceof PasswordException||s instanceof ResponseException||s instanceof UnknownErrorException)return s;switch(s instanceof Error||typeof s=="object"&&s!==null||unreachable('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),s.name){case"AbortException":return new AbortException(s.message);case"InvalidPDFException":return new InvalidPDFException(s.message);case"PasswordException":return new PasswordException(s.message,s.code);case"ResponseException":return new ResponseException(s.message,s.status,s.missing);case"UnknownErrorException":return new UnknownErrorException(s.message,s.details)}return new UnknownErrorException(s.message,s.toString())}class MessageHandler{#e=new AbortController;constructor(e,t,n){this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#r(e);return}if(e.callback){const n=e.callbackId,i=this.callbackCapabilities[n];if(!i)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],e.callback===CallbackKind.DATA)i.resolve(e.data);else if(e.callback===CallbackKind.ERROR)i.reject(wrapReason(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const n=this.sourceName,i=e.sourceName,o=this.comObj;Promise.try(t,e.data).then(function(a){o.postMessage({sourceName:n,targetName:i,callback:CallbackKind.DATA,callbackId:e.callbackId,data:a})},function(a){o.postMessage({sourceName:n,targetName:i,callback:CallbackKind.ERROR,callbackId:e.callbackId,reason:wrapReason(a)})});return}if(e.streamId){this.#n(e);return}t(e.data)}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const i=this.callbackId++,o=Promise.withResolvers();this.callbackCapabilities[i]=o;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:i,data:t},n)}catch(a){o.reject(a)}return o.promise}sendWithStream(e,t,n,i){const o=this.streamId++,a=this.sourceName,l=this.targetName,h=this.comObj;return new ReadableStream({start:d=>{const u=Promise.withResolvers();return this.streamControllers[o]={controller:d,startCall:u,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:a,targetName:l,action:e,streamId:o,data:t,desiredSize:d.desiredSize},i),u.promise},pull:d=>{const u=Promise.withResolvers();return this.streamControllers[o].pullCall=u,h.postMessage({sourceName:a,targetName:l,stream:StreamKind.PULL,streamId:o,desiredSize:d.desiredSize}),u.promise},cancel:d=>{assert$1(d instanceof Error,"cancel must have a valid reason");const u=Promise.withResolvers();return this.streamControllers[o].cancelCall=u,this.streamControllers[o].isClosed=!0,h.postMessage({sourceName:a,targetName:l,stream:StreamKind.CANCEL,streamId:o,reason:wrapReason(d)}),u.promise}},n)}#n(e){const t=e.streamId,n=this.sourceName,i=e.sourceName,o=this.comObj,a=this,l=this.actionHandler[e.action],h={enqueue(d,u=1,f){if(this.isCancelled)return;const m=this.desiredSize;this.desiredSize-=u,m>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),o.postMessage({sourceName:n,targetName:i,stream:StreamKind.ENQUEUE,streamId:t,chunk:d},f)},close(){this.isCancelled||(this.isCancelled=!0,o.postMessage({sourceName:n,targetName:i,stream:StreamKind.CLOSE,streamId:t}),delete a.streamSinks[t])},error(d){assert$1(d instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,o.postMessage({sourceName:n,targetName:i,stream:StreamKind.ERROR,streamId:t,reason:wrapReason(d)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[t]=h,Promise.try(l,e.data,h).then(function(){o.postMessage({sourceName:n,targetName:i,stream:StreamKind.START_COMPLETE,streamId:t,success:!0})},function(d){o.postMessage({sourceName:n,targetName:i,stream:StreamKind.START_COMPLETE,streamId:t,reason:wrapReason(d)})})}#r(e){const t=e.streamId,n=this.sourceName,i=e.sourceName,o=this.comObj,a=this.streamControllers[t],l=this.streamSinks[t];switch(e.stream){case StreamKind.START_COMPLETE:e.success?a.startCall.resolve():a.startCall.reject(wrapReason(e.reason));break;case StreamKind.PULL_COMPLETE:e.success?a.pullCall.resolve():a.pullCall.reject(wrapReason(e.reason));break;case StreamKind.PULL:if(!l){o.postMessage({sourceName:n,targetName:i,stream:StreamKind.PULL_COMPLETE,streamId:t,success:!0});break}l.desiredSize<=0&&e.desiredSize>0&&l.sinkCapability.resolve(),l.desiredSize=e.desiredSize,Promise.try(l.onPull||onFn).then(function(){o.postMessage({sourceName:n,targetName:i,stream:StreamKind.PULL_COMPLETE,streamId:t,success:!0})},function(d){o.postMessage({sourceName:n,targetName:i,stream:StreamKind.PULL_COMPLETE,streamId:t,reason:wrapReason(d)})});break;case StreamKind.ENQUEUE:if(assert$1(a,"enqueue should have stream controller"),a.isClosed)break;a.controller.enqueue(e.chunk);break;case StreamKind.CLOSE:if(assert$1(a,"close should have stream controller"),a.isClosed)break;a.isClosed=!0,a.controller.close(),this.#s(a,t);break;case StreamKind.ERROR:assert$1(a,"error should have stream controller"),a.controller.error(wrapReason(e.reason)),this.#s(a,t);break;case StreamKind.CANCEL_COMPLETE:e.success?a.cancelCall.resolve():a.cancelCall.reject(wrapReason(e.reason)),this.#s(a,t);break;case StreamKind.CANCEL:if(!l)break;const h=wrapReason(e.reason);Promise.try(l.onCancel||onFn,h).then(function(){o.postMessage({sourceName:n,targetName:i,stream:StreamKind.CANCEL_COMPLETE,streamId:t,success:!0})},function(d){o.postMessage({sourceName:n,targetName:i,stream:StreamKind.CANCEL_COMPLETE,streamId:t,reason:wrapReason(d)})}),l.sinkCapability.reject(h),l.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#s(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#e?.abort(),this.#e=null}}class BaseCanvasFactory{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){unreachable("Abstract method `_createCanvas` called.")}}class DOMCanvasFactory extends BaseCanvasFactory{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class BaseCMapReaderFactory{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){unreachable("Abstract method `_fetch` called.")}}class DOMCMapReaderFactory extends BaseCMapReaderFactory{async _fetch(e){const t=await fetchData(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):stringToBytes(t)}}class BaseFilterFactory{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,i,o){return"none"}destroy(e=!1){}}class DOMFilterFactory extends BaseFilterFactory{#e;#t;#n;#r;#s;#o;#i=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#r=e,this.#s=t}get#a(){return this.#t||=new Map}get#c(){return this.#o||=new Map}get#l(){if(!this.#n){const e=this.#s.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const n=this.#s.createElementNS(SVG_NS,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#n=this.#s.createElementNS(SVG_NS,"defs"),e.append(n),n.append(this.#n),this.#s.body.append(e)}return this.#n}#h(e){if(e.length===1){const h=e[0],d=new Array(256);for(let f=0;f<256;f++)d[f]=h[f]/255;const u=d.join(",");return[u,u,u]}const[t,n,i]=e,o=new Array(256),a=new Array(256),l=new Array(256);for(let h=0;h<256;h++)o[h]=t[h]/255,a[h]=n[h]/255,l[h]=i[h]/255;return[o.join(","),a.join(","),l.join(",")]}#d(e){if(this.#e===void 0){this.#e="";const t=this.#s.URL;t!==this.#s.baseURI&&(isDataScheme(t)?warn('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=updateUrlHash(t,""))}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#a.get(e);if(t)return t;const[n,i,o]=this.#h(e),a=e.length===1?n:`${n}${i}${o}`;if(t=this.#a.get(a),t)return this.#a.set(e,t),t;const l=`g_${this.#r}_transfer_map_${this.#i++}`,h=this.#d(l);this.#a.set(e,h),this.#a.set(a,h);const d=this.#m(l);return this.#p(n,i,o,d),h}addHCMFilter(e,t){const n=`${e}-${t}`,i="base";let o=this.#c.get(i);if(o?.key===n||(o?(o.filter?.remove(),o.key=n,o.url="none",o.filter=null):(o={key:n,url:"none",filter:null},this.#c.set(i,o)),!e||!t))return o.url;const a=this.#y(e);e=Util.makeHexColor(...a);const l=this.#y(t);if(t=Util.makeHexColor(...l),this.#l.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return o.url;const h=new Array(256);for(let v=0;v<=255;v++){const g=v/255;h[v]=g<=.03928?g/12.92:((g+.055)/1.055)**2.4}const d=h.join(","),u=`g_${this.#r}_hcm_filter`,f=o.filter=this.#m(u);this.#p(d,d,d,f),this.#g(f);const m=(v,g)=>{const x=a[v]/255,E=l[v]/255,b=new Array(g+1);for(let _=0;_<=g;_++)b[_]=x+_/g*(E-x);return b.join(",")};return this.#p(m(0,5),m(1,5),m(2,5),f),o.url=this.#d(u),o.url}addAlphaFilter(e){let t=this.#a.get(e);if(t)return t;const[n]=this.#h([e]),i=`alpha_${n}`;if(t=this.#a.get(i),t)return this.#a.set(e,t),t;const o=`g_${this.#r}_alpha_map_${this.#i++}`,a=this.#d(o);this.#a.set(e,a),this.#a.set(i,a);const l=this.#m(o);return this.#v(n,l),a}addLuminosityFilter(e){let t=this.#a.get(e||"luminosity");if(t)return t;let n,i;if(e?([n]=this.#h([e]),i=`luminosity_${n}`):i="luminosity",t=this.#a.get(i),t)return this.#a.set(e,t),t;const o=`g_${this.#r}_luminosity_map_${this.#i++}`,a=this.#d(o);this.#a.set(e,a),this.#a.set(i,a);const l=this.#m(o);return this.#f(l),e&&this.#v(n,l),a}addHighlightHCMFilter(e,t,n,i,o){const a=`${t}-${n}-${i}-${o}`;let l=this.#c.get(e);if(l?.key===a||(l?(l.filter?.remove(),l.key=a,l.url="none",l.filter=null):(l={key:a,url:"none",filter:null},this.#c.set(e,l)),!t||!n))return l.url;const[h,d]=[t,n].map(this.#y.bind(this));let u=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),f=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),[m,v]=[i,o].map(this.#y.bind(this));f<u&&([u,f,m,v]=[f,u,v,m]),this.#l.style.color="";const g=(b,_,S)=>{const C=new Array(256),A=(f-u)/S,R=b/255,L=(_-b)/(255*S);let j=0;for(let F=0;F<=S;F++){const W=Math.round(u+F*A),K=R+F*L;for(let ee=j;ee<=W;ee++)C[ee]=K;j=W+1}for(let F=j;F<256;F++)C[F]=C[j-1];return C.join(",")},x=`g_${this.#r}_hcm_${e}_filter`,E=l.filter=this.#m(x);return this.#g(E),this.#p(g(m[0],v[0],5),g(m[1],v[1],5),g(m[2],v[2],5),E),l.url=this.#d(x),l.url}destroy(e=!1){e&&this.#o?.size||(this.#n?.parentNode.parentNode.remove(),this.#n=null,this.#t?.clear(),this.#t=null,this.#o?.clear(),this.#o=null,this.#i=0)}#f(e){const t=this.#s.createElementNS(SVG_NS,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#g(e){const t=this.#s.createElementNS(SVG_NS,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#m(e){const t=this.#s.createElementNS(SVG_NS,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#l.append(t),t}#u(e,t,n){const i=this.#s.createElementNS(SVG_NS,t);i.setAttribute("type","discrete"),i.setAttribute("tableValues",n),e.append(i)}#p(e,t,n,i){const o=this.#s.createElementNS(SVG_NS,"feComponentTransfer");i.append(o),this.#u(o,"feFuncR",e),this.#u(o,"feFuncG",t),this.#u(o,"feFuncB",n)}#v(e,t){const n=this.#s.createElementNS(SVG_NS,"feComponentTransfer");t.append(n),this.#u(n,"feFuncA",e)}#y(e){return this.#l.style.color=e,getRGB(getComputedStyle(this.#l).getPropertyValue("color"))}}class BaseStandardFontDataFactory{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){unreachable("Abstract method `_fetch` called.")}}class DOMStandardFontDataFactory extends BaseStandardFontDataFactory{async _fetch(e){const t=await fetchData(e,"arraybuffer");return new Uint8Array(t)}}class BaseWasmFactory{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){unreachable("Abstract method `_fetch` called.")}}class DOMWasmFactory extends BaseWasmFactory{async _fetch(e){const t=await fetchData(e,"arraybuffer");return new Uint8Array(t)}}isNodeJS&&warn("Please use the `legacy` build in Node.js environments.");async function node_utils_fetchData(s){const t=await process.getBuiltinModule("fs").promises.readFile(s);return new Uint8Array(t)}class NodeFilterFactory extends BaseFilterFactory{}class NodeCanvasFactory extends BaseCanvasFactory{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class NodeCMapReaderFactory extends BaseCMapReaderFactory{async _fetch(e){return node_utils_fetchData(e)}}class NodeStandardFontDataFactory extends BaseStandardFontDataFactory{async _fetch(e){return node_utils_fetchData(e)}}class NodeWasmFactory extends BaseWasmFactory{async _fetch(e){return node_utils_fetchData(e)}}const FORCED_DEPENDENCY_LABEL="__forcedDependency",{floor,ceil}=Math;function expandBBox(s,e,t,n,i,o){s[e*4+0]=Math.min(s[e*4+0],t),s[e*4+1]=Math.min(s[e*4+1],n),s[e*4+2]=Math.max(s[e*4+2],i),s[e*4+3]=Math.max(s[e*4+3],o)}const EMPTY_BBOX=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class BBoxReader{#e;#t;constructor(e,t){this.#e=e,this.#t=t}get length(){return this.#e.length}isEmpty(e){return this.#e[e]===EMPTY_BBOX}minX(e){return this.#t[e*4+0]/256}minY(e){return this.#t[e*4+1]/256}maxX(e){return(this.#t[e*4+2]+1)/256}maxY(e){return(this.#t[e*4+3]+1)/256}}const ensureDebugMetadata=(s,e)=>{if(!s)return;let t=s.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},s.set(e,t)),t};class CanvasDependencyTracker{#e={__proto__:null};#t={__proto__:null,transform:[],moveText:[],sameLineText:[],[FORCED_DEPENDENCY_LABEL]:[]};#n=new Map;#r=[];#s=[];#o=[[1,0,0,1,0,0]];#i=[-1/0,-1/0,1/0,1/0];#a=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#h=new Map;#d=new Map;#f;#g;#m;#u;#p;constructor(e,t,n=!1){this.#f=e.width,this.#g=e.height,this.#v(t),n&&(this.#p=new Map)}growOperationsCount(e){e>=this.#u.length&&this.#v(e,this.#u)}#v(e,t){const n=new ArrayBuffer(e*4);this.#m=new Uint8ClampedArray(n),this.#u=new Uint32Array(n),t&&t.length>0?(this.#u.set(t),this.#u.fill(EMPTY_BBOX,t.length)):this.#u.fill(EMPTY_BBOX)}save(e){return this.#e={__proto__:this.#e},this.#t={__proto__:this.#t,transform:{__proto__:this.#t.transform},moveText:{__proto__:this.#t.moveText},sameLineText:{__proto__:this.#t.sameLineText},[FORCED_DEPENDENCY_LABEL]:{__proto__:this.#t[FORCED_DEPENDENCY_LABEL]}},this.#i={__proto__:this.#i},this.#r.push(e),this}restore(e){const t=Object.getPrototypeOf(this.#e);if(t===null)return this;this.#e=t,this.#t=Object.getPrototypeOf(this.#t),this.#i=Object.getPrototypeOf(this.#i);const n=this.#r.pop();return n!==void 0&&(ensureDebugMetadata(this.#p,e)?.dependencies.add(n),this.#u[e]=this.#u[n]),this}recordOpenMarker(e){return this.#r.push(e),this}getOpenMarker(){return this.#r.length===0?null:this.#r.at(-1)}recordCloseMarker(e){const t=this.#r.pop();return t!==void 0&&(ensureDebugMetadata(this.#p,e)?.dependencies.add(t),this.#u[e]=this.#u[t]),this}beginMarkedContent(e){return this.#s.push(e),this}endMarkedContent(e){const t=this.#s.pop();return t!==void 0&&(ensureDebugMetadata(this.#p,e)?.dependencies.add(t),this.#u[e]=this.#u[t]),this}pushBaseTransform(e){return this.#o.push(Util.multiplyByDOMMatrix(this.#o.at(-1),e.getTransform())),this}popBaseTransform(){return this.#o.length>1&&this.#o.pop(),this}recordSimpleData(e,t){return this.#e[e]=t,this}recordIncrementalData(e,t){return this.#t[e].push(t),this}resetIncrementalData(e,t){return this.#t[e].length=0,this}recordNamedData(e,t){return this.#n.set(e,t),this}recordSimpleDataFromNamed(e,t,n){this.#e[e]=this.#n.get(t)??n}recordFutureForcedDependency(e,t){return this.recordIncrementalData(FORCED_DEPENDENCY_LABEL,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in this.#e&&this.recordFutureForcedDependency(t,this.#e[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of this.#l)this.recordFutureForcedDependency(FORCED_DEPENDENCY_LABEL,e);return this}resetBBox(e){return this.#c!==e&&(this.#c=e,this.#a[0]=1/0,this.#a[1]=1/0,this.#a[2]=-1/0,this.#a[3]=-1/0),this}recordClipBox(e,t,n,i,o,a){const l=Util.multiplyByDOMMatrix(this.#o.at(-1),t.getTransform()),h=[1/0,1/0,-1/0,-1/0];Util.axialAlignedBoundingBox([n,o,i,a],l,h);const d=Util.intersect(this.#i,h);return d?(this.#i[0]=d[0],this.#i[1]=d[1],this.#i[2]=d[2],this.#i[3]=d[3]):(this.#i[0]=this.#i[1]=1/0,this.#i[2]=this.#i[3]=-1/0),this}recordBBox(e,t,n,i,o,a){const l=this.#i;if(l[0]===1/0)return this;const h=Util.multiplyByDOMMatrix(this.#o.at(-1),t.getTransform());if(l[0]===-1/0)return Util.axialAlignedBoundingBox([n,o,i,a],h,this.#a),this;const d=[1/0,1/0,-1/0,-1/0];return Util.axialAlignedBoundingBox([n,o,i,a],h,d),this.#a[0]=Math.min(this.#a[0],Math.max(d[0],l[0])),this.#a[1]=Math.min(this.#a[1],Math.max(d[1],l[1])),this.#a[2]=Math.max(this.#a[2],Math.min(d[2],l[2])),this.#a[3]=Math.max(this.#a[3],Math.min(d[3],l[3])),this}recordCharacterBBox(e,t,n,i=1,o=0,a=0,l){const h=n.bbox;let d,u;if(h&&(d=h[2]!==h[0]&&h[3]!==h[1]&&this.#d.get(n),d!==!1&&(u=[0,0,0,0],Util.axialAlignedBoundingBox(h,n.fontMatrix,u),(i!==1||o!==0||a!==0)&&Util.scaleMinMax([i,0,0,-i,o,a],u),d)))return this.recordBBox(e,t,u[0],u[2],u[1],u[3]);if(!l)return this.recordFullPageBBox(e);const f=l();return h&&u&&d===void 0&&(d=u[0]<=o-f.actualBoundingBoxLeft&&u[2]>=o+f.actualBoundingBoxRight&&u[1]<=a-f.actualBoundingBoxAscent&&u[3]>=a+f.actualBoundingBoxDescent,this.#d.set(n,d),d)?this.recordBBox(e,t,u[0],u[2],u[1],u[3]):this.recordBBox(e,t,o-f.actualBoundingBoxLeft,o+f.actualBoundingBoxRight,a-f.actualBoundingBoxAscent,a+f.actualBoundingBoxDescent)}recordFullPageBBox(e){return this.#a[0]=Math.max(0,this.#i[0]),this.#a[1]=Math.max(0,this.#i[1]),this.#a[2]=Math.min(this.#f,this.#i[2]),this.#a[3]=Math.min(this.#g,this.#i[3]),this}getSimpleIndex(e){return this.#e[e]}recordDependencies(e,t){const n=this.#l,i=this.#e,o=this.#t;for(const a of t)a in this.#e?n.add(i[a]):a in o&&o[a].forEach(n.add,n);return this}recordNamedDependency(e,t){return this.#n.has(t)&&this.#l.add(this.#n.get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[FORCED_DEPENDENCY_LABEL]),this.#p){const n=ensureDebugMetadata(this.#p,e),{dependencies:i}=n;this.#l.forEach(i.add,i),this.#r.forEach(i.add,i),this.#s.forEach(i.add,i),i.delete(e),n.isRenderingOperation=!0}if(this.#c===e){const n=floor(this.#a[0]*256/this.#f),i=floor(this.#a[1]*256/this.#g),o=ceil(this.#a[2]*256/this.#f),a=ceil(this.#a[3]*256/this.#g);expandBBox(this.#m,e,n,i,o,a);for(const l of this.#l)l!==e&&expandBBox(this.#m,l,n,i,o,a);for(const l of this.#r)l!==e&&expandBBox(this.#m,l,n,i,o,a);for(const l of this.#s)l!==e&&expandBBox(this.#m,l,n,i,o,a);t||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(e,t=!1){const n=Array.from(this.#l);this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const i of n)this.recordIncrementalData("sameLineText",i);return this}bboxToClipBoxDropOperation(e,t=!1){return this.#c===e&&(this.#c=-1,this.#i[0]=Math.max(this.#i[0],this.#a[0]),this.#i[1]=Math.max(this.#i[1],this.#a[1]),this.#i[2]=Math.min(this.#i[2],this.#a[2]),this.#i[3]=Math.min(this.#i[3],this.#a[3]),t||this.#l.clear()),this}_takePendingDependencies(){const e=this.#l;return this.#l=new Set,e}_extractOperation(e){const t=this.#h.get(e);return this.#h.delete(e),t}_pushPendingDependencies(e){for(const t of e)this.#l.add(t)}take(){return this.#d.clear(),new BBoxReader(this.#u,this.#m)}takeDebugMetadata(){return this.#p}}class CanvasNestedDependencyTracker{#e;#t;#n;#r=0;#s=0;constructor(e,t,n){if(e instanceof CanvasNestedDependencyTracker&&e.#n===!!n)return e;this.#e=e,this.#t=t,this.#n=!!n}growOperationsCount(){throw new Error("Unreachable")}save(e){return this.#s++,this.#e.save(this.#t),this}restore(e){return this.#s>0&&(this.#e.restore(this.#t),this.#s--),this}recordOpenMarker(e){return this.#r++,this}getOpenMarker(){return this.#r>0?this.#t:this.#e.getOpenMarker()}recordCloseMarker(e){return this.#r--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return this.#e.pushBaseTransform(e),this}popBaseTransform(){return this.#e.popBaseTransform(),this}recordSimpleData(e,t){return this.#e.recordSimpleData(e,this.#t),this}recordIncrementalData(e,t){return this.#e.recordIncrementalData(e,this.#t),this}resetIncrementalData(e,t){return this.#e.resetIncrementalData(e,this.#t),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,n){return this.#e.recordSimpleDataFromNamed(e,t,this.#t),this}recordFutureForcedDependency(e,t){return this.#e.recordFutureForcedDependency(e,this.#t),this}inheritSimpleDataAsFutureForcedDependencies(e){return this.#e.inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#e.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return this.#n||this.#e.resetBBox(this.#t),this}recordClipBox(e,t,n,i,o,a){return this.#n||this.#e.recordClipBox(this.#t,t,n,i,o,a),this}recordBBox(e,t,n,i,o,a){return this.#n||this.#e.recordBBox(this.#t,t,n,i,o,a),this}recordCharacterBBox(e,t,n,i,o,a,l){return this.#n||this.#e.recordCharacterBBox(this.#t,t,n,i,o,a,l),this}recordFullPageBBox(e){return this.#n||this.#e.recordFullPageBBox(this.#t),this}getSimpleIndex(e){return this.#e.getSimpleIndex(e)}recordDependencies(e,t){return this.#e.recordDependencies(this.#t,t),this}recordNamedDependency(e,t){return this.#e.recordNamedDependency(this.#t,t),this}recordOperation(e){return this.#e.recordOperation(this.#t,!0),this}recordShowTextOperation(e){return this.#e.recordShowTextOperation(this.#t,!0),this}bboxToClipBoxDropOperation(e){return this.#n||this.#e.bboxToClipBoxDropOperation(this.#t,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const Dependencies={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},PathType={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function applyBoundingBox(s,e){if(!e)return;const t=e[2]-e[0],n=e[3]-e[1],i=new Path2D;i.rect(e[0],e[1],t,n),s.clip(i)}class BaseShadingPattern{isModifyingCurrentTransform(){return!1}getPattern(){unreachable("Abstract method `getPattern` called.")}}class RadialAxialShadingPattern extends BaseShadingPattern{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)t.addColorStop(n[0],n[1]);return t}getPattern(e,t,n,i){let o;if(i===PathType.STROKE||i===PathType.FILL){const a=t.current.getClippedPathBoundingBox(i,getCurrentTransform(e))||[0,0,0,0],l=Math.ceil(a[2]-a[0])||1,h=Math.ceil(a[3]-a[1])||1,d=t.cachedCanvases.getCanvas("pattern",l,h),u=d.context;u.clearRect(0,0,u.canvas.width,u.canvas.height),u.beginPath(),u.rect(0,0,u.canvas.width,u.canvas.height),u.translate(-a[0],-a[1]),n=Util.transform(n,[1,0,0,1,a[0],a[1]]),u.transform(...t.baseTransform),this.matrix&&u.transform(...this.matrix),applyBoundingBox(u,this._bbox),u.fillStyle=this._createGradient(u),u.fill(),o=e.createPattern(d.canvas,"no-repeat");const f=new DOMMatrix(n);o.setTransform(f)}else applyBoundingBox(e,this._bbox),o=this._createGradient(e);return o}}function drawTriangle(s,e,t,n,i,o,a,l){const h=e.coords,d=e.colors,u=s.data,f=s.width*4;let m;h[t+1]>h[n+1]&&(m=t,t=n,n=m,m=o,o=a,a=m),h[n+1]>h[i+1]&&(m=n,n=i,i=m,m=a,a=l,l=m),h[t+1]>h[n+1]&&(m=t,t=n,n=m,m=o,o=a,a=m);const v=(h[t]+e.offsetX)*e.scaleX,g=(h[t+1]+e.offsetY)*e.scaleY,x=(h[n]+e.offsetX)*e.scaleX,E=(h[n+1]+e.offsetY)*e.scaleY,b=(h[i]+e.offsetX)*e.scaleX,_=(h[i+1]+e.offsetY)*e.scaleY;if(g>=_)return;const S=d[o],C=d[o+1],A=d[o+2],R=d[a],L=d[a+1],j=d[a+2],F=d[l],W=d[l+1],K=d[l+2],ee=Math.round(g),te=Math.round(_);let re,ie,Q,z,N,k,I,D;for(let U=ee;U<=te;U++){if(U<E){const O=U<g?0:(g-U)/(g-E);re=v-(v-x)*O,ie=S-(S-R)*O,Q=C-(C-L)*O,z=A-(A-j)*O}else{let O;U>_?O=1:E===_?O=0:O=(E-U)/(E-_),re=x-(x-b)*O,ie=R-(R-F)*O,Q=L-(L-W)*O,z=j-(j-K)*O}let $;U<g?$=0:U>_?$=1:$=(g-U)/(g-_),N=v-(v-b)*$,k=S-(S-F)*$,I=C-(C-W)*$,D=A-(A-K)*$;const q=Math.round(Math.min(re,N)),V=Math.round(Math.max(re,N));let P=f*U+q*4;for(let O=q;O<=V;O++)$=(re-O)/(re-N),$<0?$=0:$>1&&($=1),u[P++]=ie-(ie-k)*$|0,u[P++]=Q-(Q-I)*$|0,u[P++]=z-(z-D)*$|0,u[P++]=255}}function drawFigure(s,e,t){const n=e.coords,i=e.colors;let o,a;switch(e.type){case"lattice":const l=e.verticesPerRow,h=Math.floor(n.length/l)-1,d=l-1;for(o=0;o<h;o++){let u=o*l;for(let f=0;f<d;f++,u++)drawTriangle(s,t,n[u],n[u+1],n[u+l],i[u],i[u+1],i[u+l]),drawTriangle(s,t,n[u+l+1],n[u+1],n[u+l],i[u+l+1],i[u+1],i[u+l])}break;case"triangles":for(o=0,a=n.length;o<a;o+=3)drawTriangle(s,t,n[o],n[o+1],n[o+2],i[o],i[o+1],i[o+2]);break;default:throw new Error("illegal figure")}}class MeshShadingPattern extends BaseShadingPattern{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,n){const l=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),d=Math.ceil(this._bounds[2])-l,u=Math.ceil(this._bounds[3])-h,f=Math.min(Math.ceil(Math.abs(d*e[0]*1.1)),3e3),m=Math.min(Math.ceil(Math.abs(u*e[1]*1.1)),3e3),v=d/f,g=u/m,x={coords:this._coords,colors:this._colors,offsetX:-l,offsetY:-h,scaleX:1/v,scaleY:1/g},E=f+4,b=m+4,_=n.getCanvas("mesh",E,b),S=_.context,C=S.createImageData(f,m);if(t){const R=C.data;for(let L=0,j=R.length;L<j;L+=4)R[L]=t[0],R[L+1]=t[1],R[L+2]=t[2],R[L+3]=255}for(const R of this._figures)drawFigure(C,R,x);return S.putImageData(C,2,2),{canvas:_.canvas,offsetX:l-2*v,offsetY:h-2*g,scaleX:v,scaleY:g}}isModifyingCurrentTransform(){return!0}getPattern(e,t,n,i){applyBoundingBox(e,this._bbox);const o=new Float32Array(2);if(i===PathType.SHADING)Util.singularValueDecompose2dScale(getCurrentTransform(e),o);else if(this.matrix){Util.singularValueDecompose2dScale(this.matrix,o);const[l,h]=o;Util.singularValueDecompose2dScale(t.baseTransform,o),o[0]*=l,o[1]*=h}else Util.singularValueDecompose2dScale(t.baseTransform,o);const a=this._createMeshCanvas(o,i===PathType.SHADING?null:this._background,t.cachedCanvases);return i!==PathType.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(a.offsetX,a.offsetY),e.scale(a.scaleX,a.scaleY),e.createPattern(a.canvas,"no-repeat")}}class DummyShadingPattern extends BaseShadingPattern{getPattern(){return"hotpink"}}function getShadingPattern(s){switch(s[0]){case"RadialAxial":return new RadialAxialShadingPattern(s);case"Mesh":return new MeshShadingPattern(s);case"Dummy":return new DummyShadingPattern}throw new Error(`Unknown IR type: ${s[0]}`)}const PaintType={COLORED:1,UNCOLORED:2};class TilingPattern{static MAX_PATTERN_SIZE=3e3;constructor(e,t,n,i){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=n,this.baseTransform=i}createPatternCanvas(e,t){const{bbox:n,operatorList:i,paintType:o,tilingType:a,color:l,canvasGraphicsFactory:h}=this;let{xstep:d,ystep:u}=this;d=Math.abs(d),u=Math.abs(u),info("TilingType: "+a);const f=n[0],m=n[1],v=n[2],g=n[3],x=v-f,E=g-m,b=new Float32Array(2);Util.singularValueDecompose2dScale(this.matrix,b);const[_,S]=b;Util.singularValueDecompose2dScale(this.baseTransform,b);const C=_*b[0],A=S*b[1];let R=x,L=E,j=!1,F=!1;const W=Math.ceil(d*C),K=Math.ceil(u*A),ee=Math.ceil(x*C),te=Math.ceil(E*A);W>=ee?R=d:j=!0,K>=te?L=u:F=!0;const re=this.getSizeAndScale(R,this.ctx.canvas.width,C),ie=this.getSizeAndScale(L,this.ctx.canvas.height,A),Q=e.cachedCanvases.getCanvas("pattern",re.size,ie.size),z=Q.context,N=h.createCanvasGraphics(z,t);if(N.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(N,o,l),z.translate(-re.scale*f,-ie.scale*m),N.transform(0,re.scale,0,0,ie.scale,0,0),z.save(),N.dependencyTracker?.save(),this.clipBbox(N,f,m,v,g),N.baseTransform=getCurrentTransform(N.ctx),N.executeOperatorList(i),N.endDrawing(),N.dependencyTracker?.restore(),z.restore(),j||F){const k=Q.canvas;j&&(R=d),F&&(L=u);const I=this.getSizeAndScale(R,this.ctx.canvas.width,C),D=this.getSizeAndScale(L,this.ctx.canvas.height,A),U=I.size,$=D.size,q=e.cachedCanvases.getCanvas("pattern-workaround",U,$),V=q.context,P=j?Math.floor(x/d):0,O=F?Math.floor(E/u):0;for(let B=0;B<=P;B++)for(let G=0;G<=O;G++)V.drawImage(k,U*B,$*G,U,$,0,0,U,$);return{canvas:q.canvas,scaleX:I.scale,scaleY:D.scale,offsetX:f,offsetY:m}}return{canvas:Q.canvas,scaleX:re.scale,scaleY:ie.scale,offsetX:f,offsetY:m}}getSizeAndScale(e,t,n){const i=Math.max(TilingPattern.MAX_PATTERN_SIZE,t);let o=Math.ceil(e*n);return o>=i?o=i:n=o/e,{scale:n,size:o}}clipBbox(e,t,n,i,o){const a=i-t,l=o-n;e.ctx.rect(t,n,a,l),Util.axialAlignedBoundingBox([t,n,i,o],getCurrentTransform(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const i=e.ctx,o=e.current;switch(t){case PaintType.COLORED:const{fillStyle:a,strokeStyle:l}=this.ctx;i.fillStyle=o.fillColor=a,i.strokeStyle=o.strokeColor=l;break;case PaintType.UNCOLORED:i.fillStyle=i.strokeStyle=n,o.fillColor=o.strokeColor=n;break;default:throw new FormatError(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,n,i,o){let a=n;i!==PathType.SHADING&&(a=Util.transform(a,t.baseTransform),this.matrix&&(a=Util.transform(a,this.matrix)));const l=this.createPatternCanvas(t,o);let h=new DOMMatrix(a);h=h.translate(l.offsetX,l.offsetY),h=h.scale(1/l.scaleX,1/l.scaleY);const d=e.createPattern(l.canvas,"repeat");return d.setTransform(h),d}}function convertBlackAndWhiteToRGBA({src:s,srcPos:e=0,dest:t,width:n,height:i,nonBlackColor:o=4294967295,inverseDecode:a=!1}){const l=util_FeatureTest.isLittleEndian?4278190080:255,[h,d]=a?[o,l]:[l,o],u=n>>3,f=n&7,m=s.length;t=new Uint32Array(t.buffer);let v=0;for(let g=0;g<i;g++){for(const E=e+u;e<E;e++){const b=e<m?s[e]:255;t[v++]=b&128?d:h,t[v++]=b&64?d:h,t[v++]=b&32?d:h,t[v++]=b&16?d:h,t[v++]=b&8?d:h,t[v++]=b&4?d:h,t[v++]=b&2?d:h,t[v++]=b&1?d:h}if(f===0)continue;const x=e<m?s[e++]:255;for(let E=0;E<f;E++)t[v++]=x&1<<7-E?d:h}return{srcPos:e,destPos:v}}const MIN_FONT_SIZE=16,MAX_FONT_SIZE=100,EXECUTION_TIME=15,EXECUTION_STEPS=10,FULL_CHUNK_HEIGHT=16,SCALE_MATRIX=new DOMMatrix,XY=new Float32Array(2),MIN_MAX_INIT=new Float32Array([1/0,1/0,-1/0,-1/0]);function mirrorContextOperations(s,e){if(s._removeMirroring)throw new Error("Context is already forwarding operations.");s.__originalSave=s.save,s.__originalRestore=s.restore,s.__originalRotate=s.rotate,s.__originalScale=s.scale,s.__originalTranslate=s.translate,s.__originalTransform=s.transform,s.__originalSetTransform=s.setTransform,s.__originalResetTransform=s.resetTransform,s.__originalClip=s.clip,s.__originalMoveTo=s.moveTo,s.__originalLineTo=s.lineTo,s.__originalBezierCurveTo=s.bezierCurveTo,s.__originalRect=s.rect,s.__originalClosePath=s.closePath,s.__originalBeginPath=s.beginPath,s._removeMirroring=()=>{s.save=s.__originalSave,s.restore=s.__originalRestore,s.rotate=s.__originalRotate,s.scale=s.__originalScale,s.translate=s.__originalTranslate,s.transform=s.__originalTransform,s.setTransform=s.__originalSetTransform,s.resetTransform=s.__originalResetTransform,s.clip=s.__originalClip,s.moveTo=s.__originalMoveTo,s.lineTo=s.__originalLineTo,s.bezierCurveTo=s.__originalBezierCurveTo,s.rect=s.__originalRect,s.closePath=s.__originalClosePath,s.beginPath=s.__originalBeginPath,delete s._removeMirroring},s.save=function(){e.save(),this.__originalSave()},s.restore=function(){e.restore(),this.__originalRestore()},s.translate=function(t,n){e.translate(t,n),this.__originalTranslate(t,n)},s.scale=function(t,n){e.scale(t,n),this.__originalScale(t,n)},s.transform=function(t,n,i,o,a,l){e.transform(t,n,i,o,a,l),this.__originalTransform(t,n,i,o,a,l)},s.setTransform=function(t,n,i,o,a,l){e.setTransform(t,n,i,o,a,l),this.__originalSetTransform(t,n,i,o,a,l)},s.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},s.rotate=function(t){e.rotate(t),this.__originalRotate(t)},s.clip=function(t){e.clip(t),this.__originalClip(t)},s.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},s.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},s.bezierCurveTo=function(t,n,i,o,a,l){e.bezierCurveTo(t,n,i,o,a,l),this.__originalBezierCurveTo(t,n,i,o,a,l)},s.rect=function(t,n,i,o){e.rect(t,n,i,o),this.__originalRect(t,n,i,o)},s.closePath=function(){e.closePath(),this.__originalClosePath()},s.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class CachedCanvases{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let i;return this.cache[e]!==void 0?(i=this.cache[e],this.canvasFactory.reset(i,t,n)):(i=this.canvasFactory.create(t,n),this.cache[e]=i),i}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function drawImageAtIntegerCoords(s,e,t,n,i,o,a,l,h,d){const[u,f,m,v,g,x]=getCurrentTransform(s);if(f===0&&m===0){const _=a*u+g,S=Math.round(_),C=l*v+x,A=Math.round(C),R=(a+h)*u+g,L=Math.abs(Math.round(R)-S)||1,j=(l+d)*v+x,F=Math.abs(Math.round(j)-A)||1;return s.setTransform(Math.sign(u),0,0,Math.sign(v),S,A),s.drawImage(e,t,n,i,o,0,0,L,F),s.setTransform(u,f,m,v,g,x),[L,F]}if(u===0&&v===0){const _=l*m+g,S=Math.round(_),C=a*f+x,A=Math.round(C),R=(l+d)*m+g,L=Math.abs(Math.round(R)-S)||1,j=(a+h)*f+x,F=Math.abs(Math.round(j)-A)||1;return s.setTransform(0,Math.sign(f),Math.sign(m),0,S,A),s.drawImage(e,t,n,i,o,0,0,F,L),s.setTransform(u,f,m,v,g,x),[F,L]}s.drawImage(e,t,n,i,o,a,l,h,d);const E=Math.hypot(u,f),b=Math.hypot(m,v);return[E*h,b*d]}class CanvasExtraState{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=FONT_IDENTITY_MATRIX;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=TextRenderingMode.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(e,t,n){n?.(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=MIN_MAX_INIT.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=PathType.FILL,t=null){const n=this.minMax.slice();if(e===PathType.STROKE){t||unreachable("Stroke bounding box must include transform."),Util.singularValueDecompose2dScale(t,XY);const i=XY[0]*this.lineWidth/2,o=XY[1]*this.lineWidth/2;n[0]-=i,n[1]-=o,n[2]+=i,n[3]+=o}return n}updateClipFromPath(){const e=Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(MIN_MAX_INIT,0)}getClippedPathBoundingBox(e=PathType.FILL,t=null){return Util.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function putBinaryImageData(s,e){if(e instanceof ImageData){s.putImageData(e,0,0);return}const t=e.height,n=e.width,i=t%FULL_CHUNK_HEIGHT,o=(t-i)/FULL_CHUNK_HEIGHT,a=i===0?o:o+1,l=s.createImageData(n,FULL_CHUNK_HEIGHT);let h=0,d;const u=e.data,f=l.data;let m,v,g,x;if(e.kind===util_ImageKind.GRAYSCALE_1BPP){const E=u.byteLength,b=new Uint32Array(f.buffer,0,f.byteLength>>2),_=b.length,S=n+7>>3,C=4294967295,A=util_FeatureTest.isLittleEndian?4278190080:255;for(m=0;m<a;m++){for(g=m<o?FULL_CHUNK_HEIGHT:i,d=0,v=0;v<g;v++){const R=E-h;let L=0;const j=R>S?n:R*8-7,F=j&-8;let W=0,K=0;for(;L<F;L+=8)K=u[h++],b[d++]=K&128?C:A,b[d++]=K&64?C:A,b[d++]=K&32?C:A,b[d++]=K&16?C:A,b[d++]=K&8?C:A,b[d++]=K&4?C:A,b[d++]=K&2?C:A,b[d++]=K&1?C:A;for(;L<j;L++)W===0&&(K=u[h++],W=128),b[d++]=K&W?C:A,W>>=1}for(;d<_;)b[d++]=0;s.putImageData(l,0,m*FULL_CHUNK_HEIGHT)}}else if(e.kind===util_ImageKind.RGBA_32BPP){for(v=0,x=n*FULL_CHUNK_HEIGHT*4,m=0;m<o;m++)f.set(u.subarray(h,h+x)),h+=x,s.putImageData(l,0,v),v+=FULL_CHUNK_HEIGHT;m<a&&(x=n*i*4,f.set(u.subarray(h,h+x)),s.putImageData(l,0,v))}else if(e.kind===util_ImageKind.RGB_24BPP)for(g=FULL_CHUNK_HEIGHT,x=n*g,m=0;m<a;m++){for(m>=o&&(g=i,x=n*g),d=0,v=x;v--;)f[d++]=u[h++],f[d++]=u[h++],f[d++]=u[h++],f[d++]=255;s.putImageData(l,0,m*FULL_CHUNK_HEIGHT)}else throw new Error(`bad image kind: ${e.kind}`)}function putBinaryImageMask(s,e){if(e.bitmap){s.drawImage(e.bitmap,0,0);return}const t=e.height,n=e.width,i=t%FULL_CHUNK_HEIGHT,o=(t-i)/FULL_CHUNK_HEIGHT,a=i===0?o:o+1,l=s.createImageData(n,FULL_CHUNK_HEIGHT);let h=0;const d=e.data,u=l.data;for(let f=0;f<a;f++){const m=f<o?FULL_CHUNK_HEIGHT:i;({srcPos:h}=convertBlackAndWhiteToRGBA({src:d,srcPos:h,dest:u,width:n,height:m,nonBlackColor:0})),s.putImageData(l,0,f*FULL_CHUNK_HEIGHT)}}function copyCtxState(s,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of t)s[n]!==void 0&&(e[n]=s[n]);s.setLineDash!==void 0&&(e.setLineDash(s.getLineDash()),e.lineDashOffset=s.lineDashOffset)}function resetCtxToDefault(s){s.strokeStyle=s.fillStyle="#000000",s.fillRule="nonzero",s.globalAlpha=1,s.lineWidth=1,s.lineCap="butt",s.lineJoin="miter",s.miterLimit=10,s.globalCompositeOperation="source-over",s.font="10px sans-serif",s.setLineDash!==void 0&&(s.setLineDash([]),s.lineDashOffset=0);const{filter:e}=s;e!=="none"&&e!==""&&(s.filter="none")}function getImageSmoothingEnabled(s,e){if(e)return!0;Util.singularValueDecompose2dScale(s,XY);const t=Math.fround(OutputScale.pixelRatio*PixelsPerInch.PDF_TO_CSS_UNITS);return XY[0]<=t&&XY[1]<=t}const LINE_CAP_STYLES=["butt","round","square"],LINE_JOIN_STYLES=["miter","round","bevel"],NORMAL_CLIP={},EO_CLIP={};class CanvasGraphics{constructor(e,t,n,i,o,{optionalContentConfig:a,markedContentStack:l=null},h,d,u){this.ctx=e,this.current=new CanvasExtraState(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=i,this.filterFactory=o,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=l||[],this.optionalContentConfig=a,this.cachedCanvases=new CachedCanvases(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=d,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=u??null}getObject(e,t,n=null){return typeof t=="string"?(this.dependencyTracker?.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):n}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:i=null}){const o=this.ctx.canvas.width,a=this.ctx.canvas.height,l=this.ctx.fillStyle;if(this.ctx.fillStyle=i||"#ffffff",this.ctx.fillRect(0,0,o,a),this.ctx.fillStyle=l,n){const h=this.cachedCanvases.getCanvas("transparent",o,a);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...getCurrentTransform(this.compositeCtx))}this.ctx.save(),resetCtxToDefault(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=getCurrentTransform(this.ctx)}executeOperatorList(e,t,n,i,o){const a=e.argsArray,l=e.fnArray;let h=t||0;const d=a.length;if(d===h)return h;const u=d-h>EXECUTION_STEPS&&typeof n=="function",f=u?Date.now()+EXECUTION_TIME:0;let m=0;const v=this.commonObjs,g=this.objs;let x,E;for(;;){if(i!==void 0&&h===i.nextBreakPoint)return i.breakIt(h,n),h;if(!o||o(h))if(x=l[h],E=a[h]??null,x!==OPS.dependency)E===null?this[x](h):this[x](h,...E);else for(const b of E){this.dependencyTracker?.recordNamedData(b,h);const _=b.startsWith("g_")?v:g;if(!_.has(b))return _.get(b,n),h}if(h++,h===d)return h;if(u&&++m>EXECUTION_STEPS){if(Date.now()>f)return n(),h;m=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const n=e.width??e.displayWidth,i=e.height??e.displayHeight;let o=Math.max(Math.hypot(t[0],t[1]),1),a=Math.max(Math.hypot(t[2],t[3]),1),l=n,h=i,d="prescale1",u,f;for(;o>2&&l>1||a>2&&h>1;){let m=l,v=h;o>2&&l>1&&(m=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l/2),o/=l/m),a>2&&h>1&&(v=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,a/=h/v),u=this.cachedCanvases.getCanvas(d,m,v),f=u.context,f.clearRect(0,0,m,v),f.drawImage(e,0,0,l,h,0,0,m,v),e=u.canvas,l=m,h=v,d=d==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:l,paintHeight:h}}_createMaskCanvas(e,t){const n=this.ctx,{width:i,height:o}=t,a=this.current.fillColor,l=this.current.patternFill,h=getCurrentTransform(n);let d,u,f,m;if((t.bitmap||t.data)&&t.count>1){const W=t.bitmap||t.data.buffer;u=JSON.stringify(l?h:[h.slice(0,4),a]),d=this._cachedBitmapsMap.get(W),d||(d=new Map,this._cachedBitmapsMap.set(W,d));const K=d.get(u);if(K&&!l){const ee=Math.round(Math.min(h[0],h[2])+h[4]),te=Math.round(Math.min(h[1],h[3])+h[5]);return this.dependencyTracker?.recordDependencies(e,Dependencies.transformAndFill),{canvas:K,offsetX:ee,offsetY:te}}f=K}f||(m=this.cachedCanvases.getCanvas("maskCanvas",i,o),putBinaryImageMask(m.context,t));let v=Util.transform(h,[1/i,0,0,-1/o,0,0]);v=Util.transform(v,[1,0,0,1,0,-o]);const g=MIN_MAX_INIT.slice();Util.axialAlignedBoundingBox([0,0,i,o],v,g);const[x,E,b,_]=g,S=Math.round(b-x)||1,C=Math.round(_-E)||1,A=this.cachedCanvases.getCanvas("fillCanvas",S,C),R=A.context,L=x,j=E;R.translate(-L,-j),R.transform(...v),f||(f=this._scaleImage(m.canvas,getCurrentTransformInverse(R)),f=f.img,d&&l&&d.set(u,f)),R.imageSmoothingEnabled=getImageSmoothingEnabled(getCurrentTransform(R),t.interpolate),drawImageAtIntegerCoords(R,f,0,0,f.width,f.height,0,0,i,o),R.globalCompositeOperation="source-in";const F=Util.transform(getCurrentTransformInverse(R),[1,0,0,1,-L,-j]);return R.fillStyle=l?a.getPattern(n,this,F,PathType.FILL,e):a,R.fillRect(0,0,i,o),d&&!l&&(this.cachedCanvases.delete("fillCanvas"),d.set(u,A.canvas)),this.dependencyTracker?.recordDependencies(e,Dependencies.transformAndFill),{canvas:A.canvas,offsetX:Math.round(L),offsetY:Math.round(j)}}setLineWidth(e,t){this.dependencyTracker?.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){this.dependencyTracker?.recordSimpleData("lineCap",e),this.ctx.lineCap=LINE_CAP_STYLES[t]}setLineJoin(e,t){this.dependencyTracker?.recordSimpleData("lineJoin",e),this.ctx.lineJoin=LINE_JOIN_STYLES[t]}setMiterLimit(e,t){this.dependencyTracker?.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,n){this.dependencyTracker?.recordSimpleData("dash",e);const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(t),i.lineDashOffset=n)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){for(const[n,i]of t)switch(n){case"LW":this.setLineWidth(e,i);break;case"LC":this.setLineCap(e,i);break;case"LJ":this.setLineJoin(e,i);break;case"ML":this.setMiterLimit(e,i);break;case"D":this.setDash(e,i[0],i[1]);break;case"RI":this.setRenderingIntent(e,i);break;case"FL":this.setFlatness(e,i);break;case"Font":this.setFont(e,i[0],i[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=i;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=i;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=i;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",e),this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,n=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,o=this.cachedCanvases.getCanvas(i,t,n);this.suspendedCtx=this.ctx;const a=this.ctx=o.context;a.setTransform(this.suspendedCtx.getTransform()),copyCtxState(this.suspendedCtx,a),mirrorContextOperations(a,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),copyCtxState(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,i){const o=i[0],a=i[1],l=i[2]-o,h=i[3]-a;l===0||h===0||(this.genericComposeSMask(t.context,n,l,h,t.subtype,t.backdrop,t.transferMap,o,a,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,i,o,a,l,h,d,u,f){let m=e.canvas,v=h-u,g=d-f;if(a)if(v<0||g<0||v+n>m.width||g+i>m.height){const E=this.cachedCanvases.getCanvas("maskExtension",n,i),b=E.context;b.drawImage(m,-v,-g),b.globalCompositeOperation="destination-atop",b.fillStyle=a,b.fillRect(0,0,n,i),b.globalCompositeOperation="source-over",m=E.canvas,v=g=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const E=new Path2D;E.rect(v,g,n,i),e.clip(E),e.globalCompositeOperation="destination-atop",e.fillStyle=a,e.fillRect(v,g,n,i),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),o==="Alpha"&&l?t.filter=this.filterFactory.addAlphaFilter(l):o==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(l));const x=new Path2D;x.rect(h,d,n,i),t.clip(x),t.globalCompositeOperation="destination-in",t.drawImage(m,v,g,n,i,h,d,n,i),t.restore()}save(e){this.inSMaskMode&&copyCtxState(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),this.dependencyTracker?.save(e)}restore(e){if(this.dependencyTracker?.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&copyCtxState(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,n,i,o,a,l){this.dependencyTracker?.recordIncrementalData("transform",e),this.ctx.transform(t,n,i,o,a,l),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n,i){let[o]=n;if(!i){o||=n[0]=new Path2D,this[t](e,o);return}if(this.dependencyTracker!==null){const a=t===OPS.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,i[0]-a,i[2]+a,i[1]-a,i[3]+a).recordDependencies(e,["transform"])}if(!(o instanceof Path2D)){const a=n[0]=new Path2D;for(let l=0,h=o.length;l<h;)switch(o[l++]){case DrawOPS.moveTo:a.moveTo(o[l++],o[l++]);break;case DrawOPS.lineTo:a.lineTo(o[l++],o[l++]);break;case DrawOPS.curveTo:a.bezierCurveTo(o[l++],o[l++],o[l++],o[l++],o[l++],o[l++]);break;case DrawOPS.closePath:a.closePath();break;default:warn(`Unrecognized drawing path operator: ${o[l-1]}`);break}o=a}Util.axialAlignedBoundingBox(i,getCurrentTransform(this.ctx),this.current.minMax),this[t](e,o),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,n=!0){const i=this.ctx,o=this.current.strokeColor;if(i.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof o=="object"&&o?.getPattern){const a=o.isModifyingCurrentTransform()?i.getTransform():null;if(i.save(),i.strokeStyle=o.getPattern(i,this,getCurrentTransformInverse(i),PathType.STROKE,e),a){const l=new Path2D;l.addPath(t,i.getTransform().invertSelf().multiplySelf(a)),t=l}this.rescaleAndStroke(t,!1),i.restore()}else this.rescaleAndStroke(t,!0);this.dependencyTracker?.recordDependencies(e,Dependencies.stroke),n&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(PathType.STROKE,getCurrentTransform(this.ctx))),i.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,n=!0){const i=this.ctx,o=this.current.fillColor,a=this.current.patternFill;let l=!1;if(a){const d=o.isModifyingCurrentTransform()?i.getTransform():null;if(this.dependencyTracker?.save(e),i.save(),i.fillStyle=o.getPattern(i,this,getCurrentTransformInverse(i),PathType.FILL,e),d){const u=new Path2D;u.addPath(t,i.getTransform().invertSelf().multiplySelf(d)),t=u}l=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(i.fill(t,"evenodd"),this.pendingEOFill=!1):i.fill(t)),this.dependencyTracker?.recordDependencies(e,Dependencies.fill),l&&(i.restore(),this.dependencyTracker?.restore(e)),n&&this.consumePath(e,t,h)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){this.ctx.fill(t),this.dependencyTracker?.recordDependencies(e,Dependencies.rawFillPath).recordOperation(e)}clip(e){this.dependencyTracker?.recordFutureForcedDependency("clipMode",e),this.pendingClip=NORMAL_CLIP}eoClip(e){this.dependencyTracker?.recordFutureForcedDependency("clipMode",e),this.pendingClip=EO_CLIP}beginText(e){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,n=this.ctx;if(this.dependencyTracker){const{dependencyTracker:i}=this;t!==void 0&&i.recordFutureForcedDependency("textClip",i.getOpenMarker()).recordFutureForcedDependency("textClip",e),i.recordCloseMarker(e)}if(t!==void 0){const i=new Path2D,o=n.getTransform().invertSelf();for(const{transform:a,x:l,y:h,fontSize:d,path:u}of t)u&&i.addPath(u,new DOMMatrix(a).preMultiplySelf(o).translate(l,h).scale(d,-d));n.clip(i)}delete this.pendingTextPaths}setCharSpacing(e,t){this.dependencyTracker?.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){this.dependencyTracker?.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){this.dependencyTracker?.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){this.dependencyTracker?.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,n){this.dependencyTracker?.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const i=this.commonObjs.get(t),o=this.current;if(!i)throw new Error(`Can't find font for ${t}`);if(o.fontMatrix=i.fontMatrix||FONT_IDENTITY_MATRIX,(o.fontMatrix[0]===0||o.fontMatrix[3]===0)&&warn("Invalid font matrix for font "+t),n<0?(n=-n,o.fontDirection=-1):o.fontDirection=1,this.current.font=i,this.current.fontSize=n,i.isType3Font)return;const a=i.loadedName||"sans-serif",l=i.systemFontInfo?.css||`"${a}", ${i.fallbackName}`;let h="normal";i.black?h="900":i.bold&&(h="bold");const d=i.italic?"italic":"normal";let u=n;n<MIN_FONT_SIZE?u=MIN_FONT_SIZE:n>MAX_FONT_SIZE&&(u=MAX_FONT_SIZE),this.current.fontSizeScale=n/u,this.ctx.font=`${d} ${h} ${u}px ${l}`}setTextRenderingMode(e,t){this.dependencyTracker?.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){this.dependencyTracker?.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,n){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=n}setLeadingMoveText(e,t,n){this.setLeading(e,-n),this.moveText(e,t,n)}setTextMatrix(e,t){this.dependencyTracker?.recordSimpleData("textMatrix",e);const{current:n}=this;n.textMatrix=t,n.textMatrixScale=Math.hypot(t[0],t[1]),n.x=n.lineX=0,n.y=n.lineY=0}nextLine(e){this.moveText(e,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}#n(e,t,n){const i=new Path2D;return i.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),i}paintChar(e,t,n,i,o,a){const l=this.ctx,h=this.current,d=h.font,u=h.textRenderingMode,f=h.fontSize/h.fontSizeScale,m=u&TextRenderingMode.FILL_STROKE_MASK,v=!!(u&TextRenderingMode.ADD_TO_PATH_FLAG),g=h.patternFill&&!d.missingFile,x=h.patternStroke&&!d.missingFile;let E;if((d.disableFontFace||v||g||x)&&!d.missingFile&&(E=d.getPathGenerator(this.commonObjs,t)),E&&(d.disableFontFace||g||x)){l.save(),l.translate(n,i),l.scale(f,-f),this.dependencyTracker?.recordCharacterBBox(e,l,d);let b;if(m===TextRenderingMode.FILL||m===TextRenderingMode.FILL_STROKE)if(o){b=l.getTransform(),l.setTransform(...o);const _=this.#n(E,b,o);l.fill(_)}else l.fill(E);if(m===TextRenderingMode.STROKE||m===TextRenderingMode.FILL_STROKE)if(a){b||=l.getTransform(),l.setTransform(...a);const{a:_,b:S,c:C,d:A}=b,R=Util.inverseTransform(a),L=Util.transform([_,S,C,A,0,0],R);Util.singularValueDecompose2dScale(L,XY),l.lineWidth*=Math.max(XY[0],XY[1])/f,l.stroke(this.#n(E,b,a))}else l.lineWidth/=f,l.stroke(E);l.restore()}else(m===TextRenderingMode.FILL||m===TextRenderingMode.FILL_STROKE)&&(l.fillText(t,n,i),this.dependencyTracker?.recordCharacterBBox(e,l,d,f,n,i,()=>l.measureText(t))),(m===TextRenderingMode.STROKE||m===TextRenderingMode.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(e,l,d,f,n,i,()=>l.measureText(t)).recordDependencies(e,Dependencies.stroke),l.strokeText(t,n,i));v&&((this.pendingTextPaths||=[]).push({transform:getCurrentTransform(l),x:n,y:i,fontSize:f,path:E}),this.dependencyTracker?.recordCharacterBBox(e,l,d,f,n,i))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let i=3;i<t.length;i+=4)if(t[i]>0&&t[i]<255){n=!0;break}return shadow(this,"isFontSubpixelAAEnabled",n)}showText(e,t){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,Dependencies.showText).resetBBox(e),this.current.textRenderingMode&TextRenderingMode.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const n=this.current,i=n.font;if(i.isType3Font){this.showType3Text(e,t),this.dependencyTracker?.recordShowTextOperation(e);return}const o=n.fontSize;if(o===0){this.dependencyTracker?.recordOperation(e);return}const a=this.ctx,l=n.fontSizeScale,h=n.charSpacing,d=n.wordSpacing,u=n.fontDirection,f=n.textHScale*u,m=t.length,v=i.vertical,g=v?1:-1,x=i.defaultVMetrics,E=o*n.fontMatrix[0],b=n.textRenderingMode===TextRenderingMode.FILL&&!i.disableFontFace&&!n.patternFill;a.save(),n.textMatrix&&a.transform(...n.textMatrix),a.translate(n.x,n.y+n.textRise),u>0?a.scale(f,-1):a.scale(f,1);let _,S;if(n.patternFill){a.save();const j=n.fillColor.getPattern(a,this,getCurrentTransformInverse(a),PathType.FILL,e);_=getCurrentTransform(a),a.restore(),a.fillStyle=j}if(n.patternStroke){a.save();const j=n.strokeColor.getPattern(a,this,getCurrentTransformInverse(a),PathType.STROKE,e);S=getCurrentTransform(a),a.restore(),a.strokeStyle=j}let C=n.lineWidth;const A=n.textMatrixScale;if(A===0||C===0){const j=n.textRenderingMode&TextRenderingMode.FILL_STROKE_MASK;(j===TextRenderingMode.STROKE||j===TextRenderingMode.FILL_STROKE)&&(C=this.getSinglePixelWidth())}else C/=A;if(l!==1&&(a.scale(l,l),C/=l),a.lineWidth=C,i.isInvalidPDFjsFont){const j=[];let F=0;for(const K of t)j.push(K.unicode),F+=K.width;const W=j.join("");if(a.fillText(W,0,0),this.dependencyTracker!==null){const K=a.measureText(W);this.dependencyTracker.recordBBox(e,this.ctx,-K.actualBoundingBoxLeft,K.actualBoundingBoxRight,-K.actualBoundingBoxAscent,K.actualBoundingBoxDescent).recordShowTextOperation(e)}n.x+=F*E*f,a.restore(),this.compose();return}let R=0,L;for(L=0;L<m;++L){const j=t[L];if(typeof j=="number"){R+=g*j*o/1e3;continue}let F=!1;const W=(j.isSpace?d:0)+h,K=j.fontChar,ee=j.accent;let te,re,ie=j.width;if(v){const N=j.vmetric||x,k=-(j.vmetric?N[1]:ie*.5)*E,I=N[2]*E;ie=N?-N[0]:ie,te=k/l,re=(R+I)/l}else te=R/l,re=0;let Q;if(i.remeasure&&ie>0){Q=a.measureText(K);const N=Q.width*1e3/o*l;if(ie<N&&this.isFontSubpixelAAEnabled){const k=ie/N;F=!0,a.save(),a.scale(k,1),te/=k}else ie!==N&&(te+=(ie-N)/2e3*o/l)}if(this.contentVisible&&(j.isInFont||i.missingFile)){if(b&&!ee)a.fillText(K,te,re),this.dependencyTracker?.recordCharacterBBox(e,a,Q?{bbox:null}:i,o/l,te,re,()=>Q??a.measureText(K));else if(this.paintChar(e,K,te,re,_,S),ee){const N=te+o*ee.offset.x/l,k=re-o*ee.offset.y/l;this.paintChar(e,ee.fontChar,N,k,_,S)}}const z=v?ie*E-W*u:ie*E+W*u;R+=z,F&&a.restore()}v?n.y-=R:n.x+=R*f,a.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(e)}showType3Text(e,t){const n=this.ctx,i=this.current,o=i.font,a=i.fontSize,l=i.fontDirection,h=o.vertical?1:-1,d=i.charSpacing,u=i.wordSpacing,f=i.textHScale*l,m=i.fontMatrix||FONT_IDENTITY_MATRIX,v=t.length,g=i.textRenderingMode===TextRenderingMode.INVISIBLE;let x,E,b,_;if(g||a===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),i.textMatrix&&n.transform(...i.textMatrix),n.translate(i.x,i.y+i.textRise),n.scale(f,l);const S=this.dependencyTracker;for(this.dependencyTracker=S?new CanvasNestedDependencyTracker(S,e):null,x=0;x<v;++x){if(E=t[x],typeof E=="number"){_=h*E*a/1e3,this.ctx.translate(_,0),i.x+=_*f;continue}const C=(E.isSpace?u:0)+d,A=o.charProcOperatorList[E.operatorListId];A?this.contentVisible&&(this.save(),n.scale(a,a),n.transform(...m),this.executeOperatorList(A),this.restore()):warn(`Type3 character "${E.operatorListId}" is not available.`);const R=[E.width,0];Util.applyTransform(R,m),b=R[0]*a+C,n.translate(b,0),i.x+=b*f}n.restore(),S&&(this.dependencyTracker=S)}setCharWidth(e,t,n){}setCharWidthAndBounds(e,t,n,i,o,a,l){const h=new Path2D;h.rect(i,o,a-i,l-o),this.ctx.clip(h),this.dependencyTracker?.recordBBox(e,this.ctx,i,a,o,l).recordClipBox(e,this.ctx,i,a,o,l),this.endPath(e)}getColorN_Pattern(e,t){let n;if(t[0]==="TilingPattern"){const i=this.baseTransform||getCurrentTransform(this.ctx),o={createCanvasGraphics:(a,l)=>new CanvasGraphics(a,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new CanvasNestedDependencyTracker(this.dependencyTracker,l,!0):null)};n=new TilingPattern(t,this.ctx,o,i)}else n=this._getPattern(e,t[1],t[2]);return n}setStrokeColorN(e,...t){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){this.dependencyTracker?.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){this.dependencyTracker?.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){this.dependencyTracker?.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,n=null){let i;return this.cachedPatterns.has(t)?i=this.cachedPatterns.get(t):(i=getShadingPattern(this.getObject(e,t)),this.cachedPatterns.set(t,i)),n&&(i.matrix=n),i}shadingFill(e,t){if(!this.contentVisible)return;const n=this.ctx;this.save(e);const i=this._getPattern(e,t);n.fillStyle=i.getPattern(n,this,getCurrentTransformInverse(n),PathType.SHADING,e);const o=getCurrentTransformInverse(n);if(o){const{width:a,height:l}=n.canvas,h=MIN_MAX_INIT.slice();Util.axialAlignedBoundingBox([0,0,a,l],o,h);const[d,u,f,m]=h;this.ctx.fillRect(d,u,f-d,m-u)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,Dependencies.transform).recordDependencies(e,Dependencies.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){unreachable("Should not call beginInlineImage")}beginImageData(){unreachable("Should not call beginImageData")}paintFormXObjectBegin(e,t,n){if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=getCurrentTransform(this.ctx),n)){Util.axialAlignedBoundingBox(n,this.baseTransform,this.current.minMax);const[i,o,a,l]=n,h=new Path2D;h.rect(i,o,a-i,l-o),this.ctx.clip(h),this.dependencyTracker?.recordClipBox(e,this.ctx,i,a,o,l),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;t.isolated||info("TODO: Support non-isolated groups."),t.knockout&&warn("Knockout groups not supported.");const i=getCurrentTransform(n);if(t.matrix&&n.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let o=MIN_MAX_INIT.slice();Util.axialAlignedBoundingBox(t.bbox,getCurrentTransform(n),o);const a=[0,0,n.canvas.width,n.canvas.height];o=Util.intersect(o,a)||[0,0,0,0];const l=Math.floor(o[0]),h=Math.floor(o[1]),d=Math.max(Math.ceil(o[2])-l,1),u=Math.max(Math.ceil(o[3])-h,1);this.current.startNewPathAndClipBox([0,0,d,u]);let f="groupAt"+this.groupLevel;t.smask&&(f+="_smask_"+this.smaskCounter++%2);const m=this.cachedCanvases.getCanvas(f,d,u),v=m.context;v.translate(-l,-h),v.transform(...i);let g=new Path2D;const[x,E,b,_]=t.bbox;if(g.rect(x,E,b-x,_-E),t.matrix){const S=new Path2D;S.addPath(g,new DOMMatrix(t.matrix)),g=S}v.clip(g),t.smask&&this.smaskStack.push({canvas:m.canvas,context:v,offsetX:l,offsetY:h,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(n.setTransform(1,0,0,1,0,0),n.translate(l,h),n.save()),copyCtxState(n,v),this.ctx=v,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(n),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(e,t){if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const o=getCurrentTransform(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...o);const a=MIN_MAX_INIT.slice();Util.axialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],o,a),this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(a)}}beginAnnotation(e,t,n,i,o,a){if(this.#e(),resetCtxToDefault(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){const l=n[2]-n[0],h=n[3]-n[1];if(a&&this.annotationCanvasMap){i=i.slice(),i[4]-=n[0],i[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=l,n[3]=h,Util.singularValueDecompose2dScale(getCurrentTransform(this.ctx),XY);const{viewportScale:d}=this,u=Math.ceil(l*this.outputScaleX*d),f=Math.ceil(h*this.outputScaleY*d);this.annotationCanvas=this.canvasFactory.create(u,f);const{canvas:m,context:v}=this.annotationCanvas;this.annotationCanvasMap.set(t,m),this.annotationCanvas.savedCtx=this.ctx,this.ctx=v,this.ctx.save(),this.ctx.setTransform(XY[0],0,0,-XY[1],0,h*XY[1]),resetCtxToDefault(this.ctx)}else{resetCtxToDefault(this.ctx),this.endPath(e);const d=new Path2D;d.rect(n[0],n[1],l,h),this.ctx.clip(d)}}this.current=new CanvasExtraState(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...i),this.transform(e,...o)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){if(!this.contentVisible)return;const n=t.count;t=this.getObject(e,t.data,t),t.count=n;const i=this.ctx,o=this._createMaskCanvas(e,t),a=o.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(a,o.offsetX,o.offsetY),this.dependencyTracker?.resetBBox(e).recordBBox(e,this.ctx,o.offsetX,o.offsetX+a.width,o.offsetY,o.offsetY+a.height).recordOperation(e),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n,i=0,o=0,a,l){if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const h=this.ctx;h.save();const d=getCurrentTransform(h);h.transform(n,i,o,a,0,0);const u=this._createMaskCanvas(e,t);h.setTransform(1,0,0,1,u.offsetX-d[4],u.offsetY-d[5]),this.dependencyTracker?.resetBBox(e);for(let f=0,m=l.length;f<m;f+=2){const v=Util.transform(d,[n,i,o,a,l[f],l[f+1]]);h.drawImage(u.canvas,v[4],v[5]),this.dependencyTracker?.recordBBox(e,this.ctx,v[4],v[4]+u.canvas.width,v[5],v[5]+u.canvas.height)}h.restore(),this.compose(),this.dependencyTracker?.recordOperation(e)}paintImageMaskXObjectGroup(e,t){if(!this.contentVisible)return;const n=this.ctx,i=this.current.fillColor,o=this.current.patternFill;this.dependencyTracker?.resetBBox(e).recordDependencies(e,Dependencies.transformAndFill);for(const a of t){const{data:l,width:h,height:d,transform:u}=a,f=this.cachedCanvases.getCanvas("maskCanvas",h,d),m=f.context;m.save();const v=this.getObject(e,l,a);putBinaryImageMask(m,v),m.globalCompositeOperation="source-in",m.fillStyle=o?i.getPattern(m,this,getCurrentTransformInverse(n),PathType.FILL,e):i,m.fillRect(0,0,h,d),m.restore(),n.save(),n.transform(...u),n.scale(1,-1),drawImageAtIntegerCoords(n,f.canvas,0,0,h,d,0,-1,1,1),this.dependencyTracker?.recordBBox(e,n,0,h,0,d),n.restore()}this.compose(),this.dependencyTracker?.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const n=this.getObject(e,t);if(!n){warn("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,n)}paintImageXObjectRepeat(e,t,n,i,o){if(!this.contentVisible)return;const a=this.getObject(e,t);if(!a){warn("Dependent image isn't ready yet");return}const l=a.width,h=a.height,d=[];for(let u=0,f=o.length;u<f;u+=2)d.push({transform:[n,0,0,i,o[u],o[u+1]],x:0,y:0,w:l,h});this.paintInlineImageXObjectGroup(e,a,d)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:n,height:i}=e,o=this.cachedCanvases.getCanvas("inlineImage",n,i),a=o.context;return a.filter=this.current.transferMaps,a.drawImage(t,0,0),a.filter="none",o.canvas}paintInlineImageXObject(e,t){if(!this.contentVisible)return;const n=t.width,i=t.height,o=this.ctx;this.save(e);const{filter:a}=o;a!=="none"&&a!==""&&(o.filter="none"),o.scale(1/n,-1/i);let l;if(t.bitmap)l=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)l=t;else{const u=this.cachedCanvases.getCanvas("inlineImage",n,i).context;putBinaryImageData(u,t),l=this.applyTransferMapsToCanvas(u)}const h=this._scaleImage(l,getCurrentTransformInverse(o));o.imageSmoothingEnabled=getImageSmoothingEnabled(getCurrentTransform(o),t.interpolate),this.dependencyTracker?.resetBBox(e).recordBBox(e,o,0,n,-i,0).recordDependencies(e,Dependencies.imageXObject).recordOperation(e),drawImageAtIntegerCoords(o,h.img,0,0,h.paintWidth,h.paintHeight,0,-i,n,i),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,n){if(!this.contentVisible)return;const i=this.ctx;let o;if(t.bitmap)o=t.bitmap;else{const a=t.width,l=t.height,d=this.cachedCanvases.getCanvas("inlineImage",a,l).context;putBinaryImageData(d,t),o=this.applyTransferMapsToCanvas(d)}this.dependencyTracker?.resetBBox(e);for(const a of n)i.save(),i.transform(...a.transform),i.scale(1,-1),drawImageAtIntegerCoords(i,o,a.x,a.y,a.w,a.h,0,-1,1,1),this.dependencyTracker?.recordBBox(e,i,0,1,-1,0),i.restore();this.dependencyTracker?.recordOperation(e),this.compose()}paintSolidColorImageMask(e){this.contentVisible&&(this.dependencyTracker?.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,Dependencies.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,n){}beginMarkedContent(e,t){this.dependencyTracker?.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,n){this.dependencyTracker?.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){this.dependencyTracker?.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,n){const i=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const o=this.ctx;this.pendingClip?(i||(this.pendingClip===EO_CLIP?o.clip(t,"evenodd"):o.clip(t)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):this.dependencyTracker?.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=getCurrentTransform(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),i=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,i)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:n,c:i,d:o}=this.ctx.getTransform();let a,l;if(n===0&&i===0){const h=Math.abs(t),d=Math.abs(o);if(h===d)if(e===0)a=l=1/h;else{const u=h*e;a=l=u<1?1/u:1}else if(e===0)a=1/h,l=1/d;else{const u=h*e,f=d*e;a=u<1?1/u:1,l=f<1?1/f:1}}else{const h=Math.abs(t*o-n*i),d=Math.hypot(t,n),u=Math.hypot(i,o);if(e===0)a=u/h,l=d/h;else{const f=e*h;a=u>f?u/f:1,l=d>f?d/f:1}}this._cachedScaleForStroking[0]=a,this._cachedScaleForStroking[1]=l}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:n,current:{lineWidth:i}}=this,[o,a]=this.getScaleForStroking();if(o===a){n.lineWidth=(i||1)*o,n.stroke(e);return}const l=n.getLineDash();t&&n.save(),n.scale(o,a),SCALE_MATRIX.a=1/o,SCALE_MATRIX.d=1/a;const h=new Path2D;if(h.addPath(e,SCALE_MATRIX),l.length>0){const d=Math.max(o,a);n.setLineDash(l.map(u=>u/d)),n.lineDashOffset/=d}n.lineWidth=i||1,n.stroke(h),t&&n.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const s in OPS)CanvasGraphics.prototype[s]!==void 0&&(CanvasGraphics.prototype[OPS[s]]=CanvasGraphics.prototype[s]);class CssFontInfo{#e;#t;#n;static strings=["fontFamily","fontWeight","italicAngle"];static write(e){const t=new TextEncoder,n={};let i=0;for(const d of CssFontInfo.strings){const u=t.encode(e[d]);n[d]=u,i+=4+u.length}const o=new ArrayBuffer(i),a=new Uint8Array(o),l=new DataView(o);let h=0;for(const d of CssFontInfo.strings){const u=n[d],f=u.length;l.setUint32(h,f),a.set(u,h+4),h+=4+f}return assert$1(h===o.byteLength,"CssFontInfo.write: Buffer overflow"),o}constructor(e){this.#e=e,this.#t=new DataView(this.#e),this.#n=new TextDecoder}#r(e){assert$1(e<CssFontInfo.strings.length,"Invalid string index");let t=0;for(let i=0;i<e;i++)t+=this.#t.getUint32(t)+4;const n=this.#t.getUint32(t);return this.#n.decode(new Uint8Array(this.#e,t+4,n))}get fontFamily(){return this.#r(0)}get fontWeight(){return this.#r(1)}get italicAngle(){return this.#r(2)}}class SystemFontInfo{#e;#t;#n;static strings=["css","loadedName","baseFontName","src"];static write(e){const t=new TextEncoder,n={};let i=0;for(const m of SystemFontInfo.strings){const v=t.encode(e[m]);n[m]=v,i+=4+v.length}i+=4;let o,a,l=1+i;e.style&&(o=t.encode(e.style.style),a=t.encode(e.style.weight),l+=4+o.length+4+a.length);const h=new ArrayBuffer(l),d=new Uint8Array(h),u=new DataView(h);let f=0;u.setUint8(f++,e.guessFallback?1:0),u.setUint32(f,0),f+=4,i=0;for(const m of SystemFontInfo.strings){const v=n[m],g=v.length;i+=4+g,u.setUint32(f,g),d.set(v,f+4),f+=4+g}return u.setUint32(f-i-4,i),e.style&&(u.setUint32(f,o.length),d.set(o,f+4),f+=4+o.length,u.setUint32(f,a.length),d.set(a,f+4),f+=4+a.length),assert$1(f<=h.byteLength,"SubstitionInfo.write: Buffer overflow"),h.transferToFixedLength(f)}constructor(e){this.#e=e,this.#t=new DataView(this.#e),this.#n=new TextDecoder}get guessFallback(){return this.#t.getUint8(0)!==0}#r(e){assert$1(e<SystemFontInfo.strings.length,"Invalid string index");let t=5;for(let i=0;i<e;i++)t+=this.#t.getUint32(t)+4;const n=this.#t.getUint32(t);return this.#n.decode(new Uint8Array(this.#e,t+4,n))}get css(){return this.#r(0)}get loadedName(){return this.#r(1)}get baseFontName(){return this.#r(2)}get src(){return this.#r(3)}get style(){let e=1;e+=4+this.#t.getUint32(e);const t=this.#t.getUint32(e),n=this.#n.decode(new Uint8Array(this.#e,e+4,t));e+=4+t;const i=this.#t.getUint32(e),o=this.#n.decode(new Uint8Array(this.#e,e+4,i));return{style:n,weight:o}}}class FontInfo{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#e=Math.ceil(this.bools.length*2/8);static#t=this.#e+this.numbers.length*8;static#n=this.#t+1+8;static#r=this.#n+1+48;static#s=this.#r+1+6;#o;#i;#a;constructor({data:e,extra:t}){this.#o=e,this.#i=new TextDecoder,this.#a=new DataView(this.#o),t&&Object.assign(this,t)}#c(e){assert$1(e<FontInfo.bools.length,"Invalid boolean index");const t=Math.floor(e/4),n=e*2%8,i=this.#a.getUint8(t)>>n&3;return i===0?void 0:i===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(e){return assert$1(e<FontInfo.numbers.length,"Invalid number index"),this.#a.getFloat64(FontInfo.#e+e*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let e=FontInfo.#t;if(this.#a.getUint8(e)===0)return;e+=1;const n=[];for(let i=0;i<4;i++)n.push(this.#a.getInt16(e,!0)),e+=2;return n}get fontMatrix(){let e=FontInfo.#n;if(this.#a.getUint8(e)===0)return;e+=1;const n=[];for(let i=0;i<6;i++)n.push(this.#a.getFloat64(e,!0)),e+=8;return n}get defaultVMetrics(){let e=FontInfo.#r;if(this.#a.getUint8(e)===0)return;e+=1;const n=[];for(let i=0;i<3;i++)n.push(this.#a.getInt16(e,!0)),e+=2;return n}#h(e){assert$1(e<FontInfo.strings.length,"Invalid string index");let t=FontInfo.#s+4;for(let o=0;o<e;o++)t+=this.#a.getUint32(t)+4;const n=this.#a.getUint32(t),i=new Uint8Array(n);return i.set(new Uint8Array(this.#o,t+4,n)),this.#i.decode(i)}get fallbackName(){return this.#h(0)}get loadedName(){return this.#h(1)}get mimetype(){return this.#h(2)}get name(){return this.#h(3)}get data(){let e=FontInfo.#s;const t=this.#a.getUint32(e);e+=4+t;const n=this.#a.getUint32(e);e+=4+n;const i=this.#a.getUint32(e);e+=4+i;const o=this.#a.getUint32(e);if(o!==0)return new Uint8Array(this.#o,e+4,o)}clearData(){let e=FontInfo.#s;const t=this.#a.getUint32(e);e+=4+t;const n=this.#a.getUint32(e);e+=4+n;const i=this.#a.getUint32(e);e+=4+i;const o=this.#a.getUint32(e);new Uint8Array(this.#o,e+4,o).fill(0),this.#a.setUint32(e,0)}get cssFontInfo(){let e=FontInfo.#s;const t=this.#a.getUint32(e);e+=4+t;const n=this.#a.getUint32(e);e+=4+n;const i=this.#a.getUint32(e);if(i===0)return null;const o=new Uint8Array(i);return o.set(new Uint8Array(this.#o,e+4,i)),new CssFontInfo(o.buffer)}get systemFontInfo(){let e=FontInfo.#s;const t=this.#a.getUint32(e);e+=4+t;const n=this.#a.getUint32(e);if(n===0)return null;const i=new Uint8Array(n);return i.set(new Uint8Array(this.#o,e+4,n)),new SystemFontInfo(i.buffer)}static write(e){const t=e.systemFontInfo?SystemFontInfo.write(e.systemFontInfo):null,n=e.cssFontInfo?CssFontInfo.write(e.cssFontInfo):null,i=new TextEncoder,o={};let a=0;for(const x of FontInfo.strings)o[x]=i.encode(e[x]),a+=4+o[x].length;const l=FontInfo.#s+4+a+4+(t?t.byteLength:0)+4+(n?n.byteLength:0)+4+(e.data?e.data.length:0),h=new ArrayBuffer(l),d=new Uint8Array(h),u=new DataView(h);let f=0;const m=FontInfo.bools.length;let v=0,g=0;for(let x=0;x<m;x++){const E=e[FontInfo.bools[x]];v|=(E===void 0?0:E?2:1)<<g,g+=2,(g===8||x===m-1)&&(u.setUint8(f++,v),v=0,g=0)}assert$1(f===FontInfo.#e,"FontInfo.write: Boolean properties offset mismatch");for(const x of FontInfo.numbers)u.setFloat64(f,e[x]),f+=8;if(assert$1(f===FontInfo.#t,"FontInfo.write: Number properties offset mismatch"),e.bbox){u.setUint8(f++,4);for(const x of e.bbox)u.setInt16(f,x,!0),f+=2}else u.setUint8(f++,0),f+=8;if(assert$1(f===FontInfo.#n,"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){u.setUint8(f++,6);for(const x of e.fontMatrix)u.setFloat64(f,x,!0),f+=8}else u.setUint8(f++,0),f+=48;if(assert$1(f===FontInfo.#r,"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){u.setUint8(f++,1);for(const x of e.defaultVMetrics)u.setInt16(f,x,!0),f+=2}else u.setUint8(f++,0),f+=6;assert$1(f===FontInfo.#s,"FontInfo.write: DefaultVMetrics properties offset mismatch"),u.setUint32(FontInfo.#s,0),f+=4;for(const x of FontInfo.strings){const E=o[x],b=E.length;u.setUint32(f,b),d.set(E,f+4),f+=4+b}if(u.setUint32(FontInfo.#s,f-FontInfo.#s-4),!t)u.setUint32(f,0),f+=4;else{const x=t.byteLength;u.setUint32(f,x),assert$1(f+4+x<=h.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),d.set(new Uint8Array(t),f+4),f+=4+x}if(!n)u.setUint32(f,0),f+=4;else{const x=n.byteLength;u.setUint32(f,x),assert$1(f+4+x<=h.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),d.set(new Uint8Array(n),f+4),f+=4+x}return e.data===void 0?(u.setUint32(f,0),f+=4):(u.setUint32(f,e.data.length),d.set(e.data,f+4),f+=4+e.data.length),assert$1(f<=h.byteLength,"FontInfo.write: Buffer overflow"),h.transferToFixedLength(f)}}class GlobalWorkerOptions{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}}class Metadata{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}[Symbol.iterator](){return this.#e.entries()}}const INTERNAL=Symbol("INTERNAL");class OptionalContentGroup{#e=!1;#t=!1;#n=!1;#r=!0;constructor(e,{name:t,intent:n,usage:i,rbGroups:o}){this.#e=!!(e&RenderingIntentFlag.DISPLAY),this.#t=!!(e&RenderingIntentFlag.PRINT),this.name=t,this.intent=n,this.usage=i,this.rbGroups=o}get visible(){if(this.#n)return this.#r;if(!this.#r)return!1;const{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,n=!1){e!==INTERNAL&&unreachable("Internal method `_setVisible` called."),this.#n=n,this.#r=t}}class OptionalContentConfig{#e=null;#t=new Map;#n=null;#r=null;constructor(e,t=RenderingIntentFlag.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#r=e.order;for(const n of e.groups)this.#t.set(n.id,new OptionalContentGroup(t,n));if(e.baseState==="OFF")for(const n of this.#t.values())n._setVisible(INTERNAL,!1);for(const n of e.on)this.#t.get(n)._setVisible(INTERNAL,!0);for(const n of e.off)this.#t.get(n)._setVisible(INTERNAL,!1);this.#n=this.getHash()}}#s(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let i=1;i<t;i++){const o=e[i];let a;if(Array.isArray(o))a=this.#s(o);else if(this.#t.has(o))a=this.#t.get(o).visible;else return warn(`Optional content group not found: ${o}`),!0;switch(n){case"And":if(!a)return!1;break;case"Or":if(a)return!0;break;case"Not":return!a;default:return!0}}return n==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return info("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(warn(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#s(e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!this.#t.has(t))return warn(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!this.#t.has(t))return warn(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!this.#t.has(t))return warn(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!this.#t.has(t))return warn(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return warn(`Unknown optional content policy ${e.policy}.`),!0}return warn(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,n=!0){const i=this.#t.get(e);if(!i){warn(`Optional content group not found: ${e}`);return}if(n&&t&&i.rbGroups.length)for(const o of i.rbGroups)for(const a of o)a!==e&&this.#t.get(a)?._setVisible(INTERNAL,!1,!0);i._setVisible(INTERNAL,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let n;for(const i of e){switch(i){case"ON":case"OFF":case"Toggle":n=i;continue}const o=this.#t.get(i);if(o)switch(n){case"ON":this.setVisibility(i,!0,t);break;case"OFF":this.setVisibility(i,!1,t);break;case"Toggle":this.setVisibility(i,!o.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#t.size?this.#r?this.#r.slice():[...this.#t.keys()]:null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;const e=new MurmurHash3_64;for(const[t,n]of this.#t)e.update(`${t}:${n.visible}`);return this.#e=e.hexdigest()}[Symbol.iterator](){return this.#t.entries()}}class PDFDataTransportStream{constructor(e,{disableRange:t=!1,disableStream:n=!1}){assert$1(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:i,initialData:o,progressiveDone:a,contentDispositionFilename:l}=e;if(this._queuedChunks=[],this._progressiveDone=a,this._contentDispositionFilename=l,o?.length>0){const h=o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength?o.buffer:new Uint8Array(o).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!t,this._contentLength=i,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((h,d)=>{this._onReceiveData({begin:h,chunk:d})}),e.addProgressListener((h,d)=>{this._onProgress({loaded:h,total:d})}),e.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const i=this._rangeReaders.some(function(o){return o._begin!==e?!1:(o._enqueue(n),!0)});assert$1(i,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){assert$1(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new PDFDataTransportStreamReader(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new PDFDataTransportStreamRangeReader(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class PDFDataTransportStreamReader{constructor(e,t,n=!1,i=null){this._stream=e,this._done=n||!1,this._filename=isPdfFile(i)?i:null,this._queuedChunks=t||[],this._loaded=0;for(const o of this._queuedChunks)this._loaded+=o.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class PDFDataTransportStreamRangeReader{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function getFilenameFromContentDispositionHeader(s){let e=!0,t=n("filename\\*","i").exec(s);if(t){t=t[1];let u=l(t);return u=unescape(u),u=h(u),u=d(u),o(u)}if(t=a(s),t){const u=d(t);return o(u)}if(t=n("filename","i").exec(s),t){t=t[1];let u=l(t);return u=d(u),o(u)}function n(u,f){return new RegExp("(?:^|;)\\s*"+u+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',f)}function i(u,f){if(u){if(!/^[\x00-\xFF]+$/.test(f))return f;try{const m=new TextDecoder(u,{fatal:!0}),v=stringToBytes(f);f=m.decode(v),e=!1}catch{}}return f}function o(u){return e&&/[\x80-\xff]/.test(u)&&(u=i("utf-8",u),e&&(u=i("iso-8859-1",u))),u}function a(u){const f=[];let m;const v=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(m=v.exec(u))!==null;){let[,x,E,b]=m;if(x=parseInt(x,10),x in f){if(x===0)break;continue}f[x]=[E,b]}const g=[];for(let x=0;x<f.length&&x in f;++x){let[E,b]=f[x];b=l(b),E&&(b=unescape(b),x===0&&(b=h(b))),g.push(b)}return g.join("")}function l(u){if(u.startsWith('"')){const f=u.slice(1).split('\\"');for(let m=0;m<f.length;++m){const v=f[m].indexOf('"');v!==-1&&(f[m]=f[m].slice(0,v),f.length=m+1),f[m]=f[m].replaceAll(/\\(.)/g,"$1")}u=f.join('"')}return u}function h(u){const f=u.indexOf("'");if(f===-1)return u;const m=u.slice(0,f),g=u.slice(f+1).replace(/^[^']*'/,"");return i(m,g)}function d(u){return!u.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(u)?u:u.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(f,m,v,g){if(v==="q"||v==="Q")return g=g.replaceAll("_"," "),g=g.replaceAll(/=([0-9a-fA-F]{2})/g,function(x,E){return String.fromCharCode(parseInt(E,16))}),i(m,g);try{g=atob(g)}catch{}return i(m,g)})}return""}function createHeaders(s,e){const t=new Headers;if(!s||!e||typeof e!="object")return t;for(const n in e){const i=e[n];i!==void 0&&t.append(n,i)}return t}function getResponseOrigin(s){return URL.parse(s)?.origin??null}function validateRangeRequestCapabilities({responseHeaders:s,isHttp:e,rangeChunkSize:t,disableRange:n}){const i={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(s.get("Content-Length"),10);return!Number.isInteger(o)||(i.suggestedLength=o,o<=2*t)||n||!e||s.get("Accept-Ranges")!=="bytes"||(s.get("Content-Encoding")||"identity")!=="identity"||(i.allowRangeRequests=!0),i}function extractFilenameFromHeader(s){const e=s.get("Content-Disposition");if(e){let t=getFilenameFromContentDispositionHeader(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(isPdfFile(t))return t}return null}function createResponseError(s,e){return new ResponseException(`Unexpected server response (${s}) while retrieving PDF "${e}".`,s,s===404||s===0&&e.startsWith("file:"))}function validateResponseStatus(s){return s===200||s===206}function createFetchOptions(s,e,t){return{method:"GET",headers:s,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function getArrayBuffer(s){return s instanceof Uint8Array?s.buffer:s instanceof ArrayBuffer?s:(warn(`getArrayBuffer - unexpected data format: ${s}`),new Uint8Array(s).buffer)}class PDFFetchStream{_responseOrigin=null;constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=createHeaders(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return assert$1(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new PDFFetchStreamReader(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new PDFFetchStreamRangeReader(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class PDFFetchStreamReader{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const n=new Headers(e.headers),i=t.url;fetch(i,createFetchOptions(n,this._withCredentials,this._abortController)).then(o=>{if(e._responseOrigin=getResponseOrigin(o.url),!validateResponseStatus(o.status))throw createResponseError(o.status,i);this._reader=o.body.getReader(),this._headersCapability.resolve();const a=o.headers,{allowRangeRequests:l,suggestedLength:h}=validateRangeRequestCapabilities({responseHeaders:a,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=l,this._contentLength=h||this._contentLength,this._filename=extractFilenameFromHeader(a),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:getArrayBuffer(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class PDFFetchStreamRangeReader{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const i=e.source;this._withCredentials=i.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!i.disableStream,this._abortController=new AbortController;const o=new Headers(e.headers);o.append("Range",`bytes=${t}-${n-1}`);const a=i.url;fetch(a,createFetchOptions(o,this._withCredentials,this._abortController)).then(l=>{const h=getResponseOrigin(l.url);if(h!==e._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${e._responseOrigin}".`);if(!validateResponseStatus(l.status))throw createResponseError(l.status,a);this._readCapability.resolve(),this._reader=l.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:getArrayBuffer(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const OK_RESPONSE=200,PARTIAL_CONTENT_RESPONSE=206;function network_getArrayBuffer(s){const e=s.response;return typeof e!="string"?e:stringToBytes(e).buffer}class NetworkManager{_responseOrigin=null;constructor({url:e,httpHeaders:t,withCredentials:n}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=createHeaders(this.isHttp,t),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,i=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[o,a]of this.headers)t.setRequestHeader(o,a);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=PARTIAL_CONTENT_RESPONSE):i.expectedStatus=OK_RESPONSE,t.responseType="arraybuffer",assert$1(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){const n=this.pendingRequests[e];n&&n.onProgress?.(t)}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const i=n.xhr;if(i.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),i.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],i.status===0&&this.isHttp){n.onError(i.status);return}const o=i.status||OK_RESPONSE;if(!(o===OK_RESPONSE&&n.expectedStatus===PARTIAL_CONTENT_RESPONSE)&&o!==n.expectedStatus){n.onError(i.status);return}const l=network_getArrayBuffer(i);if(o===PARTIAL_CONTENT_RESPONSE){const h=i.getResponseHeader("Content-Range"),d=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);d?n.onDone({begin:parseInt(d[1],10),chunk:l}):(warn('Missing or invalid "Content-Range" header.'),n.onError(0))}else l?n.onDone({begin:0,chunk:l}):n.onError(i.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class PDFNetworkStream{constructor(e){this._source=e,this._manager=new NetworkManager(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return assert$1(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new PDFNetworkStreamFullRequestReader(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new PDFNetworkStreamRangeRequestReader(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class PDFNetworkStreamFullRequestReader{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=getResponseOrigin(t.responseURL);const n=t.getAllResponseHeaders(),i=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(l=>{const[h,...d]=l.split(": ");return[h,d.join(": ")]}):[]),{allowRangeRequests:o,suggestedLength:a}=validateRangeRequestCapabilities({responseHeaders:i,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});o&&(this._isRangeSupported=!0),this._contentLength=a||this._contentLength,this._filename=extractFilenameFromHeader(i),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=createResponseError(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class PDFNetworkStreamRangeRequestReader{constructor(e,t,n){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const e=getResponseOrigin(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??=createResponseError(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const urlRegex=/^[a-z][a-z0-9\-+.]+:/i;function parseUrlOrPath(s){if(urlRegex.test(s))return new URL(s);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(s))}class PDFNodeStream{constructor(e){this.source=e,this.url=parseUrlOrPath(e.url),assert$1(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return assert$1(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new PDFNodeStreamFsFullReader(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new PDFNodeStreamFsRangeReader(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class PDFNodeStreamFsFullReader{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(i=>{this._contentLength=i.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},i=>{i.code==="ENOENT"&&(i=createResponseError(0,this._url.href)),this._storedError=i,this._headersCapability.reject(i)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class PDFNodeStreamFsRangeReader{constructor(e,t,n){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const i=e.source;this._isStreamingSupported=!i.disableStream;const o=process.getBuiltinModule("fs");this._setReadableStream(o.createReadStream(this._url,{start:t,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const INITIAL_DATA=Symbol("INITIAL_DATA");class PDFObjects{#e=Object.create(null);#t(e){return this.#e[e]||={...Promise.withResolvers(),data:INITIAL_DATA}}get(e,t=null){if(t){const i=this.#t(e);return i.promise.then(()=>t(i.data)),null}const n=this.#e[e];if(!n||n.data===INITIAL_DATA)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=this.#e[e];return!!t&&t.data!==INITIAL_DATA}delete(e){const t=this.#e[e];return!t||t.data===INITIAL_DATA?!1:(delete this.#e[e],!0)}resolve(e,t=null){const n=this.#t(e);n.data=t,n.resolve()}clear(){for(const e in this.#e){const{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(const e in this.#e){const{data:t}=this.#e[e];t!==INITIAL_DATA&&(yield[e,t])}}}const MAX_TEXT_DIVS_TO_RENDER=1e5,DEFAULT_FONT_SIZE=30;let TextLayer$1=class Qt{#e=Promise.withResolvers();#t=null;#n=!1;#r=!!globalThis.FontInspector?.enabled;#s=null;#o=null;#i=0;#a=0;#c=null;#l=null;#h=0;#d=0;#f=Object.create(null);#g=[];#m=null;#u=[];#p=new WeakMap;#v=null;static#y=new Map;static#x=new Map;static#A=new WeakMap;static#w=null;static#b=new Set;constructor({textContentSource:e,container:t,viewport:n}){if(e instanceof ReadableStream)this.#m=e;else if(typeof e=="object")this.#m=new ReadableStream({start(h){h.enqueue(e),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#l=t,this.#d=n.scale*OutputScale.pixelRatio,this.#h=n.rotation,this.#o={div:null,properties:null,ctx:null};const{pageWidth:i,pageHeight:o,pageX:a,pageY:l}=n.rawDims;this.#v=[1,0,0,-1,-a,l+o],this.#a=i,this.#i=o,Qt.#M(),setLayerDimensions(t,n),this.#e.promise.finally(()=>{Qt.#b.delete(this),this.#o=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=util_FeatureTest.platform;return shadow(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{this.#c.read().then(({value:t,done:n})=>{if(n){this.#e.resolve();return}this.#s??=t.lang,Object.assign(this.#f,t.styles),this.#P(t.items),e()},this.#e.reject)};return this.#c=this.#m.getReader(),Qt.#b.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){const n=e.scale*OutputScale.pixelRatio,i=e.rotation;if(i!==this.#h&&(t?.(),this.#h=i,setLayerDimensions(this.#l,{rotation:i})),n!==this.#d){t?.(),this.#d=n;const o={div:null,properties:null,ctx:Qt.#T(this.#s)};for(const a of this.#u)o.properties=this.#p.get(a),o.div=a,this.#S(o)}}cancel(){const e=new AbortException("TextLayer task cancelled.");this.#c?.cancel(e).catch(()=>{}),this.#c=null,this.#e.reject(e)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#g}#P(e){if(this.#n)return;this.#o.ctx??=Qt.#T(this.#s);const t=this.#u,n=this.#g;for(const i of e){if(t.length>MAX_TEXT_DIVS_TO_RENDER){warn("Ignoring additional textDivs for performance reasons."),this.#n=!0;return}if(i.str===void 0){if(i.type==="beginMarkedContentProps"||i.type==="beginMarkedContent"){const o=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),i.id&&this.#t.setAttribute("id",`${i.id}`),o.append(this.#t)}else i.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}n.push(i.str),this.#_(i)}}#_(e){const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#u.push(t);const i=Util.transform(this.#v,e.transform);let o=Math.atan2(i[1],i[0]);const a=this.#f[e.fontName];a.vertical&&(o+=Math.PI/2);let l=this.#r&&a.fontSubstitution||a.fontFamily;l=Qt.fontFamilyMap.get(l)||l;const h=Math.hypot(i[2],i[3]),d=h*Qt.#N(l,a,this.#s);let u,f;o===0?(u=i[4],f=i[5]-d):(u=i[4]+d*Math.sin(o),f=i[5]-d*Math.cos(o));const m="calc(var(--total-scale-factor) *",v=t.style;this.#t===this.#l?(v.left=`${(100*u/this.#a).toFixed(2)}%`,v.top=`${(100*f/this.#i).toFixed(2)}%`):(v.left=`${m}${u.toFixed(2)}px)`,v.top=`${m}${f.toFixed(2)}px)`),v.fontSize=`${m}${(Qt.#w*h).toFixed(2)}px)`,v.fontFamily=l,n.fontSize=h,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#r&&(t.dataset.fontName=a.fontSubstitutionLoadedName||e.fontName),o!==0&&(n.angle=o*(180/Math.PI));let g=!1;if(e.str.length>1)g=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const x=Math.abs(e.transform[0]),E=Math.abs(e.transform[3]);x!==E&&Math.max(x,E)/Math.min(x,E)>1.5&&(g=!0)}if(g&&(n.canvasWidth=a.vertical?e.height:e.width),this.#p.set(t,n),this.#o.div=t,this.#o.properties=n,this.#S(this.#o),n.hasText&&this.#t.append(t),n.hasEOL){const x=document.createElement("br");x.setAttribute("role","presentation"),this.#t.append(x)}}#S(e){const{div:t,properties:n,ctx:i}=e,{style:o}=t;let a="";if(Qt.#w>1&&(a=`scale(${1/Qt.#w})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:l}=o,{canvasWidth:h,fontSize:d}=n;Qt.#k(i,d*this.#d,l);const{width:u}=i.measureText(t.textContent);u>0&&(a=`scaleX(${h*this.#d/u}) ${a}`)}n.angle!==0&&(a=`rotate(${n.angle}deg) ${a}`),a.length>0&&(o.transform=a)}static cleanup(){if(!(this.#b.size>0)){this.#y.clear();for(const{canvas:e}of this.#x.values())e.remove();this.#x.clear()}}static#T(e=null){let t=this.#x.get(e||="");if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#x.set(e,t),this.#A.set(t,{size:0,family:""})}return t}static#k(e,t,n){const i=this.#A.get(e);t===i.size&&n===i.family||(e.font=`${t}px ${n}`,i.size=t,i.family=n)}static#M(){if(this.#w!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#w=e.getBoundingClientRect().height,e.remove()}static#N(e,t,n){const i=this.#y.get(e);if(i)return i;const o=this.#T(n);o.canvas.width=o.canvas.height=DEFAULT_FONT_SIZE,this.#k(o,DEFAULT_FONT_SIZE,e);const a=o.measureText(""),l=a.fontBoundingBoxAscent,h=Math.abs(a.fontBoundingBoxDescent);o.canvas.width=o.canvas.height=0;let d=.8;return l?d=l/(l+h):(util_FeatureTest.platform.isFirefox&&warn("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?d=t.ascent:t.descent&&(d=1+t.descent)),this.#y.set(e,d),d}};const RENDERING_CANCELLED_TIMEOUT=100;function getDocument(s={}){typeof s=="string"||s instanceof URL?s={url:s}:(s instanceof ArrayBuffer||ArrayBuffer.isView(s))&&(s={data:s});const e=new PDFDocumentLoadingTask,{docId:t}=e,n=s.url?getUrlProp(s.url):null,i=s.data?getDataProp(s.data):null,o=s.httpHeaders||null,a=s.withCredentials===!0,l=s.password??null,h=s.range instanceof PDFDataRangeTransport$2?s.range:null,d=Number.isInteger(s.rangeChunkSize)&&s.rangeChunkSize>0?s.rangeChunkSize:2**16;let u=s.worker instanceof PDFWorker?s.worker:null;const f=s.verbosity,m=typeof s.docBaseUrl=="string"&&!isDataScheme(s.docBaseUrl)?s.docBaseUrl:null,v=getFactoryUrlProp(s.cMapUrl),g=s.cMapPacked!==!1,x=s.CMapReaderFactory||(isNodeJS?NodeCMapReaderFactory:DOMCMapReaderFactory),E=getFactoryUrlProp(s.iccUrl),b=getFactoryUrlProp(s.standardFontDataUrl),_=s.StandardFontDataFactory||(isNodeJS?NodeStandardFontDataFactory:DOMStandardFontDataFactory),S=getFactoryUrlProp(s.wasmUrl),C=s.WasmFactory||(isNodeJS?NodeWasmFactory:DOMWasmFactory),A=s.stopAtErrors!==!0,R=Number.isInteger(s.maxImageSize)&&s.maxImageSize>-1?s.maxImageSize:-1,L=s.isEvalSupported!==!1,j=typeof s.isOffscreenCanvasSupported=="boolean"?s.isOffscreenCanvasSupported:!isNodeJS,F=typeof s.isImageDecoderSupported=="boolean"?s.isImageDecoderSupported:!isNodeJS&&(util_FeatureTest.platform.isFirefox||!globalThis.chrome),W=Number.isInteger(s.canvasMaxAreaInBytes)?s.canvasMaxAreaInBytes:-1,K=typeof s.disableFontFace=="boolean"?s.disableFontFace:isNodeJS,ee=s.fontExtraProperties===!0,te=s.enableXfa===!0,re=s.ownerDocument||globalThis.document,ie=s.disableRange===!0,Q=s.disableStream===!0,z=s.disableAutoFetch===!0,N=s.pdfBug===!0,k=s.CanvasFactory||(isNodeJS?NodeCanvasFactory:DOMCanvasFactory),I=s.FilterFactory||(isNodeJS?NodeFilterFactory:DOMFilterFactory),D=s.enableHWA===!0,U=s.useWasm!==!1,$=h?h.length:s.length??NaN,q=typeof s.useSystemFonts=="boolean"?s.useSystemFonts:!isNodeJS&&!K,V=typeof s.useWorkerFetch=="boolean"?s.useWorkerFetch:!!(x===DOMCMapReaderFactory&&_===DOMStandardFontDataFactory&&C===DOMWasmFactory&&v&&b&&S&&isValidFetchUrl(v,document.baseURI)&&isValidFetchUrl(b,document.baseURI)&&isValidFetchUrl(S,document.baseURI)),P=null;setVerbosityLevel(f);const O={canvasFactory:new k({ownerDocument:re,enableHWA:D}),filterFactory:new I({docId:t,ownerDocument:re}),cMapReaderFactory:V?null:new x({baseUrl:v,isCompressed:g}),standardFontDataFactory:V?null:new _({baseUrl:b}),wasmFactory:V?null:new C({baseUrl:S})};u||(u=PDFWorker.create({verbosity:f,port:GlobalWorkerOptions.workerPort}),e._worker=u);const B={docId:t,apiVersion:"5.4.296",data:i,password:l,disableAutoFetch:z,rangeChunkSize:d,length:$,docBaseUrl:m,enableXfa:te,evaluatorOptions:{maxImageSize:R,disableFontFace:K,ignoreErrors:A,isEvalSupported:L,isOffscreenCanvasSupported:j,isImageDecoderSupported:F,canvasMaxAreaInBytes:W,fontExtraProperties:ee,useSystemFonts:q,useWasm:U,useWorkerFetch:V,cMapUrl:v,iccUrl:E,standardFontDataUrl:b,wasmUrl:S}},G={ownerDocument:re,pdfBug:N,styleElement:P,loadingParams:{disableAutoFetch:z,enableXfa:te}};return u.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const Y=u.messageHandler.sendWithPromise("GetDocRequest",B,i?[i.buffer]:null);let J;if(h)J=new PDFDataTransportStream(h,{disableRange:ie,disableStream:Q});else if(!i){if(!n)throw new Error("getDocument - no `url` parameter provided.");const Z=isValidFetchUrl(n)?PDFFetchStream:isNodeJS?PDFNodeStream:PDFNetworkStream;J=new Z({url:n,length:$,httpHeaders:o,withCredentials:a,rangeChunkSize:d,disableRange:ie,disableStream:Q})}return Y.then(Z=>{if(e.destroyed)throw new Error("Loading aborted");if(u.destroyed)throw new Error("Worker was destroyed");const oe=new MessageHandler(t,Z,u.port),ve=new WorkerTransport(oe,e,J,G,O,D);e._transport=ve,oe.send("Ready",null)})}).catch(e._capability.reject),e}class PDFDocumentLoadingTask{static#e=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${PDFDocumentLoadingTask.#e++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}let PDFDataRangeTransport$2=class{#e=Promise.withResolvers();#t=[];#n=[];#r=[];#s=[];constructor(e,t,n=!1,i=null){this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=i}addRangeListener(e){this.#s.push(e)}addProgressListener(e){this.#r.push(e)}addProgressiveReadListener(e){this.#n.push(e)}addProgressiveDoneListener(e){this.#t.push(e)}onDataRange(e,t){for(const n of this.#s)n(e,t)}onDataProgress(e,t){this.#e.promise.then(()=>{for(const n of this.#r)n(e,t)})}onDataProgressiveRead(e){this.#e.promise.then(()=>{for(const t of this.#n)t(e)})}onDataProgressiveDone(){this.#e.promise.then(()=>{for(const e of this.#t)e()})}transportReady(){this.#e.resolve()}requestDataRange(e,t){unreachable("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}};class PDFDocumentProxy{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return shadow(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class PDFPageProxy{#e=!1;constructor(e,t,n,i=!1){this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=i?new StatTimer:null,this._pdfBug=i,this.commonObjs=n.commonObjs,this.objs=new PDFObjects,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:i=0,dontFlip:o=!1}={}){return new PageViewport({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:o})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return shadow(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,canvas:t=e.canvas,viewport:n,intent:i="display",annotationMode:o=AnnotationMode.ENABLE,transform:a=null,background:l=null,optionalContentConfigPromise:h=null,annotationCanvasMap:d=null,pageColors:u=null,printAnnotationStorage:f=null,isEditing:m=!1,recordOperations:v=!1,operationsFilter:g=null}){this._stats?.time("Overall");const x=this._transport.getRenderingIntent(i,o,f,m),{renderingIntent:E,cacheKey:b}=x;this.#e=!1,h||=this._transport.getOptionalContentConfig(E);let _=this._intentStates.get(b);_||(_=Object.create(null),this._intentStates.set(b,_)),_.streamReaderCancelTimeout&&(clearTimeout(_.streamReaderCancelTimeout),_.streamReaderCancelTimeout=null);const S=!!(E&RenderingIntentFlag.PRINT);_.displayReadyCapability||(_.displayReadyCapability=Promise.withResolvers(),_.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(x));const C=!!(this._pdfBug&&globalThis.StepperManager?.enabled),A=!this.recordedBBoxes&&(v||C),R=F=>{if(_.renderTasks.delete(L),A){const W=L.gfx?.dependencyTracker.take();W&&(L.stepper&&L.stepper.setOperatorBBoxes(W,L.gfx.dependencyTracker.takeDebugMetadata()),v&&(this.recordedBBoxes=W))}S&&(this.#e=!0),this.#t(),F?(L.capability.reject(F),this._abortOperatorList({intentState:_,reason:F instanceof Error?F:new Error(F)})):L.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},L=new InternalRenderTask({callback:R,params:{canvas:t,canvasContext:e,dependencyTracker:A?new CanvasDependencyTracker(t,_.operatorList.length,C):null,viewport:n,transform:a,background:l},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:d,operatorList:_.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!S,pdfBug:this._pdfBug,pageColors:u,enableHWA:this._transport.enableHWA,operationsFilter:g});(_.renderTasks||=new Set).add(L);const j=L.task;return Promise.all([_.displayReadyCapability.promise,h]).then(([F,W])=>{if(this.destroyed){R();return}if(this._stats?.time("Rendering"),!(W.renderingIntent&E))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");L.initializeGraphics({transparency:F,optionalContentConfig:W}),L.operatorListChanged()}).catch(R),j}getOperatorList({intent:e="display",annotationMode:t=AnnotationMode.ENABLE,printAnnotationStorage:n=null,isEditing:i=!1}={}){function o(){l.operatorList.lastChunk&&(l.opListReadCapability.resolve(l.operatorList),l.renderTasks.delete(h))}const a=this._transport.getRenderingIntent(e,t,n,i,!0);let l=this._intentStates.get(a.cacheKey);l||(l=Object.create(null),this._intentStates.set(a.cacheKey,l));let h;return l.opListReadCapability||(h=Object.create(null),h.operatorListChanged=o,l.opListReadCapability=Promise.withResolvers(),(l.renderTasks||=new Set).add(h),l.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(a)),l.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>XfaText.textContent(n));const t=this.streamTextContent(e);return new Promise(function(n,i){function o(){a.read().then(function({value:h,done:d}){if(d){n(l);return}l.lang??=h.lang,Object.assign(l.styles,h.styles),l.items.push(...h.items),o()},i)}const a=t.getReader(),l={items:[],styles:Object.create(null),lang:null};o()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),this.#e=!1,Promise.all(e)}cleanup(e=!1){this.#e=!0;const t=this.#t();return e&&t&&(this._stats&&=new StatTimer),t}#t(){if(!this.#e||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}_startRenderPage(e,t){const n=this._intentStates.get(t);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let n=0,i=e.length;n<i;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&this.#t()}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:i}){const{map:o,transfer:a}=n,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:o,modifiedIds:i},a).getReader(),d=this._intentStates.get(t);d.streamReader=h;const u=()=>{h.read().then(({value:f,done:m})=>{if(m){d.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(f,d),u())},f=>{if(d.streamReader=null,!this._transport.destroyed){if(d.operatorList){d.operatorList.lastChunk=!0;for(const m of d.renderTasks)m.operatorListChanged();this.#t()}if(d.displayReadyCapability)d.displayReadyCapability.reject(f);else if(d.opListReadCapability)d.opListReadCapability.reject(f);else throw f}})};u()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof RenderingCancelledException){let i=RENDERING_CANCELLED_TIMEOUT;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new AbortException(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,o]of this._intentStates)if(o===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}class PDFWorker{#e=Promise.withResolvers();#t=null;#n=null;#r=null;static#s=0;static#o=!1;static#i=new WeakMap;static{isNodeJS&&(this.#o=!0,GlobalWorkerOptions.workerSrc||="./pdf.worker.mjs"),this._isSameOrigin=(e,t)=>{const n=URL.parse(e);if(!n?.origin||n.origin==="null")return!1;const i=new URL(t,n);return n.origin===i.origin},this._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},this.fromPort=e=>{if(deprecated("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return this.create(e)}}constructor({name:e=null,port:t=null,verbosity:n=getVerbosityLevel()}={}){if(this.name=e,this.destroyed=!1,this.verbosity=n,t){if(PDFWorker.#i.has(t))throw new Error("Cannot use more than one PDFWorker per port.");PDFWorker.#i.set(t,this),this.#c(t)}else this.#l()}get promise(){return this.#e.promise}#a(){this.#e.resolve(),this.#t.send("configure",{verbosity:this.verbosity})}get port(){return this.#n}get messageHandler(){return this.#t}#c(e){this.#n=e,this.#t=new MessageHandler("main","worker",e),this.#t.on("ready",()=>{}),this.#a()}#l(){if(PDFWorker.#o||PDFWorker.#d){this.#h();return}let{workerSrc:e}=PDFWorker;try{PDFWorker._isSameOrigin(window.location,e)||(e=PDFWorker._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new MessageHandler("main","worker",t),i=()=>{o.abort(),n.destroy(),t.terminate(),this.destroyed?this.#e.reject(new Error("Worker was destroyed")):this.#h()},o=new AbortController;t.addEventListener("error",()=>{this.#r||i()},{signal:o.signal}),n.on("test",l=>{if(o.abort(),this.destroyed||!l){i();return}this.#t=n,this.#n=t,this.#r=t,this.#a()}),n.on("ready",l=>{if(o.abort(),this.destroyed){i();return}try{a()}catch{this.#h()}});const a=()=>{const l=new Uint8Array;n.send("test",l,[l.buffer])};a();return}catch{info("The worker has been disabled.")}this.#h()}#h(){PDFWorker.#o||(warn("Setting up fake worker."),PDFWorker.#o=!0),PDFWorker._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this.#e.reject(new Error("Worker was destroyed"));return}const t=new LoopbackPort;this.#n=t;const n=`fake${PDFWorker.#s++}`,i=new MessageHandler(n+"_worker",n,t);e.setup(i,t),this.#t=new MessageHandler(n,n+"_worker",t),this.#a()}).catch(e=>{this.#e.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){this.destroyed=!0,this.#r?.terminate(),this.#r=null,PDFWorker.#i.delete(this.#n),this.#n=null,this.#t?.destroy(),this.#t=null}static create(e){const t=this.#i.get(e?.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new PDFWorker(e)}static get workerSrc(){if(GlobalWorkerOptions.workerSrc)return GlobalWorkerOptions.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get#d(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){return shadow(this,"_setupFakeWorkerGlobal",(async()=>this.#d?this.#d:(await import(this.workerSrc)).WorkerMessageHandler)())}}class WorkerTransport{#e=new Map;#t=new Map;#n=new Map;#r=new Map;#s=null;constructor(e,t,n,i,o,a){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new PDFObjects,this.fontLoader=new FontLoader({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this.loadingParams=i.loadingParams,this._params=i,this.canvasFactory=o.canvasFactory,this.filterFactory=o.filterFactory,this.cMapReaderFactory=o.cMapReaderFactory,this.standardFontDataFactory=o.standardFontDataFactory,this.wasmFactory=o.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=a,this.setupMessageHandler()}#o(e,t=null){const n=this.#e.get(e);if(n)return n;const i=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,i),i}get annotationStorage(){return shadow(this,"annotationStorage",new AnnotationStorage)}getRenderingIntent(e,t=AnnotationMode.ENABLE,n=null,i=!1,o=!1){let a=RenderingIntentFlag.DISPLAY,l=SerializableEmpty;switch(e){case"any":a=RenderingIntentFlag.ANY;break;case"display":break;case"print":a=RenderingIntentFlag.PRINT;break;default:warn(`getRenderingIntent - invalid intent: ${e}`)}const h=a&RenderingIntentFlag.PRINT&&n instanceof PrintAnnotationStorage?n:this.annotationStorage;switch(t){case AnnotationMode.DISABLE:a+=RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case AnnotationMode.ENABLE:break;case AnnotationMode.ENABLE_FORMS:a+=RenderingIntentFlag.ANNOTATIONS_FORMS;break;case AnnotationMode.ENABLE_STORAGE:a+=RenderingIntentFlag.ANNOTATIONS_STORAGE,l=h.serializable;break;default:warn(`getRenderingIntent - invalid annotationMode: ${t}`)}i&&(a+=RenderingIntentFlag.IS_EDITING),o&&(a+=RenderingIntentFlag.OPLIST);const{ids:d,hash:u}=h.modifiedIds,f=[a,l.hash,u];return{renderingIntent:a,cacheKey:f.join("_"),annotationStorageSerializable:l,modifiedIds:d}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#s?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const n of this.#t.values())e.push(n._destroy());this.#t.clear(),this.#n.clear(),this.#r.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),TextLayer$1.cleanup(),this._networkStream?.cancelAllRequests(new AbortException("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,i)=>{assert$1(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=o=>{this._lastProgress={loaded:o.loaded,total:o.total}},i.onPull=()=>{this._fullReader.read().then(function({value:o,done:a}){if(a){i.close();return}assert$1(o instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{i.error(o)})},i.onCancel=o=>{this._fullReader.cancel(o),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",async n=>{await this._fullReader.headersReady;const{isStreamingSupported:i,isRangeSupported:o,contentLength:a}=this._fullReader;return(!i||!o)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=l=>{t.onProgress?.({loaded:l.loaded,total:l.total})}),{isStreamingSupported:i,isRangeSupported:o,contentLength:a}}),e.on("GetRangeReader",(n,i)=>{assert$1(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const o=this._networkStream.getRangeReader(n.begin,n.end);if(!o){i.close();return}i.onPull=()=>{o.read().then(function({value:a,done:l}){if(l){i.close();return}assert$1(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{i.error(a)})},i.onCancel=a=>{o.cancel(a),i.ready.catch(l=>{if(!this.destroyed)throw l})}}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new PDFDocumentProxy(n,this))}),e.on("DocException",n=>{t._capability.reject(wrapReason(n))}),e.on("PasswordRequest",n=>{this.#s=Promise.withResolvers();try{if(!t.onPassword)throw wrapReason(n);const i=o=>{o instanceof Error?this.#s.reject(o):this.#s.resolve({password:o})};t.onPassword(i,n.code)}catch(i){this.#s.reject(i)}return this.#s.promise}),e.on("DataLoaded",n=>{t.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;this.#t.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,i,o])=>{if(this.destroyed||this.commonObjs.has(n))return null;switch(i){case"Font":if("error"in o){const u=o.error;warn(`Error during font loading: ${u}`),this.commonObjs.resolve(n,u);break}const a=new FontInfo(o),l=this._params.pdfBug&&globalThis.FontInspector?.enabled?(u,f)=>globalThis.FontInspector.fontAdded(u,f):null,h=new FontFaceObject(a,l,o.extra,o.charProcOperatorList);this.fontLoader.bind(h).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!h.fontExtraProperties&&h.data&&h.clearData(),this.commonObjs.resolve(n,h)});break;case"CopyLocalImage":const{imageRef:d}=o;assert$1(d,"The imageRef must be defined.");for(const u of this.#t.values())for(const[,f]of u.objs)if(f?.ref===d)return f.dataLen?(this.commonObjs.resolve(n,structuredClone(f)),f.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,o);break;default:throw new Error(`Got unknown common object type ${i}`)}return null}),e.on("obj",([n,i,o,a])=>{if(this.destroyed)return;const l=this.#t.get(i);if(!l.objs.has(n)){if(l._intentStates.size===0){a?.bitmap?.close();return}switch(o){case"Image":case"Pattern":l.objs.resolve(n,a);break;default:throw new Error(`Got unknown object type ${o}`)}}}),e.on("DocProgress",n=>{this.destroyed||t.onProgress?.({loaded:n.loaded,total:n.total})}),e.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const i=this[n.type];if(!i)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return i.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&warn("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=this.#n.get(t);if(n)return n;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(o=>{if(this.destroyed)throw new Error("Transport destroyed");o.refStr&&this.#r.set(o.refStr,e);const a=new PDFPageProxy(t,o,this,this._params.pdfBug);return this.#t.set(t,a),a});return this.#n.set(t,i),i}getPageIndex(e){return isRefProxy(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#o("GetFieldObjects")}hasJSActions(){return this.#o("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return this.#o("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#o("GetOptionalContentConfig").then(t=>new OptionalContentConfig(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#e.get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(i=>({info:i[0],metadata:i[1]?new Metadata(i[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),TextLayer$1.cleanup()}}cachedPageNumber(e){if(!isRefProxy(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#r.get(t)??null}}class RenderTask{#e=null;onContinue=null;onError=null;constructor(e){this.#e=e}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}}class InternalRenderTask{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:n,commonObjs:i,annotationCanvasMap:o,operatorList:a,pageIndex:l,canvasFactory:h,filterFactory:d,useRequestAnimationFrame:u=!1,pdfBug:f=!1,pageColors:m=null,enableHWA:v=!1,operationsFilter:g=null}){this.callback=e,this.params=t,this.objs=n,this.commonObjs=i,this.annotationCanvasMap=o,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=l,this.canvasFactory=h,this.filterFactory=d,this._pdfBug=f,this.pageColors=m,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=u===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=v,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=g}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:i,background:o,dependencyTracker:a}=this.params,l=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new CanvasGraphics(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,a),this.gfx.beginDrawing({transform:i,viewport:n,transparency:e,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),InternalRenderTask.#t.delete(this._canvas),e||=new RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,t),this.callback(e),this.task.onError?.(e)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),InternalRenderTask.#t.delete(this._canvas),this.callback())))}}const version="5.4.296",build="f56dc8601";class ColorPicker{#e=null;#t=null;#n;#r=null;#s=!1;#o=!1;#i=null;#a;#c=null;#l=null;static#h=null;static get _keyboardManager(){return shadow(this,"_keyboardManager",new KeyboardManager([[["Escape","mac+Escape"],ColorPicker.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],ColorPicker.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],ColorPicker.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],ColorPicker.prototype._moveToPrevious],[["Home","mac+Home"],ColorPicker.prototype._moveToBeginning],[["End","mac+End"],ColorPicker.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#o=!1,this.#i=e):this.#o=!0,this.#l=e?._uiManager||t,this.#a=this.#l._eventBus,this.#n=e?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",ColorPicker.#h||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",this.#i&&(e.ariaControls=`${this.#i.id}_colorpicker_dropdown`);const t=this.#l._signal;e.addEventListener("click",this.#m.bind(this),{signal:t}),e.addEventListener("keydown",this.#g.bind(this),{signal:t});const n=this.#t=document.createElement("span");return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=this.#n,e.append(n),e}renderMainDropdown(){const e=this.#r=this.#d();return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}#d(){const e=document.createElement("div"),t=this.#l._signal;e.addEventListener("contextmenu",noContextMenu,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#i&&(e.id=`${this.#i.id}_colorpicker_dropdown`);for(const[n,i]of this.#l.highlightColors){const o=document.createElement("button");o.tabIndex="0",o.role="option",o.setAttribute("data-color",i),o.title=n,o.setAttribute("data-l10n-id",ColorPicker.#h[n]);const a=document.createElement("span");o.append(a),a.className="swatch",a.style.backgroundColor=i,o.ariaSelected=i===this.#n,o.addEventListener("click",this.#f.bind(this,i),{signal:t}),e.append(o)}return e.addEventListener("keydown",this.#g.bind(this),{signal:t}),e}#f(e,t){t.stopPropagation(),this.#a.dispatch("switchannotationeditorparams",{source:this,type:AnnotationEditorParamsType.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#m(e);return}const t=e.target.getAttribute("data-color");t&&this.#f(t,e)}_moveToNext(e){if(!this.#p){this.#m(e);return}if(e.target===this.#e){this.#r.firstChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#r?.firstChild||e.target===this.#e){this.#p&&this._hideDropdownFromKeyboard();return}this.#p||this.#m(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#p){this.#m(e);return}this.#r.firstChild?.focus()}_moveToEnd(e){if(!this.#p){this.#m(e);return}this.#r.lastChild?.focus()}#g(e){ColorPicker._keyboardManager.exec(this,e)}#m(e){if(this.#p){this.hideDropdown();return}if(this.#s=e.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#e.ariaExpanded="true",this.#r){this.#r.classList.remove("hidden");return}const t=this.#r=this.#d();this.#e.append(t)}#u(e){this.#r?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#r?.classList.add("hidden"),this.#e.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#p(){return this.#r&&!this.#r.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#o){if(!this.#p){this.#i?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#s})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#r)return;const t=this.#l.highlightColors.values();for(const n of this.#r.children)n.ariaSelected=t.next().value===e.toUpperCase()}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#r?.remove(),this.#r=null}}class BasicColorPicker{#e=null;#t=null;#n=null;static#r=null;constructor(e){this.#t=e,this.#n=e._uiManager,BasicColorPicker.#r||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#e)return this.#e;const{editorType:e,colorType:t,colorValue:n}=this.#t,i=this.#e=document.createElement("input");return i.type="color",i.value=n||"#000000",i.className="basicColorPicker",i.tabIndex=0,i.setAttribute("data-l10n-id",BasicColorPicker.#r[e]),i.addEventListener("input",()=>{this.#n.updateParams(t,i.value)},{signal:this.#n._signal}),i}update(e){this.#e&&(this.#e.value=e)}destroy(){this.#e?.remove(),this.#e=null}hideDropdown(){}}function makeColorComp(s){return Math.floor(Math.max(0,Math.min(1,s))*255).toString(16).padStart(2,"0")}function scaleAndClamp(s){return Math.max(0,Math.min(255,255*s))}class ColorConverters{static CMYK_G([e,t,n,i]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+i)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=scaleAndClamp(e),[e,e,e]}static G_HTML([e]){const t=makeColorComp(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(scaleAndClamp)}static RGB_HTML(e){return`#${e.map(makeColorComp).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,i]){return["RGB",1-Math.min(1,e+i),1-Math.min(1,n+i),1-Math.min(1,t+i)]}static CMYK_rgb([e,t,n,i]){return[scaleAndClamp(1-Math.min(1,e+i)),scaleAndClamp(1-Math.min(1,n+i)),scaleAndClamp(1-Math.min(1,t+i))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const i=1-e,o=1-t,a=1-n,l=Math.min(i,o,a);return["CMYK",i,o,a,l]}}class BaseSVGFactory{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const i=this._createSVG("svg:svg");return i.setAttribute("version","1.1"),n||(i.setAttribute("width",`${e}px`),i.setAttribute("height",`${t}px`)),i.setAttribute("preserveAspectRatio","none"),i.setAttribute("viewBox",`0 0 ${e} ${t}`),i}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){unreachable("Abstract method `_createSVG` called.")}}class DOMSVGFactory extends BaseSVGFactory{_createSVG(e){return document.createElementNS(SVG_NS,e)}}const annotation_layer_DEFAULT_FONT_SIZE=9,GetElementsByNameSet=new WeakSet,TIMEZONE_OFFSET=new Date().getTimezoneOffset()*60*1e3;class AnnotationElementFactory{static create(e){switch(e.data.annotationType){case AnnotationType.LINK:return new LinkAnnotationElement(e);case AnnotationType.TEXT:return new TextAnnotationElement(e);case AnnotationType.WIDGET:switch(e.data.fieldType){case"Tx":return new TextWidgetAnnotationElement(e);case"Btn":return e.data.radioButton?new RadioButtonWidgetAnnotationElement(e):e.data.checkBox?new CheckboxWidgetAnnotationElement(e):new PushButtonWidgetAnnotationElement(e);case"Ch":return new ChoiceWidgetAnnotationElement(e);case"Sig":return new SignatureWidgetAnnotationElement(e)}return new WidgetAnnotationElement(e);case AnnotationType.POPUP:return new PopupAnnotationElement(e);case AnnotationType.FREETEXT:return new FreeTextAnnotationElement(e);case AnnotationType.LINE:return new LineAnnotationElement(e);case AnnotationType.SQUARE:return new SquareAnnotationElement(e);case AnnotationType.CIRCLE:return new CircleAnnotationElement(e);case AnnotationType.POLYLINE:return new PolylineAnnotationElement(e);case AnnotationType.CARET:return new CaretAnnotationElement(e);case AnnotationType.INK:return new InkAnnotationElement(e);case AnnotationType.POLYGON:return new PolygonAnnotationElement(e);case AnnotationType.HIGHLIGHT:return new HighlightAnnotationElement(e);case AnnotationType.UNDERLINE:return new UnderlineAnnotationElement(e);case AnnotationType.SQUIGGLY:return new SquigglyAnnotationElement(e);case AnnotationType.STRIKEOUT:return new StrikeOutAnnotationElement(e);case AnnotationType.STAMP:return new StampAnnotationElement(e);case AnnotationType.FILEATTACHMENT:return new FileAttachmentAnnotationElement(e);default:return new AnnotationElement(e)}}}class AnnotationElement{#e=null;#t=!1;#n=null;constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:i=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(n)),i&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e?.str||t?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return AnnotationElement._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:e}=this,t=this.annotationStorage?.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const e=this.annotationStorage?.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:n,rect:i}=this.data;let o=-1/0,a=-1/0;if(t?.length>=8){for(let l=0;l<t.length;l+=8)t[l+1]>a?(a=t[l+1],o=t[l+2]):t[l+1]===a&&(o=Math.max(o,t[l+2]));return[o,a]}if(n?.length>=1){for(const l of n)for(let h=0,d=l.length;h<d;h+=2)l[h+1]>a?(a=l[h+1],o=l[h]):l[h+1]===a&&(o=Math.max(o,l[h]));if(o!==1/0)return[o,a]}return i?[i[2],i[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:n,pageHeight:i,pageX:o,pageY:a}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-o)/n,e[1]=100*(e[1]-a)/i,e}get commentText(){const{data:e}=this;return this.annotationStorage.getRawValue(`${AnnotationEditorPrefix}${e.id}`)?.popup?.contents||e.contentsObj?.str||""}set commentText(e){const{data:t}=this,n={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:n})||this.annotationStorage.setValue(`${AnnotationEditorPrefix}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:n,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){(this.#n?.popup||this.popup)?.remove(),this.#n=this.popup=null}updateEdited(e){if(!this.container)return;e.rect&&(this.#e||={rect:this.data.rect.slice(0)});const{rect:t,popup:n}=e;t&&this.#r(t);let i=this.#n?.popup||this.popup;!i&&n?.text&&(this._createPopup(n),i=this.#n.popup),i&&(i.updateEdited(e),n?.deleted&&(i.remove(),this.#n=null,this.popup=null))}resetEdited(){this.#e&&(this.#r(this.#e.rect),this.#n?.popup.resetEdited(),this.#e=null)}#r(e){const{container:{style:t},data:{rect:n,rotation:i},parent:{viewport:{rawDims:{pageWidth:o,pageHeight:a,pageX:l,pageY:h}}}}=this;n?.splice(0,4,...e),t.left=`${100*(e[0]-l)/o}%`,t.top=`${100*(a-e[3]+h)/a}%`,i===0?(t.width=`${100*(e[2]-e[0])/o}%`,t.height=`${100*(e[3]-e[1])/a}%`):this.setRotation(i)}_createContainer(e){const{data:t,parent:{page:n,viewport:i}}=this,o=document.createElement("section");o.setAttribute("data-annotation-id",t.id),!(this instanceof WidgetAnnotationElement)&&!(this instanceof LinkAnnotationElement)&&(o.tabIndex=0);const{style:a}=o;if(a.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(o.title=t.alternativeText),t.noRotate&&o.classList.add("norotate"),!t.rect||this instanceof PopupAnnotationElement){const{rotation:x}=t;return!t.hasOwnCanvas&&x!==0&&this.setRotation(x,o),o}const{width:l,height:h}=this;if(!e&&t.borderStyle.width>0){a.borderWidth=`${t.borderStyle.width}px`;const x=t.borderStyle.horizontalCornerRadius,E=t.borderStyle.verticalCornerRadius;if(x>0||E>0){const _=`calc(${x}px * var(--total-scale-factor)) / calc(${E}px * var(--total-scale-factor))`;a.borderRadius=_}else if(this instanceof RadioButtonWidgetAnnotationElement){const _=`calc(${l}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;a.borderRadius=_}switch(t.borderStyle.style){case AnnotationBorderStyleType.SOLID:a.borderStyle="solid";break;case AnnotationBorderStyleType.DASHED:a.borderStyle="dashed";break;case AnnotationBorderStyleType.BEVELED:warn("Unimplemented border style: beveled");break;case AnnotationBorderStyleType.INSET:warn("Unimplemented border style: inset");break;case AnnotationBorderStyleType.UNDERLINE:a.borderBottomStyle="solid";break}const b=t.borderColor||null;b?(this.#t=!0,a.borderColor=Util.makeHexColor(b[0]|0,b[1]|0,b[2]|0)):a.borderWidth=0}const d=Util.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:u,pageHeight:f,pageX:m,pageY:v}=i.rawDims;a.left=`${100*(d[0]-m)/u}%`,a.top=`${100*(d[1]-v)/f}%`;const{rotation:g}=t;return t.hasOwnCanvas||g===0?(a.width=`${100*l/u}%`,a.height=`${100*h/f}%`):this.setRotation(g,o),o}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:i}=this.parent.viewport.rawDims;let{width:o,height:a}=this;e%180!==0&&([o,a]=[a,o]),t.style.width=`${100*o/n}%`,t.style.height=`${100*a/i}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,n,i)=>{const o=i.detail[t],a=o[0],l=o.slice(1);i.target.style[n]=ColorConverters[`${a}_HTML`](l),this.annotationStorage.setValue(this.data.id,{[n]:ColorConverters[`${a}_rgb`](l)})};return shadow(this,"_commonActions",{display:t=>{const{display:n}=t.detail,i=n%2===1;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:i,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const i of Object.keys(t.detail))(e[i]||n[i])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[i,o]of Object.entries(t)){const a=n[i];if(a){const l={detail:{[i]:o},target:e};a(l),delete t[i]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,i,o]=this.data.rect.map(x=>Math.fround(x));if(e.length===8){const[x,E,b,_]=e.subarray(2,6);if(i===x&&o===E&&t===b&&n===_)return}const{style:a}=this.container;let l;if(this.#t){const{borderColor:x,borderWidth:E}=a;a.borderWidth=0,l=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${x}" stroke-width="${E}">`],this.container.classList.add("hasBorder")}const h=i-t,d=o-n,{svgFactory:u}=this,f=u.createElement("svg");f.classList.add("quadrilateralsContainer"),f.setAttribute("width",0),f.setAttribute("height",0),f.role="none";const m=u.createElement("defs");f.append(m);const v=u.createElement("clipPath"),g=`clippath_${this.data.id}`;v.setAttribute("id",g),v.setAttribute("clipPathUnits","objectBoundingBox"),m.append(v);for(let x=2,E=e.length;x<E;x+=8){const b=e[x],_=e[x+1],S=e[x+2],C=e[x+3],A=u.createElement("rect"),R=(S-t)/h,L=(o-_)/d,j=(b-S)/h,F=(_-C)/d;A.setAttribute("x",R),A.setAttribute("y",L),A.setAttribute("width",j),A.setAttribute("height",F),v.append(A),l?.push(`<rect vector-effect="non-scaling-stroke" x="${R}" y="${L}" width="${j}" height="${F}"/>`)}this.#t&&(l.push("</g></svg>')"),a.backgroundImage=l.join("")),this.container.append(f),this.container.style.clipPath=`url(#${g})`}_createPopup(e=null){const{data:t}=this;let n,i;e?(n={str:e.text},i=e.date):(n=t.contentsObj,i=t.modificationDate);const o=this.#n=new PopupAnnotationElement({data:{color:t.color,titleObj:t.titleObj,modificationDate:i,contentsObj:n,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]});this.parent._commentManager||this.parent.div.append(o.render())}get hasPopupElement(){return!!(this.#n||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#n}render(){unreachable("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const i=this._fieldObjects[e];if(i)for(const{page:o,id:a,exportValues:l}of i){if(o===-1||a===t)continue;const h=typeof l=="string"?l:null,d=document.querySelector(`[data-element-id="${a}"]`);if(d&&!GetElementsByNameSet.has(d)){warn(`_getElementsByName - element not allowed: ${a}`);continue}n.push({id:a,exportValue:h,domElement:d})}return n}for(const i of document.getElementsByName(e)){const{exportValue:o}=i,a=i.getAttribute("data-element-id");a!==t&&GetElementsByNameSet.has(i)&&n.push({id:a,exportValue:o,domElement:i})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class EditorAnnotationElement extends AnnotationElement{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&(this._createPopup(e.comment),this.extraPopupElement.popup.renderCommentButton())}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.container.remove(),this.container=null,this.removePopup()}}class LinkAnnotationElement extends AnnotationElement{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let i=!1;return e.url?(t.addLinkAttributes(n,e.url,e.newWindow),i=!0):e.action?(this._bindNamedAction(n,e.action,e.overlaidText),i=!0):e.attachment?(this.#t(n,e.attachment,e.overlaidText,e.attachmentDest),i=!0):e.setOCGState?(this.#n(n,e.setOCGState,e.overlaidText),i=!0):e.dest?(this._bindLink(n,e.dest,e.overlaidText),i=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),i=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),i=!0):this.isTooltipOnly&&!i&&(this._bindLink(n,""),i=!0)),this.container.classList.add("linkAnnotation"),i&&this.container.append(n),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t,n=""){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e(),n&&(e.title=n)}_bindNamedAction(e,t,n=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),n&&(e.title=n),this.#e()}#t(e,t,n="",i=null){e.href=this.linkService.getAnchorUrl(""),t.description?e.title=t.description:n&&(e.title=n),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,i),!1),this.#e()}#n(e,t,n=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),n&&(e.title=n),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const i of Object.keys(t.actions)){const o=n.get(i);o&&(e[o]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:i}}),!1))}t.overlaidText&&(e.title=t.overlaidText),e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){const n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){warn('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(e.onclick=()=>!1);return}e.onclick=()=>{n?.();const{fields:i,refs:o,include:a}=t,l=[];if(i.length!==0||o.length!==0){const u=new Set(o);for(const f of i){const m=this._fieldObjects[f]||[];for(const{id:v}of m)u.add(v)}for(const f of Object.values(this._fieldObjects))for(const m of f)u.has(m.id)===a&&l.push(m)}else for(const u of Object.values(this._fieldObjects))l.push(...u);const h=this.annotationStorage,d=[];for(const u of l){const{id:f}=u;switch(d.push(f),u.type){case"text":{const v=u.defaultValue||"";h.setValue(f,{value:v});break}case"checkbox":case"radiobutton":{const v=u.defaultValue===u.exportValues;h.setValue(f,{value:v});break}case"combobox":case"listbox":{const v=u.defaultValue||"";h.setValue(f,{value:v});break}default:continue}const m=document.querySelector(`[data-element-id="${f}"]`);if(m){if(!GetElementsByNameSet.has(m)){warn(`_bindResetFormAction - element not allowed: ${f}`);continue}}else continue;m.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:d,name:"ResetForm"}}),!1}}}class TextAnnotationElement extends AnnotationElement{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class WidgetAnnotationElement extends AnnotationElement{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return util_FeatureTest.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,i,o){n.includes("mouse")?e.addEventListener(n,a=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:o(a),shift:a.shiftKey,modifier:this._getKeyModifier(a)}})}):e.addEventListener(n,a=>{if(n==="blur"){if(!t.focused||!a.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}o&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:o(a)}})})}_setEventListeners(e,t,n,i){for(const[o,a]of n)(a==="Action"||this.data.actions?.[a])&&((a==="Focus"||a==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,o,a,i),a==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):a==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":Util.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,i=this.data.defaultAppearanceData.fontSize||annotation_layer_DEFAULT_FONT_SIZE,o=e.style;let a;const l=2,h=d=>Math.round(10*d)/10;if(this.data.multiLine){const d=Math.abs(this.data.rect[3]-this.data.rect[1]-l),u=Math.round(d/(LINE_FACTOR*i))||1,f=d/u;a=Math.min(i,h(f/LINE_FACTOR))}else{const d=Math.abs(this.data.rect[3]-this.data.rect[1]-l);a=Math.min(i,h(d/LINE_FACTOR))}o.fontSize=`calc(${a}px * var(--total-scale-factor))`,o.color=Util.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(o.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class TextWidgetAnnotationElement extends WidgetAnnotationElement{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,i){const o=this.annotationStorage;for(const a of this._getElementsByName(e.name,e.id))a.domElement&&(a.domElement[t]=n),o.setValue(a.id,{[i]:n})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const i=e.getValue(t,{value:this.data.fieldValue});let o=i.value||"";const a=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;a&&o.length>a&&(o=o.slice(0,a));let l=i.formattedValue||this.data.textContent?.join(`
`)||null;l&&this.data.comb&&(l=l.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:l,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=l??o,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",l??o),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),GetElementsByNameSet.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:d,datetimeType:u,timeStep:f}=this.data,m=!!u&&this.enableScripting;d&&(n.title=d),this._setRequired(n,this.data.required),a&&(n.maxLength=a),n.addEventListener("input",g=>{e.setValue(t,{value:g.target.value}),this.setPropertyOnSiblings(n,"value",g.target.value,"value"),h.formattedValue=null}),n.addEventListener("resetform",g=>{const x=this.data.defaultFieldValue??"";n.value=h.userValue=x,h.formattedValue=null});let v=g=>{const{formattedValue:x}=h;x!=null&&(g.target.value=x),g.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",x=>{if(h.focused)return;const{target:E}=x;if(m&&(E.type=u,f&&(E.step=f)),h.userValue){const b=h.userValue;if(m)if(u==="time"){const _=new Date(b),S=[_.getHours(),_.getMinutes(),_.getSeconds()];E.value=S.map(C=>C.toString().padStart(2,"0")).join(":")}else E.value=new Date(b-TIMEZONE_OFFSET).toISOString().split(u==="date"?"T":".",1)[0];else E.value=b}h.lastCommittedValue=E.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),n.addEventListener("updatefromsandbox",x=>{this.showElementAndHideCanvas(x.target);const E={value(b){h.userValue=b.detail.value??"",m||e.setValue(t,{value:h.userValue.toString()}),b.target.value=h.userValue},formattedValue(b){const{formattedValue:_}=b.detail;h.formattedValue=_,_!=null&&b.target!==document.activeElement&&(b.target.value=_);const S={formattedValue:_};m&&(S.value=_),e.setValue(t,S)},selRange(b){b.target.setSelectionRange(...b.detail.selRange)},charLimit:b=>{const{charLimit:_}=b.detail,{target:S}=b;if(_===0){S.removeAttribute("maxLength");return}S.setAttribute("maxLength",_);let C=h.userValue;!C||C.length<=_||(C=C.slice(0,_),S.value=h.userValue=C,e.setValue(t,{value:C}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:C,willCommit:!0,commitKey:1,selStart:S.selectionStart,selEnd:S.selectionEnd}}))}};this._dispatchEventFromSandbox(E,x)}),n.addEventListener("keydown",x=>{h.commitKey=1;let E=-1;if(x.key==="Escape"?E=0:x.key==="Enter"&&!this.data.multiLine?E=2:x.key==="Tab"&&(h.commitKey=3),E===-1)return;const{value:b}=x.target;h.lastCommittedValue!==b&&(h.lastCommittedValue=b,h.userValue=b,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:b,willCommit:!0,commitKey:E,selStart:x.target.selectionStart,selEnd:x.target.selectionEnd}}))});const g=v;v=null,n.addEventListener("blur",x=>{if(!h.focused||!x.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{target:E}=x;let{value:b}=E;if(m){if(b&&u==="time"){const _=b.split(":").map(S=>parseInt(S,10));b=new Date(2e3,0,1,_[0],_[1],_[2]||0).valueOf(),E.step=""}else b.includes("T")||(b=`${b}T00:00`),b=new Date(b).valueOf();E.type="text"}h.userValue=b,h.lastCommittedValue!==b&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:b,willCommit:!0,commitKey:h.commitKey,selStart:x.target.selectionStart,selEnd:x.target.selectionEnd}}),g(x)}),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",x=>{h.lastCommittedValue=null;const{data:E,target:b}=x,{value:_,selectionStart:S,selectionEnd:C}=b;let A=S,R=C;switch(x.inputType){case"deleteWordBackward":{const L=_.substring(0,S).match(/\w*[^\w]*$/);L&&(A-=L[0].length);break}case"deleteWordForward":{const L=_.substring(S).match(/^[^\w]*\w*/);L&&(R+=L[0].length);break}case"deleteContentBackward":S===C&&(A-=1);break;case"deleteContentForward":S===C&&(R+=1);break}x.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:_,change:E||"",willCommit:!1,selStart:A,selEnd:R}})}),this._setEventListeners(n,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],x=>x.target.value)}if(v&&n.addEventListener("blur",v),this.data.comb){const x=(this.data.rect[2]-this.data.rect[0])/a;n.classList.add("comb"),n.style.letterSpacing=`calc(${x}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class SignatureWidgetAnnotationElement extends WidgetAnnotationElement{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class CheckboxWidgetAnnotationElement extends WidgetAnnotationElement{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let i=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof i=="string"&&(i=i!=="Off",e.setValue(n,{value:i})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const o=document.createElement("input");return GetElementsByNameSet.add(o),o.setAttribute("data-element-id",n),o.disabled=t.readOnly,this._setRequired(o,this.data.required),o.type="checkbox",o.name=t.fieldName,i&&o.setAttribute("checked",!0),o.setAttribute("exportValue",t.exportValue),o.tabIndex=0,o.addEventListener("change",a=>{const{name:l,checked:h}=a.target;for(const d of this._getElementsByName(l,n)){const u=h&&d.exportValue===t.exportValue;d.domElement&&(d.domElement.checked=u),e.setValue(d.id,{value:u})}e.setValue(n,{value:h})}),o.addEventListener("resetform",a=>{const l=t.defaultFieldValue||"Off";a.target.checked=l===t.exportValue}),this.enableScripting&&this.hasJSActions&&(o.addEventListener("updatefromsandbox",a=>{const l={value(h){h.target.checked=h.detail.value!=="Off",e.setValue(n,{value:h.target.checked})}};this._dispatchEventFromSandbox(l,a)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)),this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class RadioButtonWidgetAnnotationElement extends WidgetAnnotationElement{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let i=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof i=="string"&&(i=i!==t.buttonValue,e.setValue(n,{value:i})),i)for(const a of this._getElementsByName(t.fieldName,n))e.setValue(a.id,{value:!1});const o=document.createElement("input");if(GetElementsByNameSet.add(o),o.setAttribute("data-element-id",n),o.disabled=t.readOnly,this._setRequired(o,this.data.required),o.type="radio",o.name=t.fieldName,i&&o.setAttribute("checked",!0),o.tabIndex=0,o.addEventListener("change",a=>{const{name:l,checked:h}=a.target;for(const d of this._getElementsByName(l,n))e.setValue(d.id,{value:!1});e.setValue(n,{value:h})}),o.addEventListener("resetform",a=>{const l=t.defaultFieldValue;a.target.checked=l!=null&&l===t.buttonValue}),this.enableScripting&&this.hasJSActions){const a=t.buttonValue;o.addEventListener("updatefromsandbox",l=>{const h={value:d=>{const u=a===d.detail.value;for(const f of this._getElementsByName(d.target.name)){const m=u&&f.id===n;f.domElement&&(f.domElement.checked=m),e.setValue(f.id,{value:m})}}};this._dispatchEventFromSandbox(h,l)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)}return this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class PushButtonWidgetAnnotationElement extends LinkAnnotationElement{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}}class ChoiceWidgetAnnotationElement extends WidgetAnnotationElement{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),i=document.createElement("select");GetElementsByNameSet.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,this._setRequired(i,this.data.required),i.name=this.data.fieldName,i.tabIndex=0;let o=this.data.combo&&this.data.options.length>0;this.data.combo||(i.size=this.data.options.length,this.data.multiSelect&&(i.multiple=!0)),i.addEventListener("resetform",u=>{const f=this.data.defaultFieldValue;for(const m of i.options)m.selected=m.value===f});for(const u of this.data.options){const f=document.createElement("option");f.textContent=u.displayValue,f.value=u.exportValue,n.value.includes(u.exportValue)&&(f.setAttribute("selected",!0),o=!1),i.append(f)}let a=null;if(o){const u=document.createElement("option");u.value=" ",u.setAttribute("hidden",!0),u.setAttribute("selected",!0),i.prepend(u),a=()=>{u.remove(),i.removeEventListener("input",a),a=null},i.addEventListener("input",a)}const l=u=>{const f=u?"value":"textContent",{options:m,multiple:v}=i;return v?Array.prototype.filter.call(m,g=>g.selected).map(g=>g[f]):m.selectedIndex===-1?null:m[m.selectedIndex][f]};let h=l(!1);const d=u=>{const f=u.target.options;return Array.prototype.map.call(f,m=>({displayValue:m.textContent,exportValue:m.value}))};return this.enableScripting&&this.hasJSActions?(i.addEventListener("updatefromsandbox",u=>{const f={value(m){a?.();const v=m.detail.value,g=new Set(Array.isArray(v)?v:[v]);for(const x of i.options)x.selected=g.has(x.value);e.setValue(t,{value:l(!0)}),h=l(!1)},multipleSelection(m){i.multiple=!0},remove(m){const v=i.options,g=m.detail.remove;v[g].selected=!1,i.remove(g),v.length>0&&Array.prototype.findIndex.call(v,E=>E.selected)===-1&&(v[0].selected=!0),e.setValue(t,{value:l(!0),items:d(m)}),h=l(!1)},clear(m){for(;i.length!==0;)i.remove(0);e.setValue(t,{value:null,items:[]}),h=l(!1)},insert(m){const{index:v,displayValue:g,exportValue:x}=m.detail.insert,E=i.children[v],b=document.createElement("option");b.textContent=g,b.value=x,E?E.before(b):i.append(b),e.setValue(t,{value:l(!0),items:d(m)}),h=l(!1)},items(m){const{items:v}=m.detail;for(;i.length!==0;)i.remove(0);for(const g of v){const{displayValue:x,exportValue:E}=g,b=document.createElement("option");b.textContent=x,b.value=E,i.append(b)}i.options.length>0&&(i.options[0].selected=!0),e.setValue(t,{value:l(!0),items:d(m)}),h=l(!1)},indices(m){const v=new Set(m.detail.indices);for(const g of m.target.options)g.selected=v.has(g.index);e.setValue(t,{value:l(!0)}),h=l(!1)},editable(m){m.target.disabled=!m.detail.editable}};this._dispatchEventFromSandbox(f,u)}),i.addEventListener("input",u=>{const f=l(!0),m=l(!1);e.setValue(t,{value:f}),u.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:h,change:m,changeEx:f,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(i,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],u=>u.target.value)):i.addEventListener("input",function(u){e.setValue(t,{value:l(!0)})}),this.data.combo&&this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class PopupAnnotationElement extends AnnotationElement{constructor(e){const{data:t,elements:n,parent:i}=e,o=!!i._commentManager;if(super(e,{isRenderable:!o&&AnnotationElement._hasPopupData(t)}),this.elements=n,o&&AnnotationElement._hasPopupData(t)){const a=this.popup=this.#e();for(const l of n)l.popup=a}else this.popup=null}#e(){return new PopupElement({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=this.#e(),n=[];for(const i of this.elements)i.popup=t,i.container.ariaHasPopup="dialog",n.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(i=>`${AnnotationPrefix}${i}`).join(",")),this.container}}class PopupElement{#e=null;#t=this.#z.bind(this);#n=this.#F.bind(this);#r=this.#O.bind(this);#s=this.#E.bind(this);#o=null;#i=null;#a=null;#c=null;#l=null;#h=null;#d=null;#f=!1;#g=null;#m=null;#u=null;#p=null;#v=null;#y=null;#x=null;#A=null;#w=null;#b=null;#P=!1;#_=null;#S=null;constructor({container:e,color:t,elements:n,titleObj:i,modificationDate:o,contentsObj:a,richText:l,parent:h,rect:d,parentRect:u,open:f,commentManager:m=null}){this.#i=e,this.#w=i,this.#a=a,this.#A=l,this.#h=h,this.#o=t,this.#x=d,this.#d=u,this.#l=n,this.#e=m,this.#_=n[0],this.#c=PDFDateString.toDateObject(o),this.trigger=n.flatMap(v=>v.getElementsToTriggerPopup()),m?this.renderCommentButton():(this.#T(),this.#i.hidden=!0,f&&this.#E())}#T(){if(this.#m)return;this.#m=new AbortController;const{signal:e}=this.#m;for(const t of this.trigger)t.addEventListener("click",this.#s,{signal:e}),t.addEventListener("pointerenter",this.#r,{signal:e}),t.addEventListener("pointerleave",this.#n,{signal:e}),t.classList.add("popupTriggerArea");for(const t of this.#l)t.container?.addEventListener("keydown",this.#t,{signal:e})}#k(){const e=this.#l.find(t=>t.hasCommentButton);e&&(this.#v=e._normalizePoint(e.commentButtonPosition))}renderCommentButton(){if(this.#p||(this.#v||this.#k(),!this.#v))return;const{signal:e}=this.#m=new AbortController,t=!!this.#_.extraPopupElement,n=()=>{this.#e.toggleCommentPopup(this,!0,void 0,!t)},i=()=>{this.#e.toggleCommentPopup(this,!1,!0,!t)},o=()=>{this.#e.toggleCommentPopup(this,!1,!1)};if(t){this.#p=this.#_.container;for(const a of this.trigger)a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.addEventListener("keydown",this.#t,{signal:e}),a.addEventListener("click",n,{signal:e}),a.addEventListener("pointerenter",i,{signal:e}),a.addEventListener("pointerleave",o,{signal:e}),a.classList.add("popupTriggerArea")}else{const a=this.#p=document.createElement("button");a.className="annotationCommentButton";const l=this.#_.container;a.style.zIndex=l.style.zIndex+1,a.tabIndex=0,a.ariaHasPopup="dialog",a.ariaControls="commentPopup",a.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#N(),this.#M(),a.addEventListener("keydown",this.#t,{signal:e}),a.addEventListener("click",n,{signal:e}),a.addEventListener("pointerenter",i,{signal:e}),a.addEventListener("pointerleave",o,{signal:e}),l.after(a)}}#M(){if(this.#_.extraPopupElement&&!this.#_.editor)return;this.renderCommentButton();const[e,t]=this.#v,{style:n}=this.#p;n.left=`calc(${e}%)`,n.top=`calc(${t}% - var(--comment-button-dim))`}#N(){this.#_.extraPopupElement||(this.renderCommentButton(),this.#p.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:e,opacity:t}=this.#_.commentData;return e?this.#h._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{this.#p?.focus()},0)}getData(){const{richText:e,color:t,opacity:n,creationDate:i,modificationDate:o}=this.#_.commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:n,creationDate:i,modificationDate:o}}get elementBeforePopup(){return this.#p}get comment(){return this.#S||=this.#_.commentText,this.#S}set comment(e){e!==this.comment&&(this.#_.commentText=this.#S=e)}get parentBoundingClientRect(){return this.#_.layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){this.#p&&(this.#p.classList.toggle("selected",e),this.#p.ariaExpanded=t)}setSelectedCommentButton(e){this.#p.classList.toggle("selected",e)}get commentPopupPosition(){if(this.#y)return this.#y;const{x:e,y:t,height:n}=this.#p.getBoundingClientRect(),{x:i,y:o,width:a,height:l}=this.#_.layer.getBoundingClientRect();return[(e-i)/a,(t+n-o)/l]}set commentPopupPosition(e){this.#y=e}hasDefaultPopupPosition(){return this.#y===null}get commentButtonPosition(){return this.#v}get commentButtonWidth(){return this.#p.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,n]=this.#y||this.commentButtonPosition.map(d=>d/100),i=this.parentBoundingClientRect,{x:o,y:a,width:l,height:h}=i;this.#e.showDialog(null,this,o+t*l,a+n*h,{...e,parentDimensions:i})}render(){if(this.#g)return;const e=this.#g=document.createElement("div");if(e.className="popup",this.#o){const n=e.style.outlineColor=Util.makeHexColor(...this.#o);e.style.backgroundColor=`color-mix(in srgb, ${n} 30%, white)`}const t=document.createElement("span");if(t.className="header",this.#w?.str){const n=document.createElement("span");n.className="title",t.append(n),{dir:n.dir,str:n.textContent}=this.#w}if(e.append(t),this.#c){const n=document.createElement("time");n.className="popupDate",n.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),n.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),n.dateTime=this.#c.toISOString(),t.append(n)}renderRichText({html:this.#R||this.#a.str,dir:this.#a?.dir,className:"popupContent"},e),this.#i.append(e)}get#R(){const e=this.#A,t=this.#a;return e?.str&&(!t?.str||t.str===e.str)&&this.#A.html||null}get#D(){return this.#R?.attributes?.style?.fontSize||0}get#I(){return this.#R?.attributes?.style?.color||null}#L(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},i={style:{color:this.#I,fontSize:this.#D?`calc(${this.#D}px * var(--total-scale-factor))`:""}};for(const o of e.split(`
`))t.push({name:"span",value:o,attributes:i});return n}#z(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#f)&&this.#E()}updateEdited({rect:e,popup:t,deleted:n}){if(this.#e){n?(this.remove(),this.#S=null):t&&(t.deleted?this.remove():(this.#N(),this.#S=t.text)),e&&(this.#v=null,this.#k(),this.#M());return}if(n||t?.deleted){this.remove();return}this.#T(),this.#b||={contentsObj:this.#a,richText:this.#A},e&&(this.#u=null),t&&t.text&&(this.#A=this.#L(t.text),this.#c=PDFDateString.toDateObject(t.date),this.#a=null),this.#g?.remove(),this.#g=null}resetEdited(){this.#b&&({contentsObj:this.#a,richText:this.#A}=this.#b,this.#b=null,this.#g?.remove(),this.#g=null,this.#u=null)}remove(){if(this.#m?.abort(),this.#m=null,this.#g?.remove(),this.#g=null,this.#P=!1,this.#f=!1,this.#p?.remove(),this.#p=null,this.trigger)for(const e of this.trigger)e.classList.remove("popupTriggerArea")}#C(){if(this.#u!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:i,pageY:o}}}=this.#h;let a=!!this.#d,l=a?this.#d:this.#x;for(const g of this.#l)if(!l||Util.intersect(g.data.rect,l)!==null){l=g.data.rect,a=!0;break}const h=Util.normalizeRect([l[0],e[3]-l[1]+e[1],l[2],e[3]-l[3]+e[1]]),u=a?l[2]-l[0]+5:0,f=h[0]+u,m=h[1];this.#u=[100*(f-i)/t,100*(m-o)/n];const{style:v}=this.#i;v.left=`${this.#u[0]}%`,v.top=`${this.#u[1]}%`}#E(){if(this.#e){this.#e.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#O(),this.#i.addEventListener("click",this.#s),this.#i.addEventListener("keydown",this.#t)):(this.#F(),this.#i.removeEventListener("click",this.#s),this.#i.removeEventListener("keydown",this.#t))}#O(){this.#g||this.render(),this.isVisible?this.#f&&this.#i.classList.add("focused"):(this.#C(),this.#i.hidden=!1,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)+1e3)}#F(){this.#i.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#i.hidden=!0,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)-1e3)}forceHide(){this.#P=this.isVisible,this.#P&&(this.#i.hidden=!0)}maybeShow(){this.#e||(this.#T(),this.#P&&(this.#g||this.#O(),this.#P=!1,this.#i.hidden=!1))}get isVisible(){return this.#e?!1:this.#i.hidden===!1}}class FreeTextAnnotationElement extends AnnotationElement{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class LineAnnotationElement extends AnnotationElement{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:e,width:t,height:n}=this,i=this.svgFactory.create(t,n,!0),o=this.#e=this.svgFactory.createElement("svg:line");return o.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),o.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),o.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),o.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),o.setAttribute("stroke-width",e.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),i.append(o),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class SquareAnnotationElement extends AnnotationElement{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:e,width:t,height:n}=this,i=this.svgFactory.create(t,n,!0),o=e.borderStyle.width,a=this.#e=this.svgFactory.createElement("svg:rect");return a.setAttribute("x",o/2),a.setAttribute("y",o/2),a.setAttribute("width",t-o),a.setAttribute("height",n-o),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class CircleAnnotationElement extends AnnotationElement{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:e,width:t,height:n}=this,i=this.svgFactory.create(t,n,!0),o=e.borderStyle.width,a=this.#e=this.svgFactory.createElement("svg:ellipse");return a.setAttribute("cx",t/2),a.setAttribute("cy",n/2),a.setAttribute("rx",t/2-o/2),a.setAttribute("ry",n/2-o/2),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),i.append(a),this.container.append(i),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class PolylineAnnotationElement extends AnnotationElement{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:n,popupRef:i},width:o,height:a}=this;if(!t)return this.container;const l=this.svgFactory.create(o,a,!0);let h=[];for(let u=0,f=t.length;u<f;u+=2){const m=t[u]-e[0],v=e[3]-t[u+1];h.push(`${m},${v}`)}h=h.join(" ");const d=this.#e=this.svgFactory.createElement(this.svgElementName);return d.setAttribute("points",h),d.setAttribute("stroke-width",n.width||1),d.setAttribute("stroke","transparent"),d.setAttribute("fill","transparent"),l.append(d),this.container.append(l),!i&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class PolygonAnnotationElement extends PolylineAnnotationElement{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class CaretAnnotationElement extends AnnotationElement{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class InkAnnotationElement extends AnnotationElement{#e=null;#t=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?AnnotationEditorType.HIGHLIGHT:AnnotationEditorType.INK}#n(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:n,borderStyle:i,popupRef:o}}=this,{transform:a,width:l,height:h}=this.#n(t,e),d=this.svgFactory.create(l,h,!0),u=this.#e=this.svgFactory.createElement("svg:g");d.append(u),u.setAttribute("stroke-width",i.width||1),u.setAttribute("stroke-linecap","round"),u.setAttribute("stroke-linejoin","round"),u.setAttribute("stroke-miterlimit",10),u.setAttribute("stroke","transparent"),u.setAttribute("fill","transparent"),u.setAttribute("transform",a);for(let f=0,m=n.length;f<m;f++){const v=this.svgFactory.createElement(this.svgElementName);this.#t.push(v),v.setAttribute("points",n[f].join(",")),u.append(v)}return!o&&this.hasPopupData&&this._createPopup(),this.container.append(d),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:n,rect:i}=e,o=this.#e;if(t>=0&&o.setAttribute("stroke-width",t||1),n)for(let a=0,l=this.#t.length;a<l;a++)this.#t[a].setAttribute("points",n[a].join(","));if(i){const{transform:a,width:l,height:h}=this.#n(this.data.rotation,i);o.parentElement.setAttribute("viewBox",`0 0 ${l} ${h}`),o.setAttribute("transform",a)}}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class HighlightAnnotationElement extends AnnotationElement{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=AnnotationEditorType.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class UnderlineAnnotationElement extends AnnotationElement{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class SquigglyAnnotationElement extends AnnotationElement{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class StrikeOutAnnotationElement extends AnnotationElement{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),e){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class StampAnnotationElement extends AnnotationElement{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=AnnotationEditorType.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class FileAttachmentAnnotationElement extends AnnotationElement{#e=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let n;t.hasAppearance||t.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),n.addEventListener("dblclick",this.#t.bind(this)),this.#e=n;const{isMac:i}=util_FeatureTest.platform;return e.addEventListener("keydown",o=>{o.key==="Enter"&&(i?o.metaKey:o.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}let AnnotationLayer$1=class bc{#e=null;#t=null;#n=null;#r=new Map;#s=null;#o=null;constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:i,page:o,viewport:a,structTreeLayer:l,commentManager:h,linkService:d,annotationStorage:u}){this.div=e,this.#e=t,this.#t=n,this.#s=l||null,this.#o=d||null,this.#n=u||new AnnotationStorage,this.page=o,this.viewport=a,this.zIndex=0,this._annotationEditorUIManager=i,this._commentManager=h||null}hasEditableAnnotations(){return this.#r.size>0}async#i(e,t,n){const i=e.firstChild||e,o=i.id=`${AnnotationPrefix}${t}`,a=await this.#s?.getAriaAttributes(o);if(a)for(const[l,h]of a)i.setAttribute(l,h);n?n.at(-1).container.after(e):(this.div.append(e),this.#e?.moveElementInDOM(this.div,e,i,!1))}async render(e){const{annotations:t}=e,n=this.div;setLayerDimensions(n,this.viewport);const i=new Map,o={data:null,layer:n,linkService:this.#o,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new DOMSVGFactory,annotationStorage:this.#n,enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const a of t){if(a.noHTML)continue;const l=a.annotationType===AnnotationType.POPUP;if(l){const u=i.get(a.id);if(!u)continue;o.elements=u}else if(a.rect[2]===a.rect[0]||a.rect[3]===a.rect[1])continue;o.data=a;const h=AnnotationElementFactory.create(o);if(!h.isRenderable)continue;if(!l&&a.popupRef){const u=i.get(a.popupRef);u?u.push(h):i.set(a.popupRef,[h])}const d=h.render();a.hidden&&(d.style.visibility="hidden"),await this.#i(d,a.id,o.elements),h.extraPopupElement?.popup?.renderCommentButton(),h._isEditable&&(this.#r.set(h.data.id,h),this._annotationEditorUIManager?.renderAnnotationElement(h))}this.#a()}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:this.#o,svgFactory:new DOMSVGFactory,parent:this};for(const n of e){n.borderStyle||=bc._defaultBorderStyle,t.data=n;const i=AnnotationElementFactory.create(t);if(!i.isRenderable)continue;const o=i.render();await this.#i(o,n.id,null)}}update({viewport:e}){const t=this.div;this.viewport=e,setLayerDimensions(t,{rotation:e.rotation}),this.#a(),t.hidden=!1}#a(){if(!this.#t)return;const e=this.div;for(const[t,n]of this.#t){const i=e.querySelector(`[data-annotation-id="${t}"]`);if(!i)continue;n.className="annotationContent";const{firstChild:o}=i;o?o.nodeName==="CANVAS"?o.replaceWith(n):o.classList.contains("annotationContent")?o.after(n):o.before(n):i.append(n);const a=this.#r.get(t);a&&(a._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(t,i.id,n),a._hasNoCanvas=!1):a.canvas=n)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#r.values())}getEditableAnnotation(e){return this.#r.get(e)}addFakeAnnotation(e){const{div:t}=this,{id:n,rotation:i}=e,o=new EditorAnnotationElement({data:{id:n,rect:e.getPDFRect(),rotation:i},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:this.#o,annotationStorage:this.#n}),a=o.render();return t.append(a),this.#e?.moveElementInDOM(t,a,a,!1),o.createOrUpdatePopup(),o}static get _defaultBorderStyle(){return shadow(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:AnnotationBorderStyleType.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};const EOL_PATTERN=/\r\n?|\n/g;class FreeTextEditor extends AnnotationEditor{#e="";#t=`${this.id}-editor`;#n=null;#r;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=FreeTextEditor.prototype,t=o=>o.isEmpty(),n=AnnotationEditorUIManager.TRANSLATE_SMALL,i=AnnotationEditorUIManager.TRANSLATE_BIG;return shadow(this,"_keyboardManager",new KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-i,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[i,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-i],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,i],checker:t}]]))}static _type="freetext";static _editorType=AnnotationEditorType.FREETEXT;constructor(e){super({...e,name:"freeTextEditor"}),this.color=e.color||FreeTextEditor._defaultColor||AnnotationEditor._defaultLineColor,this.#r=e.fontSize||FreeTextEditor._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static initialize(e,t){AnnotationEditor.initialize(e,t);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case AnnotationEditorParamsType.FREETEXT_SIZE:FreeTextEditor._defaultFontSize=t;break;case AnnotationEditorParamsType.FREETEXT_COLOR:FreeTextEditor._defaultColor=t;break}}updateParams(e,t){switch(e){case AnnotationEditorParamsType.FREETEXT_SIZE:this.#s(t);break;case AnnotationEditorParamsType.FREETEXT_COLOR:this.#o(t);break}}static get defaultPropertiesToUpdate(){return[[AnnotationEditorParamsType.FREETEXT_SIZE,FreeTextEditor._defaultFontSize],[AnnotationEditorParamsType.FREETEXT_COLOR,FreeTextEditor._defaultColor||AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[AnnotationEditorParamsType.FREETEXT_SIZE,this.#r],[AnnotationEditorParamsType.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new BasicColorPicker(this),[["colorPicker",this._colorPicker]]}get colorType(){return AnnotationEditorParamsType.FREETEXT_COLOR}#s(e){const t=i=>{this.editorDiv.style.fontSize=`calc(${i}px * var(--total-scale-factor))`,this.translate(0,-(i-this.#r)*this.parentScale),this.#r=i,this.#a()},n=this.#r;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#o(e){const t=i=>{this.color=i,this.onUpdatedColor()},n=this.color;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-FreeTextEditor._internalPadding*e,-(FreeTextEditor._internalPadding+this.#r)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#n=new AbortController;const e=this._uiManager.combinedSignal(this.#n);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#t),this._isDraggable=!0,this.#n?.abort(),this.#n=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#i(){const e=[];this.editorDiv.normalize();let t=null;for(const n of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&n.nodeName==="BR"||(e.push(FreeTextEditor.#c(n)),t=n);return e.join(`
`)}#a(){const[e,t]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:i,div:o}=this,a=o.style.display,l=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",i.div.append(this.div),n=o.getBoundingClientRect(),o.remove(),o.style.display=a,o.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=n.width/e,this.height=n.height/t):(this.width=n.height/e,this.height=n.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#e,t=this.#e=this.#i().trimEnd();if(e===t)return;const n=i=>{if(this.#e=i,!i){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#a()};this.addCommands({cmd:()=>{n(t)},undo:()=>{n(e)},mustExec:!1}),this.#a()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){FreeTextEditor._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,t;(this._isCopy||this.annotationElementId)&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#t),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#r}px * var(--total-scale-factor))`,n.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[i,o]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this._initialData;let[l,h]=this.getInitialTranslation();[l,h]=this.pageTranslationToScreen(l,h);const[d,u]=this.pageDimensions,[f,m]=this.pageTranslation;let v,g;switch(this.rotation){case 0:v=e+(a[0]-f)/d,g=t+this.height-(a[1]-m)/u;break;case 90:v=e+(a[0]-f)/d,g=t-(a[1]-m)/u,[l,h]=[h,-l];break;case 180:v=e-this.width+(a[0]-f)/d,g=t-(a[1]-m)/u,[l,h]=[-l,-h];break;case 270:v=e+(a[0]-f-this.height*u)/d,g=t+(a[1]-m-this.width*d)/u,[l,h]=[-h,l];break}this.setAt(v*i,g*o,l,h)}else this._moveAfterPaste(e,t);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(EOL_PATTERN,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:n}=t;if(n.length===1&&n[0]==="text/plain")return;e.preventDefault();const i=FreeTextEditor.#d(t.getData("text")||"").replaceAll(EOL_PATTERN,`
`);if(!i)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const a=o.getRangeAt(0);if(!i.includes(`
`)){a.insertNode(document.createTextNode(i)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:l,startOffset:h}=a,d=[],u=[];if(l.nodeType===Node.TEXT_NODE){const v=l.parentElement;if(u.push(l.nodeValue.slice(h).replaceAll(EOL_PATTERN,"")),v!==this.editorDiv){let g=d;for(const x of this.editorDiv.childNodes){if(x===v){g=u;continue}g.push(FreeTextEditor.#c(x))}}d.push(l.nodeValue.slice(0,h).replaceAll(EOL_PATTERN,""))}else if(l===this.editorDiv){let v=d,g=0;for(const x of this.editorDiv.childNodes)g++===h&&(v=u),v.push(FreeTextEditor.#c(x))}this.#e=`${d.join(`
`)}${i}${u.join(`
`)}`,this.#l();const f=new Range;let m=Math.sumPrecise(d.map(v=>v.length));for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const g=v.nodeValue.length;if(m<=g){f.setStart(v,m),f.setEnd(v,m);break}m-=g}o.removeAllRanges(),o.addRange(f)}#l(){if(this.editorDiv.replaceChildren(),!!this.#e)for(const e of this.#e.split(`
`)){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#h(){return this.#e.replaceAll(""," ")}static#d(e){return e.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const e=FreeTextEditor._internalPadding*this.parentScale;return this.getRect(e,e)}static async deserialize(e,t,n){let i=null;if(e instanceof FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:a,fontColor:l},rect:h,rotation:d,id:u,popupRef:f,richText:m,contentsObj:v,creationDate:g,modificationDate:x},textContent:E,textPosition:b,parent:{page:{pageNumber:_}}}=e;if(!E||E.length===0)return null;i=e={annotationType:AnnotationEditorType.FREETEXT,color:Array.from(l),fontSize:a,value:E.join(`
`),position:b,pageIndex:_-1,rect:h.slice(0),rotation:d,annotationElementId:u,id:u,deleted:!1,popupRef:f,comment:v?.str||null,richText:m,creationDate:g,modificationDate:x}}const o=await super.deserialize(e,t,n);return o.#r=e.fontSize,o.color=Util.makeHexColor(...e.color),o.#e=FreeTextEditor.#d(e.value),o._initialData=i,e.comment&&o.setCommentData(e),o}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),n=Object.assign(super.serialize(e),{color:t,fontSize:this.#r,value:this.#h()});return this.addComment(n),e?(n.isCopy=!0,n):this.annotationElementId&&!this.#f(n)?null:(n.id=this.annotationElementId,n)}#f(e){const{value:t,fontSize:n,color:i,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||e.value!==t||e.fontSize!==n||e.color.some((a,l)=>a!==i[l])||e.pageIndex!==o}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(!t)return null;const{style:n}=t;n.fontSize=`calc(${this.#r}px * var(--total-scale-factor))`,n.color=this.color,t.replaceChildren();for(const i of this.#e.split(`
`)){const o=document.createElement("div");o.append(i?document.createTextNode(i):document.createElement("br")),t.append(o)}return e.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#e}}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class Outline{static PRECISION=1e-4;toSVGPath(){unreachable("Abstract method `toSVGPath` must be implemented.")}get box(){unreachable("Abstract getter `box` must be implemented.")}serialize(e,t){unreachable("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,i,o,a){a||=new Float32Array(e.length);for(let l=0,h=e.length;l<h;l+=2)a[l]=t+e[l]*i,a[l+1]=n+e[l+1]*o;return a}static _rescaleAndSwap(e,t,n,i,o,a){a||=new Float32Array(e.length);for(let l=0,h=e.length;l<h;l+=2)a[l]=t+e[l+1]*i,a[l+1]=n+e[l]*o;return a}static _translate(e,t,n,i){i||=new Float32Array(e.length);for(let o=0,a=e.length;o<a;o+=2)i[o]=t+e[o],i[o+1]=n+e[o+1];return i}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,n,i,o){switch(o){case 90:return[1-t/n,e/i];case 180:return[1-e/n,1-t/i];case 270:return[t/n,1-e/i];default:return[e/n,t/i]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,i,o,a){return[(e+5*n)/6,(t+5*i)/6,(5*n+o)/6,(5*i+a)/6,(n+o)/2,(i+a)/2]}}class FreeDrawOutliner{#e;#t=[];#n;#r;#s=[];#o=new Float32Array(18);#i;#a;#c;#l;#h;#d;#f=[];static#g=8;static#m=2;static#u=FreeDrawOutliner.#g+FreeDrawOutliner.#m;constructor({x:e,y:t},n,i,o,a,l=0){this.#e=n,this.#d=o*i,this.#r=a,this.#o.set([NaN,NaN,NaN,NaN,e,t],6),this.#n=l,this.#l=FreeDrawOutliner.#g*i,this.#c=FreeDrawOutliner.#u*i,this.#h=i,this.#f.push(e,t)}isEmpty(){return isNaN(this.#o[8])}#p(){const e=this.#o.subarray(4,6),t=this.#o.subarray(16,18),[n,i,o,a]=this.#e;return[(this.#i+(e[0]-t[0])/2-n)/o,(this.#a+(e[1]-t[1])/2-i)/a,(this.#i+(t[0]-e[0])/2-n)/o,(this.#a+(t[1]-e[1])/2-i)/a]}add({x:e,y:t}){this.#i=e,this.#a=t;const[n,i,o,a]=this.#e;let[l,h,d,u]=this.#o.subarray(8,12);const f=e-d,m=t-u,v=Math.hypot(f,m);if(v<this.#c)return!1;const g=v-this.#l,x=g/v,E=x*f,b=x*m;let _=l,S=h;l=d,h=u,d+=E,u+=b,this.#f?.push(e,t);const C=-b/g,A=E/g,R=C*this.#d,L=A*this.#d;return this.#o.set(this.#o.subarray(2,8),0),this.#o.set([d+R,u+L],4),this.#o.set(this.#o.subarray(14,18),12),this.#o.set([d-R,u-L],16),isNaN(this.#o[6])?(this.#s.length===0&&(this.#o.set([l+R,h+L],2),this.#s.push(NaN,NaN,NaN,NaN,(l+R-n)/o,(h+L-i)/a),this.#o.set([l-R,h-L],14),this.#t.push(NaN,NaN,NaN,NaN,(l-R-n)/o,(h-L-i)/a)),this.#o.set([_,S,l,h,d,u],6),!this.isEmpty()):(this.#o.set([_,S,l,h,d,u],6),Math.abs(Math.atan2(S-h,_-l)-Math.atan2(b,E))<Math.PI/2?([l,h,d,u]=this.#o.subarray(2,6),this.#s.push(NaN,NaN,NaN,NaN,((l+d)/2-n)/o,((h+u)/2-i)/a),[l,h,_,S]=this.#o.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((_+l)/2-n)/o,((S+h)/2-i)/a),!0):([_,S,l,h,d,u]=this.#o.subarray(0,6),this.#s.push(((_+5*l)/6-n)/o,((S+5*h)/6-i)/a,((5*l+d)/6-n)/o,((5*h+u)/6-i)/a,((l+d)/2-n)/o,((h+u)/2-i)/a),[d,u,l,h,_,S]=this.#o.subarray(12,18),this.#t.push(((_+5*l)/6-n)/o,((S+5*h)/6-i)/a,((5*l+d)/6-n)/o,((5*h+u)/6-i)/a,((l+d)/2-n)/o,((h+u)/2-i)/a),!0))}toSVGPath(){if(this.isEmpty())return"";const e=this.#s,t=this.#t;if(isNaN(this.#o[6])&&!this.isEmpty())return this.#v();const n=[];n.push(`M${e[4]} ${e[5]}`);for(let i=6;i<e.length;i+=6)isNaN(e[i])?n.push(`L${e[i+4]} ${e[i+5]}`):n.push(`C${e[i]} ${e[i+1]} ${e[i+2]} ${e[i+3]} ${e[i+4]} ${e[i+5]}`);this.#x(n);for(let i=t.length-6;i>=6;i-=6)isNaN(t[i])?n.push(`L${t[i+4]} ${t[i+5]}`):n.push(`C${t[i]} ${t[i+1]} ${t[i+2]} ${t[i+3]} ${t[i+4]} ${t[i+5]}`);return this.#y(n),n.join(" ")}#v(){const[e,t,n,i]=this.#e,[o,a,l,h]=this.#p();return`M${(this.#o[2]-e)/n} ${(this.#o[3]-t)/i} L${(this.#o[4]-e)/n} ${(this.#o[5]-t)/i} L${o} ${a} L${l} ${h} L${(this.#o[16]-e)/n} ${(this.#o[17]-t)/i} L${(this.#o[14]-e)/n} ${(this.#o[15]-t)/i} Z`}#y(e){const t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#x(e){const[t,n,i,o]=this.#e,a=this.#o.subarray(4,6),l=this.#o.subarray(16,18),[h,d,u,f]=this.#p();e.push(`L${(a[0]-t)/i} ${(a[1]-n)/o} L${h} ${d} L${u} ${f} L${(l[0]-t)/i} ${(l[1]-n)/o}`)}newFreeDrawOutline(e,t,n,i,o,a){return new FreeDrawOutline(e,t,n,i,o,a)}getOutlines(){const e=this.#s,t=this.#t,n=this.#o,[i,o,a,l]=this.#e,h=new Float32Array((this.#f?.length??0)+2);for(let f=0,m=h.length-2;f<m;f+=2)h[f]=(this.#f[f]-i)/a,h[f+1]=(this.#f[f+1]-o)/l;if(h[h.length-2]=(this.#i-i)/a,h[h.length-1]=(this.#a-o)/l,isNaN(n[6])&&!this.isEmpty())return this.#A(h);const d=new Float32Array(this.#s.length+24+this.#t.length);let u=e.length;for(let f=0;f<u;f+=2){if(isNaN(e[f])){d[f]=d[f+1]=NaN;continue}d[f]=e[f],d[f+1]=e[f+1]}u=this.#b(d,u);for(let f=t.length-6;f>=6;f-=6)for(let m=0;m<6;m+=2){if(isNaN(t[f+m])){d[u]=d[u+1]=NaN,u+=2;continue}d[u]=t[f+m],d[u+1]=t[f+m+1],u+=2}return this.#w(d,u),this.newFreeDrawOutline(d,h,this.#e,this.#h,this.#n,this.#r)}#A(e){const t=this.#o,[n,i,o,a]=this.#e,[l,h,d,u]=this.#p(),f=new Float32Array(36);return f.set([NaN,NaN,NaN,NaN,(t[2]-n)/o,(t[3]-i)/a,NaN,NaN,NaN,NaN,(t[4]-n)/o,(t[5]-i)/a,NaN,NaN,NaN,NaN,l,h,NaN,NaN,NaN,NaN,d,u,NaN,NaN,NaN,NaN,(t[16]-n)/o,(t[17]-i)/a,NaN,NaN,NaN,NaN,(t[14]-n)/o,(t[15]-i)/a],0),this.newFreeDrawOutline(f,e,this.#e,this.#h,this.#n,this.#r)}#w(e,t){const n=this.#t;return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+=6}#b(e,t){const n=this.#o.subarray(4,6),i=this.#o.subarray(16,18),[o,a,l,h]=this.#e,[d,u,f,m]=this.#p();return e.set([NaN,NaN,NaN,NaN,(n[0]-o)/l,(n[1]-a)/h,NaN,NaN,NaN,NaN,d,u,NaN,NaN,NaN,NaN,f,m,NaN,NaN,NaN,NaN,(i[0]-o)/l,(i[1]-a)/h],t),t+=24}}class FreeDrawOutline extends Outline{#e;#t=new Float32Array(4);#n;#r;#s;#o;#i;constructor(e,t,n,i,o,a){super(),this.#i=e,this.#s=t,this.#e=n,this.#o=i,this.#n=o,this.#r=a,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#a(a);const[l,h,d,u]=this.#t;for(let f=0,m=e.length;f<m;f+=2)e[f]=(e[f]-l)/d,e[f+1]=(e[f+1]-h)/u;for(let f=0,m=t.length;f<m;f+=2)t[f]=(t[f]-l)/d,t[f+1]=(t[f+1]-h)/u}toSVGPath(){const e=[`M${this.#i[4]} ${this.#i[5]}`];for(let t=6,n=this.#i.length;t<n;t+=6){if(isNaN(this.#i[t])){e.push(`L${this.#i[t+4]} ${this.#i[t+5]}`);continue}e.push(`C${this.#i[t]} ${this.#i[t+1]} ${this.#i[t+2]} ${this.#i[t+3]} ${this.#i[t+4]} ${this.#i[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,n,i],o){const a=n-e,l=i-t;let h,d;switch(o){case 0:h=Outline._rescale(this.#i,e,i,a,-l),d=Outline._rescale(this.#s,e,i,a,-l);break;case 90:h=Outline._rescaleAndSwap(this.#i,e,t,a,l),d=Outline._rescaleAndSwap(this.#s,e,t,a,l);break;case 180:h=Outline._rescale(this.#i,n,t,-a,l),d=Outline._rescale(this.#s,n,t,-a,l);break;case 270:h=Outline._rescaleAndSwap(this.#i,n,i,-a,-l),d=Outline._rescaleAndSwap(this.#s,n,i,-a,-l);break}return{outline:Array.from(h),points:[Array.from(d)]}}#a(e){const t=this.#i;let n=t[4],i=t[5];const o=[n,i,n,i];let a=n,l=i,h=n,d=i;const u=e?Math.max:Math.min,f=new Float32Array(4);for(let v=6,g=t.length;v<g;v+=6){const x=t[v+4],E=t[v+5];isNaN(t[v])?(Util.pointBoundingBox(x,E,o),l>E?(a=x,l=E):l===E&&(a=u(a,x)),d<E?(h=x,d=E):d===E&&(h=u(h,x))):(f[0]=f[1]=1/0,f[2]=f[3]=-1/0,Util.bezierBoundingBox(n,i,...t.slice(v,v+6),f),Util.rectBoundingBox(f[0],f[1],f[2],f[3],o),l>f[1]?(a=f[0],l=f[1]):l===f[1]&&(a=u(a,f[0])),d<f[3]?(h=f[2],d=f[3]):d===f[3]&&(h=u(h,f[2]))),n=x,i=E}const m=this.#t;m[0]=o[0]-this.#n,m[1]=o[1]-this.#n,m[2]=o[2]-o[0]+2*this.#n,m[3]=o[3]-o[1]+2*this.#n,this.firstPoint=[a,l],this.lastPoint=[h,d]}get box(){return this.#t}newOutliner(e,t,n,i,o,a=0){return new FreeDrawOutliner(e,t,n,i,o,a)}getNewOutline(e,t){const[n,i,o,a]=this.#t,[l,h,d,u]=this.#e,f=o*d,m=a*u,v=n*d+l,g=i*u+h,x=this.newOutliner({x:this.#s[0]*f+v,y:this.#s[1]*m+g},this.#e,this.#o,e,this.#r,t??this.#n);for(let E=2;E<this.#s.length;E+=2)x.add({x:this.#s[E]*f+v,y:this.#s[E+1]*m+g});return x.getOutlines()}}class HighlightOutliner{#e;#t;#n;#r=[];#s=[];constructor(e,t=0,n=0,i=!0){const o=[1/0,1/0,-1/0,-1/0],a=10**-4;for(const{x,y:E,width:b,height:_}of e){const S=Math.floor((x-t)/a)*a,C=Math.ceil((x+b+t)/a)*a,A=Math.floor((E-t)/a)*a,R=Math.ceil((E+_+t)/a)*a,L=[S,A,R,!0],j=[C,A,R,!1];this.#r.push(L,j),Util.rectBoundingBox(S,A,C,R,o)}const l=o[2]-o[0]+2*n,h=o[3]-o[1]+2*n,d=o[0]-n,u=o[1]-n;let f=i?-1/0:1/0,m=1/0;const v=this.#r.at(i?-1:-2),g=[v[0],v[2]];for(const x of this.#r){const[E,b,_,S]=x;!S&&i?b<m?(m=b,f=E):b===m&&(f=Math.max(f,E)):S&&!i&&(b<m?(m=b,f=E):b===m&&(f=Math.min(f,E))),x[0]=(E-d)/l,x[1]=(b-u)/h,x[2]=(_-u)/h}this.#e=new Float32Array([d,u,l,h]),this.#t=[f,m],this.#n=g}getOutlines(){this.#r.sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);const e=[];for(const t of this.#r)t[3]?(e.push(...this.#l(t)),this.#a(t)):(this.#c(t),e.push(...this.#l(t)));return this.#o(e)}#o(e){const t=[],n=new Set;for(const a of e){const[l,h,d]=a;t.push([l,h,a],[l,d,a])}t.sort((a,l)=>a[1]-l[1]||a[0]-l[0]);for(let a=0,l=t.length;a<l;a+=2){const h=t[a][2],d=t[a+1][2];h.push(d),d.push(h),n.add(h),n.add(d)}const i=[];let o;for(;n.size>0;){const a=n.values().next().value;let[l,h,d,u,f]=a;n.delete(a);let m=l,v=h;for(o=[l,d],i.push(o);;){let g;if(n.has(u))g=u;else if(n.has(f))g=f;else break;n.delete(g),[l,h,d,u,f]=g,m!==l&&(o.push(m,v,l,v===h?h:d),m=l),v=v===h?d:h}o.push(m,v)}return new HighlightOutline(i,this.#e,this.#t,this.#n)}#i(e){const t=this.#s;let n=0,i=t.length-1;for(;n<=i;){const o=n+i>>1,a=t[o][0];if(a===e)return o;a<e?n=o+1:i=o-1}return i+1}#a([,e,t]){const n=this.#i(e);this.#s.splice(n,0,[e,t])}#c([,e,t]){const n=this.#i(e);for(let i=n;i<this.#s.length;i++){const[o,a]=this.#s[i];if(o!==e)break;if(o===e&&a===t){this.#s.splice(i,1);return}}for(let i=n-1;i>=0;i--){const[o,a]=this.#s[i];if(o!==e)break;if(o===e&&a===t){this.#s.splice(i,1);return}}}#l(e){const[t,n,i]=e,o=[[t,n,i]],a=this.#i(i);for(let l=0;l<a;l++){const[h,d]=this.#s[l];for(let u=0,f=o.length;u<f;u++){const[,m,v]=o[u];if(!(d<=m||v<=h)){if(m>=h){if(v>d)o[u][1]=d;else{if(f===1)return[];o.splice(u,1),u--,f--}continue}o[u][2]=h,v>d&&o.push([t,d,v])}}}return o}}class HighlightOutline extends Outline{#e;#t;constructor(e,t,n,i){super(),this.#t=e,this.#e=t,this.firstPoint=n,this.lastPoint=i}toSVGPath(){const e=[];for(const t of this.#t){let[n,i]=t;e.push(`M${n} ${i}`);for(let o=2;o<t.length;o+=2){const a=t[o],l=t[o+1];a===n?(e.push(`V${l}`),i=l):l===i&&(e.push(`H${a}`),n=a)}e.push("Z")}return e.join(" ")}serialize([e,t,n,i],o){const a=[],l=n-e,h=i-t;for(const d of this.#t){const u=new Array(d.length);for(let f=0;f<d.length;f+=2)u[f]=e+d[f]*l,u[f+1]=i-d[f+1]*h;a.push(u)}return a}get box(){return this.#e}get classNamesForOutlining(){return["highlightOutline"]}}class FreeHighlightOutliner extends FreeDrawOutliner{newFreeDrawOutline(e,t,n,i,o,a){return new FreeHighlightOutline(e,t,n,i,o,a)}}class FreeHighlightOutline extends FreeDrawOutline{newOutliner(e,t,n,i,o,a=0){return new FreeHighlightOutliner(e,t,n,i,o,a)}}class HighlightEditor extends AnnotationEditor{#e=null;#t=0;#n;#r=null;#s=null;#o=null;#i=null;#a=0;#c=null;#l=null;#h=null;#d=!1;#f=null;#g=null;#m=null;#u="";#p;#v="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=AnnotationEditorType.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=HighlightEditor.prototype;return shadow(this,"_keyboardManager",new KeyboardManager([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||HighlightEditor._defaultColor,this.#p=e.thickness||HighlightEditor._defaultThickness,this.opacity=e.opacity||HighlightEditor._defaultOpacity,this.#n=e.boxes||null,this.#v=e.methodOfCreation||"",this.#u=e.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(this.#d=!0,this.#x(e),this.#_()):this.#n&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#i=e.focusNode,this.#a=e.focusOffset,this.#y(),this.#_(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#d?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#p,methodOfCreation:this.#v}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#y(){const e=new HighlightOutliner(this.#n,.001);this.#l=e.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const t=new HighlightOutliner(this.#n,.0025,.001,this._uiManager.direction==="ltr");this.#o=t.getOutlines();const{firstPoint:n}=this.#l;this.#f=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height];const{lastPoint:i}=this.#o;this.#g=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height]}#x({highlightOutlines:e,highlightId:t,clipPathId:n}){this.#l=e;const i=1.5;if(this.#o=e.getNewOutline(this.#p/2+i,.0025),t>=0)this.#h=t,this.#r=n,this.parent.drawLayer.finalizeDraw(t,{bbox:e.box,path:{d:e.toSVGPath()}}),this.#m=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#o.box,path:{d:this.#o.toSVGPath()}},!0);else if(this.parent){const f=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#h,{bbox:HighlightEditor.#S(this.#l.box,(f-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#m,{bbox:HighlightEditor.#S(this.#o.box,f),path:{d:this.#o.toSVGPath()}})}const[o,a,l,h]=e.box;switch(this.rotation){case 0:this.x=o,this.y=a,this.width=l,this.height=h;break;case 90:{const[f,m]=this.parentDimensions;this.x=a,this.y=1-o,this.width=l*m/f,this.height=h*f/m;break}case 180:this.x=1-o,this.y=1-a,this.width=l,this.height=h;break;case 270:{const[f,m]=this.parentDimensions;this.x=1-a,this.y=o,this.width=l*m/f,this.height=h*f/m;break}}const{firstPoint:d}=e;this.#f=[(d[0]-o)/l,(d[1]-a)/h];const{lastPoint:u}=this.#o;this.#g=[(u[0]-o)/l,(u[1]-a)/h]}static initialize(e,t){AnnotationEditor.initialize(e,t),HighlightEditor._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case AnnotationEditorParamsType.HIGHLIGHT_COLOR:HighlightEditor._defaultColor=t;break;case AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:HighlightEditor._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#g}get commentButtonPosition(){return this.#f}updateParams(e,t){switch(e){case AnnotationEditorParamsType.HIGHLIGHT_COLOR:this.#A(t);break;case AnnotationEditorParamsType.HIGHLIGHT_THICKNESS:this.#w(t);break}}static get defaultPropertiesToUpdate(){return[[AnnotationEditorParamsType.HIGHLIGHT_COLOR,HighlightEditor._defaultColor],[AnnotationEditorParamsType.HIGHLIGHT_THICKNESS,HighlightEditor._defaultThickness]]}get propertiesToUpdate(){return[[AnnotationEditorParamsType.HIGHLIGHT_COLOR,this.color||HighlightEditor._defaultColor],[AnnotationEditorParamsType.HIGHLIGHT_THICKNESS,this.#p||HighlightEditor._defaultThickness],[AnnotationEditorParamsType.HIGHLIGHT_FREE,this.#d]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#h,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#s?.updateColor(this.color),super.onUpdatedColor()}#A(e){const t=(o,a)=>{this.color=o,this.opacity=a,this.onUpdatedColor()},n=this.color,i=this.opacity;this.addCommands({cmd:t.bind(this,e,HighlightEditor._defaultOpacity),undo:t.bind(this,n,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:AnnotationEditorParamsType.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(e)},!0)}#w(e){const t=this.#p,n=i=>{this.#p=i,this.#b(i)};this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#s=new ColorPicker({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#M())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#M())}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){this.#P(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#_(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#P():e&&(this.#_(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#b(e){this.#d&&(this.#x({highlightOutlines:this.#l.getNewOutline(e/2)}),this.fixAndSetPosition(),this.setDims(this.width,this.height))}#P(){this.#h===null||!this.parent||(this.parent.drawLayer.remove(this.#h),this.#h=null,this.parent.drawLayer.remove(this.#m),this.#m=null)}#_(e=this.parent){this.#h===null&&({id:this.#h,clipPathId:this.#r}=e.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#d},path:{d:this.#l.toSVGPath()}},!1,!0),this.#m=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#d},bbox:this.#o.box,path:{d:this.#o.toSVGPath()}},this.#d),this.#c&&(this.#c.style.clipPath=this.#r))}static#S([e,t,n,i],o){switch(o){case 90:return[1-t-i,e,i,n];case 180:return[1-e-n,1-t-i,n,i];case 270:return[t,1-e-n,i,n]}return[e,t,n,i]}rotate(e){const{drawLayer:t}=this.parent;let n;this.#d?(e=(e-this.rotation+360)%360,n=HighlightEditor.#S(this.#l.box,e)):n=HighlightEditor.#S([this.x,this.y,this.width,this.height],e),t.updateProperties(this.#h,{bbox:n,root:{"data-main-rotation":e}}),t.updateProperties(this.#m,{bbox:HighlightEditor.#S(this.#o.box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();this.#u&&(e.setAttribute("aria-label",this.#u),e.setAttribute("role","mark")),this.#d?e.classList.add("free"):this.div.addEventListener("keydown",this.#T.bind(this),{signal:this._uiManager._signal});const t=this.#c=document.createElement("div");return e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#r,this.setDims(this.width,this.height),bindEvents(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!1}})}#T(e){HighlightEditor._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#k(!0);break;case 1:case 3:this.#k(!1);break}}#k(e){if(!this.#e)return;const t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#i,this.#a)}select(){super.select(),this.#m&&this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#m&&(this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{selected:!1}}),this.#d||this.#k(!1))}get _mustFixPosition(){return!this.#d}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#h,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#m,{rootClass:{hidden:!e}}))}#M(){return this.#d?this.rotation:0}#N(){if(this.#d)return null;const[e,t]=this.pageDimensions,[n,i]=this.pageTranslation,o=this.#n,a=new Float32Array(o.length*8);let l=0;for(const{x:h,y:d,width:u,height:f}of o){const m=h*e+n,v=(1-d)*t+i;a[l]=a[l+4]=m,a[l+1]=a[l+3]=v,a[l+2]=a[l+6]=m+u*e,a[l+5]=a[l+7]=v-f*t,l+=8}return a}#R(e){return this.#l.serialize(e,this.#M())}static startHighlighting(e,t,{target:n,x:i,y:o}){const{x:a,y:l,width:h,height:d}=n.getBoundingClientRect(),u=new AbortController,f=e.combinedSignal(u),m=v=>{u.abort(),this.#I(e,v)};window.addEventListener("blur",m,{signal:f}),window.addEventListener("pointerup",m,{signal:f}),window.addEventListener("pointerdown",stopEvent,{capture:!0,passive:!1,signal:f}),window.addEventListener("contextmenu",noContextMenu,{signal:f}),n.addEventListener("pointermove",this.#D.bind(this,e),{signal:f}),this._freeHighlight=new FreeHighlightOutliner({x:i,y:o},[a,l,h,d],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#D(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#I(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,n){let i=null;if(e instanceof HighlightAnnotationElement){const{data:{quadPoints:g,rect:x,rotation:E,id:b,color:_,opacity:S,popupRef:C,richText:A,contentsObj:R,creationDate:L,modificationDate:j},parent:{page:{pageNumber:F}}}=e;i=e={annotationType:AnnotationEditorType.HIGHLIGHT,color:Array.from(_),opacity:S,quadPoints:g,boxes:null,pageIndex:F-1,rect:x.slice(0),rotation:E,annotationElementId:b,id:b,deleted:!1,popupRef:C,richText:A,comment:R?.str||null,creationDate:L,modificationDate:j}}else if(e instanceof InkAnnotationElement){const{data:{inkLists:g,rect:x,rotation:E,id:b,color:_,borderStyle:{rawWidth:S},popupRef:C,richText:A,contentsObj:R,creationDate:L,modificationDate:j},parent:{page:{pageNumber:F}}}=e;i=e={annotationType:AnnotationEditorType.HIGHLIGHT,color:Array.from(_),thickness:S,inkLists:g,boxes:null,pageIndex:F-1,rect:x.slice(0),rotation:E,annotationElementId:b,id:b,deleted:!1,popupRef:C,richText:A,comment:R?.str||null,creationDate:L,modificationDate:j}}const{color:o,quadPoints:a,inkLists:l,opacity:h}=e,d=await super.deserialize(e,t,n);d.color=Util.makeHexColor(...o),d.opacity=h||1,l&&(d.#p=e.thickness),d._initialData=i,e.comment&&d.setCommentData(e);const[u,f]=d.pageDimensions,[m,v]=d.pageTranslation;if(a){const g=d.#n=[];for(let x=0;x<a.length;x+=8)g.push({x:(a[x]-m)/u,y:1-(a[x+1]-v)/f,width:(a[x+2]-a[x])/u,height:(a[x+1]-a[x+5])/f});d.#y(),d.#_(),d.rotate(d.rotation)}else if(l){d.#d=!0;const g=l[0],x={x:g[0]-m,y:f-(g[1]-v)},E=new FreeHighlightOutliner(x,[0,0,u,f],1,d.#p/2,!0,.001);for(let S=0,C=g.length;S<C;S+=2)x.x=g[S]-m,x.y=f-(g[S+1]-v),E.add(x);const{id:b,clipPathId:_}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:d.color,"fill-opacity":d._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:E.toSVGPath()}},!0,!0);d.#x({highlightOutlines:E.getOutlines(),highlightId:b,clipPathId:_}),d.#_(),d.rotate(d.parentRotation)}return d}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=AnnotationEditor._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),n=super.serialize(e);return Object.assign(n,{color:t,opacity:this.opacity,thickness:this.#p,quadPoints:this.#N(),outlines:this.#R(n.rect)}),this.addComment(n),this.annotationElementId&&!this.#L(n)?null:(n.id=this.annotationElementId,n)}#L(e){const{color:t}=this._initialData;return this.hasEditedComment||e.color.some((n,i)=>n!==t[i])}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class DrawingOptions{#e=Object.create(null);updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,n)}updateSVGProperty(e,t){this.#e[e]=t}toSVGProperties(){const e=this.#e;return this.#e=Object.create(null),{root:e}}reset(){this.#e=Object.create(null)}updateAll(e=this){this.updateProperties(e)}clone(){unreachable("Not implemented")}}class DrawingEditor extends AnnotationEditor{#e=null;#t;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#n=null;static#r=null;static#s=null;static#o=NaN;static#i=null;static#a=null;static#c=NaN;static _INNER_MARGIN=3;constructor(e){super(e),this.#t=e.mustBeCommitted||!1,this._addOutlines(e)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(e){e.drawOutlines&&(this.#l(e),this.#f())}#l({drawOutlines:e,drawId:t,drawingOptions:n}){this.#e=e,this._drawingOptions||=n,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),t>=0?(this._drawId=t,this.parent.drawLayer.finalizeDraw(t,e.defaultProperties)):this._drawId=this.#h(e,this.parent),this.#u(e.box)}#h(e,t){const{id:n}=t.drawLayer.draw(DrawingEditor._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return n}static _mergeSVGProperties(e,t){const n=new Set(Object.keys(e));for(const[i,o]of Object.entries(t))n.has(i)?Object.assign(e[i],o):e[i]=o;return e}static getDefaultDrawingOptions(e){unreachable("Not implemented")}static get typesMap(){unreachable("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const n=this.typesMap.get(e);n&&this._defaultDrawingOptions.updateProperty(n,t),this._currentParent&&(DrawingEditor.#n.updateProperty(n,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const n=this.constructor.typesMap.get(e);n&&this._updateProperty(e,n,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[n,i]of this.typesMap)e.push([n,t[i]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[n,i]of this.constructor.typesMap)e.push([n,t[i]]);return e}_updateProperty(e,t,n){const i=this._drawingOptions,o=i[t],a=l=>{i.updateProperty(t,l);const h=this.#e.updateProperty(t,l);h&&this.#u(h),this.parent?.drawLayer.updateProperties(this._drawId,i.toSVGProperties()),e===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:a.bind(this,n),undo:a.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,DrawingEditor._mergeSVGProperties(this.#e.getPathResizingSVGProperties(this.#m()),{bbox:this.#p()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,DrawingEditor._mergeSVGProperties(this.#e.getPathResizedSVGProperties(this.#m()),{bbox:this.#p()}))}_onTranslating(e,t){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#p()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,DrawingEditor._mergeSVGProperties(this.#e.getPathTranslatedSVGProperties(this.#m(),this.parentDimensions),{bbox:this.#p()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#t&&(this.#t=!1,this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){this.#d(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#f(),this.#u(this.#e.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),this.#d()):e&&(this._uiManager.addShouldRescale(this),this.#f(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),t&&this.select()}#d(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#f(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#h(this.#e,e)}}#g([e,t,n,i]){const{parentDimensions:[o,a],rotation:l}=this;switch(l){case 90:return[t,1-e,n*(a/o),i*(o/a)];case 180:return[1-e,1-t,n,i];case 270:return[1-t,e,n*(a/o),i*(o/a)];default:return[e,t,n,i]}}#m(){const{x:e,y:t,width:n,height:i,parentDimensions:[o,a],rotation:l}=this;switch(l){case 90:return[1-t,e,n*(o/a),i*(a/o)];case 180:return[1-e,1-t,n,i];case 270:return[t,1-e,n*(o/a),i*(a/o)];default:return[e,t,n,i]}}#u(e){[this.x,this.y,this.width,this.height]=this.#g(e),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#p(){const{x:e,y:t,width:n,height:i,rotation:o,parentRotation:a,parentDimensions:[l,h]}=this;switch((o*4+a)/90){case 1:return[1-t-i,e,i,n];case 2:return[1-e-n,1-t-i,n,i];case 3:return[t,1-e-n,i,n];case 4:return[e,t-n*(l/h),i*(h/l),n*(l/h)];case 5:return[1-t,e,n*(l/h),i*(h/l)];case 6:return[1-e-i*(h/l),1-t,i*(h/l),n*(l/h)];case 7:return[t-n*(l/h),1-e-i*(h/l),n*(l/h),i*(h/l)];case 8:return[e-n,t-i,n,i];case 9:return[1-t,e-n,i,n];case 10:return[1-e,1-t,n,i];case 11:return[t-i,1-e,i,n];case 12:return[e-i*(h/l),t,i*(h/l),n*(l/h)];case 13:return[1-t-n*(l/h),e-i*(h/l),n*(l/h),i*(h/l)];case 14:return[1-e,1-t-n*(l/h),i*(h/l),n*(l/h)];case 15:return[t,1-e,n*(l/h),i*(h/l)];default:return[e,t,n,i]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,DrawingEditor._mergeSVGProperties({bbox:this.#p()},this.#e.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#u(this.#e.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,t;this._isCopy&&(e=this.x,t=this.y);const n=super.render();n.classList.add("draw");const i=document.createElement("div");return n.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,t),n}static createDrawerInstance(e,t,n,i,o){unreachable("Not implemented")}static startDrawing(e,t,n,i){const{target:o,offsetX:a,offsetY:l,pointerId:h,pointerType:d}=i;if(DrawingEditor.#i&&DrawingEditor.#i!==d)return;const{viewport:{rotation:u}}=e,{width:f,height:m}=o.getBoundingClientRect(),v=DrawingEditor.#r=new AbortController,g=e.combinedSignal(v);if(DrawingEditor.#o||=h,DrawingEditor.#i??=d,window.addEventListener("pointerup",x=>{DrawingEditor.#o===x.pointerId?this._endDraw(x):DrawingEditor.#a?.delete(x.pointerId)},{signal:g}),window.addEventListener("pointercancel",x=>{DrawingEditor.#o===x.pointerId?this._currentParent.endDrawingSession():DrawingEditor.#a?.delete(x.pointerId)},{signal:g}),window.addEventListener("pointerdown",x=>{DrawingEditor.#i===x.pointerType&&((DrawingEditor.#a||=new Set).add(x.pointerId),DrawingEditor.#n.isCancellable()&&(DrawingEditor.#n.removeLastElement(),DrawingEditor.#n.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:g}),window.addEventListener("contextmenu",noContextMenu,{signal:g}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:g}),o.addEventListener("touchmove",x=>{x.timeStamp===DrawingEditor.#c&&stopEvent(x)},{signal:g}),e.toggleDrawing(),t._editorUndoBar?.hide(),DrawingEditor.#n){e.drawLayer.updateProperties(this._currentDrawId,DrawingEditor.#n.startNew(a,l,f,m,u));return}t.updateUIForDefaultProperties(this),DrawingEditor.#n=this.createDrawerInstance(a,l,f,m,u),DrawingEditor.#s=this.getDefaultDrawingOptions(),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(DrawingEditor.#s.toSVGProperties(),DrawingEditor.#n.defaultSVGProperties),!0,!1)}static _drawMove(e){if(DrawingEditor.#c=-1,!DrawingEditor.#n)return;const{offsetX:t,offsetY:n,pointerId:i}=e;if(DrawingEditor.#o===i){if(DrawingEditor.#a?.size>=1){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,DrawingEditor.#n.add(t,n)),DrawingEditor.#c=e.timeStamp,stopEvent(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,DrawingEditor.#n=null,DrawingEditor.#s=null,DrawingEditor.#i=null,DrawingEditor.#c=NaN),DrawingEditor.#r&&(DrawingEditor.#r.abort(),DrawingEditor.#r=null,DrawingEditor.#o=NaN,DrawingEditor.#a=null)}static _endDraw(e){const t=this._currentParent;if(t){if(t.toggleDrawing(!0),this._cleanup(!1),e?.target===t.div&&t.drawLayer.updateProperties(this._currentDrawId,DrawingEditor.#n.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const n=DrawingEditor.#n,i=this._currentDrawId,o=n.getLastElement();t.addCommands({cmd:()=>{t.drawLayer.updateProperties(i,n.setLastElement(o))},undo:()=>{t.drawLayer.updateProperties(i,n.removeLastElement())},mustExec:!1,type:AnnotationEditorParamsType.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(AnnotationEditorParamsType.DRAW_STEP),!DrawingEditor.#n.isEmpty()){const{pageDimensions:[n,i],scale:o}=t,a=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:DrawingEditor.#n.getOutlines(n*o,i*o,o,this._INNER_MARGIN),drawingOptions:DrawingEditor.#s,mustBeCommitted:!e});return this._cleanup(!0),a}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,n,i,o,a){unreachable("Not implemented")}static async deserialize(e,t,n){const{rawDims:{pageWidth:i,pageHeight:o,pageX:a,pageY:l}}=t.viewport,h=this.deserializeDraw(a,l,i,o,this._INNER_MARGIN,e),d=await super.deserialize(e,t,n);return d.createDrawingOptions(e),d.#l({drawOutlines:h}),d.#f(),d.onScaleChanging(),d.rotate(),d}serializeDraw(e){const[t,n]=this.pageTranslation,[i,o]=this.pageDimensions;return this.#e.serialize([t,n,i,o],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class InkDrawOutliner{#e=new Float64Array(6);#t;#n;#r;#s;#o;#i="";#a=0;#c=new InkDrawOutline;#l;#h;constructor(e,t,n,i,o,a){this.#l=n,this.#h=i,this.#r=o,this.#s=a,[e,t]=this.#d(e,t);const l=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#o=[e,t],this.#n=[{line:l,points:this.#o}],this.#e.set(l,0)}updateProperty(e,t){e==="stroke-width"&&(this.#s=t)}#d(e,t){return Outline._normalizePoint(e,t,this.#l,this.#h,this.#r)}isEmpty(){return!this.#n||this.#n.length===0}isCancellable(){return this.#o.length<=10}add(e,t){[e,t]=this.#d(e,t);const[n,i,o,a]=this.#e.subarray(2,6),l=e-o,h=t-a;return Math.hypot(this.#l*l,this.#h*h)<=2?null:(this.#o.push(e,t),isNaN(n)?(this.#e.set([o,a,e,t],2),this.#t.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#e[0])&&this.#t.splice(6,6),this.#e.set([n,i,o,a,e,t],0),this.#t.push(...Outline.createBezierPoints(n,i,o,a,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(this.#o.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,i,o){this.#l=n,this.#h=i,this.#r=o,[e,t]=this.#d(e,t);const a=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#o=[e,t];const l=this.#n.at(-1);return l&&(l.line=new Float32Array(l.line),l.points=new Float32Array(l.points)),this.#n.push({line:a,points:this.#o}),this.#e.set(a,0),this.#a=0,this.toSVGPath(),null}getLastElement(){return this.#n.at(-1)}setLastElement(e){return this.#n?(this.#n.push(e),this.#t=e.line,this.#o=e.points,this.#a=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(e)}removeLastElement(){if(!this.#n)return this.#c.removeLastElement();this.#n.pop(),this.#i="";for(let e=0,t=this.#n.length;e<t;e++){const{line:n,points:i}=this.#n[e];this.#t=n,this.#o=i,this.#a=0,this.toSVGPath()}return{path:{d:this.#i}}}toSVGPath(){const e=Outline.svgRound(this.#t[4]),t=Outline.svgRound(this.#t[5]);if(this.#o.length===2)return this.#i=`${this.#i} M ${e} ${t} Z`,this.#i;if(this.#o.length<=6){const i=this.#i.lastIndexOf("M");this.#i=`${this.#i.slice(0,i)} M ${e} ${t}`,this.#a=6}if(this.#o.length===4){const i=Outline.svgRound(this.#t[10]),o=Outline.svgRound(this.#t[11]);return this.#i=`${this.#i} L ${i} ${o}`,this.#a=12,this.#i}const n=[];this.#a===0&&(n.push(`M ${e} ${t}`),this.#a=6);for(let i=this.#a,o=this.#t.length;i<o;i+=6){const[a,l,h,d,u,f]=this.#t.slice(i,i+6).map(Outline.svgRound);n.push(`C${a} ${l} ${h} ${d} ${u} ${f}`)}return this.#i+=n.join(" "),this.#a=this.#t.length,this.#i}getOutlines(e,t,n,i){const o=this.#n.at(-1);return o.line=new Float32Array(o.line),o.points=new Float32Array(o.points),this.#c.build(this.#n,e,t,n,this.#r,this.#s,i),this.#e=null,this.#t=null,this.#n=null,this.#i=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class InkDrawOutline extends Outline{#e;#t=0;#n;#r;#s;#o;#i;#a;#c;build(e,t,n,i,o,a,l){this.#s=t,this.#o=n,this.#i=i,this.#a=o,this.#c=a,this.#n=l??0,this.#r=e,this.#d()}get thickness(){return this.#c}setLastElement(e){return this.#r.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#r.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of this.#r){if(e.push(`M${Outline.svgRound(t[4])} ${Outline.svgRound(t[5])}`),t.length===6){e.push("Z");continue}if(t.length===12&&isNaN(t[6])){e.push(`L${Outline.svgRound(t[10])} ${Outline.svgRound(t[11])}`);continue}for(let n=6,i=t.length;n<i;n+=6){const[o,a,l,h,d,u]=t.subarray(n,n+6).map(Outline.svgRound);e.push(`C${o} ${a} ${l} ${h} ${d} ${u}`)}}return e.join("")}serialize([e,t,n,i],o){const a=[],l=[],[h,d,u,f]=this.#h();let m,v,g,x,E,b,_,S,C;switch(this.#a){case 0:C=Outline._rescale,m=e,v=t+i,g=n,x=-i,E=e+h*n,b=t+(1-d-f)*i,_=e+(h+u)*n,S=t+(1-d)*i;break;case 90:C=Outline._rescaleAndSwap,m=e,v=t,g=n,x=i,E=e+d*n,b=t+h*i,_=e+(d+f)*n,S=t+(h+u)*i;break;case 180:C=Outline._rescale,m=e+n,v=t,g=-n,x=i,E=e+(1-h-u)*n,b=t+d*i,_=e+(1-h)*n,S=t+(d+f)*i;break;case 270:C=Outline._rescaleAndSwap,m=e+n,v=t+i,g=-n,x=-i,E=e+(1-d-f)*n,b=t+(1-h-u)*i,_=e+(1-d)*n,S=t+(1-h)*i;break}for(const{line:A,points:R}of this.#r)a.push(C(A,m,v,g,x,o?new Array(A.length):null)),l.push(C(R,m,v,g,x,o?new Array(R.length):null));return{lines:a,points:l,rect:[E,b,_,S]}}static deserialize(e,t,n,i,o,{paths:{lines:a,points:l},rotation:h,thickness:d}){const u=[];let f,m,v,g,x;switch(h){case 0:x=Outline._rescale,f=-e/n,m=t/i+1,v=1/n,g=-1/i;break;case 90:x=Outline._rescaleAndSwap,f=-t/i,m=-e/n,v=1/i,g=1/n;break;case 180:x=Outline._rescale,f=e/n+1,m=-t/i,v=-1/n,g=1/i;break;case 270:x=Outline._rescaleAndSwap,f=t/i+1,m=e/n+1,v=-1/i,g=-1/n;break}if(!a){a=[];for(const b of l){const _=b.length;if(_===2){a.push(new Float32Array([NaN,NaN,NaN,NaN,b[0],b[1]]));continue}if(_===4){a.push(new Float32Array([NaN,NaN,NaN,NaN,b[0],b[1],NaN,NaN,NaN,NaN,b[2],b[3]]));continue}const S=new Float32Array(3*(_-2));a.push(S);let[C,A,R,L]=b.subarray(0,4);S.set([NaN,NaN,NaN,NaN,C,A],0);for(let j=4;j<_;j+=2){const F=b[j],W=b[j+1];S.set(Outline.createBezierPoints(C,A,R,L,F,W),(j-2)*3),[C,A,R,L]=[R,L,F,W]}}}for(let b=0,_=a.length;b<_;b++)u.push({line:x(a[b].map(S=>S??NaN),f,m,v,g),points:x(l[b].map(S=>S??NaN),f,m,v,g)});const E=new this.prototype.constructor;return E.build(u,n,i,1,h,d,o),E}#l(e=this.#c){const t=this.#n+e/2*this.#i;return this.#a%180===0?[t/this.#s,t/this.#o]:[t/this.#o,t/this.#s]}#h(){const[e,t,n,i]=this.#e,[o,a]=this.#l(0);return[e+o,t+a,n-2*o,i-2*a]}#d(){const e=this.#e=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:i}of this.#r){if(i.length<=12){for(let l=4,h=i.length;l<h;l+=6)Util.pointBoundingBox(i[l],i[l+1],e);continue}let o=i[4],a=i[5];for(let l=6,h=i.length;l<h;l+=6){const[d,u,f,m,v,g]=i.subarray(l,l+6);Util.bezierBoundingBox(o,a,d,u,f,m,v,g,e),o=v,a=g}}const[t,n]=this.#l();e[0]=MathClamp(e[0]-t,0,1),e[1]=MathClamp(e[1]-n,0,1),e[2]=MathClamp(e[2]+t,0,1),e[3]=MathClamp(e[3]+n,0,1),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#e}updateProperty(e,t){return e==="stroke-width"?this.#f(t):null}#f(e){const[t,n]=this.#l();this.#c=e;const[i,o]=this.#l(),[a,l]=[i-t,o-n],h=this.#e;return h[0]-=a,h[1]-=l,h[2]+=2*a,h[3]+=2*l,h}updateParentDimensions([e,t],n){const[i,o]=this.#l();this.#s=e,this.#o=t,this.#i=n;const[a,l]=this.#l(),h=a-i,d=l-o,u=this.#e;return u[0]-=h,u[1]-=d,u[2]+=2*h,u[3]+=2*d,u}updateRotation(e){return this.#t=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#e.map(Outline.svgRound).join(" ")}get defaultProperties(){const[e,t]=this.#e;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Outline.svgRound(e)} ${Outline.svgRound(t)}`}}}get rotationTransform(){const[,,e,t]=this.#e;let n=0,i=0,o=0,a=0,l=0,h=0;switch(this.#t){case 90:i=t/e,o=-e/t,l=e;break;case 180:n=-1,a=-1,l=e,h=t;break;case 270:i=-t/e,o=e/t,h=t;break;default:return""}return`matrix(${n} ${i} ${o} ${a} ${Outline.svgRound(l)} ${Outline.svgRound(h)})`}getPathResizingSVGProperties([e,t,n,i]){const[o,a]=this.#l(),[l,h,d,u]=this.#e;if(Math.abs(d-o)<=Outline.PRECISION||Math.abs(u-a)<=Outline.PRECISION){const x=e+n/2-(l+d/2),E=t+i/2-(h+u/2);return{path:{"transform-origin":`${Outline.svgRound(e)} ${Outline.svgRound(t)}`,transform:`${this.rotationTransform} translate(${x} ${E})`}}}const f=(n-2*o)/(d-2*o),m=(i-2*a)/(u-2*a),v=d/n,g=u/i;return{path:{"transform-origin":`${Outline.svgRound(l)} ${Outline.svgRound(h)}`,transform:`${this.rotationTransform} scale(${v} ${g}) translate(${Outline.svgRound(o)} ${Outline.svgRound(a)}) scale(${f} ${m}) translate(${Outline.svgRound(-o)} ${Outline.svgRound(-a)})`}}}getPathResizedSVGProperties([e,t,n,i]){const[o,a]=this.#l(),l=this.#e,[h,d,u,f]=l;if(l[0]=e,l[1]=t,l[2]=n,l[3]=i,Math.abs(u-o)<=Outline.PRECISION||Math.abs(f-a)<=Outline.PRECISION){const E=e+n/2-(h+u/2),b=t+i/2-(d+f/2);for(const{line:_,points:S}of this.#r)Outline._translate(_,E,b,_),Outline._translate(S,E,b,S);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Outline.svgRound(e)} ${Outline.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const m=(n-2*o)/(u-2*o),v=(i-2*a)/(f-2*a),g=-m*(h+o)+e+o,x=-v*(d+a)+t+a;if(m!==1||v!==1||g!==0||x!==0)for(const{line:E,points:b}of this.#r)Outline._rescale(E,g,x,m,v,E),Outline._rescale(b,g,x,m,v,b);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Outline.svgRound(e)} ${Outline.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,t],n){const[i,o]=n,a=this.#e,l=e-a[0],h=t-a[1];if(this.#s===i&&this.#o===o)for(const{line:d,points:u}of this.#r)Outline._translate(d,l,h,d),Outline._translate(u,l,h,u);else{const d=this.#s/i,u=this.#o/o;this.#s=i,this.#o=o;for(const{line:f,points:m}of this.#r)Outline._rescale(f,l,h,d,u,f),Outline._rescale(m,l,h,d,u,m);a[2]*=d,a[3]*=u}return a[0]=e,a[1]=t,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Outline.svgRound(e)} ${Outline.svgRound(t)}`}}}get defaultSVGProperties(){const e=this.#e;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Outline.svgRound(e[0])} ${Outline.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}class InkDrawingOptions extends DrawingOptions{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:AnnotationEditor._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??=this["stroke-width"],t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new InkDrawingOptions(this._viewParameters);return e.updateAll(this),e}}class InkEditor extends DrawingEditor{static _type="ink";static _editorType=AnnotationEditorType.INK;static _defaultDrawingOptions=null;constructor(e){super({...e,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,t){AnnotationEditor.initialize(e,t),this._defaultDrawingOptions=new InkDrawingOptions(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return shadow(this,"typesMap",new Map([[AnnotationEditorParamsType.INK_THICKNESS,"stroke-width"],[AnnotationEditorParamsType.INK_COLOR,"stroke"],[AnnotationEditorParamsType.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,n,i,o){return new InkDrawOutliner(e,t,n,i,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,n,i,o,a){return InkDrawOutline.deserialize(e,t,n,i,o,a)}static async deserialize(e,t,n){let i=null;if(e instanceof InkAnnotationElement){const{data:{inkLists:a,rect:l,rotation:h,id:d,color:u,opacity:f,borderStyle:{rawWidth:m},popupRef:v,richText:g,contentsObj:x,creationDate:E,modificationDate:b},parent:{page:{pageNumber:_}}}=e;i=e={annotationType:AnnotationEditorType.INK,color:Array.from(u),thickness:m,opacity:f,paths:{points:a},boxes:null,pageIndex:_-1,rect:l.slice(0),rotation:h,annotationElementId:d,id:d,deleted:!1,popupRef:v,richText:g,comment:x?.str||null,creationDate:E,modificationDate:b}}const o=await super.deserialize(e,t,n);return o._initialData=i,e.comment&&o.setCommentData(e),o}get toolbarButtons(){return this._colorPicker||=new BasicColorPicker(this),[["colorPicker",this._colorPicker]]}get colorType(){return AnnotationEditorParamsType.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:n}=this;t.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:t,opacity:n}){this._drawingOptions=InkEditor.getDefaultDrawingOptions({stroke:Util.makeHexColor(...e),"stroke-width":t,"stroke-opacity":n})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:n}=this.serializeDraw(e),{_drawingOptions:{stroke:i,"stroke-opacity":o,"stroke-width":a}}=this,l=Object.assign(super.serialize(e),{color:AnnotationEditor._colorManager.convert(i),opacity:o,thickness:a,paths:{lines:t,points:n}});return this.addComment(l),e?(l.isCopy=!0,l):this.annotationElementId&&!this.#e(l)?null:(l.id=this.annotationElementId,l)}#e(e){const{color:t,thickness:n,opacity:i,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||e.color.some((a,l)=>a!==t[l])||e.thickness!==n||e.opacity!==i||e.pageIndex!==o}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;const{points:t,rect:n}=this.serializeDraw(!1);return e.updateEdited({rect:n,thickness:this._drawingOptions["stroke-width"],points:t,popup:this.comment}),null}}class ContourDrawOutline extends InkDrawOutline{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const BASE_HEADER_LENGTH=8,POINTS_PROPERTIES_NUMBER=3;class SignatureExtractor{static#e={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#t(e,t,n,i){return n-=e,i-=t,n===0?i>0?0:4:n===1?i+6:2-i}static#n=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#r(e,t,n,i,o,a,l){const h=this.#t(n,i,o,a);for(let d=0;d<8;d++){const u=(-d+h-l+16)%8,f=this.#n[2*u],m=this.#n[2*u+1];if(e[(n+f)*t+(i+m)]!==0)return u}return-1}static#s(e,t,n,i,o,a,l){const h=this.#t(n,i,o,a);for(let d=0;d<8;d++){const u=(d+h+l+16)%8,f=this.#n[2*u],m=this.#n[2*u+1];if(e[(n+f)*t+(i+m)]!==0)return u}return-1}static#o(e,t,n,i){const o=e.length,a=new Int32Array(o);for(let u=0;u<o;u++)a[u]=e[u]<=i?1:0;for(let u=1;u<n-1;u++)a[u*t]=a[u*t+t-1]=0;for(let u=0;u<t;u++)a[u]=a[t*n-1-u]=0;let l=1,h;const d=[];for(let u=1;u<n-1;u++){h=1;for(let f=1;f<t-1;f++){const m=u*t+f,v=a[m];if(v===0)continue;let g=u,x=f;if(v===1&&a[m-1]===0)l+=1,x-=1;else if(v>=1&&a[m+1]===0)l+=1,x+=1,v>1&&(h=v);else{v!==1&&(h=Math.abs(v));continue}const E=[f,u],b=x===f+1,_={isHole:b,points:E,id:l,parent:0};d.push(_);let S;for(const K of d)if(K.id===h){S=K;break}S?S.isHole?_.parent=b?S.parent:h:_.parent=b?h:S.parent:_.parent=b?h:0;const C=this.#r(a,t,u,f,g,x,0);if(C===-1){a[m]=-l,a[m]!==1&&(h=Math.abs(a[m]));continue}let A=this.#n[2*C],R=this.#n[2*C+1];const L=u+A,j=f+R;g=L,x=j;let F=u,W=f;for(;;){const K=this.#s(a,t,F,W,g,x,1);A=this.#n[2*K],R=this.#n[2*K+1];const ee=F+A,te=W+R;E.push(te,ee);const re=F*t+W;if(a[re+1]===0?a[re]=-l:a[re]===1&&(a[re]=l),ee===u&&te===f&&F===L&&W===j){a[m]!==1&&(h=Math.abs(a[m]));break}else g=F,x=W,F=ee,W=te}}}return d}static#i(e,t,n,i){if(n-t<=4){for(let L=t;L<n-2;L+=2)i.push(e[L],e[L+1]);return}const o=e[t],a=e[t+1],l=e[n-4]-o,h=e[n-3]-a,d=Math.hypot(l,h),u=l/d,f=h/d,m=u*a-f*o,v=h/l,g=1/d,x=Math.atan(v),E=Math.cos(x),b=Math.sin(x),_=g*(Math.abs(E)+Math.abs(b)),S=g*(1-_+_**2),C=Math.max(Math.atan(Math.abs(b+E)*S),Math.atan(Math.abs(b-E)*S));let A=0,R=t;for(let L=t+2;L<n-2;L+=2){const j=Math.abs(m-u*e[L+1]+f*e[L]);j>A&&(R=L,A=j)}A>(d*C)**2?(this.#i(e,t,R+2,i),this.#i(e,R,n,i)):i.push(o,a)}static#a(e){const t=[],n=e.length;return this.#i(e,0,n,t),t.push(e[n-2],e[n-1]),t.length<=4?null:t}static#c(e,t,n,i,o,a){const l=new Float32Array(a**2),h=-2*i**2,d=a>>1;for(let x=0;x<a;x++){const E=(x-d)**2;for(let b=0;b<a;b++)l[x*a+b]=Math.exp((E+(b-d)**2)/h)}const u=new Float32Array(256),f=-2*o**2;for(let x=0;x<256;x++)u[x]=Math.exp(x**2/f);const m=e.length,v=new Uint8Array(m),g=new Uint32Array(256);for(let x=0;x<n;x++)for(let E=0;E<t;E++){const b=x*t+E,_=e[b];let S=0,C=0;for(let R=0;R<a;R++){const L=x+R-d;if(!(L<0||L>=n))for(let j=0;j<a;j++){const F=E+j-d;if(F<0||F>=t)continue;const W=e[L*t+F],K=l[R*a+j]*u[Math.abs(W-_)];S+=W*K,C+=K}}const A=v[b]=Math.round(S/C);g[A]++}return[v,g]}static#l(e){const t=new Uint32Array(256);for(const n of e)t[n]++;return t}static#h(e){const t=e.length,n=new Uint8ClampedArray(t>>2);let i=-1/0,o=1/0;for(let l=0,h=n.length;l<h;l++){const d=n[l]=e[l<<2];i=Math.max(i,d),o=Math.min(o,d)}const a=255/(i-o);for(let l=0,h=n.length;l<h;l++)n[l]=(n[l]-o)*a;return n}static#d(e){let t,n=-1/0,i=-1/0;const o=e.findIndex(h=>h!==0);let a=o,l=o;for(t=o;t<256;t++){const h=e[t];h>n&&(t-a>i&&(i=t-a,l=t-1),n=h,a=t)}for(t=l-1;t>=0&&!(e[t]>e[t+1]);t--);return t}static#f(e){const t=e,{width:n,height:i}=e,{maxDim:o}=this.#e;let a=n,l=i;if(n>o||i>o){let m=n,v=i,g=Math.log2(Math.max(n,i)/o);const x=Math.floor(g);g=g===x?x-1:x;for(let b=0;b<g;b++){a=Math.ceil(m/2),l=Math.ceil(v/2);const _=new OffscreenCanvas(a,l);_.getContext("2d").drawImage(e,0,0,m,v,0,0,a,l),m=a,v=l,e!==t&&e.close(),e=_.transferToImageBitmap()}const E=Math.min(o/a,o/l);a=Math.round(a*E),l=Math.round(l*E)}const d=new OffscreenCanvas(a,l).getContext("2d",{willReadFrequently:!0});d.fillStyle="white",d.fillRect(0,0,a,l),d.filter="grayscale(1)",d.drawImage(e,0,0,e.width,e.height,0,0,a,l);const u=d.getImageData(0,0,a,l).data;return[this.#h(u),a,l]}static extractContoursFromText(e,{fontFamily:t,fontStyle:n,fontWeight:i},o,a,l,h){let d=new OffscreenCanvas(1,1),u=d.getContext("2d",{alpha:!1});const f=200,m=u.font=`${n} ${i} ${f}px ${t}`,{actualBoundingBoxLeft:v,actualBoundingBoxRight:g,actualBoundingBoxAscent:x,actualBoundingBoxDescent:E,fontBoundingBoxAscent:b,fontBoundingBoxDescent:_,width:S}=u.measureText(e),C=1.5,A=Math.ceil(Math.max(Math.abs(v)+Math.abs(g)||0,S)*C),R=Math.ceil(Math.max(Math.abs(x)+Math.abs(E)||f,Math.abs(b)+Math.abs(_)||f)*C);d=new OffscreenCanvas(A,R),u=d.getContext("2d",{alpha:!0,willReadFrequently:!0}),u.font=m,u.filter="grayscale(1)",u.fillStyle="white",u.fillRect(0,0,A,R),u.fillStyle="black",u.fillText(e,A*(C-1)/2,R*(3-C)/2);const L=this.#h(u.getImageData(0,0,A,R).data),j=this.#l(L),F=this.#d(j),W=this.#o(L,A,R,F);return this.processDrawnLines({lines:{curves:W,width:A,height:R},pageWidth:o,pageHeight:a,rotation:l,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(e,t,n,i,o){const[a,l,h]=this.#f(e),[d,u]=this.#c(a,l,h,Math.hypot(l,h)*this.#e.sigmaSFactor,this.#e.sigmaR,this.#e.kernelSize),f=this.#d(u),m=this.#o(d,l,h,f);return this.processDrawnLines({lines:{curves:m,width:l,height:h},pageWidth:t,pageHeight:n,rotation:i,innerMargin:o,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:i,innerMargin:o,mustSmooth:a,areContours:l}){i%180!==0&&([t,n]=[n,t]);const{curves:h,width:d,height:u}=e,f=e.thickness??0,m=[],v=Math.min(t/d,n/u),g=v/t,x=v/n,E=[];for(const{points:_}of h){const S=a?this.#a(_):_;if(!S)continue;E.push(S);const C=S.length,A=new Float32Array(C),R=new Float32Array(3*(C===2?2:C-2));if(m.push({line:R,points:A}),C===2){A[0]=S[0]*g,A[1]=S[1]*x,R.set([NaN,NaN,NaN,NaN,A[0],A[1]],0);continue}let[L,j,F,W]=S;L*=g,j*=x,F*=g,W*=x,A.set([L,j,F,W],0),R.set([NaN,NaN,NaN,NaN,L,j],0);for(let K=4;K<C;K+=2){const ee=A[K]=S[K]*g,te=A[K+1]=S[K+1]*x;R.set(Outline.createBezierPoints(L,j,F,W,ee,te),(K-2)*3),[L,j,F,W]=[F,W,ee,te]}}if(m.length===0)return null;const b=l?new ContourDrawOutline:new InkDrawOutline;return b.build(m,t,n,1,i,l?0:f,o),{outline:b,newCurves:E,areContours:l,thickness:f,width:d,height:u}}static async compressSignature({outlines:e,areContours:t,thickness:n,width:i,height:o}){let a=1/0,l=-1/0,h=0;for(const S of e){h+=S.length;for(let C=2,A=S.length;C<A;C++){const R=S[C]-S[C-2];a=Math.min(a,R),l=Math.max(l,R)}}let d;a>=-128&&l<=127?d=Int8Array:a>=-32768&&l<=32767?d=Int16Array:d=Int32Array;const u=e.length,f=BASE_HEADER_LENGTH+POINTS_PROPERTIES_NUMBER*u,m=new Uint32Array(f);let v=0;m[v++]=f*Uint32Array.BYTES_PER_ELEMENT+(h-2*u)*d.BYTES_PER_ELEMENT,m[v++]=0,m[v++]=i,m[v++]=o,m[v++]=t?0:1,m[v++]=Math.max(0,Math.floor(n??0)),m[v++]=u,m[v++]=d.BYTES_PER_ELEMENT;for(const S of e)m[v++]=S.length-2,m[v++]=S[0],m[v++]=S[1];const g=new CompressionStream("deflate-raw"),x=g.writable.getWriter();await x.ready,x.write(m);const E=d.prototype.constructor;for(const S of e){const C=new E(S.length-2);for(let A=2,R=S.length;A<R;A++)C[A-2]=S[A]-S[A-2];x.write(C)}x.close();const b=await new Response(g.readable).arrayBuffer(),_=new Uint8Array(b);return toBase64Util(_)}static async decompressSignature(e){try{const t=fromBase64Util(e),{readable:n,writable:i}=new DecompressionStream("deflate-raw"),o=i.getWriter();await o.ready,o.write(t).then(async()=>{await o.ready,await o.close()}).catch(()=>{});let a=null,l=0;for await(const S of n)a||=new Uint8Array(new Uint32Array(S.buffer,0,4)[0]),a.set(S,l),l+=S.length;const h=new Uint32Array(a.buffer,0,a.length>>2),d=h[1];if(d!==0)throw new Error(`Invalid version: ${d}`);const u=h[2],f=h[3],m=h[4]===0,v=h[5],g=h[6],x=h[7],E=[],b=(BASE_HEADER_LENGTH+POINTS_PROPERTIES_NUMBER*g)*Uint32Array.BYTES_PER_ELEMENT;let _;switch(x){case Int8Array.BYTES_PER_ELEMENT:_=new Int8Array(a.buffer,b);break;case Int16Array.BYTES_PER_ELEMENT:_=new Int16Array(a.buffer,b);break;case Int32Array.BYTES_PER_ELEMENT:_=new Int32Array(a.buffer,b);break}l=0;for(let S=0;S<g;S++){const C=h[POINTS_PROPERTIES_NUMBER*S+BASE_HEADER_LENGTH],A=new Float32Array(C+2);E.push(A);for(let R=0;R<POINTS_PROPERTIES_NUMBER-1;R++)A[R]=h[POINTS_PROPERTIES_NUMBER*S+BASE_HEADER_LENGTH+R+1];for(let R=0;R<C;R++)A[R+2]=A[R]+_[l++]}return{areContours:m,thickness:v,outlines:E,width:u,height:f}}catch(t){return warn(`decompressSignature: ${t}`),null}}}class SignatureOptions extends DrawingOptions{constructor(){super(),super.updateProperties({fill:AnnotationEditor._defaultLineColor,"stroke-width":0})}clone(){const e=new SignatureOptions;return e.updateAll(this),e}}class DrawnSignatureOptions extends InkDrawingOptions{constructor(e){super(e),super.updateProperties({stroke:AnnotationEditor._defaultLineColor,"stroke-width":1})}clone(){const e=new DrawnSignatureOptions(this._viewParameters);return e.updateAll(this),e}}class SignatureEditor extends DrawingEditor{#e=!1;#t=null;#n=null;#r=null;static _type="signature";static _editorType=AnnotationEditorType.SIGNATURE;static _defaultDrawingOptions=null;constructor(e){super({...e,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#n=e.signatureData||null,this.#t=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,t){AnnotationEditor.initialize(e,t),this._defaultDrawingOptions=new SignatureOptions,this._defaultDrawnSignatureOptions=new DrawnSignatureOptions(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!1}static get typesMap(){return shadow(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#t}}static computeTelemetryFinalData(e){const t=e.get("hasDescription");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,t;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,e=this.x,t=this.y),super.render(),this._drawId===null)if(this.#n){const{lines:i,mustSmooth:o,areContours:a,description:l,uuid:h,heightInPage:d}=this.#n,{rawDims:{pageWidth:u,pageHeight:f},rotation:m}=this.parent.viewport,v=SignatureExtractor.processDrawnLines({lines:i,pageWidth:u,pageHeight:f,rotation:m,innerMargin:SignatureEditor._INNER_MARGIN,mustSmooth:o,areContours:a});this.addSignature(v,d,l,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#t||""}));return n&&(this._isCopy=!0,this._moveAfterPaste(e,t)),this.div}setUuid(e){this.#r=e,this.addEditToolbar()}getUuid(){return this.#r}get description(){return this.#t}set description(e){this.#t=e,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:e})),super.addEditToolbar().then(t=>{t?.updateEditSignatureButton(e)}))}getSignaturePreview(){const{newCurves:e,areContours:t,thickness:n,width:i,height:o}=this.#n,a=Math.max(i,o),l=SignatureExtractor.processDrawnLines({lines:{curves:e.map(h=>({points:h})),thickness:n,width:i,height:o},pageWidth:a,pageHeight:a,rotation:0,innerMargin:0,mustSmooth:!1,areContours:t});return{areContours:t,outline:l.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,t,n,i){const{x:o,y:a}=this,{outline:l}=this.#n=e;this.#e=l instanceof ContourDrawOutline,this.description=n;let h;this.#e?h=SignatureEditor.getDefaultDrawingOptions():(h=SignatureEditor._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":l.thickness})),this._addOutlines({drawOutlines:l,drawingOptions:h});const[,d]=this.pageDimensions;let u=t/d;u=u>=1?.5:u,this.width*=u/this.height,this.width>=1&&(u*=.9/this.width,this.width=.9),this.height=u,this.setDims(),this.x=o,this.y=a,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(i),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!i,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:i}=this.parent.viewport;return SignatureExtractor.process(e,t,n,i,SignatureEditor._INNER_MARGIN)}getFromText(e,t){const{rawDims:{pageWidth:n,pageHeight:i},rotation:o}=this.parent.viewport;return SignatureExtractor.extractContoursFromText(e,t,n,i,o,SignatureEditor._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:i}=this.parent.viewport;return SignatureExtractor.processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:i,innerMargin:SignatureEditor._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:e,thickness:t}){e?this._drawingOptions=SignatureEditor.getDefaultDrawingOptions():(this._drawingOptions=SignatureEditor._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":t}))}serialize(e=!1){if(this.isEmpty())return null;const{lines:t,points:n}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":i}}=this,o=Object.assign(super.serialize(e),{isSignature:!0,areContours:this.#e,color:[0,0,0],thickness:this.#e?0:i});return this.addComment(o),e?(o.paths={lines:t,points:n},o.uuid=this.#r,o.isCopy=!0):o.lines=t,this.#t&&(o.accessibilityData={type:"Figure",alt:this.#t}),o}static deserializeDraw(e,t,n,i,o,a){return a.areContours?ContourDrawOutline.deserialize(e,t,n,i,o,a):InkDrawOutline.deserialize(e,t,n,i,o,a)}static async deserialize(e,t,n){const i=await super.deserialize(e,t,n);return i.#e=e.areContours,i.description=e.accessibilityData?.alt||"",i.#r=e.uuid,i}}class StampEditor extends AnnotationEditor{#e=null;#t=null;#n=null;#r=null;#s=null;#o="";#i=null;#a=!1;#c=null;#l=!1;#h=!1;static _type="stamp";static _editorType=AnnotationEditorType.STAMP;constructor(e){super({...e,name:"stampEditor"}),this.#r=e.bitmapUrl,this.#s=e.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,t){AnnotationEditor.initialize(e,t)}static isHandlingMimeForPasting(e){return SupportedImageMimeTypes.includes(e)}static paste(e,t){t.pasteEditor({mode:AnnotationEditorType.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#d(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#l=e.isSvg),e.file&&(this.#o=e.file.name),this.#m()}#f(){if(this.#n=null,this._uiManager.enableWaiting(!1),!!this.#i){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:i,width:o,height:a}=e||this.copyCanvas(null,null,!0).imageData,l=await n.guess({name:"altText",request:{data:i,width:o,height:a,channels:i.length/(o*a)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const h=l.output;return await this.setGuessedAltText(h),t&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#g(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(n=>this.#d(n,!0)).finally(()=>this.#f());return}if(this.#r){const n=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(n).then(i=>this.#d(i)).finally(()=>this.#f());return}if(this.#s){const n=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(n).then(i=>this.#d(i)).finally(()=>this.#f());return}const e=document.createElement("input");e.type="file",e.accept=SupportedImageMimeTypes.join(",");const t=this._uiManager._signal;this.#n=new Promise(n=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const i=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#d(i)}n()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),n()},{signal:t})}).finally(()=>this.#f()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#i?.remove(),this.#i=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#g();return}super.rebuild(),this.div!==null&&(this.#t&&this.#i===null&&this.#g(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(this.#n||this.#e||this.#r||this.#s||this.#t||this.#a)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;return this._isCopy&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#a||(this.#e?this.#m():this.#g()),this._isCopy&&this._moveAfterPaste(e,t),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,t){const{id:n,bitmap:i}=this._uiManager.imageManager.getFromCanvas(e,t);t.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(this.#t=n,i&&(this.#e=i),this.#a=!1,this.#m())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const e=200;this.#c=setTimeout(()=>{this.#c=null,this.#p()},e)}#m(){const{div:e}=this;let{width:t,height:n}=this.#e;const[i,o]=this.pageDimensions,a=.75;if(this.width)t=this.width*i,n=this.height*o;else if(t>a*i||n>a*o){const h=Math.min(a*i/t,a*o/n);t*=h,n*=h}this._uiManager.enableWaiting(!1);const l=this.#i=document.createElement("canvas");l.setAttribute("role","img"),this.addContainer(l),this.width=t/i,this.height=n/o,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#p(),this.#h||(this.parent.addUndoableEditor(this),this.#h=!0),this._reportTelemetry({action:"inserted_image"}),this.#o&&this.div.setAttribute("aria-description",this.#o),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(e,t,n=!1){e||(e=224);const{width:i,height:o}=this.#e,a=new OutputScale;let l=this.#e,h=i,d=o,u=null;if(t){if(i>t||o>t){const R=Math.min(t/i,t/o);h=Math.floor(i*R),d=Math.floor(o*R)}u=document.createElement("canvas");const m=u.width=Math.ceil(h*a.sx),v=u.height=Math.ceil(d*a.sy);this.#l||(l=this.#u(m,v));const g=u.getContext("2d");g.filter=this._uiManager.hcmFilter;let x="white",E="#cfcfd8";this._uiManager.hcmFilter!=="none"?E="black":ColorScheme.isDarkMode&&(x="#8f8f9d",E="#42414d");const b=15,_=b*a.sx,S=b*a.sy,C=new OffscreenCanvas(_*2,S*2),A=C.getContext("2d");A.fillStyle=x,A.fillRect(0,0,_*2,S*2),A.fillStyle=E,A.fillRect(0,0,_,S),A.fillRect(_,S,_,S),g.fillStyle=g.createPattern(C,"repeat"),g.fillRect(0,0,m,v),g.drawImage(l,0,0,l.width,l.height,0,0,m,v)}let f=null;if(n){let m,v;if(a.symmetric&&l.width<e&&l.height<e)m=l.width,v=l.height;else if(l=this.#e,i>e||o>e){const E=Math.min(e/i,e/o);m=Math.floor(i*E),v=Math.floor(o*E),this.#l||(l=this.#u(m,v))}const x=new OffscreenCanvas(m,v).getContext("2d",{willReadFrequently:!0});x.drawImage(l,0,0,l.width,l.height,0,0,m,v),f={width:m,height:v,data:x.getImageData(0,0,m,v).data}}return{canvas:u,width:h,height:d,imageData:f}}#u(e,t){const{width:n,height:i}=this.#e;let o=n,a=i,l=this.#e;for(;o>2*e||a>2*t;){const h=o,d=a;o>2*e&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),a>2*t&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const u=new OffscreenCanvas(o,a);u.getContext("2d").drawImage(l,0,0,h,d,0,0,o,a),l=u.transferToImageBitmap()}return l}#p(){const[e,t]=this.parentDimensions,{width:n,height:i}=this,o=new OutputScale,a=Math.ceil(n*e*o.sx),l=Math.ceil(i*t*o.sy),h=this.#i;if(!h||h.width===a&&h.height===l)return;h.width=a,h.height=l;const d=this.#l?this.#e:this.#u(a,l),u=h.getContext("2d");u.filter=this._uiManager.hcmFilter,u.drawImage(d,0,0,d.width,d.height,0,0,a,l)}#v(e){if(e){if(this.#l){const i=this._uiManager.imageManager.getSvgUrl(this.#t);if(i)return i}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#l){const[t,n]=this.pageDimensions,i=Math.round(this.width*t*PixelsPerInch.PDF_TO_CSS_UNITS),o=Math.round(this.height*n*PixelsPerInch.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(i,o);return a.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,i,o),a.transferToImageBitmap()}return structuredClone(this.#e)}static async deserialize(e,t,n){let i=null,o=!1;if(e instanceof StampAnnotationElement){const{data:{rect:x,rotation:E,id:b,structParent:_,popupRef:S,richText:C,contentsObj:A,creationDate:R,modificationDate:L},container:j,parent:{page:{pageNumber:F}},canvas:W}=e;let K,ee;W?(delete e.canvas,{id:K,bitmap:ee}=n.imageManager.getFromCanvas(j.id,W),W.remove()):(o=!0,e._hasNoCanvas=!0);const te=(await t._structTree.getAriaAttributes(`${AnnotationPrefix}${b}`))?.get("aria-label")||"";i=e={annotationType:AnnotationEditorType.STAMP,bitmapId:K,bitmap:ee,pageIndex:F-1,rect:x.slice(0),rotation:E,annotationElementId:b,id:b,deleted:!1,accessibilityData:{decorative:!1,altText:te},isSvg:!1,structParent:_,popupRef:S,richText:C,comment:A?.str||null,creationDate:R,modificationDate:L}}const a=await super.deserialize(e,t,n),{rect:l,bitmap:h,bitmapUrl:d,bitmapId:u,isSvg:f,accessibilityData:m}=e;o?(n.addMissingCanvas(e.id,a),a.#a=!0):u&&n.imageManager.isValidId(u)?(a.#t=u,h&&(a.#e=h)):a.#r=d,a.#l=f;const[v,g]=a.pageDimensions;return a.width=(l[2]-l[0])/v,a.height=(l[3]-l[1])/g,m&&(a.altTextData=m),a._initialData=i,e.comment&&a.setCommentData(e),a.#h=!!i,a}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Object.assign(super.serialize(e),{bitmapId:this.#t,isSvg:this.#l});if(this.addComment(n),e)return n.bitmapUrl=this.#v(!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:i,altText:o}=this.serializeAltText(!1);if(!i&&o&&(n.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const l=this.#y(n);return l.isSame?null:(l.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1,n.id=this.annotationElementId,delete n.bitmapId,n)}if(t===null)return n;t.stamps||=new Map;const a=this.#l?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:a,serialized:n}),n.bitmap=this.#v(!1);else if(this.#l){const l=t.stamps.get(this.#t);a>l.area&&(l.area=a,l.serialized.bitmap.close(),l.serialized.bitmap=this.#v(!1))}return n}#y(e){const{pageIndex:t,accessibilityData:{altText:n}}=this._initialData,i=e.pageIndex===t,o=(e.accessibilityData?.alt||"")===n;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&i&&o,isSameAltText:o}}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class AnnotationEditorLayer{#e;#t=!1;#n=null;#r=null;#s=null;#o=new Map;#i=!1;#a=!1;#c=!1;#l=null;#h=null;#d=null;#f=null;#g=null;#m=-1;#u;static _initialized=!1;static#p=new Map([FreeTextEditor,InkEditor,StampEditor,HighlightEditor,SignatureEditor].map(e=>[e._editorType,e]));constructor({uiManager:e,pageIndex:t,div:n,structTreeLayer:i,accessibilityManager:o,annotationLayer:a,drawLayer:l,textLayer:h,viewport:d,l10n:u}){const f=[...AnnotationEditorLayer.#p.values()];if(!AnnotationEditorLayer._initialized){AnnotationEditorLayer._initialized=!0;for(const m of f)m.initialize(u,e)}e.registerEditorTypes(f),this.#u=e,this.pageIndex=t,this.div=n,this.#e=o,this.#n=a,this.viewport=d,this.#d=h,this.drawLayer=l,this._structTree=i,this.#u.addLayer(this)}get isEmpty(){return this.#o.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===AnnotationEditorType.NONE}updateToolbar(e){this.#u.updateToolbar(e)}updateMode(e=this.#u.getMode()){switch(this.#b(),e){case AnnotationEditorType.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case AnnotationEditorType.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case AnnotationEditorType.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===AnnotationEditorType.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const n of AnnotationEditorLayer.#p.values())t.toggle(`${n._type}Editing`,e===n._editorType)}this.div.hidden=!1}hasTextLayer(e){return e===this.#d?.div}setEditingState(e){this.#u.setEditingState(e)}addCommands(e){this.#u.addCommands(e)}cleanUndoStack(e){this.#u.cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){this.#n?.div.classList.toggle("disabled",!e)}get#v(){return this.#o.size!==0?this.#o.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#g?.abort(),this.#g=null;const e=new Set;for(const n of this.#v)n.enableEditing(),n.show(!0),n.annotationElementId&&(this.#u.removeChangedExistingAnnotation(n),e.add(n.annotationElementId));const t=this.#n;if(t)for(const n of t.getEditableAnnotations()){if(n.hide(),this.#u.isDeletedAnnotationElement(n.data.id)||e.has(n.data.id))continue;const i=await this.deserialize(n);i&&(this.addOrRebuild(i),i.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#a=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#d&&!this.#g){this.#g=new AbortController;const n=this.#u.combinedSignal(this.#g);this.#d.div.addEventListener("pointerdown",i=>{const{clientX:a,clientY:l,timeStamp:h}=i,d=this.#m;if(h-d>500){this.#m=h;return}this.#m=-1;const{classList:u}=this.div;u.toggle("getElements",!0);const f=document.elementsFromPoint(a,l);if(u.toggle("getElements",!1),!this.div.contains(f[0]))return;let m;const v=new RegExp(`^${AnnotationEditorPrefix}[0-9]+$`);for(const x of f)if(v.test(x.id)){m=x.id;break}if(!m)return;const g=this.#o.get(m);g?.annotationElementId===null&&(i.stopPropagation(),i.preventDefault(),g.dblclick(i))},{signal:n,capture:!0})}const e=this.#n;if(e){const n=new Map,i=new Map;for(const a of this.#v){if(a.disableEditing(),!a.annotationElementId){a.updateFakeAnnotationElement(e);continue}if(a.serialize()!==null){n.set(a.annotationElementId,a);continue}else i.set(a.annotationElementId,a);this.getEditableAnnotation(a.annotationElementId)?.show(),a.remove()}const o=e.getEditableAnnotations();for(const a of o){const{id:l}=a.data;if(this.#u.isDeletedAnnotationElement(l)){a.updateEdited({deleted:!0});continue}let h=i.get(l);if(h){h.resetAnnotationElement(a),h.show(!1),a.show();continue}h=n.get(l),h&&(this.#u.addChangedExistingAnnotation(h),h.renderAnnotationElement(a)&&h.show(!1)),a.show()}}this.#b(),this.isEmpty&&(this.div.hidden=!0);const{classList:t}=this.div;for(const n of AnnotationEditorLayer.#p.values())t.remove(`${n._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#a=!1}getEditableAnnotation(e){return this.#n?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#u.getActive()!==e&&this.#u.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#d?.div&&!this.#f){this.#f=new AbortController;const e=this.#u.combinedSignal(this.#f);this.#d.div.addEventListener("pointerdown",this.#y.bind(this),{signal:e}),this.#d.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#d?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#d.div.classList.remove("highlighting"))}#y(e){this.#u.unselectAll();const{target:t}=e;if(t===this.#d.div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&this.#d.div.contains(t)){const{isMac:n}=util_FeatureTest.platform;if(e.button!==0||e.ctrlKey&&n)return;this.#u.showAllEditors("highlight",!0,!0),this.#d.div.classList.add("free"),this.toggleDrawing(),HighlightEditor.startHighlighting(this,this.#u.direction==="ltr",{target:this.#d.div,x:e.x,y:e.y}),this.#d.div.addEventListener("pointerup",()=>{this.#d.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),e.preventDefault()}}enableClick(){if(this.#r)return;this.#r=new AbortController;const e=this.#u.combinedSignal(this.#r);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){this.#r?.abort(),this.#r=null}attach(e){this.#o.set(e.id,e);const{annotationElementId:t}=e;t&&this.#u.isDeletedAnnotationElement(t)&&this.#u.removeDeletedAnnotationElement(e)}detach(e){this.#o.delete(e.id),this.#e?.removePointerInTextLayer(e.contentDiv),!this.#a&&e.annotationElementId&&this.#u.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#u.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#u.addDeletedAnnotationElement(e.annotationElementId),AnnotationEditor.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),this.#u.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!this.#c),this.#u.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#s&&(e._focusEventsAllowed=!1,this.#s=setTimeout(()=>{this.#s=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),t.focus())},0)),e._structTreeParentId=this.#e?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),n=()=>{e.remove()};this.addCommands({cmd:t,undo:n,mustExec:!1})}getEditorByUID(e){for(const t of this.#o.values())if(t.uid===e)return t;return null}getNextId(){return this.#u.getId()}get#x(){return AnnotationEditorLayer.#p.get(this.#u.getMode())}combinedSignal(e){return this.#u.combinedSignal(e)}#A(e){const t=this.#x;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#x?.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await this.#u.updateMode(e.mode);const{offsetX:n,offsetY:i}=this.#w(),o=this.getNextId(),a=this.#A({parent:this,id:o,x:n,y:i,uiManager:this.#u,isCentered:!0,...t});a&&this.add(a)}async deserialize(e){return await AnnotationEditorLayer.#p.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#u)||null}createAndAddNewEditor(e,t,n={}){const i=this.getNextId(),o=this.#A({parent:this,id:i,x:e.offsetX,y:e.offsetY,uiManager:this.#u,isCentered:t,...n});return o&&this.add(o),o}get boundingClientRect(){return this.div.getBoundingClientRect()}#w(){const{x:e,y:t,width:n,height:i}=this.boundingClientRect,o=Math.max(0,e),a=Math.max(0,t),l=Math.min(window.innerWidth,e+n),h=Math.min(window.innerHeight,t+i),d=(o+l)/2-e,u=(a+h)/2-t,[f,m]=this.viewport.rotation%180===0?[d,u]:[u,d];return{offsetX:f,offsetY:m}}addNewEditor(e={}){this.createAndAddNewEditor(this.#w(),!0,e)}setSelected(e){this.#u.setSelected(e)}toggleSelected(e){this.#u.toggleSelected(e)}unselect(e){this.#u.unselect(e)}pointerup(e){const{isMac:t}=util_FeatureTest.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!this.#i||(this.#i=!1,this.#x?.isDrawer&&this.#x.supportMultipleDrawings))return;if(!this.#t){this.#t=!0;return}const n=this.#u.getMode();if(n===AnnotationEditorType.STAMP||n===AnnotationEditorType.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){if(this.#u.getMode()===AnnotationEditorType.HIGHLIGHT&&this.enableTextSelection(),this.#i){this.#i=!1;return}const{isMac:t}=util_FeatureTest.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(this.#i=!0,this.#x?.isDrawer){this.startDrawingSession(e);return}const n=this.#u.getActive();this.#t=!n||n.isEmpty()}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),this.#l){this.#x.startDrawing(this,this.#u,!1,e);return}this.#u.setCurrentDrawingSession(this),this.#l=new AbortController;const t=this.#u.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(this.#h=null,this.commitOrRemove())},{signal:t}),this.#x.startDrawing(this,this.#u,!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&(this.#h=t);return}this.#h&&setTimeout(()=>{this.#h?.focus(),this.#h=null},0)}endDrawingSession(e=!1){return this.#l?(this.#u.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#h=null,this.#x.endDrawing(e)):null}findNewParent(e,t,n){const i=this.#u.findParent(t,n);return i===null||i===this?!1:(i.changeParent(e),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#x.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#s&&(clearTimeout(this.#s),this.#s=null);for(const e of this.#o.values())this.#e?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#o.clear(),this.#u.removeLayer(this)}#b(){for(const e of this.#o.values())e.isEmpty()&&e.remove()}render({viewport:e}){this.viewport=e,setLayerDimensions(this.div,e);for(const t of this.#u.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){this.#u.commitOrRemove(),this.#b();const t=this.viewport.rotation,n=e.rotation;if(this.viewport=e,setLayerDimensions(this.div,{rotation:n}),t!==n)for(const i of this.#o.values())i.rotate(n)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#u.viewParameters.realScale}}class DrawLayer{#e=null;#t=new Map;#n=new Map;static#r=0;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#t.size>0)for(const t of this.#t.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return shadow(this,"_svgFactory",new DOMSVGFactory)}static#s(e,[t,n,i,o]){const{style:a}=e;a.top=`${100*n}%`,a.left=`${100*t}%`,a.width=`${100*i}%`,a.height=`${100*o}%`}#o(){const e=DrawLayer._svgFactory.create(1,1,!0);return this.#e.append(e),e.setAttribute("aria-hidden",!0),e}#i(e,t){const n=DrawLayer._svgFactory.createElement("clipPath");e.append(n);const i=`clip_${t}`;n.setAttribute("id",i),n.setAttribute("clipPathUnits","objectBoundingBox");const o=DrawLayer._svgFactory.createElement("use");return n.append(o),o.setAttribute("href",`#${t}`),o.classList.add("clip"),i}#a(e,t){for(const[n,i]of Object.entries(t))i===null?e.removeAttribute(n):e.setAttribute(n,i)}draw(e,t=!1,n=!1){const i=DrawLayer.#r++,o=this.#o(),a=DrawLayer._svgFactory.createElement("defs");o.append(a);const l=DrawLayer._svgFactory.createElement("path");a.append(l);const h=`path_p${this.pageIndex}_${i}`;l.setAttribute("id",h),l.setAttribute("vector-effect","non-scaling-stroke"),t&&this.#n.set(i,l);const d=n?this.#i(a,h):null,u=DrawLayer._svgFactory.createElement("use");return o.append(u),u.setAttribute("href",`#${h}`),this.updateProperties(o,e),this.#t.set(i,o),{id:i,clipPathId:`url(#${d})`}}drawOutline(e,t){const n=DrawLayer.#r++,i=this.#o(),o=DrawLayer._svgFactory.createElement("defs");i.append(o);const a=DrawLayer._svgFactory.createElement("path");o.append(a);const l=`path_p${this.pageIndex}_${n}`;a.setAttribute("id",l),a.setAttribute("vector-effect","non-scaling-stroke");let h;if(t){const f=DrawLayer._svgFactory.createElement("mask");o.append(f),h=`mask_p${this.pageIndex}_${n}`,f.setAttribute("id",h),f.setAttribute("maskUnits","objectBoundingBox");const m=DrawLayer._svgFactory.createElement("rect");f.append(m),m.setAttribute("width","1"),m.setAttribute("height","1"),m.setAttribute("fill","white");const v=DrawLayer._svgFactory.createElement("use");f.append(v),v.setAttribute("href",`#${l}`),v.setAttribute("stroke","none"),v.setAttribute("fill","black"),v.setAttribute("fill-rule","nonzero"),v.classList.add("mask")}const d=DrawLayer._svgFactory.createElement("use");i.append(d),d.setAttribute("href",`#${l}`),h&&d.setAttribute("mask",`url(#${h})`);const u=d.cloneNode();return i.append(u),d.classList.add("mainOutline"),u.classList.add("secondaryOutline"),this.updateProperties(i,e),this.#t.set(n,i),n}finalizeDraw(e,t){this.#n.delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:n,bbox:i,rootClass:o,path:a}=t,l=typeof e=="number"?this.#t.get(e):e;if(l){if(n&&this.#a(l,n),i&&DrawLayer.#s(l,i),o){const{classList:h}=l;for(const[d,u]of Object.entries(o))h.toggle(d,u)}if(a){const d=l.firstChild.firstChild;this.#a(d,a)}}}updateParent(e,t){if(t===this)return;const n=this.#t.get(e);n&&(t.#e.append(n),this.#t.delete(e),t.#t.set(e,n))}remove(e){this.#n.delete(e),this.#e!==null&&(this.#t.get(e).remove(),this.#t.delete(e))}destroy(){this.#e=null;for(const e of this.#t.values())e.remove();this.#t.clear(),this.#n.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner};globalThis.pdfjsLib={AbortException,AnnotationEditorLayer,AnnotationEditorParamsType,AnnotationEditorType,AnnotationEditorUIManager,AnnotationLayer:AnnotationLayer$1,AnnotationMode,AnnotationType,applyOpacity,build,ColorPicker,createValidAbsoluteUrl,CSSConstants,DOMSVGFactory,DrawLayer,FeatureTest:util_FeatureTest,fetchData,findContrastColor,getDocument,getFilenameFromUrl,getPdfFilenameFromUrl,getRGB,getUuid,getXfaPageViewport,GlobalWorkerOptions,ImageKind:util_ImageKind,InvalidPDFException,isDataScheme,isPdfFile,isValidExplicitDest,MathClamp,noContextMenu,normalizeUnicode,OPS,OutputScale,PasswordResponses:PasswordResponses$1,PDFDataRangeTransport:PDFDataRangeTransport$2,PDFDateString,PDFWorker,PermissionFlag,PixelsPerInch,RenderingCancelledException,renderRichText,ResponseException,setLayerDimensions,shadow,SignatureExtractor,stopEvent,SupportedImageMimeTypes,TextLayer:TextLayer$1,TouchManager,updateUrlHash,Util,VerbosityLevel,version,XfaLayer};const pdfjsWorker="/assets/pdf.worker.min-qwK7q_zL.mjs";GlobalWorkerOptions.workerSrc=pdfjsWorker;function validatePDF(s){return!s.type||s.type!=="application/pdf"?{valid:!1,error:"File must be a PDF"}:s.size>52428800?{valid:!1,error:"PDF must be smaller than 50MB"}:{valid:!0}}function UploadDialog({open:s,onOpenChange:e,onUpload:t}){const[n,i]=reactExports.useState(null),[o,a]=reactExports.useState("select"),[l,h]=reactExports.useState(0),[d,u]=reactExports.useState(""),[f,m]=reactExports.useState(""),[v,g]=reactExports.useState(""),[x,E]=reactExports.useState(""),[b,_]=reactExports.useState(!1),S=reactExports.useState({current:!1})[0],C=K=>{if(K.length===0)return;const ee=K[0],te=validatePDF(ee);if(!te.valid){toast.error(te.error);return}i(ee),m(ee.name.replace(".pdf","")),a("metadata"),u("")},{getRootProps:A,getInputProps:R,isDragActive:L}=useDropzone({onDrop:C,accept:{"application/pdf":[".pdf"]},maxFiles:1,multiple:!1}),j=async()=>{if(n)try{a("uploading"),h(0),_(!0),S.current=!1;const K={title:f.trim()||n.name.replace(".pdf",""),subject:v.trim()||void 0,learningGoal:x.trim()||void 0};if(await t(n,K),S.current){console.log("[Upload] Aborted by user");return}a("done"),h(100),_(!1),setTimeout(()=>{W()},1500)}catch(K){if(S.current)return;console.error("[Upload] Error:",K),u(K instanceof Error?K.message:"Upload failed"),a("error"),_(!1)}},F=()=>{b&&(S.current=!0,toast.error("Upload canceled - note: this may not stop all processing")),W()},W=()=>{i(null),a("select"),h(0),u(""),m(""),g(""),E(""),e(!1)};return console.log("[UploadDialog] Render - open:",s,"stage:",o),s?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{style:{position:"fixed",inset:0,backgroundColor:"rgba(0, 0, 0, 0.8)",zIndex:50},onClick:()=>{b?confirm("Upload in progress. Cancel upload and close?")&&F():e(!1)}}),jsxRuntimeExports.jsxs("div",{style:{position:"fixed",left:"50%",top:"50%",transform:"translate(-50%, -50%)",zIndex:51,width:"90%",maxWidth:"500px",backgroundColor:"white",borderRadius:"8px",padding:"24px",boxShadow:"0 10px 40px rgba(0,0,0,0.3)"},children:[jsxRuntimeExports.jsx("button",{onClick:()=>{b?confirm("Upload in progress. Cancel upload and close?")&&F():e(!1)},style:{position:"absolute",right:"16px",top:"16px",background:"none",border:"none",cursor:"pointer",fontSize:"20px"},children:""}),jsxRuntimeExports.jsx("h2",{style:{fontSize:"18px",fontWeight:"600",marginBottom:"8px"},children:"Upload Textbook"}),jsxRuntimeExports.jsx("p",{style:{fontSize:"14px",color:"#666",marginBottom:"16px"},children:"Upload a PDF textbook to start reading with AI assistance"}),jsxRuntimeExports.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"16px"},children:[o==="select"&&jsxRuntimeExports.jsxs("div",{...A(),style:{border:"2px dashed #ccc",borderRadius:"8px",padding:"32px",textAlign:"center",cursor:"pointer",backgroundColor:L?"#f0f9ff":"transparent"},children:[jsxRuntimeExports.jsx("input",{...R()}),jsxRuntimeExports.jsx(Upload,{style:{width:"48px",height:"48px",margin:"0 auto 16px",color:"#999"}}),L?jsxRuntimeExports.jsx("p",{style:{fontSize:"14px",fontWeight:"500"},children:"Drop PDF here..."}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("p",{style:{fontSize:"14px",fontWeight:"500",marginBottom:"4px"},children:"Drag & drop PDF here, or click to browse"}),jsxRuntimeExports.jsx("p",{style:{fontSize:"12px",color:"#999"},children:"Maximum file size: 50MB"})]})]}),o==="metadata"&&n&&jsxRuntimeExports.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[jsxRuntimeExports.jsxs("div",{style:{padding:"12px",backgroundColor:"#f5f5f5",borderRadius:"6px"},children:[jsxRuntimeExports.jsx("p",{style:{fontSize:"14px",fontWeight:"500"},children:n.name}),jsxRuntimeExports.jsxs("p",{style:{fontSize:"12px",color:"#666"},children:[(n.size/1024/1024).toFixed(2)," MB"]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"500",marginBottom:"4px"},children:"Title *"}),jsxRuntimeExports.jsx("input",{type:"text",value:f,onChange:K=>m(K.target.value),placeholder:"e.g., Deep Learning Fundamentals",style:{width:"100%",padding:"8px 12px",border:"1px solid #ccc",borderRadius:"6px",fontSize:"14px"}})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{style:{display:"block",fontSize:"12px",fontWeight:"500",marginBottom:"4px"},children:"Subject (optional)"}),jsxRuntimeExports.jsx("input",{type:"text",value:v,onChange:K=>g(K.target.value),placeholder:"e.g., Machine Learning, Physics",style:{width:"100%",padding:"8px 12px",border:"1px solid #ccc",borderRadius:"6px",fontSize:"14px"}})]}),jsxRuntimeExports.jsx("button",{onClick:j,disabled:!f.trim(),style:{width:"100%",padding:"10px 16px",backgroundColor:f.trim()?"#000":"#ccc",color:"white",border:"none",borderRadius:"6px",cursor:f.trim()?"pointer":"not-allowed",fontSize:"14px",fontWeight:"500"},children:"Upload & Process"})]}),(o==="uploading"||o==="extracting"||o==="saving")&&jsxRuntimeExports.jsxs("div",{style:{textAlign:"center",padding:"20px"},children:[jsxRuntimeExports.jsx("div",{style:{marginBottom:"12px"},children:jsxRuntimeExports.jsx("div",{style:{width:"40px",height:"40px",border:"4px solid #f3f3f3",borderTop:"4px solid #000",borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto"}})}),jsxRuntimeExports.jsxs("p",{style:{fontSize:"14px",fontWeight:"500",marginBottom:"4px"},children:[o==="uploading"&&"Uploading PDF...",o==="extracting"&&"Extracting text from pages...",o==="saving"&&"Saving to database..."]}),jsxRuntimeExports.jsx("p",{style:{fontSize:"12px",color:"#666",marginBottom:"16px"},children:l>0?`${Math.round(l)}%`:"Please wait..."}),jsxRuntimeExports.jsx("p",{style:{fontSize:"11px",color:"#999",marginBottom:"12px"},children:"This may take a few minutes for large PDFs"}),jsxRuntimeExports.jsx("button",{onClick:F,style:{padding:"6px 16px",backgroundColor:"white",color:"#dc2626",border:"1px solid #dc2626",borderRadius:"6px",cursor:"pointer",fontSize:"12px",fontWeight:"500"},children:"Cancel Upload"})]}),o==="done"&&jsxRuntimeExports.jsxs("div",{style:{padding:"16px",backgroundColor:"#f0fdf4",borderRadius:"6px",textAlign:"center"},children:[jsxRuntimeExports.jsx("p",{style:{fontSize:"16px",color:"#16a34a",marginBottom:"4px"},children:" Upload Complete!"}),jsxRuntimeExports.jsx("p",{style:{fontSize:"12px",color:"#15803d"},children:"Opening your textbook..."})]}),o==="error"&&jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{style:{padding:"16px",backgroundColor:"#fef2f2",borderRadius:"6px",marginBottom:"12px"},children:[jsxRuntimeExports.jsx("p",{style:{fontSize:"14px",color:"#dc2626",marginBottom:"4px"},children:"Upload Failed"}),jsxRuntimeExports.jsx("p",{style:{fontSize:"12px",color:"#991b1b"},children:d})]}),jsxRuntimeExports.jsx("button",{onClick:()=>a("select"),style:{width:"100%",padding:"8px 16px",backgroundColor:"white",color:"#000",border:"1px solid #ccc",borderRadius:"6px",cursor:"pointer",fontSize:"14px",fontWeight:"500"},children:"Try Again"})]})]})]})]}):null}function useStateMachine$1(s,e){return reactExports.useReducer((t,n)=>e[t][n]??t,s)}var Presence=s=>{const{present:e,children:t}=s,n=usePresence$1(e),i=typeof t=="function"?t({present:n.isPresent}):reactExports.Children.only(t),o=useComposedRefs(n.ref,getElementRef(i));return typeof t=="function"||n.isPresent?reactExports.cloneElement(i,{ref:o}):null};Presence.displayName="Presence";function usePresence$1(s){const[e,t]=reactExports.useState(),n=reactExports.useRef(null),i=reactExports.useRef(s),o=reactExports.useRef("none"),a=s?"mounted":"unmounted",[l,h]=useStateMachine$1(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return reactExports.useEffect(()=>{const d=getAnimationName(n.current);o.current=l==="mounted"?d:"none"},[l]),useLayoutEffect2(()=>{const d=n.current,u=i.current;if(u!==s){const m=o.current,v=getAnimationName(d);s?h("MOUNT"):v==="none"||d?.display==="none"?h("UNMOUNT"):h(u&&m!==v?"ANIMATION_OUT":"UNMOUNT"),i.current=s}},[s,h]),useLayoutEffect2(()=>{if(e){let d;const u=e.ownerDocument.defaultView??window,f=v=>{const x=getAnimationName(n.current).includes(CSS.escape(v.animationName));if(v.target===e&&x&&(h("ANIMATION_END"),!i.current)){const E=e.style.animationFillMode;e.style.animationFillMode="forwards",d=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=E)})}},m=v=>{v.target===e&&(o.current=getAnimationName(n.current))};return e.addEventListener("animationstart",m),e.addEventListener("animationcancel",f),e.addEventListener("animationend",f),()=>{u.clearTimeout(d),e.removeEventListener("animationstart",m),e.removeEventListener("animationcancel",f),e.removeEventListener("animationend",f)}}else h("ANIMATION_END")},[e,h]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:reactExports.useCallback(d=>{n.current=d?getComputedStyle(d):null,t(d)},[])}}function getAnimationName(s){return s?.animationName||"none"}function getElementRef(s){let e=Object.getOwnPropertyDescriptor(s.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?s.ref:(e=Object.getOwnPropertyDescriptor(s,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?s.props.ref:s.props.ref||s.ref)}var ENTRY_FOCUS="rovingFocusGroup.onEntryFocus",EVENT_OPTIONS={bubbles:!1,cancelable:!0},GROUP_NAME$2="RovingFocusGroup",[Collection$1,useCollection$1,createCollectionScope$1]=createCollection(GROUP_NAME$2),[createRovingFocusGroupContext,createRovingFocusGroupScope]=createContextScope(GROUP_NAME$2,[createCollectionScope$1]),[RovingFocusProvider,useRovingFocusContext]=createRovingFocusGroupContext(GROUP_NAME$2),RovingFocusGroup=reactExports.forwardRef((s,e)=>jsxRuntimeExports.jsx(Collection$1.Provider,{scope:s.__scopeRovingFocusGroup,children:jsxRuntimeExports.jsx(Collection$1.Slot,{scope:s.__scopeRovingFocusGroup,children:jsxRuntimeExports.jsx(RovingFocusGroupImpl,{...s,ref:e})})}));RovingFocusGroup.displayName=GROUP_NAME$2;var RovingFocusGroupImpl=reactExports.forwardRef((s,e)=>{const{__scopeRovingFocusGroup:t,orientation:n,loop:i=!1,dir:o,currentTabStopId:a,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:h,onEntryFocus:d,preventScrollOnEntryFocus:u=!1,...f}=s,m=reactExports.useRef(null),v=useComposedRefs(e,m),g=useDirection(o),[x,E]=useControllableState({prop:a,defaultProp:l??null,onChange:h,caller:GROUP_NAME$2}),[b,_]=reactExports.useState(!1),S=useCallbackRef$1(d),C=useCollection$1(t),A=reactExports.useRef(!1),[R,L]=reactExports.useState(0);return reactExports.useEffect(()=>{const j=m.current;if(j)return j.addEventListener(ENTRY_FOCUS,S),()=>j.removeEventListener(ENTRY_FOCUS,S)},[S]),jsxRuntimeExports.jsx(RovingFocusProvider,{scope:t,orientation:n,dir:g,loop:i,currentTabStopId:x,onItemFocus:reactExports.useCallback(j=>E(j),[E]),onItemShiftTab:reactExports.useCallback(()=>_(!0),[]),onFocusableItemAdd:reactExports.useCallback(()=>L(j=>j+1),[]),onFocusableItemRemove:reactExports.useCallback(()=>L(j=>j-1),[]),children:jsxRuntimeExports.jsx(Primitive.div,{tabIndex:b||R===0?-1:0,"data-orientation":n,...f,ref:v,style:{outline:"none",...s.style},onMouseDown:composeEventHandlers$1(s.onMouseDown,()=>{A.current=!0}),onFocus:composeEventHandlers$1(s.onFocus,j=>{const F=!A.current;if(j.target===j.currentTarget&&F&&!b){const W=new CustomEvent(ENTRY_FOCUS,EVENT_OPTIONS);if(j.currentTarget.dispatchEvent(W),!W.defaultPrevented){const K=C().filter(Q=>Q.focusable),ee=K.find(Q=>Q.active),te=K.find(Q=>Q.id===x),ie=[ee,te,...K].filter(Boolean).map(Q=>Q.ref.current);focusFirst$1(ie,u)}}A.current=!1}),onBlur:composeEventHandlers$1(s.onBlur,()=>_(!1))})})}),ITEM_NAME$2="RovingFocusGroupItem",RovingFocusGroupItem=reactExports.forwardRef((s,e)=>{const{__scopeRovingFocusGroup:t,focusable:n=!0,active:i=!1,tabStopId:o,children:a,...l}=s,h=useId$1(),d=o||h,u=useRovingFocusContext(ITEM_NAME$2,t),f=u.currentTabStopId===d,m=useCollection$1(t),{onFocusableItemAdd:v,onFocusableItemRemove:g,currentTabStopId:x}=u;return reactExports.useEffect(()=>{if(n)return v(),()=>g()},[n,v,g]),jsxRuntimeExports.jsx(Collection$1.ItemSlot,{scope:t,id:d,focusable:n,active:i,children:jsxRuntimeExports.jsx(Primitive.span,{tabIndex:f?0:-1,"data-orientation":u.orientation,...l,ref:e,onMouseDown:composeEventHandlers$1(s.onMouseDown,E=>{n?u.onItemFocus(d):E.preventDefault()}),onFocus:composeEventHandlers$1(s.onFocus,()=>u.onItemFocus(d)),onKeyDown:composeEventHandlers$1(s.onKeyDown,E=>{if(E.key==="Tab"&&E.shiftKey){u.onItemShiftTab();return}if(E.target!==E.currentTarget)return;const b=getFocusIntent(E,u.orientation,u.dir);if(b!==void 0){if(E.metaKey||E.ctrlKey||E.altKey||E.shiftKey)return;E.preventDefault();let S=m().filter(C=>C.focusable).map(C=>C.ref.current);if(b==="last")S.reverse();else if(b==="prev"||b==="next"){b==="prev"&&S.reverse();const C=S.indexOf(E.currentTarget);S=u.loop?wrapArray$1(S,C+1):S.slice(C+1)}setTimeout(()=>focusFirst$1(S))}}),children:typeof a=="function"?a({isCurrentTabStop:f,hasTabStop:x!=null}):a})})});RovingFocusGroupItem.displayName=ITEM_NAME$2;var MAP_KEY_TO_FOCUS_INTENT={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function getDirectionAwareKey(s,e){return e!=="rtl"?s:s==="ArrowLeft"?"ArrowRight":s==="ArrowRight"?"ArrowLeft":s}function getFocusIntent(s,e,t){const n=getDirectionAwareKey(s.key,t);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(n))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(n)))return MAP_KEY_TO_FOCUS_INTENT[n]}function focusFirst$1(s,e=!1){const t=document.activeElement;for(const n of s)if(n===t||(n.focus({preventScroll:e}),document.activeElement!==t))return}function wrapArray$1(s,e){return s.map((t,n)=>s[(e+n)%s.length])}var Root$3=RovingFocusGroup,Item=RovingFocusGroupItem,SELECTION_KEYS=["Enter"," "],FIRST_KEYS=["ArrowDown","PageUp","Home"],LAST_KEYS=["ArrowUp","PageDown","End"],FIRST_LAST_KEYS=[...FIRST_KEYS,...LAST_KEYS],SUB_OPEN_KEYS={ltr:[...SELECTION_KEYS,"ArrowRight"],rtl:[...SELECTION_KEYS,"ArrowLeft"]},SUB_CLOSE_KEYS={ltr:["ArrowLeft"],rtl:["ArrowRight"]},MENU_NAME="Menu",[Collection,useCollection,createCollectionScope]=createCollection(MENU_NAME),[createMenuContext,createMenuScope]=createContextScope(MENU_NAME,[createCollectionScope,createPopperScope,createRovingFocusGroupScope]),usePopperScope=createPopperScope(),useRovingFocusGroupScope$1=createRovingFocusGroupScope(),[MenuProvider,useMenuContext]=createMenuContext(MENU_NAME),[MenuRootProvider,useMenuRootContext]=createMenuContext(MENU_NAME),Menu=s=>{const{__scopeMenu:e,open:t=!1,children:n,dir:i,onOpenChange:o,modal:a=!0}=s,l=usePopperScope(e),[h,d]=reactExports.useState(null),u=reactExports.useRef(!1),f=useCallbackRef$1(o),m=useDirection(i);return reactExports.useEffect(()=>{const v=()=>{u.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>u.current=!1;return document.addEventListener("keydown",v,{capture:!0}),()=>{document.removeEventListener("keydown",v,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),jsxRuntimeExports.jsx(Root2$4,{...l,children:jsxRuntimeExports.jsx(MenuProvider,{scope:e,open:t,onOpenChange:f,content:h,onContentChange:d,children:jsxRuntimeExports.jsx(MenuRootProvider,{scope:e,onClose:reactExports.useCallback(()=>f(!1),[f]),isUsingKeyboardRef:u,dir:m,modal:a,children:n})})})};Menu.displayName=MENU_NAME;var ANCHOR_NAME="MenuAnchor",MenuAnchor=reactExports.forwardRef((s,e)=>{const{__scopeMenu:t,...n}=s,i=usePopperScope(t);return jsxRuntimeExports.jsx(Anchor,{...i,...n,ref:e})});MenuAnchor.displayName=ANCHOR_NAME;var PORTAL_NAME$3="MenuPortal",[PortalProvider$1,usePortalContext$1]=createMenuContext(PORTAL_NAME$3,{forceMount:void 0}),MenuPortal=s=>{const{__scopeMenu:e,forceMount:t,children:n,container:i}=s,o=useMenuContext(PORTAL_NAME$3,e);return jsxRuntimeExports.jsx(PortalProvider$1,{scope:e,forceMount:t,children:jsxRuntimeExports.jsx(Presence,{present:t||o.open,children:jsxRuntimeExports.jsx(Portal$3,{asChild:!0,container:i,children:n})})})};MenuPortal.displayName=PORTAL_NAME$3;var CONTENT_NAME$4="MenuContent",[MenuContentProvider,useMenuContentContext]=createMenuContext(CONTENT_NAME$4),MenuContent=reactExports.forwardRef((s,e)=>{const t=usePortalContext$1(CONTENT_NAME$4,s.__scopeMenu),{forceMount:n=t.forceMount,...i}=s,o=useMenuContext(CONTENT_NAME$4,s.__scopeMenu),a=useMenuRootContext(CONTENT_NAME$4,s.__scopeMenu);return jsxRuntimeExports.jsx(Collection.Provider,{scope:s.__scopeMenu,children:jsxRuntimeExports.jsx(Presence,{present:n||o.open,children:jsxRuntimeExports.jsx(Collection.Slot,{scope:s.__scopeMenu,children:a.modal?jsxRuntimeExports.jsx(MenuRootContentModal,{...i,ref:e}):jsxRuntimeExports.jsx(MenuRootContentNonModal,{...i,ref:e})})})})}),MenuRootContentModal=reactExports.forwardRef((s,e)=>{const t=useMenuContext(CONTENT_NAME$4,s.__scopeMenu),n=reactExports.useRef(null),i=useComposedRefs(e,n);return reactExports.useEffect(()=>{const o=n.current;if(o)return hideOthers(o)},[]),jsxRuntimeExports.jsx(MenuContentImpl,{...s,ref:i,trapFocus:t.open,disableOutsidePointerEvents:t.open,disableOutsideScroll:!0,onFocusOutside:composeEventHandlers$1(s.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>t.onOpenChange(!1)})}),MenuRootContentNonModal=reactExports.forwardRef((s,e)=>{const t=useMenuContext(CONTENT_NAME$4,s.__scopeMenu);return jsxRuntimeExports.jsx(MenuContentImpl,{...s,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>t.onOpenChange(!1)})}),Slot$1=createSlot("MenuContent.ScrollLock"),MenuContentImpl=reactExports.forwardRef((s,e)=>{const{__scopeMenu:t,loop:n=!1,trapFocus:i,onOpenAutoFocus:o,onCloseAutoFocus:a,disableOutsidePointerEvents:l,onEntryFocus:h,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:f,onInteractOutside:m,onDismiss:v,disableOutsideScroll:g,...x}=s,E=useMenuContext(CONTENT_NAME$4,t),b=useMenuRootContext(CONTENT_NAME$4,t),_=usePopperScope(t),S=useRovingFocusGroupScope$1(t),C=useCollection(t),[A,R]=reactExports.useState(null),L=reactExports.useRef(null),j=useComposedRefs(e,L,E.onContentChange),F=reactExports.useRef(0),W=reactExports.useRef(""),K=reactExports.useRef(0),ee=reactExports.useRef(null),te=reactExports.useRef("right"),re=reactExports.useRef(0),ie=g?ReactRemoveScroll:reactExports.Fragment,Q=g?{as:Slot$1,allowPinchZoom:!0}:void 0,z=k=>{const I=W.current+k,D=C().filter(O=>!O.disabled),U=document.activeElement,$=D.find(O=>O.ref.current===U)?.textValue,q=D.map(O=>O.textValue),V=getNextMatch(q,I,$),P=D.find(O=>O.textValue===V)?.ref.current;(function O(B){W.current=B,window.clearTimeout(F.current),B!==""&&(F.current=window.setTimeout(()=>O(""),1e3))})(I),P&&setTimeout(()=>P.focus())};reactExports.useEffect(()=>()=>window.clearTimeout(F.current),[]),useFocusGuards();const N=reactExports.useCallback(k=>te.current===ee.current?.side&&isPointerInGraceArea(k,ee.current?.area),[]);return jsxRuntimeExports.jsx(MenuContentProvider,{scope:t,searchRef:W,onItemEnter:reactExports.useCallback(k=>{N(k)&&k.preventDefault()},[N]),onItemLeave:reactExports.useCallback(k=>{N(k)||(L.current?.focus(),R(null))},[N]),onTriggerLeave:reactExports.useCallback(k=>{N(k)&&k.preventDefault()},[N]),pointerGraceTimerRef:K,onPointerGraceIntentChange:reactExports.useCallback(k=>{ee.current=k},[]),children:jsxRuntimeExports.jsx(ie,{...Q,children:jsxRuntimeExports.jsx(FocusScope,{asChild:!0,trapped:i,onMountAutoFocus:composeEventHandlers$1(o,k=>{k.preventDefault(),L.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:a,children:jsxRuntimeExports.jsx(DismissableLayer,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:d,onPointerDownOutside:u,onFocusOutside:f,onInteractOutside:m,onDismiss:v,children:jsxRuntimeExports.jsx(Root$3,{asChild:!0,...S,dir:b.dir,orientation:"vertical",loop:n,currentTabStopId:A,onCurrentTabStopIdChange:R,onEntryFocus:composeEventHandlers$1(h,k=>{b.isUsingKeyboardRef.current||k.preventDefault()}),preventScrollOnEntryFocus:!0,children:jsxRuntimeExports.jsx(Content$2,{role:"menu","aria-orientation":"vertical","data-state":getOpenState(E.open),"data-radix-menu-content":"",dir:b.dir,..._,...x,ref:j,style:{outline:"none",...x.style},onKeyDown:composeEventHandlers$1(x.onKeyDown,k=>{const D=k.target.closest("[data-radix-menu-content]")===k.currentTarget,U=k.ctrlKey||k.altKey||k.metaKey,$=k.key.length===1;D&&(k.key==="Tab"&&k.preventDefault(),!U&&$&&z(k.key));const q=L.current;if(k.target!==q||!FIRST_LAST_KEYS.includes(k.key))return;k.preventDefault();const P=C().filter(O=>!O.disabled).map(O=>O.ref.current);LAST_KEYS.includes(k.key)&&P.reverse(),focusFirst(P)}),onBlur:composeEventHandlers$1(s.onBlur,k=>{k.currentTarget.contains(k.target)||(window.clearTimeout(F.current),W.current="")}),onPointerMove:composeEventHandlers$1(s.onPointerMove,whenMouse(k=>{const I=k.target,D=re.current!==k.clientX;if(k.currentTarget.contains(I)&&D){const U=k.clientX>re.current?"right":"left";te.current=U,re.current=k.clientX}}))})})})})})})});MenuContent.displayName=CONTENT_NAME$4;var GROUP_NAME$1="MenuGroup",MenuGroup=reactExports.forwardRef((s,e)=>{const{__scopeMenu:t,...n}=s;return jsxRuntimeExports.jsx(Primitive.div,{role:"group",...n,ref:e})});MenuGroup.displayName=GROUP_NAME$1;var LABEL_NAME$1="MenuLabel",MenuLabel=reactExports.forwardRef((s,e)=>{const{__scopeMenu:t,...n}=s;return jsxRuntimeExports.jsx(Primitive.div,{...n,ref:e})});MenuLabel.displayName=LABEL_NAME$1;var ITEM_NAME$1="MenuItem",ITEM_SELECT="menu.itemSelect",MenuItem=reactExports.forwardRef((s,e)=>{const{disabled:t=!1,onSelect:n,...i}=s,o=reactExports.useRef(null),a=useMenuRootContext(ITEM_NAME$1,s.__scopeMenu),l=useMenuContentContext(ITEM_NAME$1,s.__scopeMenu),h=useComposedRefs(e,o),d=reactExports.useRef(!1),u=()=>{const f=o.current;if(!t&&f){const m=new CustomEvent(ITEM_SELECT,{bubbles:!0,cancelable:!0});f.addEventListener(ITEM_SELECT,v=>n?.(v),{once:!0}),dispatchDiscreteCustomEvent(f,m),m.defaultPrevented?d.current=!1:a.onClose()}};return jsxRuntimeExports.jsx(MenuItemImpl,{...i,ref:h,disabled:t,onClick:composeEventHandlers$1(s.onClick,u),onPointerDown:f=>{s.onPointerDown?.(f),d.current=!0},onPointerUp:composeEventHandlers$1(s.onPointerUp,f=>{d.current||f.currentTarget?.click()}),onKeyDown:composeEventHandlers$1(s.onKeyDown,f=>{const m=l.searchRef.current!=="";t||m&&f.key===" "||SELECTION_KEYS.includes(f.key)&&(f.currentTarget.click(),f.preventDefault())})})});MenuItem.displayName=ITEM_NAME$1;var MenuItemImpl=reactExports.forwardRef((s,e)=>{const{__scopeMenu:t,disabled:n=!1,textValue:i,...o}=s,a=useMenuContentContext(ITEM_NAME$1,t),l=useRovingFocusGroupScope$1(t),h=reactExports.useRef(null),d=useComposedRefs(e,h),[u,f]=reactExports.useState(!1),[m,v]=reactExports.useState("");return reactExports.useEffect(()=>{const g=h.current;g&&v((g.textContent??"").trim())},[o.children]),jsxRuntimeExports.jsx(Collection.ItemSlot,{scope:t,disabled:n,textValue:i??m,children:jsxRuntimeExports.jsx(Item,{asChild:!0,...l,focusable:!n,children:jsxRuntimeExports.jsx(Primitive.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":n||void 0,"data-disabled":n?"":void 0,...o,ref:d,onPointerMove:composeEventHandlers$1(s.onPointerMove,whenMouse(g=>{n?a.onItemLeave(g):(a.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:composeEventHandlers$1(s.onPointerLeave,whenMouse(g=>a.onItemLeave(g))),onFocus:composeEventHandlers$1(s.onFocus,()=>f(!0)),onBlur:composeEventHandlers$1(s.onBlur,()=>f(!1))})})})}),CHECKBOX_ITEM_NAME$1="MenuCheckboxItem",MenuCheckboxItem=reactExports.forwardRef((s,e)=>{const{checked:t=!1,onCheckedChange:n,...i}=s;return jsxRuntimeExports.jsx(ItemIndicatorProvider,{scope:s.__scopeMenu,checked:t,children:jsxRuntimeExports.jsx(MenuItem,{role:"menuitemcheckbox","aria-checked":isIndeterminate(t)?"mixed":t,...i,ref:e,"data-state":getCheckedState(t),onSelect:composeEventHandlers$1(i.onSelect,()=>n?.(isIndeterminate(t)?!0:!t),{checkForDefaultPrevented:!1})})})});MenuCheckboxItem.displayName=CHECKBOX_ITEM_NAME$1;var RADIO_GROUP_NAME$1="MenuRadioGroup",[RadioGroupProvider,useRadioGroupContext]=createMenuContext(RADIO_GROUP_NAME$1,{value:void 0,onValueChange:()=>{}}),MenuRadioGroup=reactExports.forwardRef((s,e)=>{const{value:t,onValueChange:n,...i}=s,o=useCallbackRef$1(n);return jsxRuntimeExports.jsx(RadioGroupProvider,{scope:s.__scopeMenu,value:t,onValueChange:o,children:jsxRuntimeExports.jsx(MenuGroup,{...i,ref:e})})});MenuRadioGroup.displayName=RADIO_GROUP_NAME$1;var RADIO_ITEM_NAME$1="MenuRadioItem",MenuRadioItem=reactExports.forwardRef((s,e)=>{const{value:t,...n}=s,i=useRadioGroupContext(RADIO_ITEM_NAME$1,s.__scopeMenu),o=t===i.value;return jsxRuntimeExports.jsx(ItemIndicatorProvider,{scope:s.__scopeMenu,checked:o,children:jsxRuntimeExports.jsx(MenuItem,{role:"menuitemradio","aria-checked":o,...n,ref:e,"data-state":getCheckedState(o),onSelect:composeEventHandlers$1(n.onSelect,()=>i.onValueChange?.(t),{checkForDefaultPrevented:!1})})})});MenuRadioItem.displayName=RADIO_ITEM_NAME$1;var ITEM_INDICATOR_NAME="MenuItemIndicator",[ItemIndicatorProvider,useItemIndicatorContext]=createMenuContext(ITEM_INDICATOR_NAME,{checked:!1}),MenuItemIndicator=reactExports.forwardRef((s,e)=>{const{__scopeMenu:t,forceMount:n,...i}=s,o=useItemIndicatorContext(ITEM_INDICATOR_NAME,t);return jsxRuntimeExports.jsx(Presence,{present:n||isIndeterminate(o.checked)||o.checked===!0,children:jsxRuntimeExports.jsx(Primitive.span,{...i,ref:e,"data-state":getCheckedState(o.checked)})})});MenuItemIndicator.displayName=ITEM_INDICATOR_NAME;var SEPARATOR_NAME$1="MenuSeparator",MenuSeparator=reactExports.forwardRef((s,e)=>{const{__scopeMenu:t,...n}=s;return jsxRuntimeExports.jsx(Primitive.div,{role:"separator","aria-orientation":"horizontal",...n,ref:e})});MenuSeparator.displayName=SEPARATOR_NAME$1;var ARROW_NAME$1="MenuArrow",MenuArrow=reactExports.forwardRef((s,e)=>{const{__scopeMenu:t,...n}=s,i=usePopperScope(t);return jsxRuntimeExports.jsx(Arrow,{...i,...n,ref:e})});MenuArrow.displayName=ARROW_NAME$1;var SUB_NAME="MenuSub",[MenuSubProvider,useMenuSubContext]=createMenuContext(SUB_NAME),SUB_TRIGGER_NAME$1="MenuSubTrigger",MenuSubTrigger=reactExports.forwardRef((s,e)=>{const t=useMenuContext(SUB_TRIGGER_NAME$1,s.__scopeMenu),n=useMenuRootContext(SUB_TRIGGER_NAME$1,s.__scopeMenu),i=useMenuSubContext(SUB_TRIGGER_NAME$1,s.__scopeMenu),o=useMenuContentContext(SUB_TRIGGER_NAME$1,s.__scopeMenu),a=reactExports.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:h}=o,d={__scopeMenu:s.__scopeMenu},u=reactExports.useCallback(()=>{a.current&&window.clearTimeout(a.current),a.current=null},[]);return reactExports.useEffect(()=>u,[u]),reactExports.useEffect(()=>{const f=l.current;return()=>{window.clearTimeout(f),h(null)}},[l,h]),jsxRuntimeExports.jsx(MenuAnchor,{asChild:!0,...d,children:jsxRuntimeExports.jsx(MenuItemImpl,{id:i.triggerId,"aria-haspopup":"menu","aria-expanded":t.open,"aria-controls":i.contentId,"data-state":getOpenState(t.open),...s,ref:composeRefs(e,i.onTriggerChange),onClick:f=>{s.onClick?.(f),!(s.disabled||f.defaultPrevented)&&(f.currentTarget.focus(),t.open||t.onOpenChange(!0))},onPointerMove:composeEventHandlers$1(s.onPointerMove,whenMouse(f=>{o.onItemEnter(f),!f.defaultPrevented&&!s.disabled&&!t.open&&!a.current&&(o.onPointerGraceIntentChange(null),a.current=window.setTimeout(()=>{t.onOpenChange(!0),u()},100))})),onPointerLeave:composeEventHandlers$1(s.onPointerLeave,whenMouse(f=>{u();const m=t.content?.getBoundingClientRect();if(m){const v=t.content?.dataset.side,g=v==="right",x=g?-5:5,E=m[g?"left":"right"],b=m[g?"right":"left"];o.onPointerGraceIntentChange({area:[{x:f.clientX+x,y:f.clientY},{x:E,y:m.top},{x:b,y:m.top},{x:b,y:m.bottom},{x:E,y:m.bottom}],side:v}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>o.onPointerGraceIntentChange(null),300)}else{if(o.onTriggerLeave(f),f.defaultPrevented)return;o.onPointerGraceIntentChange(null)}})),onKeyDown:composeEventHandlers$1(s.onKeyDown,f=>{const m=o.searchRef.current!=="";s.disabled||m&&f.key===" "||SUB_OPEN_KEYS[n.dir].includes(f.key)&&(t.onOpenChange(!0),t.content?.focus(),f.preventDefault())})})})});MenuSubTrigger.displayName=SUB_TRIGGER_NAME$1;var SUB_CONTENT_NAME$1="MenuSubContent",MenuSubContent=reactExports.forwardRef((s,e)=>{const t=usePortalContext$1(CONTENT_NAME$4,s.__scopeMenu),{forceMount:n=t.forceMount,...i}=s,o=useMenuContext(CONTENT_NAME$4,s.__scopeMenu),a=useMenuRootContext(CONTENT_NAME$4,s.__scopeMenu),l=useMenuSubContext(SUB_CONTENT_NAME$1,s.__scopeMenu),h=reactExports.useRef(null),d=useComposedRefs(e,h);return jsxRuntimeExports.jsx(Collection.Provider,{scope:s.__scopeMenu,children:jsxRuntimeExports.jsx(Presence,{present:n||o.open,children:jsxRuntimeExports.jsx(Collection.Slot,{scope:s.__scopeMenu,children:jsxRuntimeExports.jsx(MenuContentImpl,{id:l.contentId,"aria-labelledby":l.triggerId,...i,ref:d,align:"start",side:a.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{a.isUsingKeyboardRef.current&&h.current?.focus(),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:composeEventHandlers$1(s.onFocusOutside,u=>{u.target!==l.trigger&&o.onOpenChange(!1)}),onEscapeKeyDown:composeEventHandlers$1(s.onEscapeKeyDown,u=>{a.onClose(),u.preventDefault()}),onKeyDown:composeEventHandlers$1(s.onKeyDown,u=>{const f=u.currentTarget.contains(u.target),m=SUB_CLOSE_KEYS[a.dir].includes(u.key);f&&m&&(o.onOpenChange(!1),l.trigger?.focus(),u.preventDefault())})})})})})});MenuSubContent.displayName=SUB_CONTENT_NAME$1;function getOpenState(s){return s?"open":"closed"}function isIndeterminate(s){return s==="indeterminate"}function getCheckedState(s){return isIndeterminate(s)?"indeterminate":s?"checked":"unchecked"}function focusFirst(s){const e=document.activeElement;for(const t of s)if(t===e||(t.focus(),document.activeElement!==e))return}function wrapArray(s,e){return s.map((t,n)=>s[(e+n)%s.length])}function getNextMatch(s,e,t){const i=e.length>1&&Array.from(e).every(d=>d===e[0])?e[0]:e,o=t?s.indexOf(t):-1;let a=wrapArray(s,Math.max(o,0));i.length===1&&(a=a.filter(d=>d!==t));const h=a.find(d=>d.toLowerCase().startsWith(i.toLowerCase()));return h!==t?h:void 0}function isPointInPolygon(s,e){const{x:t,y:n}=s;let i=!1;for(let o=0,a=e.length-1;o<e.length;a=o++){const l=e[o],h=e[a],d=l.x,u=l.y,f=h.x,m=h.y;u>n!=m>n&&t<(f-d)*(n-u)/(m-u)+d&&(i=!i)}return i}function isPointerInGraceArea(s,e){if(!e)return!1;const t={x:s.clientX,y:s.clientY};return isPointInPolygon(t,e)}function whenMouse(s){return e=>e.pointerType==="mouse"?s(e):void 0}var Root3=Menu,Anchor2=MenuAnchor,Portal$1=MenuPortal,Content2$2=MenuContent,Group=MenuGroup,Label$2=MenuLabel,Item2$1=MenuItem,CheckboxItem=MenuCheckboxItem,RadioGroup=MenuRadioGroup,RadioItem=MenuRadioItem,ItemIndicator=MenuItemIndicator,Separator=MenuSeparator,Arrow2=MenuArrow,SubTrigger=MenuSubTrigger,SubContent=MenuSubContent,DROPDOWN_MENU_NAME="DropdownMenu",[createDropdownMenuContext]=createContextScope(DROPDOWN_MENU_NAME,[createMenuScope]),useMenuScope=createMenuScope(),[DropdownMenuProvider,useDropdownMenuContext]=createDropdownMenuContext(DROPDOWN_MENU_NAME),DropdownMenu$1=s=>{const{__scopeDropdownMenu:e,children:t,dir:n,open:i,defaultOpen:o,onOpenChange:a,modal:l=!0}=s,h=useMenuScope(e),d=reactExports.useRef(null),[u,f]=useControllableState({prop:i,defaultProp:o??!1,onChange:a,caller:DROPDOWN_MENU_NAME});return jsxRuntimeExports.jsx(DropdownMenuProvider,{scope:e,triggerId:useId$1(),triggerRef:d,contentId:useId$1(),open:u,onOpenChange:f,onOpenToggle:reactExports.useCallback(()=>f(m=>!m),[f]),modal:l,children:jsxRuntimeExports.jsx(Root3,{...h,open:u,onOpenChange:f,dir:n,modal:l,children:t})})};DropdownMenu$1.displayName=DROPDOWN_MENU_NAME;var TRIGGER_NAME$3="DropdownMenuTrigger",DropdownMenuTrigger$1=reactExports.forwardRef((s,e)=>{const{__scopeDropdownMenu:t,disabled:n=!1,...i}=s,o=useDropdownMenuContext(TRIGGER_NAME$3,t),a=useMenuScope(t);return jsxRuntimeExports.jsx(Anchor2,{asChild:!0,...a,children:jsxRuntimeExports.jsx(Primitive.button,{type:"button",id:o.triggerId,"aria-haspopup":"menu","aria-expanded":o.open,"aria-controls":o.open?o.contentId:void 0,"data-state":o.open?"open":"closed","data-disabled":n?"":void 0,disabled:n,...i,ref:composeRefs(e,o.triggerRef),onPointerDown:composeEventHandlers$1(s.onPointerDown,l=>{!n&&l.button===0&&l.ctrlKey===!1&&(o.onOpenToggle(),o.open||l.preventDefault())}),onKeyDown:composeEventHandlers$1(s.onKeyDown,l=>{n||(["Enter"," "].includes(l.key)&&o.onOpenToggle(),l.key==="ArrowDown"&&o.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});DropdownMenuTrigger$1.displayName=TRIGGER_NAME$3;var PORTAL_NAME$2="DropdownMenuPortal",DropdownMenuPortal=s=>{const{__scopeDropdownMenu:e,...t}=s,n=useMenuScope(e);return jsxRuntimeExports.jsx(Portal$1,{...n,...t})};DropdownMenuPortal.displayName=PORTAL_NAME$2;var CONTENT_NAME$3="DropdownMenuContent",DropdownMenuContent$1=reactExports.forwardRef((s,e)=>{const{__scopeDropdownMenu:t,...n}=s,i=useDropdownMenuContext(CONTENT_NAME$3,t),o=useMenuScope(t),a=reactExports.useRef(!1);return jsxRuntimeExports.jsx(Content2$2,{id:i.contentId,"aria-labelledby":i.triggerId,...o,...n,ref:e,onCloseAutoFocus:composeEventHandlers$1(s.onCloseAutoFocus,l=>{a.current||i.triggerRef.current?.focus(),a.current=!1,l.preventDefault()}),onInteractOutside:composeEventHandlers$1(s.onInteractOutside,l=>{const h=l.detail.originalEvent,d=h.button===0&&h.ctrlKey===!0,u=h.button===2||d;(!i.modal||u)&&(a.current=!0)}),style:{...s.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});DropdownMenuContent$1.displayName=CONTENT_NAME$3;var GROUP_NAME="DropdownMenuGroup",DropdownMenuGroup=reactExports.forwardRef((s,e)=>{const{__scopeDropdownMenu:t,...n}=s,i=useMenuScope(t);return jsxRuntimeExports.jsx(Group,{...i,...n,ref:e})});DropdownMenuGroup.displayName=GROUP_NAME;var LABEL_NAME="DropdownMenuLabel",DropdownMenuLabel$1=reactExports.forwardRef((s,e)=>{const{__scopeDropdownMenu:t,...n}=s,i=useMenuScope(t);return jsxRuntimeExports.jsx(Label$2,{...i,...n,ref:e})});DropdownMenuLabel$1.displayName=LABEL_NAME;var ITEM_NAME="DropdownMenuItem",DropdownMenuItem$1=reactExports.forwardRef((s,e)=>{const{__scopeDropdownMenu:t,...n}=s,i=useMenuScope(t);return jsxRuntimeExports.jsx(Item2$1,{...i,...n,ref:e})});DropdownMenuItem$1.displayName=ITEM_NAME;var CHECKBOX_ITEM_NAME="DropdownMenuCheckboxItem",DropdownMenuCheckboxItem=reactExports.forwardRef((s,e)=>{const{__scopeDropdownMenu:t,...n}=s,i=useMenuScope(t);return jsxRuntimeExports.jsx(CheckboxItem,{...i,...n,ref:e})});DropdownMenuCheckboxItem.displayName=CHECKBOX_ITEM_NAME;var RADIO_GROUP_NAME="DropdownMenuRadioGroup",DropdownMenuRadioGroup=reactExports.forwardRef((s,e)=>{const{__scopeDropdownMenu:t,...n}=s,i=useMenuScope(t);return jsxRuntimeExports.jsx(RadioGroup,{...i,...n,ref:e})});DropdownMenuRadioGroup.displayName=RADIO_GROUP_NAME;var RADIO_ITEM_NAME="DropdownMenuRadioItem",DropdownMenuRadioItem=reactExports.forwardRef((s,e)=>{const{__scopeDropdownMenu:t,...n}=s,i=useMenuScope(t);return jsxRuntimeExports.jsx(RadioItem,{...i,...n,ref:e})});DropdownMenuRadioItem.displayName=RADIO_ITEM_NAME;var INDICATOR_NAME="DropdownMenuItemIndicator",DropdownMenuItemIndicator=reactExports.forwardRef((s,e)=>{const{__scopeDropdownMenu:t,...n}=s,i=useMenuScope(t);return jsxRuntimeExports.jsx(ItemIndicator,{...i,...n,ref:e})});DropdownMenuItemIndicator.displayName=INDICATOR_NAME;var SEPARATOR_NAME="DropdownMenuSeparator",DropdownMenuSeparator$1=reactExports.forwardRef((s,e)=>{const{__scopeDropdownMenu:t,...n}=s,i=useMenuScope(t);return jsxRuntimeExports.jsx(Separator,{...i,...n,ref:e})});DropdownMenuSeparator$1.displayName=SEPARATOR_NAME;var ARROW_NAME="DropdownMenuArrow",DropdownMenuArrow=reactExports.forwardRef((s,e)=>{const{__scopeDropdownMenu:t,...n}=s,i=useMenuScope(t);return jsxRuntimeExports.jsx(Arrow2,{...i,...n,ref:e})});DropdownMenuArrow.displayName=ARROW_NAME;var SUB_TRIGGER_NAME="DropdownMenuSubTrigger",DropdownMenuSubTrigger=reactExports.forwardRef((s,e)=>{const{__scopeDropdownMenu:t,...n}=s,i=useMenuScope(t);return jsxRuntimeExports.jsx(SubTrigger,{...i,...n,ref:e})});DropdownMenuSubTrigger.displayName=SUB_TRIGGER_NAME;var SUB_CONTENT_NAME="DropdownMenuSubContent",DropdownMenuSubContent=reactExports.forwardRef((s,e)=>{const{__scopeDropdownMenu:t,...n}=s,i=useMenuScope(t);return jsxRuntimeExports.jsx(SubContent,{...i,...n,ref:e,style:{...s.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});DropdownMenuSubContent.displayName=SUB_CONTENT_NAME;var Root2$2=DropdownMenu$1,Trigger$2=DropdownMenuTrigger$1,Portal2$1=DropdownMenuPortal,Content2$1=DropdownMenuContent$1,Label2=DropdownMenuLabel$1,Item2=DropdownMenuItem$1,Separator2=DropdownMenuSeparator$1;function DropdownMenu({...s}){return jsxRuntimeExports.jsx(Root2$2,{"data-slot":"dropdown-menu",...s})}function DropdownMenuTrigger({...s}){return jsxRuntimeExports.jsx(Trigger$2,{"data-slot":"dropdown-menu-trigger",...s})}function DropdownMenuContent({className:s,sideOffset:e=4,...t}){return jsxRuntimeExports.jsx(Portal2$1,{children:jsxRuntimeExports.jsx(Content2$1,{"data-slot":"dropdown-menu-content",sideOffset:e,className:cn("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",s),...t})})}function DropdownMenuItem({className:s,inset:e,variant:t="default",...n}){return jsxRuntimeExports.jsx(Item2,{"data-slot":"dropdown-menu-item","data-inset":e,"data-variant":t,className:cn("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...n})}function DropdownMenuLabel({className:s,inset:e,...t}){return jsxRuntimeExports.jsx(Label2,{"data-slot":"dropdown-menu-label","data-inset":e,className:cn("px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",s),...t})}function DropdownMenuSeparator({className:s,...e}){return jsxRuntimeExports.jsx(Separator2,{"data-slot":"dropdown-menu-separator",className:cn("bg-border -mx-1 my-1 h-px",s),...e})}var DIALOG_NAME="Dialog",[createDialogContext,createDialogScope]=createContextScope(DIALOG_NAME),[DialogProvider,useDialogContext]=createDialogContext(DIALOG_NAME),Dialog=s=>{const{__scopeDialog:e,children:t,open:n,defaultOpen:i,onOpenChange:o,modal:a=!0}=s,l=reactExports.useRef(null),h=reactExports.useRef(null),[d,u]=useControllableState({prop:n,defaultProp:i??!1,onChange:o,caller:DIALOG_NAME});return jsxRuntimeExports.jsx(DialogProvider,{scope:e,triggerRef:l,contentRef:h,contentId:useId$1(),titleId:useId$1(),descriptionId:useId$1(),open:d,onOpenChange:u,onOpenToggle:reactExports.useCallback(()=>u(f=>!f),[u]),modal:a,children:t})};Dialog.displayName=DIALOG_NAME;var TRIGGER_NAME$2="DialogTrigger",DialogTrigger=reactExports.forwardRef((s,e)=>{const{__scopeDialog:t,...n}=s,i=useDialogContext(TRIGGER_NAME$2,t),o=useComposedRefs(e,i.triggerRef);return jsxRuntimeExports.jsx(Primitive.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":getState(i.open),...n,ref:o,onClick:composeEventHandlers$1(s.onClick,i.onOpenToggle)})});DialogTrigger.displayName=TRIGGER_NAME$2;var PORTAL_NAME$1="DialogPortal",[PortalProvider,usePortalContext]=createDialogContext(PORTAL_NAME$1,{forceMount:void 0}),DialogPortal=s=>{const{__scopeDialog:e,forceMount:t,children:n,container:i}=s,o=useDialogContext(PORTAL_NAME$1,e);return jsxRuntimeExports.jsx(PortalProvider,{scope:e,forceMount:t,children:reactExports.Children.map(n,a=>jsxRuntimeExports.jsx(Presence,{present:t||o.open,children:jsxRuntimeExports.jsx(Portal$3,{asChild:!0,container:i,children:a})}))})};DialogPortal.displayName=PORTAL_NAME$1;var OVERLAY_NAME$1="DialogOverlay",DialogOverlay=reactExports.forwardRef((s,e)=>{const t=usePortalContext(OVERLAY_NAME$1,s.__scopeDialog),{forceMount:n=t.forceMount,...i}=s,o=useDialogContext(OVERLAY_NAME$1,s.__scopeDialog);return o.modal?jsxRuntimeExports.jsx(Presence,{present:n||o.open,children:jsxRuntimeExports.jsx(DialogOverlayImpl,{...i,ref:e})}):null});DialogOverlay.displayName=OVERLAY_NAME$1;var Slot=createSlot("DialogOverlay.RemoveScroll"),DialogOverlayImpl=reactExports.forwardRef((s,e)=>{const{__scopeDialog:t,...n}=s,i=useDialogContext(OVERLAY_NAME$1,t);return jsxRuntimeExports.jsx(ReactRemoveScroll,{as:Slot,allowPinchZoom:!0,shards:[i.contentRef],children:jsxRuntimeExports.jsx(Primitive.div,{"data-state":getState(i.open),...n,ref:e,style:{pointerEvents:"auto",...n.style}})})}),CONTENT_NAME$2="DialogContent",DialogContent=reactExports.forwardRef((s,e)=>{const t=usePortalContext(CONTENT_NAME$2,s.__scopeDialog),{forceMount:n=t.forceMount,...i}=s,o=useDialogContext(CONTENT_NAME$2,s.__scopeDialog);return jsxRuntimeExports.jsx(Presence,{present:n||o.open,children:o.modal?jsxRuntimeExports.jsx(DialogContentModal,{...i,ref:e}):jsxRuntimeExports.jsx(DialogContentNonModal,{...i,ref:e})})});DialogContent.displayName=CONTENT_NAME$2;var DialogContentModal=reactExports.forwardRef((s,e)=>{const t=useDialogContext(CONTENT_NAME$2,s.__scopeDialog),n=reactExports.useRef(null),i=useComposedRefs(e,t.contentRef,n);return reactExports.useEffect(()=>{const o=n.current;if(o)return hideOthers(o)},[]),jsxRuntimeExports.jsx(DialogContentImpl,{...s,ref:i,trapFocus:t.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:composeEventHandlers$1(s.onCloseAutoFocus,o=>{o.preventDefault(),t.triggerRef.current?.focus()}),onPointerDownOutside:composeEventHandlers$1(s.onPointerDownOutside,o=>{const a=o.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0;(a.button===2||l)&&o.preventDefault()}),onFocusOutside:composeEventHandlers$1(s.onFocusOutside,o=>o.preventDefault())})}),DialogContentNonModal=reactExports.forwardRef((s,e)=>{const t=useDialogContext(CONTENT_NAME$2,s.__scopeDialog),n=reactExports.useRef(!1),i=reactExports.useRef(!1);return jsxRuntimeExports.jsx(DialogContentImpl,{...s,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{s.onCloseAutoFocus?.(o),o.defaultPrevented||(n.current||t.triggerRef.current?.focus(),o.preventDefault()),n.current=!1,i.current=!1},onInteractOutside:o=>{s.onInteractOutside?.(o),o.defaultPrevented||(n.current=!0,o.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const a=o.target;t.triggerRef.current?.contains(a)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&i.current&&o.preventDefault()}})}),DialogContentImpl=reactExports.forwardRef((s,e)=>{const{__scopeDialog:t,trapFocus:n,onOpenAutoFocus:i,onCloseAutoFocus:o,...a}=s,l=useDialogContext(CONTENT_NAME$2,t),h=reactExports.useRef(null),d=useComposedRefs(e,h);return useFocusGuards(),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(FocusScope,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:i,onUnmountAutoFocus:o,children:jsxRuntimeExports.jsx(DismissableLayer,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":getState(l.open),...a,ref:d,onDismiss:()=>l.onOpenChange(!1)})}),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(TitleWarning,{titleId:l.titleId}),jsxRuntimeExports.jsx(DescriptionWarning$1,{contentRef:h,descriptionId:l.descriptionId})]})]})}),TITLE_NAME$1="DialogTitle",DialogTitle=reactExports.forwardRef((s,e)=>{const{__scopeDialog:t,...n}=s,i=useDialogContext(TITLE_NAME$1,t);return jsxRuntimeExports.jsx(Primitive.h2,{id:i.titleId,...n,ref:e})});DialogTitle.displayName=TITLE_NAME$1;var DESCRIPTION_NAME$1="DialogDescription",DialogDescription=reactExports.forwardRef((s,e)=>{const{__scopeDialog:t,...n}=s,i=useDialogContext(DESCRIPTION_NAME$1,t);return jsxRuntimeExports.jsx(Primitive.p,{id:i.descriptionId,...n,ref:e})});DialogDescription.displayName=DESCRIPTION_NAME$1;var CLOSE_NAME="DialogClose",DialogClose=reactExports.forwardRef((s,e)=>{const{__scopeDialog:t,...n}=s,i=useDialogContext(CLOSE_NAME,t);return jsxRuntimeExports.jsx(Primitive.button,{type:"button",...n,ref:e,onClick:composeEventHandlers$1(s.onClick,()=>i.onOpenChange(!1))})});DialogClose.displayName=CLOSE_NAME;function getState(s){return s?"open":"closed"}var TITLE_WARNING_NAME="DialogTitleWarning",[WarningProvider,useWarningContext]=createContext2(TITLE_WARNING_NAME,{contentName:CONTENT_NAME$2,titleName:TITLE_NAME$1,docsSlug:"dialog"}),TitleWarning=({titleId:s})=>{const e=useWarningContext(TITLE_WARNING_NAME),t=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return reactExports.useEffect(()=>{s&&(document.getElementById(s)||console.error(t))},[t,s]),null},DESCRIPTION_WARNING_NAME="DialogDescriptionWarning",DescriptionWarning$1=({contentRef:s,descriptionId:e})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${useWarningContext(DESCRIPTION_WARNING_NAME).contentName}}.`;return reactExports.useEffect(()=>{const i=s.current?.getAttribute("aria-describedby");e&&i&&(document.getElementById(e)||console.warn(n))},[n,s,e]),null},Root$2=Dialog,Trigger$1=DialogTrigger,Portal=DialogPortal,Overlay=DialogOverlay,Content$1=DialogContent,Title=DialogTitle,Description=DialogDescription,Close=DialogClose,ROOT_NAME="AlertDialog",[createAlertDialogContext]=createContextScope(ROOT_NAME,[createDialogScope]),useDialogScope=createDialogScope(),AlertDialog$1=s=>{const{__scopeAlertDialog:e,...t}=s,n=useDialogScope(e);return jsxRuntimeExports.jsx(Root$2,{...n,...t,modal:!0})};AlertDialog$1.displayName=ROOT_NAME;var TRIGGER_NAME$1="AlertDialogTrigger",AlertDialogTrigger=reactExports.forwardRef((s,e)=>{const{__scopeAlertDialog:t,...n}=s,i=useDialogScope(t);return jsxRuntimeExports.jsx(Trigger$1,{...i,...n,ref:e})});AlertDialogTrigger.displayName=TRIGGER_NAME$1;var PORTAL_NAME="AlertDialogPortal",AlertDialogPortal$1=s=>{const{__scopeAlertDialog:e,...t}=s,n=useDialogScope(e);return jsxRuntimeExports.jsx(Portal,{...n,...t})};AlertDialogPortal$1.displayName=PORTAL_NAME;var OVERLAY_NAME="AlertDialogOverlay",AlertDialogOverlay$1=reactExports.forwardRef((s,e)=>{const{__scopeAlertDialog:t,...n}=s,i=useDialogScope(t);return jsxRuntimeExports.jsx(Overlay,{...i,...n,ref:e})});AlertDialogOverlay$1.displayName=OVERLAY_NAME;var CONTENT_NAME$1="AlertDialogContent",[AlertDialogContentProvider,useAlertDialogContentContext]=createAlertDialogContext(CONTENT_NAME$1),Slottable=createSlottable("AlertDialogContent"),AlertDialogContent$1=reactExports.forwardRef((s,e)=>{const{__scopeAlertDialog:t,children:n,...i}=s,o=useDialogScope(t),a=reactExports.useRef(null),l=useComposedRefs(e,a),h=reactExports.useRef(null);return jsxRuntimeExports.jsx(WarningProvider,{contentName:CONTENT_NAME$1,titleName:TITLE_NAME,docsSlug:"alert-dialog",children:jsxRuntimeExports.jsx(AlertDialogContentProvider,{scope:t,cancelRef:h,children:jsxRuntimeExports.jsxs(Content$1,{role:"alertdialog",...o,...i,ref:l,onOpenAutoFocus:composeEventHandlers$1(i.onOpenAutoFocus,d=>{d.preventDefault(),h.current?.focus({preventScroll:!0})}),onPointerDownOutside:d=>d.preventDefault(),onInteractOutside:d=>d.preventDefault(),children:[jsxRuntimeExports.jsx(Slottable,{children:n}),jsxRuntimeExports.jsx(DescriptionWarning,{contentRef:a})]})})})});AlertDialogContent$1.displayName=CONTENT_NAME$1;var TITLE_NAME="AlertDialogTitle",AlertDialogTitle$1=reactExports.forwardRef((s,e)=>{const{__scopeAlertDialog:t,...n}=s,i=useDialogScope(t);return jsxRuntimeExports.jsx(Title,{...i,...n,ref:e})});AlertDialogTitle$1.displayName=TITLE_NAME;var DESCRIPTION_NAME="AlertDialogDescription",AlertDialogDescription$1=reactExports.forwardRef((s,e)=>{const{__scopeAlertDialog:t,...n}=s,i=useDialogScope(t);return jsxRuntimeExports.jsx(Description,{...i,...n,ref:e})});AlertDialogDescription$1.displayName=DESCRIPTION_NAME;var ACTION_NAME="AlertDialogAction",AlertDialogAction$1=reactExports.forwardRef((s,e)=>{const{__scopeAlertDialog:t,...n}=s,i=useDialogScope(t);return jsxRuntimeExports.jsx(Close,{...i,...n,ref:e})});AlertDialogAction$1.displayName=ACTION_NAME;var CANCEL_NAME="AlertDialogCancel",AlertDialogCancel$1=reactExports.forwardRef((s,e)=>{const{__scopeAlertDialog:t,...n}=s,{cancelRef:i}=useAlertDialogContentContext(CANCEL_NAME,t),o=useDialogScope(t),a=useComposedRefs(e,i);return jsxRuntimeExports.jsx(Close,{...o,...n,ref:a})});AlertDialogCancel$1.displayName=CANCEL_NAME;var DescriptionWarning=({contentRef:s})=>{const e=`\`${CONTENT_NAME$1}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${CONTENT_NAME$1}\` by passing a \`${DESCRIPTION_NAME}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${CONTENT_NAME$1}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return reactExports.useEffect(()=>{document.getElementById(s.current?.getAttribute("aria-describedby"))||console.warn(e)},[e,s]),null},Root2$1=AlertDialog$1,Portal2=AlertDialogPortal$1,Overlay2=AlertDialogOverlay$1,Content2=AlertDialogContent$1,Action=AlertDialogAction$1,Cancel=AlertDialogCancel$1,Title2=AlertDialogTitle$1,Description2=AlertDialogDescription$1;const falsyToString=s=>typeof s=="boolean"?`${s}`:s===0?"0":s,cx=clsx,cva=(s,e)=>t=>{var n;if(e?.variants==null)return cx(s,t?.class,t?.className);const{variants:i,defaultVariants:o}=e,a=Object.keys(i).map(d=>{const u=t?.[d],f=o?.[d];if(u===null)return null;const m=falsyToString(u)||falsyToString(f);return i[d][m]}),l=t&&Object.entries(t).reduce((d,u)=>{let[f,m]=u;return m===void 0||(d[f]=m),d},{}),h=e==null||(n=e.compoundVariants)===null||n===void 0?void 0:n.reduce((d,u)=>{let{class:f,className:m,...v}=u;return Object.entries(v).every(g=>{let[x,E]=g;return Array.isArray(E)?E.includes({...o,...l}[x]):{...o,...l}[x]===E})?[...d,f,m]:d},[]);return cx(s,a,h,t?.class,t?.className)},buttonVariants=cva("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background text-foreground hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9 rounded-md"}},defaultVariants:{variant:"default",size:"default"}});function Button({className:s,variant:e,size:t,asChild:n=!1,...i}){const o=n?Slot$3:"button";return jsxRuntimeExports.jsx(o,{"data-slot":"button",className:cn(buttonVariants({variant:e,size:t,className:s})),...i})}function AlertDialog({...s}){return jsxRuntimeExports.jsx(Root2$1,{"data-slot":"alert-dialog",...s})}function AlertDialogPortal({...s}){return jsxRuntimeExports.jsx(Portal2,{"data-slot":"alert-dialog-portal",...s})}function AlertDialogOverlay({className:s,...e}){return jsxRuntimeExports.jsx(Overlay2,{"data-slot":"alert-dialog-overlay",className:cn("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",s),...e})}function AlertDialogContent({className:s,...e}){return jsxRuntimeExports.jsxs(AlertDialogPortal,{children:[jsxRuntimeExports.jsx(AlertDialogOverlay,{}),jsxRuntimeExports.jsx(Content2,{"data-slot":"alert-dialog-content",className:cn("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",s),...e})]})}function AlertDialogHeader({className:s,...e}){return jsxRuntimeExports.jsx("div",{"data-slot":"alert-dialog-header",className:cn("flex flex-col gap-2 text-center sm:text-left",s),...e})}function AlertDialogFooter({className:s,...e}){return jsxRuntimeExports.jsx("div",{"data-slot":"alert-dialog-footer",className:cn("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",s),...e})}function AlertDialogTitle({className:s,...e}){return jsxRuntimeExports.jsx(Title2,{"data-slot":"alert-dialog-title",className:cn("text-lg font-semibold",s),...e})}function AlertDialogDescription({className:s,...e}){return jsxRuntimeExports.jsx(Description2,{"data-slot":"alert-dialog-description",className:cn("text-muted-foreground text-sm",s),...e})}function AlertDialogAction({className:s,...e}){return jsxRuntimeExports.jsx(Action,{className:cn(buttonVariants(),s),...e})}function AlertDialogCancel({className:s,...e}){return jsxRuntimeExports.jsx(Cancel,{className:cn(buttonVariants({variant:"outline"}),s),...e})}function MinimalHeader(){const[s,e]=reactExports.useState(!1),[t,n]=reactExports.useState(""),[i,o]=reactExports.useState([]),[a,l]=reactExports.useState(!1),[h,d]=reactExports.useState(!1),[u,f]=reactExports.useState(null),{user:m,signOut:v}=useAuth(),{textbooks:g,currentTextbook:x,loadTextbook:E,uploadTextbook:b,setCurrentPage:_,loadTextbooks:S}=useTextbook(),C=async(F,W)=>{await b(F,W)},A=F=>{f(F),d(!0)},R=async()=>{if(u)try{const{error:F}=await supabase.from("textbooks").delete().eq("id",u);if(F)throw F;if(toast.success("Textbook deleted successfully"),await S(),x?.id===u&&g.length>1){const W=g.find(K=>K.id!==u);W&&await E(W.id)}}catch(F){console.error("[Delete] Error:",F),toast.error("Failed to delete textbook")}finally{d(!1),f(null)}},L=async F=>{if(!F.trim()||!x){o([]),l(!1);return}try{const{data:W,error:K}=await supabase.from("pages").select("page_number, raw_text").eq("textbook_id",x.id).ilike("raw_text",`%${F}%`).limit(10);if(K)throw K;const{data:ee,error:te}=await supabase.from("user_notes").select("page_number, content").eq("textbook_id",x.id).eq("user_id",m?.id).ilike("content",`%${F}%`).limit(5);if(te)throw te;const re=[...(W||[]).map(ie=>({page_number:ie.page_number,snippet:ie.raw_text.substring(Math.max(0,ie.raw_text.toLowerCase().indexOf(F.toLowerCase())-50),ie.raw_text.toLowerCase().indexOf(F.toLowerCase())+F.length+50),type:"textbook"})),...(ee||[]).map(ie=>({page_number:ie.page_number||0,snippet:ie.content.substring(0,100),type:"note"}))];o(re),l(!0)}catch(W){console.error("[Search] Error:",W),toast.error("Search failed")}},j=F=>{_(F),l(!1),n("")};return jsxRuntimeExports.jsxs("header",{className:"h-12 border-b border-border bg-card flex items-center px-4 gap-4",children:[jsxRuntimeExports.jsxs(Select,{value:x?.id||"",onValueChange:F=>{F==="upload"?e(!0):E(F)},children:[jsxRuntimeExports.jsx(SelectTrigger,{className:"w-[220px] h-8 text-xs border-border",children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Select textbook"})}),jsxRuntimeExports.jsxs(SelectContent,{children:[g.length===0?jsxRuntimeExports.jsx(SelectItem,{value:"none",disabled:!0,children:"No textbooks yet"}):g.map(F=>jsxRuntimeExports.jsx(SelectItem,{value:F.id,children:F.title},F.id)),jsxRuntimeExports.jsx(SelectSeparator,{}),jsxRuntimeExports.jsx(SelectItem,{value:"upload",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Upload,{className:"w-3.5 h-3.5"}),jsxRuntimeExports.jsx("span",{children:"Upload New Textbook"})]})})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 max-w-md relative",children:[jsxRuntimeExports.jsx(Search,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-muted-foreground"}),jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Search in book and notes...",value:t,onChange:F=>{n(F.target.value),L(F.target.value)},onFocus:()=>i.length>0&&l(!0),className:"w-full h-8 pl-8 pr-3 text-xs bg-muted border border-border rounded-md focus:outline-none focus:ring-1 focus:ring-ring"}),a&&i.length>0&&jsxRuntimeExports.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-card border border-border rounded-md shadow-lg max-h-80 overflow-y-auto z-50",children:i.map((F,W)=>jsxRuntimeExports.jsxs("button",{onClick:()=>j(F.page_number),className:"w-full text-left px-3 py-2 hover:bg-muted border-b border-border last:border-b-0 transition-colors",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[jsxRuntimeExports.jsxs("span",{className:"text-xs font-medium",children:["Page ",F.page_number]}),jsxRuntimeExports.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-muted rounded",children:F.type==="textbook"?"Textbook":"Note"})]}),jsxRuntimeExports.jsxs("p",{className:"text-xs text-muted-foreground line-clamp-2",children:["...",F.snippet,"..."]})]},W))})]}),x&&jsxRuntimeExports.jsxs(DropdownMenu,{children:[jsxRuntimeExports.jsx(DropdownMenuTrigger,{asChild:!0,children:jsxRuntimeExports.jsx("button",{className:"p-1.5 hover:bg-muted rounded transition-colors",children:jsxRuntimeExports.jsx(EllipsisVertical,{className:"w-4 h-4 text-muted-foreground"})})}),jsxRuntimeExports.jsxs(DropdownMenuContent,{align:"end",children:[jsxRuntimeExports.jsx(DropdownMenuLabel,{className:"text-xs",children:"Manage Textbook"}),jsxRuntimeExports.jsx(DropdownMenuSeparator,{}),jsxRuntimeExports.jsxs(DropdownMenuItem,{onClick:()=>A(x.id),className:"text-xs text-red-600",children:[jsxRuntimeExports.jsx(Trash2,{className:"w-3 h-3 mr-2"}),"Delete Textbook"]})]})]}),jsxRuntimeExports.jsxs(DropdownMenu,{children:[jsxRuntimeExports.jsx(DropdownMenuTrigger,{asChild:!0,children:jsxRuntimeExports.jsx("button",{className:"p-1.5 hover:bg-muted rounded-full transition-colors ml-auto",children:jsxRuntimeExports.jsx(User,{className:"w-4 h-4 text-muted-foreground"})})}),jsxRuntimeExports.jsxs(DropdownMenuContent,{align:"end",children:[jsxRuntimeExports.jsx(DropdownMenuLabel,{className:"text-xs",children:m?.email}),jsxRuntimeExports.jsx(DropdownMenuSeparator,{}),jsxRuntimeExports.jsxs(DropdownMenuItem,{onClick:v,className:"text-xs",children:[jsxRuntimeExports.jsx(LogOut,{className:"w-3 h-3 mr-2"}),"Sign Out"]})]})]}),jsxRuntimeExports.jsx(UploadDialog,{open:s,onOpenChange:e,onUpload:C}),jsxRuntimeExports.jsx(AlertDialog,{open:h,onOpenChange:d,children:jsxRuntimeExports.jsxs(AlertDialogContent,{children:[jsxRuntimeExports.jsxs(AlertDialogHeader,{children:[jsxRuntimeExports.jsx(AlertDialogTitle,{children:"Delete Textbook?"}),jsxRuntimeExports.jsx(AlertDialogDescription,{children:"This will permanently delete this textbook along with all your notes, highlights, and AI-generated content. This action cannot be undone."})]}),jsxRuntimeExports.jsxs(AlertDialogFooter,{children:[jsxRuntimeExports.jsx(AlertDialogCancel,{children:"Cancel"}),jsxRuntimeExports.jsx(AlertDialogAction,{onClick:R,className:"bg-red-600 hover:bg-red-700",children:"Delete"})]})]})})]})}function Textarea({className:s,...e}){return jsxRuntimeExports.jsx("textarea",{"data-slot":"textarea",className:cn("resize-none border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-input-background px-3 py-2 text-base transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),...e})}const NotesContext=reactExports.createContext(void 0);function NotesProvider({children:s}){const{user:e}=useAuth(),{currentTextbook:t,currentPage:n}=useTextbook(),[i,o]=reactExports.useState([]),[a,l]=reactExports.useState(null),[h,d]=reactExports.useState(!1),[u,f]=reactExports.useState(!1),m=reactExports.useCallback(async()=>{if(!(!e||!t))try{d(!0);const{data:S,error:C}=await supabase.from("user_notes").select("*").eq("user_id",e.id).eq("textbook_id",t.id).order("updated_at",{ascending:!1});if(C)throw C;const A=(S||[]).map(R=>({...R,title:R.content?.split(`
`)[0]?.substring(0,50)||"Untitled Note"}));o(A),A.length>0&&!a&&l(A[0])}catch(S){console.error("[Notes] Failed to load notes:",S),toast.error("Failed to load notes")}finally{d(!1)}},[e,t,a]),v=async()=>{if(!(!e||!t))try{f(!0);const{data:S,error:C}=await supabase.from("user_notes").insert({user_id:e.id,textbook_id:t.id,page_number:n,content:""}).select().single();if(C)throw C;const A={...S,title:"Untitled Note"};o(R=>[A,...R]),l(A),toast.success("New note created")}catch(S){console.error("[Notes] Failed to create note:",S),toast.error("Failed to create note")}finally{f(!1)}},g=S=>{const C=i.find(A=>A.id===S);C&&l(C)},x=reactExports.useCallback(async()=>{if(!(!a||!e))try{f(!0);const{error:S}=await supabase.from("user_notes").update({content:a.content,updated_at:new Date().toISOString()}).eq("id",a.id);if(S)throw S;const C=a.content.split(`
`)[0]?.substring(0,50)||"Untitled Note";o(A=>A.map(R=>R.id===a.id?{...R,title:C,content:a.content,updated_at:new Date().toISOString()}:R))}catch(S){console.error("[Notes] Auto-save failed:",S)}finally{f(!1)}},[a,e]),E=S=>{a&&l({...a,content:S})},b=S=>{a&&l({...a,title:S})},_=async S=>{if(e)try{const{error:C}=await supabase.from("user_notes").delete().eq("id",S);if(C)throw C;o(A=>A.filter(R=>R.id!==S)),a?.id===S&&l(i[0]||null),toast.success("Note deleted")}catch(C){console.error("[Notes] Failed to delete note:",C),toast.error("Failed to delete note")}};return reactExports.useEffect(()=>{if(!a||a.content==="")return;const S=setTimeout(()=>{x()},1e3);return()=>clearTimeout(S)},[a?.content,x]),reactExports.useEffect(()=>{t&&m()},[t]),jsxRuntimeExports.jsx(NotesContext.Provider,{value:{notes:i,activeNote:a,loading:h,saving:u,createNote:v,selectNote:g,updateNoteContent:E,updateNoteTitle:b,deleteNote:_,loadNotes:m},children:s})}function useNotes(){const s=reactExports.useContext(NotesContext);if(s===void 0)throw new Error("useNotes must be used within a NotesProvider");return s}function useStateMachine(s,e){return reactExports.useReducer((t,n)=>e[t][n]??t,s)}var SCROLL_AREA_NAME="ScrollArea",[createScrollAreaContext]=createContextScope(SCROLL_AREA_NAME),[ScrollAreaProvider,useScrollAreaContext]=createScrollAreaContext(SCROLL_AREA_NAME),ScrollArea$1=reactExports.forwardRef((s,e)=>{const{__scopeScrollArea:t,type:n="hover",dir:i,scrollHideDelay:o=600,...a}=s,[l,h]=reactExports.useState(null),[d,u]=reactExports.useState(null),[f,m]=reactExports.useState(null),[v,g]=reactExports.useState(null),[x,E]=reactExports.useState(null),[b,_]=reactExports.useState(0),[S,C]=reactExports.useState(0),[A,R]=reactExports.useState(!1),[L,j]=reactExports.useState(!1),F=useComposedRefs(e,K=>h(K)),W=useDirection(i);return jsxRuntimeExports.jsx(ScrollAreaProvider,{scope:t,type:n,dir:W,scrollHideDelay:o,scrollArea:l,viewport:d,onViewportChange:u,content:f,onContentChange:m,scrollbarX:v,onScrollbarXChange:g,scrollbarXEnabled:A,onScrollbarXEnabledChange:R,scrollbarY:x,onScrollbarYChange:E,scrollbarYEnabled:L,onScrollbarYEnabledChange:j,onCornerWidthChange:_,onCornerHeightChange:C,children:jsxRuntimeExports.jsx(Primitive.div,{dir:W,...a,ref:F,style:{position:"relative","--radix-scroll-area-corner-width":b+"px","--radix-scroll-area-corner-height":S+"px",...s.style}})})});ScrollArea$1.displayName=SCROLL_AREA_NAME;var VIEWPORT_NAME="ScrollAreaViewport",ScrollAreaViewport=reactExports.forwardRef((s,e)=>{const{__scopeScrollArea:t,children:n,nonce:i,...o}=s,a=useScrollAreaContext(VIEWPORT_NAME,t),l=reactExports.useRef(null),h=useComposedRefs(e,l,a.onViewportChange);return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),jsxRuntimeExports.jsx(Primitive.div,{"data-radix-scroll-area-viewport":"",...o,ref:h,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...s.style},children:jsxRuntimeExports.jsx("div",{ref:a.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});ScrollAreaViewport.displayName=VIEWPORT_NAME;var SCROLLBAR_NAME="ScrollAreaScrollbar",ScrollAreaScrollbar=reactExports.forwardRef((s,e)=>{const{forceMount:t,...n}=s,i=useScrollAreaContext(SCROLLBAR_NAME,s.__scopeScrollArea),{onScrollbarXEnabledChange:o,onScrollbarYEnabledChange:a}=i,l=s.orientation==="horizontal";return reactExports.useEffect(()=>(l?o(!0):a(!0),()=>{l?o(!1):a(!1)}),[l,o,a]),i.type==="hover"?jsxRuntimeExports.jsx(ScrollAreaScrollbarHover,{...n,ref:e,forceMount:t}):i.type==="scroll"?jsxRuntimeExports.jsx(ScrollAreaScrollbarScroll,{...n,ref:e,forceMount:t}):i.type==="auto"?jsxRuntimeExports.jsx(ScrollAreaScrollbarAuto,{...n,ref:e,forceMount:t}):i.type==="always"?jsxRuntimeExports.jsx(ScrollAreaScrollbarVisible,{...n,ref:e}):null});ScrollAreaScrollbar.displayName=SCROLLBAR_NAME;var ScrollAreaScrollbarHover=reactExports.forwardRef((s,e)=>{const{forceMount:t,...n}=s,i=useScrollAreaContext(SCROLLBAR_NAME,s.__scopeScrollArea),[o,a]=reactExports.useState(!1);return reactExports.useEffect(()=>{const l=i.scrollArea;let h=0;if(l){const d=()=>{window.clearTimeout(h),a(!0)},u=()=>{h=window.setTimeout(()=>a(!1),i.scrollHideDelay)};return l.addEventListener("pointerenter",d),l.addEventListener("pointerleave",u),()=>{window.clearTimeout(h),l.removeEventListener("pointerenter",d),l.removeEventListener("pointerleave",u)}}},[i.scrollArea,i.scrollHideDelay]),jsxRuntimeExports.jsx(Presence,{present:t||o,children:jsxRuntimeExports.jsx(ScrollAreaScrollbarAuto,{"data-state":o?"visible":"hidden",...n,ref:e})})}),ScrollAreaScrollbarScroll=reactExports.forwardRef((s,e)=>{const{forceMount:t,...n}=s,i=useScrollAreaContext(SCROLLBAR_NAME,s.__scopeScrollArea),o=s.orientation==="horizontal",a=useDebounceCallback(()=>h("SCROLL_END"),100),[l,h]=useStateMachine("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return reactExports.useEffect(()=>{if(l==="idle"){const d=window.setTimeout(()=>h("HIDE"),i.scrollHideDelay);return()=>window.clearTimeout(d)}},[l,i.scrollHideDelay,h]),reactExports.useEffect(()=>{const d=i.viewport,u=o?"scrollLeft":"scrollTop";if(d){let f=d[u];const m=()=>{const v=d[u];f!==v&&(h("SCROLL"),a()),f=v};return d.addEventListener("scroll",m),()=>d.removeEventListener("scroll",m)}},[i.viewport,o,h,a]),jsxRuntimeExports.jsx(Presence,{present:t||l!=="hidden",children:jsxRuntimeExports.jsx(ScrollAreaScrollbarVisible,{"data-state":l==="hidden"?"hidden":"visible",...n,ref:e,onPointerEnter:composeEventHandlers$1(s.onPointerEnter,()=>h("POINTER_ENTER")),onPointerLeave:composeEventHandlers$1(s.onPointerLeave,()=>h("POINTER_LEAVE"))})})}),ScrollAreaScrollbarAuto=reactExports.forwardRef((s,e)=>{const t=useScrollAreaContext(SCROLLBAR_NAME,s.__scopeScrollArea),{forceMount:n,...i}=s,[o,a]=reactExports.useState(!1),l=s.orientation==="horizontal",h=useDebounceCallback(()=>{if(t.viewport){const d=t.viewport.offsetWidth<t.viewport.scrollWidth,u=t.viewport.offsetHeight<t.viewport.scrollHeight;a(l?d:u)}},10);return useResizeObserver(t.viewport,h),useResizeObserver(t.content,h),jsxRuntimeExports.jsx(Presence,{present:n||o,children:jsxRuntimeExports.jsx(ScrollAreaScrollbarVisible,{"data-state":o?"visible":"hidden",...i,ref:e})})}),ScrollAreaScrollbarVisible=reactExports.forwardRef((s,e)=>{const{orientation:t="vertical",...n}=s,i=useScrollAreaContext(SCROLLBAR_NAME,s.__scopeScrollArea),o=reactExports.useRef(null),a=reactExports.useRef(0),[l,h]=reactExports.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),d=getThumbRatio(l.viewport,l.content),u={...n,sizes:l,onSizesChange:h,hasThumb:d>0&&d<1,onThumbChange:m=>o.current=m,onThumbPointerUp:()=>a.current=0,onThumbPointerDown:m=>a.current=m};function f(m,v){return getScrollPositionFromPointer(m,a.current,l,v)}return t==="horizontal"?jsxRuntimeExports.jsx(ScrollAreaScrollbarX,{...u,ref:e,onThumbPositionChange:()=>{if(i.viewport&&o.current){const m=i.viewport.scrollLeft,v=getThumbOffsetFromScroll(m,l,i.dir);o.current.style.transform=`translate3d(${v}px, 0, 0)`}},onWheelScroll:m=>{i.viewport&&(i.viewport.scrollLeft=m)},onDragScroll:m=>{i.viewport&&(i.viewport.scrollLeft=f(m,i.dir))}}):t==="vertical"?jsxRuntimeExports.jsx(ScrollAreaScrollbarY,{...u,ref:e,onThumbPositionChange:()=>{if(i.viewport&&o.current){const m=i.viewport.scrollTop,v=getThumbOffsetFromScroll(m,l);o.current.style.transform=`translate3d(0, ${v}px, 0)`}},onWheelScroll:m=>{i.viewport&&(i.viewport.scrollTop=m)},onDragScroll:m=>{i.viewport&&(i.viewport.scrollTop=f(m))}}):null}),ScrollAreaScrollbarX=reactExports.forwardRef((s,e)=>{const{sizes:t,onSizesChange:n,...i}=s,o=useScrollAreaContext(SCROLLBAR_NAME,s.__scopeScrollArea),[a,l]=reactExports.useState(),h=reactExports.useRef(null),d=useComposedRefs(e,h,o.onScrollbarXChange);return reactExports.useEffect(()=>{h.current&&l(getComputedStyle(h.current))},[h]),jsxRuntimeExports.jsx(ScrollAreaScrollbarImpl,{"data-orientation":"horizontal",...i,ref:d,sizes:t,style:{bottom:0,left:o.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:o.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":getThumbSize(t)+"px",...s.style},onThumbPointerDown:u=>s.onThumbPointerDown(u.x),onDragScroll:u=>s.onDragScroll(u.x),onWheelScroll:(u,f)=>{if(o.viewport){const m=o.viewport.scrollLeft+u.deltaX;s.onWheelScroll(m),isScrollingWithinScrollbarBounds(m,f)&&u.preventDefault()}},onResize:()=>{h.current&&o.viewport&&a&&n({content:o.viewport.scrollWidth,viewport:o.viewport.offsetWidth,scrollbar:{size:h.current.clientWidth,paddingStart:toInt(a.paddingLeft),paddingEnd:toInt(a.paddingRight)}})}})}),ScrollAreaScrollbarY=reactExports.forwardRef((s,e)=>{const{sizes:t,onSizesChange:n,...i}=s,o=useScrollAreaContext(SCROLLBAR_NAME,s.__scopeScrollArea),[a,l]=reactExports.useState(),h=reactExports.useRef(null),d=useComposedRefs(e,h,o.onScrollbarYChange);return reactExports.useEffect(()=>{h.current&&l(getComputedStyle(h.current))},[h]),jsxRuntimeExports.jsx(ScrollAreaScrollbarImpl,{"data-orientation":"vertical",...i,ref:d,sizes:t,style:{top:0,right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":getThumbSize(t)+"px",...s.style},onThumbPointerDown:u=>s.onThumbPointerDown(u.y),onDragScroll:u=>s.onDragScroll(u.y),onWheelScroll:(u,f)=>{if(o.viewport){const m=o.viewport.scrollTop+u.deltaY;s.onWheelScroll(m),isScrollingWithinScrollbarBounds(m,f)&&u.preventDefault()}},onResize:()=>{h.current&&o.viewport&&a&&n({content:o.viewport.scrollHeight,viewport:o.viewport.offsetHeight,scrollbar:{size:h.current.clientHeight,paddingStart:toInt(a.paddingTop),paddingEnd:toInt(a.paddingBottom)}})}})}),[ScrollbarProvider,useScrollbarContext]=createScrollAreaContext(SCROLLBAR_NAME),ScrollAreaScrollbarImpl=reactExports.forwardRef((s,e)=>{const{__scopeScrollArea:t,sizes:n,hasThumb:i,onThumbChange:o,onThumbPointerUp:a,onThumbPointerDown:l,onThumbPositionChange:h,onDragScroll:d,onWheelScroll:u,onResize:f,...m}=s,v=useScrollAreaContext(SCROLLBAR_NAME,t),[g,x]=reactExports.useState(null),E=useComposedRefs(e,F=>x(F)),b=reactExports.useRef(null),_=reactExports.useRef(""),S=v.viewport,C=n.content-n.viewport,A=useCallbackRef$1(u),R=useCallbackRef$1(h),L=useDebounceCallback(f,10);function j(F){if(b.current){const W=F.clientX-b.current.left,K=F.clientY-b.current.top;d({x:W,y:K})}}return reactExports.useEffect(()=>{const F=W=>{const K=W.target;g?.contains(K)&&A(W,C)};return document.addEventListener("wheel",F,{passive:!1}),()=>document.removeEventListener("wheel",F,{passive:!1})},[S,g,C,A]),reactExports.useEffect(R,[n,R]),useResizeObserver(g,L),useResizeObserver(v.content,L),jsxRuntimeExports.jsx(ScrollbarProvider,{scope:t,scrollbar:g,hasThumb:i,onThumbChange:useCallbackRef$1(o),onThumbPointerUp:useCallbackRef$1(a),onThumbPositionChange:R,onThumbPointerDown:useCallbackRef$1(l),children:jsxRuntimeExports.jsx(Primitive.div,{...m,ref:E,style:{position:"absolute",...m.style},onPointerDown:composeEventHandlers$1(s.onPointerDown,F=>{F.button===0&&(F.target.setPointerCapture(F.pointerId),b.current=g.getBoundingClientRect(),_.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",v.viewport&&(v.viewport.style.scrollBehavior="auto"),j(F))}),onPointerMove:composeEventHandlers$1(s.onPointerMove,j),onPointerUp:composeEventHandlers$1(s.onPointerUp,F=>{const W=F.target;W.hasPointerCapture(F.pointerId)&&W.releasePointerCapture(F.pointerId),document.body.style.webkitUserSelect=_.current,v.viewport&&(v.viewport.style.scrollBehavior=""),b.current=null})})})}),THUMB_NAME="ScrollAreaThumb",ScrollAreaThumb=reactExports.forwardRef((s,e)=>{const{forceMount:t,...n}=s,i=useScrollbarContext(THUMB_NAME,s.__scopeScrollArea);return jsxRuntimeExports.jsx(Presence,{present:t||i.hasThumb,children:jsxRuntimeExports.jsx(ScrollAreaThumbImpl,{ref:e,...n})})}),ScrollAreaThumbImpl=reactExports.forwardRef((s,e)=>{const{__scopeScrollArea:t,style:n,...i}=s,o=useScrollAreaContext(THUMB_NAME,t),a=useScrollbarContext(THUMB_NAME,t),{onThumbPositionChange:l}=a,h=useComposedRefs(e,f=>a.onThumbChange(f)),d=reactExports.useRef(void 0),u=useDebounceCallback(()=>{d.current&&(d.current(),d.current=void 0)},100);return reactExports.useEffect(()=>{const f=o.viewport;if(f){const m=()=>{if(u(),!d.current){const v=addUnlinkedScrollListener(f,l);d.current=v,l()}};return l(),f.addEventListener("scroll",m),()=>f.removeEventListener("scroll",m)}},[o.viewport,u,l]),jsxRuntimeExports.jsx(Primitive.div,{"data-state":a.hasThumb?"visible":"hidden",...i,ref:h,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:composeEventHandlers$1(s.onPointerDownCapture,f=>{const v=f.target.getBoundingClientRect(),g=f.clientX-v.left,x=f.clientY-v.top;a.onThumbPointerDown({x:g,y:x})}),onPointerUp:composeEventHandlers$1(s.onPointerUp,a.onThumbPointerUp)})});ScrollAreaThumb.displayName=THUMB_NAME;var CORNER_NAME="ScrollAreaCorner",ScrollAreaCorner=reactExports.forwardRef((s,e)=>{const t=useScrollAreaContext(CORNER_NAME,s.__scopeScrollArea),n=!!(t.scrollbarX&&t.scrollbarY);return t.type!=="scroll"&&n?jsxRuntimeExports.jsx(ScrollAreaCornerImpl,{...s,ref:e}):null});ScrollAreaCorner.displayName=CORNER_NAME;var ScrollAreaCornerImpl=reactExports.forwardRef((s,e)=>{const{__scopeScrollArea:t,...n}=s,i=useScrollAreaContext(CORNER_NAME,t),[o,a]=reactExports.useState(0),[l,h]=reactExports.useState(0),d=!!(o&&l);return useResizeObserver(i.scrollbarX,()=>{const u=i.scrollbarX?.offsetHeight||0;i.onCornerHeightChange(u),h(u)}),useResizeObserver(i.scrollbarY,()=>{const u=i.scrollbarY?.offsetWidth||0;i.onCornerWidthChange(u),a(u)}),d?jsxRuntimeExports.jsx(Primitive.div,{...n,ref:e,style:{width:o,height:l,position:"absolute",right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:0,...s.style}}):null});function toInt(s){return s?parseInt(s,10):0}function getThumbRatio(s,e){const t=s/e;return isNaN(t)?0:t}function getThumbSize(s){const e=getThumbRatio(s.viewport,s.content),t=s.scrollbar.paddingStart+s.scrollbar.paddingEnd,n=(s.scrollbar.size-t)*e;return Math.max(n,18)}function getScrollPositionFromPointer(s,e,t,n="ltr"){const i=getThumbSize(t),o=i/2,a=e||o,l=i-a,h=t.scrollbar.paddingStart+a,d=t.scrollbar.size-t.scrollbar.paddingEnd-l,u=t.content-t.viewport,f=n==="ltr"?[0,u]:[u*-1,0];return linearScale([h,d],f)(s)}function getThumbOffsetFromScroll(s,e,t="ltr"){const n=getThumbSize(e),i=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,o=e.scrollbar.size-i,a=e.content-e.viewport,l=o-n,h=t==="ltr"?[0,a]:[a*-1,0],d=clamp$2(s,h);return linearScale([0,a],[0,l])(d)}function linearScale(s,e){return t=>{if(s[0]===s[1]||e[0]===e[1])return e[0];const n=(e[1]-e[0])/(s[1]-s[0]);return e[0]+n*(t-s[0])}}function isScrollingWithinScrollbarBounds(s,e){return s>0&&s<e}var addUnlinkedScrollListener=(s,e=()=>{})=>{let t={left:s.scrollLeft,top:s.scrollTop},n=0;return(function i(){const o={left:s.scrollLeft,top:s.scrollTop},a=t.left!==o.left,l=t.top!==o.top;(a||l)&&e(),t=o,n=window.requestAnimationFrame(i)})(),()=>window.cancelAnimationFrame(n)};function useDebounceCallback(s,e){const t=useCallbackRef$1(s),n=reactExports.useRef(0);return reactExports.useEffect(()=>()=>window.clearTimeout(n.current),[]),reactExports.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(t,e)},[t,e])}function useResizeObserver(s,e){const t=useCallbackRef$1(e);useLayoutEffect2(()=>{let n=0;if(s){const i=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(t)});return i.observe(s),()=>{window.cancelAnimationFrame(n),i.unobserve(s)}}},[s,t])}var Root$1=ScrollArea$1,Viewport=ScrollAreaViewport,Corner=ScrollAreaCorner;function ScrollArea({className:s,children:e,...t}){return jsxRuntimeExports.jsxs(Root$1,{"data-slot":"scroll-area",className:cn("relative",s),...t,children:[jsxRuntimeExports.jsx(Viewport,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:e}),jsxRuntimeExports.jsx(ScrollBar,{}),jsxRuntimeExports.jsx(Corner,{})]})}function ScrollBar({className:s,orientation:e="vertical",...t}){return jsxRuntimeExports.jsx(ScrollAreaScrollbar,{"data-slot":"scroll-area-scrollbar",orientation:e,className:cn("flex touch-none p-px transition-colors select-none",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",s),...t,children:jsxRuntimeExports.jsx(ScrollAreaThumb,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}function NotesPanel(){const{notes:s,activeNote:e,createNote:t,selectNote:n,updateNoteContent:i,deleteNote:o,saving:a,loading:l}=useNotes(),{currentTextbook:h}=useTextbook(),[d,u]=reactExports.useState(!1),[f,m]=reactExports.useState(null),v=_=>{m(_),u(!0)},g=async()=>{f&&(await o(f),u(!1),m(null))},x=()=>{if(!e?.content.trim()){toast.error("No content to export");return}const _=`# ${e.title}
**Textbook:** ${h?.title||"Unknown"}
**Date:** ${new Date(e.updated_at).toLocaleDateString()}

---

${e.content}

---

*Exported from AI Textbook Reader*
`,S=new Blob([_],{type:"text/markdown"}),C=URL.createObjectURL(S),A=document.createElement("a");A.href=C,A.download=`${e.title.replace(/\s+/g,"-")}.md`,A.click(),URL.revokeObjectURL(C),toast.success("Note exported as Markdown")},E=()=>{if(!e?.content.trim()){toast.error("No content to export");return}const _=`${e.title}
Textbook: ${h?.title||"Unknown"}
Date: ${new Date(e.updated_at).toLocaleDateString()}

${e.content}
`,S=new Blob([_],{type:"text/plain"}),C=URL.createObjectURL(S),A=document.createElement("a");A.href=C,A.download=`${e.title.replace(/\s+/g,"-")}.txt`,A.click(),URL.revokeObjectURL(C),toast.success("Note exported as text file")},b=()=>{if(!e?.content.trim()){toast.error("No content to export");return}const _=window.open("","_blank");_&&(_.document.write(`
      <html>
        <head>
          <title>${e.title}</title>
          <style>
            body {
              font-family: system-ui, -apple-system, sans-serif;
              max-width: 800px;
              margin: 40px auto;
              padding: 20px;
              line-height: 1.6;
            }
            h1 { color: #333; margin-bottom: 10px; }
            .meta { color: #666; font-size: 14px; margin-bottom: 20px; }
            .content { white-space: pre-wrap; }
            .footer { margin-top: 40px; padding-top: 20px; border-top: 1px solid #ccc; color: #999; font-size: 12px; }
          </style>
        </head>
        <body>
          <h1>${e.title}</h1>
          <div class="meta">
            Textbook: ${h?.title||"Unknown"}<br>
            Date: ${new Date(e.updated_at).toLocaleDateString()}
          </div>
          <div class="content">${e.content}</div>
          <div class="footer">Exported from AI Textbook Reader</div>
        </body>
      </html>
    `),_.document.close(),_.print())};return jsxRuntimeExports.jsxs("div",{className:"h-full flex flex-col border-r border-border bg-card",children:[jsxRuntimeExports.jsxs("div",{className:"px-3 py-2 border-b border-border flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-xs tracking-wide uppercase text-muted-foreground",children:"Notes"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5",children:[jsxRuntimeExports.jsx("div",{className:`w-1.5 h-1.5 rounded-full ${a?"bg-amber-500":"bg-emerald-500"}`}),jsxRuntimeExports.jsx("span",{className:"text-xs text-muted-foreground",children:a?"Saving...":"Synced"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1",children:[jsxRuntimeExports.jsxs(Button,{size:"sm",variant:"ghost",onClick:t,className:"h-7 px-2 text-xs",disabled:!h,children:[jsxRuntimeExports.jsx(Plus,{className:"w-3.5 h-3.5 mr-1"}),"New Note"]}),e&&jsxRuntimeExports.jsxs(DropdownMenu,{children:[jsxRuntimeExports.jsx(DropdownMenuTrigger,{asChild:!0,children:jsxRuntimeExports.jsx("button",{className:"p-1 hover:bg-muted rounded transition-colors",title:"Export note",children:jsxRuntimeExports.jsx(Download,{className:"w-3.5 h-3.5 text-muted-foreground"})})}),jsxRuntimeExports.jsxs(DropdownMenuContent,{align:"end",children:[jsxRuntimeExports.jsxs(DropdownMenuItem,{onClick:x,className:"text-xs",children:[jsxRuntimeExports.jsx(FileDown,{className:"w-3 h-3 mr-2"}),"Export as Markdown"]}),jsxRuntimeExports.jsxs(DropdownMenuItem,{onClick:E,className:"text-xs",children:[jsxRuntimeExports.jsx(FileDown,{className:"w-3 h-3 mr-2"}),"Export as Text"]}),jsxRuntimeExports.jsxs(DropdownMenuItem,{onClick:b,className:"text-xs",children:[jsxRuntimeExports.jsx(FileDown,{className:"w-3 h-3 mr-2"}),"Print / Save as PDF"]})]})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[s.length>0&&jsxRuntimeExports.jsx("div",{className:"border-b border-border",children:jsxRuntimeExports.jsx(ScrollArea,{className:"h-[200px]",children:jsxRuntimeExports.jsx("div",{className:"p-2 space-y-1",children:s.map(_=>jsxRuntimeExports.jsx("div",{onClick:()=>n(_.id),className:`p-2 rounded-md cursor-pointer group transition-colors ${e?.id===_.id?"bg-accent border border-accent":"hover:bg-muted border border-transparent"}`,children:jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between gap-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5",children:[jsxRuntimeExports.jsx(FileText,{className:"w-3 h-3 text-muted-foreground flex-shrink-0"}),jsxRuntimeExports.jsx("h4",{className:"text-xs font-medium truncate",children:_.title})]}),jsxRuntimeExports.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:new Date(_.updated_at).toLocaleDateString()})]}),jsxRuntimeExports.jsx("button",{onClick:S=>{S.stopPropagation(),v(_.id)},className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-destructive/10 rounded transition-opacity",title:"Delete note",children:jsxRuntimeExports.jsx(Trash2,{className:"w-3 h-3 text-destructive"})})]})},_.id))})})}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-auto p-3",children:l?jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center h-full",children:jsxRuntimeExports.jsx(LoaderCircle,{className:"w-6 h-6 animate-spin text-muted-foreground"})}):h?s.length===0?jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-4",children:[jsxRuntimeExports.jsx(FileText,{className:"w-12 h-12 text-muted-foreground/30 mb-3"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"No notes yet"}),jsxRuntimeExports.jsxs(Button,{size:"sm",variant:"outline",onClick:t,className:"text-xs",children:[jsxRuntimeExports.jsx(Plus,{className:"w-3 h-3 mr-1"}),"Create your first note"]})]}):e?jsxRuntimeExports.jsx(Textarea,{value:e.content,onChange:_=>i(_.target.value),className:"min-h-full w-full resize-none border-0 p-0 focus-visible:ring-0 font-mono text-xs leading-relaxed",placeholder:"Start typing your notes... (First line becomes the title)"}):jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center h-full",children:jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Select a note to edit"})}):jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center px-4",children:[jsxRuntimeExports.jsx(FileText,{className:"w-12 h-12 text-muted-foreground/30 mb-3"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Upload a textbook to start taking notes"})]})})]}),jsxRuntimeExports.jsx(AlertDialog,{open:d,onOpenChange:u,children:jsxRuntimeExports.jsxs(AlertDialogContent,{children:[jsxRuntimeExports.jsxs(AlertDialogHeader,{children:[jsxRuntimeExports.jsx(AlertDialogTitle,{children:"Delete Note?"}),jsxRuntimeExports.jsx(AlertDialogDescription,{children:"This action cannot be undone. This will permanently delete your note."})]}),jsxRuntimeExports.jsxs(AlertDialogFooter,{children:[jsxRuntimeExports.jsx(AlertDialogCancel,{children:"Cancel"}),jsxRuntimeExports.jsx(AlertDialogAction,{onClick:g,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Delete"})]})]})})]})}function commonjsRequire(s){throw new Error('Could not dynamically require "'+s+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf$1={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);var hasRequiredPdf;function requirePdf(){return hasRequiredPdf||(hasRequiredPdf=1,(function(module,exports){(function(e,t){module.exports=e.pdfjsLib=t()})(globalThis,()=>(()=>{var __webpack_modules__=[,((s,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.VerbosityLevel=e.Util=e.UnknownErrorException=e.UnexpectedResponseException=e.TextRenderingMode=e.RenderingIntentFlag=e.PromiseCapability=e.PermissionFlag=e.PasswordResponses=e.PasswordException=e.PageActionEventType=e.OPS=e.MissingPDFException=e.MAX_IMAGE_SIZE_TO_CACHE=e.LINE_FACTOR=e.LINE_DESCENT_FACTOR=e.InvalidPDFException=e.ImageKind=e.IDENTITY_MATRIX=e.FormatError=e.FeatureTest=e.FONT_IDENTITY_MATRIX=e.DocumentActionEventType=e.CMapCompressionType=e.BaseException=e.BASELINE_FACTOR=e.AnnotationType=e.AnnotationReplyType=e.AnnotationPrefix=e.AnnotationMode=e.AnnotationFlag=e.AnnotationFieldFlag=e.AnnotationEditorType=e.AnnotationEditorPrefix=e.AnnotationEditorParamsType=e.AnnotationBorderStyleType=e.AnnotationActionEventType=e.AbortException=void 0,e.assert=k,e.bytesToString=J,e.createValidAbsoluteUrl=D,e.getModificationDate=Ue,e.getUuid=ut,e.getVerbosityLevel=ie,e.info=Q,e.isArrayBuffer=Te,e.isArrayEqual=$e,e.isNodeJS=void 0,e.normalizeUnicode=xt,e.objectFromMap=ce,e.objectSize=ve,e.setVerbosityLevel=re,e.shadow=U,e.string32=oe,e.stringToBytes=Z,e.stringToPDFString=Pe,e.stringToUTF8String=Oe,e.unreachable=N,e.utf8StringToString=xe,e.warn=z;const t=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");e.isNodeJS=t;const n=[1,0,0,1,0,0];e.IDENTITY_MATRIX=n;const i=[.001,0,0,.001,0,0];e.FONT_IDENTITY_MATRIX=i;const o=1e7;e.MAX_IMAGE_SIZE_TO_CACHE=o;const a=1.35;e.LINE_FACTOR=a;const l=.35;e.LINE_DESCENT_FACTOR=l;const h=l/a;e.BASELINE_FACTOR=h;const d={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};e.RenderingIntentFlag=d;const u={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};e.AnnotationMode=u;const f="pdfjs_internal_editor_";e.AnnotationEditorPrefix=f;const m={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};e.AnnotationEditorType=m;const v={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};e.AnnotationEditorParamsType=v;const g={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};e.PermissionFlag=g;const x={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};e.TextRenderingMode=x;const E={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};e.ImageKind=E;const b={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};e.AnnotationType=b;const _={GROUP:"Group",REPLY:"R"};e.AnnotationReplyType=_;const S={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};e.AnnotationFlag=S;const C={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};e.AnnotationFieldFlag=C;const A={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};e.AnnotationBorderStyleType=A;const R={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};e.AnnotationActionEventType=R;const L={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};e.DocumentActionEventType=L;const j={O:"PageOpen",C:"PageClose"};e.PageActionEventType=j;const F={ERRORS:0,WARNINGS:1,INFOS:5};e.VerbosityLevel=F;const W={NONE:0,BINARY:1};e.CMapCompressionType=W;const K={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};e.OPS=K;const ee={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};e.PasswordResponses=ee;let te=F.WARNINGS;function re(be){Number.isInteger(be)&&(te=be)}function ie(){return te}function Q(be){te>=F.INFOS&&console.log(`Info: ${be}`)}function z(be){te>=F.WARNINGS&&console.log(`Warning: ${be}`)}function N(be){throw new Error(be)}function k(be,he){be||N(he)}function I(be){switch(be?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function D(be,he=null,le=null){if(!be)return null;try{if(le&&typeof be=="string"&&(le.addDefaultProtocol&&be.startsWith("www.")&&be.match(/\./g)?.length>=2&&(be=`http://${be}`),le.tryConvertEncoding))try{be=Oe(be)}catch{}const Re=he?new URL(be,he):new URL(be);if(I(Re))return Re}catch{}return null}function U(be,he,le,Re=!1){return Object.defineProperty(be,he,{value:le,enumerable:!Re,configurable:!0,writable:!1}),le}const $=(function(){function he(le,Re){this.constructor===he&&N("Cannot initialize BaseException."),this.message=le,this.name=Re}return he.prototype=new Error,he.constructor=he,he})();e.BaseException=$;class q extends ${constructor(he,le){super(he,"PasswordException"),this.code=le}}e.PasswordException=q;class V extends ${constructor(he,le){super(he,"UnknownErrorException"),this.details=le}}e.UnknownErrorException=V;class P extends ${constructor(he){super(he,"InvalidPDFException")}}e.InvalidPDFException=P;class O extends ${constructor(he){super(he,"MissingPDFException")}}e.MissingPDFException=O;class B extends ${constructor(he,le){super(he,"UnexpectedResponseException"),this.status=le}}e.UnexpectedResponseException=B;class G extends ${constructor(he){super(he,"FormatError")}}e.FormatError=G;class Y extends ${constructor(he){super(he,"AbortException")}}e.AbortException=Y;function J(be){(typeof be!="object"||be?.length===void 0)&&N("Invalid argument for bytesToString");const he=be.length,le=8192;if(he<le)return String.fromCharCode.apply(null,be);const Re=[];for(let ze=0;ze<he;ze+=le){const He=Math.min(ze+le,he),st=be.subarray(ze,He);Re.push(String.fromCharCode.apply(null,st))}return Re.join("")}function Z(be){typeof be!="string"&&N("Invalid argument for stringToBytes");const he=be.length,le=new Uint8Array(he);for(let Re=0;Re<he;++Re)le[Re]=be.charCodeAt(Re)&255;return le}function oe(be){return String.fromCharCode(be>>24&255,be>>16&255,be>>8&255,be&255)}function ve(be){return Object.keys(be).length}function ce(be){const he=Object.create(null);for(const[le,Re]of be)he[le]=Re;return he}function ue(){const be=new Uint8Array(4);return be[0]=1,new Uint32Array(be.buffer,0,1)[0]===1}function de(){try{return new Function(""),!0}catch{return!1}}class pe{static get isLittleEndian(){return U(this,"isLittleEndian",ue())}static get isEvalSupported(){return U(this,"isEvalSupported",de())}static get isOffscreenCanvasSupported(){return U(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?U(this,"platform",{isWin:!1,isMac:!1}):U(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){return U(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}e.FeatureTest=pe;const ye=[...Array(256).keys()].map(be=>be.toString(16).padStart(2,"0"));class Ae{static makeHexColor(he,le,Re){return`#${ye[he]}${ye[le]}${ye[Re]}`}static scaleMinMax(he,le){let Re;he[0]?(he[0]<0&&(Re=le[0],le[0]=le[1],le[1]=Re),le[0]*=he[0],le[1]*=he[0],he[3]<0&&(Re=le[2],le[2]=le[3],le[3]=Re),le[2]*=he[3],le[3]*=he[3]):(Re=le[0],le[0]=le[2],le[2]=Re,Re=le[1],le[1]=le[3],le[3]=Re,he[1]<0&&(Re=le[2],le[2]=le[3],le[3]=Re),le[2]*=he[1],le[3]*=he[1],he[2]<0&&(Re=le[0],le[0]=le[1],le[1]=Re),le[0]*=he[2],le[1]*=he[2]),le[0]+=he[4],le[1]+=he[4],le[2]+=he[5],le[3]+=he[5]}static transform(he,le){return[he[0]*le[0]+he[2]*le[1],he[1]*le[0]+he[3]*le[1],he[0]*le[2]+he[2]*le[3],he[1]*le[2]+he[3]*le[3],he[0]*le[4]+he[2]*le[5]+he[4],he[1]*le[4]+he[3]*le[5]+he[5]]}static applyTransform(he,le){const Re=he[0]*le[0]+he[1]*le[2]+le[4],ze=he[0]*le[1]+he[1]*le[3]+le[5];return[Re,ze]}static applyInverseTransform(he,le){const Re=le[0]*le[3]-le[1]*le[2],ze=(he[0]*le[3]-he[1]*le[2]+le[2]*le[5]-le[4]*le[3])/Re,He=(-he[0]*le[1]+he[1]*le[0]+le[4]*le[1]-le[5]*le[0])/Re;return[ze,He]}static getAxialAlignedBoundingBox(he,le){const Re=this.applyTransform(he,le),ze=this.applyTransform(he.slice(2,4),le),He=this.applyTransform([he[0],he[3]],le),st=this.applyTransform([he[2],he[1]],le);return[Math.min(Re[0],ze[0],He[0],st[0]),Math.min(Re[1],ze[1],He[1],st[1]),Math.max(Re[0],ze[0],He[0],st[0]),Math.max(Re[1],ze[1],He[1],st[1])]}static inverseTransform(he){const le=he[0]*he[3]-he[1]*he[2];return[he[3]/le,-he[1]/le,-he[2]/le,he[0]/le,(he[2]*he[5]-he[4]*he[3])/le,(he[4]*he[1]-he[5]*he[0])/le]}static singularValueDecompose2dScale(he){const le=[he[0],he[2],he[1],he[3]],Re=he[0]*le[0]+he[1]*le[2],ze=he[0]*le[1]+he[1]*le[3],He=he[2]*le[0]+he[3]*le[2],st=he[2]*le[1]+he[3]*le[3],Mt=(Re+st)/2,Tt=Math.sqrt((Re+st)**2-4*(Re*st-He*ze))/2,$t=Mt+Tt||1,Le=Mt-Tt||1;return[Math.sqrt($t),Math.sqrt(Le)]}static normalizeRect(he){const le=he.slice(0);return he[0]>he[2]&&(le[0]=he[2],le[2]=he[0]),he[1]>he[3]&&(le[1]=he[3],le[3]=he[1]),le}static intersect(he,le){const Re=Math.max(Math.min(he[0],he[2]),Math.min(le[0],le[2])),ze=Math.min(Math.max(he[0],he[2]),Math.max(le[0],le[2]));if(Re>ze)return null;const He=Math.max(Math.min(he[1],he[3]),Math.min(le[1],le[3])),st=Math.min(Math.max(he[1],he[3]),Math.max(le[1],le[3]));return He>st?null:[Re,He,ze,st]}static bezierBoundingBox(he,le,Re,ze,He,st,Mt,Tt){const $t=[],Le=[[],[]];let Ye,Je,dt,Qe,et,it,Wt,ht;for(let fn=0;fn<2;++fn){if(fn===0?(Je=6*he-12*Re+6*He,Ye=-3*he+9*Re-9*He+3*Mt,dt=3*Re-3*he):(Je=6*le-12*ze+6*st,Ye=-3*le+9*ze-9*st+3*Tt,dt=3*ze-3*le),Math.abs(Ye)<1e-12){if(Math.abs(Je)<1e-12)continue;Qe=-dt/Je,0<Qe&&Qe<1&&$t.push(Qe);continue}Wt=Je*Je-4*dt*Ye,ht=Math.sqrt(Wt),!(Wt<0)&&(et=(-Je+ht)/(2*Ye),0<et&&et<1&&$t.push(et),it=(-Je-ht)/(2*Ye),0<it&&it<1&&$t.push(it))}let gt=$t.length,lt;const bt=gt;for(;gt--;)Qe=$t[gt],lt=1-Qe,Le[0][gt]=lt*lt*lt*he+3*lt*lt*Qe*Re+3*lt*Qe*Qe*He+Qe*Qe*Qe*Mt,Le[1][gt]=lt*lt*lt*le+3*lt*lt*Qe*ze+3*lt*Qe*Qe*st+Qe*Qe*Qe*Tt;return Le[0][bt]=he,Le[1][bt]=le,Le[0][bt+1]=Mt,Le[1][bt+1]=Tt,Le[0].length=Le[1].length=bt+2,[Math.min(...Le[0]),Math.min(...Le[1]),Math.max(...Le[0]),Math.max(...Le[1])]}}e.Util=Ae;const Ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function Pe(be){if(be[0]>=""){let le;if(be[0]===""&&be[1]===""?le="utf-16be":be[0]===""&&be[1]===""?le="utf-16le":be[0]===""&&be[1]===""&&be[2]===""&&(le="utf-8"),le)try{const Re=new TextDecoder(le,{fatal:!0}),ze=Z(be);return Re.decode(ze)}catch(Re){z(`stringToPDFString: "${Re}".`)}}const he=[];for(let le=0,Re=be.length;le<Re;le++){const ze=Ce[be.charCodeAt(le)];he.push(ze?String.fromCharCode(ze):be.charAt(le))}return he.join("")}function Oe(be){return decodeURIComponent(escape(be))}function xe(be){return unescape(encodeURIComponent(be))}function Te(be){return typeof be=="object"&&be?.byteLength!==void 0}function $e(be,he){if(be.length!==he.length)return!1;for(let le=0,Re=be.length;le<Re;le++)if(be[le]!==he[le])return!1;return!0}function Ue(be=new Date){return[be.getUTCFullYear().toString(),(be.getUTCMonth()+1).toString().padStart(2,"0"),be.getUTCDate().toString().padStart(2,"0"),be.getUTCHours().toString().padStart(2,"0"),be.getUTCMinutes().toString().padStart(2,"0"),be.getUTCSeconds().toString().padStart(2,"0")].join("")}class qe{#e=!1;constructor(){this.promise=new Promise((he,le)=>{this.resolve=Re=>{this.#e=!0,he(Re)},this.reject=Re=>{this.#e=!0,le(Re)}})}get settled(){return this.#e}}e.PromiseCapability=qe;let Ke=null,Ge=null;function xt(be){return Ke||(Ke=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Ge=new Map([["","t"]])),be.replaceAll(Ke,(he,le,Re)=>le?le.normalize("NFKC"):Ge.get(Re))}function ut(){if(typeof crypto<"u"&&typeof crypto?.randomUUID=="function")return crypto.randomUUID();const be=new Uint8Array(32);if(typeof crypto<"u"&&typeof crypto?.getRandomValues=="function")crypto.getRandomValues(be);else for(let he=0;he<32;he++)be[he]=Math.floor(Math.random()*255);return J(be)}const Ot="pdfjs_internal_id_";e.AnnotationPrefix=Ot}),((__unused_webpack_module,exports,__w_pdfjs_require__)=>{Object.defineProperty(exports,"__esModule",{value:!0}),exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultFilterFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports.build=void 0,exports.getDocument=getDocument,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(s){if(typeof s=="string"||s instanceof URL?s={url:s}:(0,_util.isArrayBuffer)(s)&&(s={data:s}),typeof s!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!s.url&&!s.data&&!s.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const e=new PDFDocumentLoadingTask,{docId:t}=e,n=s.url?getUrlProp(s.url):null,i=s.data?getDataProp(s.data):null,o=s.httpHeaders||null,a=s.withCredentials===!0,l=s.password??null,h=s.range instanceof PDFDataRangeTransport?s.range:null,d=Number.isInteger(s.rangeChunkSize)&&s.rangeChunkSize>0?s.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let u=s.worker instanceof PDFWorker?s.worker:null;const f=s.verbosity,m=typeof s.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(s.docBaseUrl)?s.docBaseUrl:null,v=typeof s.cMapUrl=="string"?s.cMapUrl:null,g=s.cMapPacked!==!1,x=s.CMapReaderFactory||DefaultCMapReaderFactory,E=typeof s.standardFontDataUrl=="string"?s.standardFontDataUrl:null,b=s.StandardFontDataFactory||DefaultStandardFontDataFactory,_=s.stopAtErrors!==!0,S=Number.isInteger(s.maxImageSize)&&s.maxImageSize>-1?s.maxImageSize:-1,C=s.isEvalSupported!==!1,A=typeof s.isOffscreenCanvasSupported=="boolean"?s.isOffscreenCanvasSupported:!_util.isNodeJS,R=Number.isInteger(s.canvasMaxAreaInBytes)?s.canvasMaxAreaInBytes:-1,L=typeof s.disableFontFace=="boolean"?s.disableFontFace:_util.isNodeJS,j=s.fontExtraProperties===!0,F=s.enableXfa===!0,W=s.ownerDocument||globalThis.document,K=s.disableRange===!0,ee=s.disableStream===!0,te=s.disableAutoFetch===!0,re=s.pdfBug===!0,ie=h?h.length:s.length??NaN,Q=typeof s.useSystemFonts=="boolean"?s.useSystemFonts:!_util.isNodeJS&&!L,z=typeof s.useWorkerFetch=="boolean"?s.useWorkerFetch:x===_display_utils.DOMCMapReaderFactory&&b===_display_utils.DOMStandardFontDataFactory&&v&&E&&(0,_display_utils.isValidFetchUrl)(v,document.baseURI)&&(0,_display_utils.isValidFetchUrl)(E,document.baseURI),N=s.canvasFactory||new DefaultCanvasFactory({ownerDocument:W}),k=s.filterFactory||new DefaultFilterFactory({docId:t,ownerDocument:W}),I=null;(0,_util.setVerbosityLevel)(f);const D={canvasFactory:N,filterFactory:k};if(z||(D.cMapReaderFactory=new x({baseUrl:v,isCompressed:g}),D.standardFontDataFactory=new b({baseUrl:E})),!u){const q={verbosity:f,port:_worker_options.GlobalWorkerOptions.workerPort};u=q.port?PDFWorker.fromPort(q):new PDFWorker(q),e._worker=u}const U={docId:t,apiVersion:"3.11.174",data:i,password:l,disableAutoFetch:te,rangeChunkSize:d,length:ie,docBaseUrl:m,enableXfa:F,evaluatorOptions:{maxImageSize:S,disableFontFace:L,ignoreErrors:_,isEvalSupported:C,isOffscreenCanvasSupported:A,canvasMaxAreaInBytes:R,fontExtraProperties:j,useSystemFonts:Q,cMapUrl:z?v:null,standardFontDataUrl:z?E:null}},$={ignoreErrors:_,isEvalSupported:C,disableFontFace:L,fontExtraProperties:j,enableXfa:F,ownerDocument:W,disableAutoFetch:te,pdfBug:re,styleElement:I};return u.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");const q=_fetchDocument(u,U),V=new Promise(function(P){let O;h?O=new _transport_stream.PDFDataTransportStream({length:ie,initialData:h.initialData,progressiveDone:h.progressiveDone,contentDispositionFilename:h.contentDispositionFilename,disableRange:K,disableStream:ee},h):i||(O=(G=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(G):(0,_display_utils.isValidFetchUrl)(G.url)?new _displayFetch_stream.PDFFetchStream(G):new _displayNetwork.PDFNetworkStream(G))({url:n,length:ie,httpHeaders:o,withCredentials:a,rangeChunkSize:d,disableRange:K,disableStream:ee})),P(O)});return Promise.all([q,V]).then(function([P,O]){if(e.destroyed)throw new Error("Loading aborted");const B=new _message_handler.MessageHandler(t,P,u.port),G=new WorkerTransport(B,e,O,$,D);e._transport=G,B.send("Ready",null)})}).catch(e._capability.reject),e}async function _fetchDocument(s,e){if(s.destroyed)throw new Error("Worker was destroyed");const t=await s.messageHandler.sendWithPromise("GetDocRequest",e,e.data?[e.data.buffer]:null);if(s.destroyed)throw new Error("Worker was destroyed");return t}function getUrlProp(s){if(s instanceof URL)return s.href;try{return new URL(s,window.location).href}catch{if(_util.isNodeJS&&typeof s=="string")return s}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(s){if(_util.isNodeJS&&typeof Buffer<"u"&&s instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(s instanceof Uint8Array&&s.byteLength===s.buffer.byteLength)return s;if(typeof s=="string")return(0,_util.stringToBytes)(s);if(typeof s=="object"&&!isNaN(s?.length)||(0,_util.isArrayBuffer)(s))return new Uint8Array(s);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}class PDFDocumentLoadingTask{static#e=0;constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${PDFDocumentLoadingTask.#e++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(e,t,n=!1,i=null){this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=i,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const n of this._rangeListeners)n(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const n of this._progressListeners)n(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(e,t){this._pdfInfo=e,this._transport=t,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(n=>{if(!n)return n;const i=[];for(const o in n)i.push(...n[o]);return i}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{#e=null;#t=!1;constructor(e,t,n,i=!1){this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=i?new _display_utils.StatTimer:null,this._pdfBug=i,this.commonObjs=n.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:i=0,dontFlip:o=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:o})}getAnnotations({intent:e="display"}={}){const t=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,viewport:t,intent:n="display",annotationMode:i=_util.AnnotationMode.ENABLE,transform:o=null,background:a=null,optionalContentConfigPromise:l=null,annotationCanvasMap:h=null,pageColors:d=null,printAnnotationStorage:u=null}){this._stats?.time("Overall");const f=this._transport.getRenderingIntent(n,i,u);this.#t=!1,this.#r(),l||(l=this._transport.getOptionalContentConfig());let m=this._intentStates.get(f.cacheKey);m||(m=Object.create(null),this._intentStates.set(f.cacheKey,m)),m.streamReaderCancelTimeout&&(clearTimeout(m.streamReaderCancelTimeout),m.streamReaderCancelTimeout=null);const v=!!(f.renderingIntent&_util.RenderingIntentFlag.PRINT);m.displayReadyCapability||(m.displayReadyCapability=new _util.PromiseCapability,m.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(f));const g=b=>{m.renderTasks.delete(x),(this._maybeCleanupAfterRender||v)&&(this.#t=!0),this.#n(!v),b?(x.capability.reject(b),this._abortOperatorList({intentState:m,reason:b instanceof Error?b:new Error(b)})):x.capability.resolve(),this._stats?.timeEnd("Rendering"),this._stats?.timeEnd("Overall")},x=new InternalRenderTask({callback:g,params:{canvasContext:e,viewport:t,transform:o,background:a},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:h,operatorList:m.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!v,pdfBug:this._pdfBug,pageColors:d});(m.renderTasks||=new Set).add(x);const E=x.task;return Promise.all([m.displayReadyCapability.promise,l]).then(([b,_])=>{if(this.destroyed){g();return}this._stats?.time("Rendering"),x.initializeGraphics({transparency:b,optionalContentConfig:_}),x.operatorListChanged()}).catch(g),E}getOperatorList({intent:e="display",annotationMode:t=_util.AnnotationMode.ENABLE,printAnnotationStorage:n=null}={}){function i(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(l))}const o=this._transport.getRenderingIntent(e,t,n,!0);let a=this._intentStates.get(o.cacheKey);a||(a=Object.create(null),this._intentStates.set(o.cacheKey,a));let l;return a.opListReadCapability||(l=Object.create(null),l.operatorListChanged=i,a.opListReadCapability=new _util.PromiseCapability,(a.renderTasks||=new Set).add(l),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(o)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(i){return i.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>_xfa_text.XfaText.textContent(n));const t=this.streamTextContent(e);return new Promise(function(n,i){function o(){a.read().then(function({value:h,done:d}){if(d){n(l);return}Object.assign(l.styles,h.styles),l.items.push(...h.items),o()},i)}const a=t.getReader(),l={items:[],styles:Object.create(null)};o()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),this.#t=!1,this.#r(),Promise.all(e)}cleanup(e=!1){this.#t=!0;const t=this.#n(!1);return e&&t&&(this._stats&&=new _display_utils.StatTimer),t}#n(e=!1){if(this.#r(),!this.#t||this.destroyed)return!1;if(e)return this.#e=setTimeout(()=>{this.#e=null,this.#n(!1)},DELAYED_CLEANUP_TIMEOUT),!1;for(const{renderTasks:t,operatorList:n}of this._intentStates.values())if(t.size>0||!n.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}#r(){this.#e&&(clearTimeout(this.#e),this.#e=null)}_startRenderPage(e,t){const n=this._intentStates.get(t);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let n=0,i=e.length;n<i;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&this.#n(!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n}){const{map:i,transfers:o}=n,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:i},o).getReader(),h=this._intentStates.get(t);h.streamReader=l;const d=()=>{l.read().then(({value:u,done:f})=>{if(f){h.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(u,h),d())},u=>{if(h.streamReader=null,!this._transport.destroyed){if(h.operatorList){h.operatorList.lastChunk=!0;for(const f of h.renderTasks)f.operatorListChanged();this.#n(!0)}if(h.displayReadyCapability)h.displayReadyCapability.reject(u);else if(h.opListReadCapability)h.opListReadCapability.reject(u);else throw u}})};d()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof _display_utils.RenderingCancelledException){let i=RENDERING_CANCELLED_TIMEOUT;t.extraDelay>0&&t.extraDelay<1e3&&(i+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},i);return}}if(e.streamReader.cancel(new _util.AbortException(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[i,o]of this._intentStates)if(o===e){this._intentStates.delete(i);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{#e=new Set;#t=Promise.resolve();postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(const i of this.#e)i.call(this,n)})}addEventListener(e,t){this.#e.add(t)}removeEventListener(e,t){this.#e.delete(t)}terminate(){this.#e.clear()}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const s=document?.currentScript?.src;s&&(PDFWorkerUtil.fallbackWorkerSrc=s.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(s,e){let t;try{if(t=new URL(s),!t.origin||t.origin==="null")return!1}catch{return!1}const n=new URL(e,t);return t.origin===n.origin},PDFWorkerUtil.createCDNWrapper=function(s){const e=`importScripts("${s}");`;return URL.createObjectURL(new Blob([e]))}}class PDFWorker{static#workerPorts;constructor({name:s=null,port:e=null,verbosity:t=(0,_util.getVerbosityLevel)()}={}){if(this.name=s,this.destroyed=!1,this.verbosity=t,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,e){if(PDFWorker.#workerPorts?.has(e))throw new Error("Cannot use more than one PDFWorker per port.");(PDFWorker.#workerPorts||=new WeakMap).set(e,this),this._initializeFromPort(e);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(s){this._port=s,this._messageHandler=new _message_handler.MessageHandler("main","worker",s),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:s}=PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,s)||(s=PDFWorkerUtil.createCDNWrapper(new URL(s,window.location).href));const e=new Worker(s),t=new _message_handler.MessageHandler("main","worker",e),n=()=>{e.removeEventListener("error",i),t.destroy(),e.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},i=()=>{this._webWorker||n()};e.addEventListener("error",i),t.on("test",a=>{if(e.removeEventListener("error",i),this.destroyed){n();return}a?(this._messageHandler=t,this._port=e,this._webWorker=e,this._readyCapability.resolve(),t.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),t.destroy(),e.terminate())}),t.on("ready",a=>{if(e.removeEventListener("error",i),this.destroyed){n();return}try{o()}catch{this._setupFakeWorker()}});const o=()=>{const a=new Uint8Array;t.send("test",a,[a.buffer])};o();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then(s=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const e=new LoopbackPort;this._port=e;const t=`fake${PDFWorkerUtil.fakeWorkerId++}`,n=new _message_handler.MessageHandler(t+"_worker",t,e);s.setup(n,e);const i=new _message_handler.MessageHandler(t,t+"_worker",e);this._messageHandler=i,this._readyCapability.resolve(),i.send("configure",{verbosity:this.verbosity})}).catch(s=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${s.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),PDFWorker.#workerPorts?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(s){if(!s?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const e=this.#workerPorts?.get(s.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new PDFWorker(s)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=PDFWorker;class WorkerTransport{#e=new Map;#t=new Map;#n=new Map;#r=null;constructor(e,t,n,i,o){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:i.ownerDocument,styleElement:i.styleElement}),this._params=i,this.canvasFactory=o.canvasFactory,this.filterFactory=o.filterFactory,this.cMapReaderFactory=o.cMapReaderFactory,this.standardFontDataFactory=o.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}#s(e,t=null){const n=this.#e.get(e);if(n)return n;const i=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,i),i}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(e,t=_util.AnnotationMode.ENABLE,n=null,i=!1){let o=_util.RenderingIntentFlag.DISPLAY,a=_annotation_storage.SerializableEmpty;switch(e){case"any":o=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":o=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${e}`)}switch(t){case _util.AnnotationMode.DISABLE:o+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:o+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:o+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,a=(o&_util.RenderingIntentFlag.PRINT&&n instanceof _annotation_storage.PrintAnnotationStorage?n:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${t}`)}return i&&(o+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:o,cacheKey:`${o}_${a.hash}`,annotationStorageSerializable:a}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,this.#r?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const n of this.#t.values())e.push(n._destroy());this.#t.clear(),this.#n.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),this._networkStream?.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,i)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=o=>{this._lastProgress={loaded:o.loaded,total:o.total}},i.onPull=()=>{this._fullReader.read().then(function({value:o,done:a}){if(a){i.close();return}(0,_util.assert)(o instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{i.error(o)})},i.onCancel=o=>{this._fullReader.cancel(o),i.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("ReaderHeadersReady",n=>{const i=new _util.PromiseCapability,o=this._fullReader;return o.headersReady.then(()=>{(!o.isStreamingSupported||!o.isRangeSupported)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),o.onProgress=a=>{t.onProgress?.({loaded:a.loaded,total:a.total})}),i.resolve({isStreamingSupported:o.isStreamingSupported,isRangeSupported:o.isRangeSupported,contentLength:o.contentLength})},i.reject),i.promise}),e.on("GetRangeReader",(n,i)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const o=this._networkStream.getRangeReader(n.begin,n.end);if(!o){i.close();return}i.onPull=()=>{o.read().then(function({value:a,done:l}){if(l){i.close();return}(0,_util.assert)(a instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),i.enqueue(new Uint8Array(a),1,[a])}).catch(a=>{i.error(a)})},i.onCancel=a=>{o.cancel(a),i.ready.catch(l=>{if(!this.destroyed)throw l})}}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new PDFDocumentProxy(n,this))}),e.on("DocException",function(n){let i;switch(n.name){case"PasswordException":i=new _util.PasswordException(n.message,n.code);break;case"InvalidPDFException":i=new _util.InvalidPDFException(n.message);break;case"MissingPDFException":i=new _util.MissingPDFException(n.message);break;case"UnexpectedResponseException":i=new _util.UnexpectedResponseException(n.message,n.status);break;case"UnknownErrorException":i=new _util.UnknownErrorException(n.message,n.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}t._capability.reject(i)}),e.on("PasswordRequest",n=>{if(this.#r=new _util.PromiseCapability,t.onPassword){const i=o=>{o instanceof Error?this.#r.reject(o):this.#r.resolve({password:o})};try{t.onPassword(i,n.code)}catch(o){this.#r.reject(o)}}else this.#r.reject(new _util.PasswordException(n.message,n.code));return this.#r.promise}),e.on("DataLoaded",n=>{t.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;this.#t.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,i,o])=>{if(!this.destroyed&&!this.commonObjs.has(n))switch(i){case"Font":const a=this._params;if("error"in o){const d=o.error;(0,_util.warn)(`Error during font loading: ${d}`),this.commonObjs.resolve(n,d);break}const l=a.pdfBug&&globalThis.FontInspector?.enabled?(d,u)=>globalThis.FontInspector.fontAdded(d,u):null,h=new _font_loader.FontFaceObject(o,{isEvalSupported:a.isEvalSupported,disableFontFace:a.disableFontFace,ignoreErrors:a.ignoreErrors,inspectFont:l});this.fontLoader.bind(h).catch(d=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!a.fontExtraProperties&&h.data&&(h.data=null),this.commonObjs.resolve(n,h)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,o);break;default:throw new Error(`Got unknown common object type ${i}`)}}),e.on("obj",([n,i,o,a])=>{if(this.destroyed)return;const l=this.#t.get(i);if(!l.objs.has(n))switch(o){case"Image":if(l.objs.resolve(n,a),a){let h;if(a.bitmap){const{width:d,height:u}=a;h=d*u*4}else h=a.data?.length||0;h>_util.MAX_IMAGE_SIZE_TO_CACHE&&(l._maybeCleanupAfterRender=!0)}break;case"Pattern":l.objs.resolve(n,a);break;default:throw new Error(`Got unknown object type ${o}`)}}),e.on("DocProgress",n=>{this.destroyed||t.onProgress?.({loaded:n.loaded,total:n.total})}),e.on("FetchBuiltInCMap",n=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(n):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),e.on("FetchStandardFontData",n=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(n):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfers:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=this.#n.get(t);if(n)return n;const i=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(o=>{if(this.destroyed)throw new Error("Transport destroyed");const a=new PDFPageProxy(t,o,this,this._params.pdfBug);return this.#t.set(t,a),a});return this.#n.set(t,i),i}getPageIndex(e){return typeof e!="object"||e===null||!Number.isInteger(e.num)||e.num<0||!Number.isInteger(e.gen)||e.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen})}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#s("GetFieldObjects")}hasJSActions(){return this.#s("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#s("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(e=>new _optional_content_config.OptionalContentConfig(e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#e.get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(i=>({info:i[0],metadata:i[1]?new _metadata.Metadata(i[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:e,enableXfa:t}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:e,enableXfa:t})}}class PDFObjects{#e=Object.create(null);#t(e){return this.#e[e]||={capability:new _util.PromiseCapability,data:null}}get(e,t=null){if(t){const i=this.#t(e);return i.capability.promise.then(()=>t(i.data)),null}const n=this.#e[e];if(!n?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){return this.#e[e]?.capability.settled||!1}resolve(e,t=null){const n=this.#t(e);n.data=t,n.capability.resolve()}clear(){for(const e in this.#e){const{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}}class RenderTask{#e=null;constructor(e){this.#e=e,this.onContinue=null}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}}exports.RenderTask=RenderTask;class InternalRenderTask{static#e=new WeakSet;constructor({callback:e,params:t,objs:n,commonObjs:i,annotationCanvasMap:o,operatorList:a,pageIndex:l,canvasFactory:h,filterFactory:d,useRequestAnimationFrame:u=!1,pdfBug:f=!1,pageColors:m=null}){this.callback=e,this.params=t,this.objs=n,this.commonObjs=i,this.annotationCanvasMap=o,this.operatorListIdx=null,this.operatorList=a,this._pageIndex=l,this.canvasFactory=h,this.filterFactory=d,this._pdfBug=f,this.pageColors=m,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=u===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:i,transform:o,background:a}=this.params;this.gfx=new _canvas.CanvasGraphics(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:o,viewport:i,transparency:e,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),InternalRenderTask.#e.delete(this._canvas),this.callback(e||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),InternalRenderTask.#e.delete(this._canvas),this.callback())))}}const version="3.11.174";exports.version=version;const build="ce8716743";exports.build=build}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SerializableEmpty=e.PrintAnnotationStorage=e.AnnotationStorage=void 0;var n=t(1),i=t(4),o=t(8);const a=Object.freeze({map:null,hash:"",transfers:void 0});e.SerializableEmpty=a;class l{#e=!1;#t=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(u,f){const m=this.#t.get(u);return m===void 0?f:Object.assign(f,m)}getRawValue(u){return this.#t.get(u)}remove(u){if(this.#t.delete(u),this.#t.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const f of this.#t.values())if(f instanceof i.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(u,f){const m=this.#t.get(u);let v=!1;if(m!==void 0)for(const[g,x]of Object.entries(f))m[g]!==x&&(v=!0,m[g]=x);else v=!0,this.#t.set(u,f);v&&this.#n(),f instanceof i.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(f.constructor._type)}has(u){return this.#t.has(u)}getAll(){return this.#t.size>0?(0,n.objectFromMap)(this.#t):null}setAll(u){for(const[f,m]of Object.entries(u))this.setValue(f,m)}get size(){return this.#t.size}#n(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new h(this)}get serializable(){if(this.#t.size===0)return a;const u=new Map,f=new o.MurmurHash3_64,m=[],v=Object.create(null);let g=!1;for(const[x,E]of this.#t){const b=E instanceof i.AnnotationEditor?E.serialize(!1,v):E;b&&(u.set(x,b),f.update(`${x}:${JSON.stringify(b)}`),g||=!!b.bitmap)}if(g)for(const x of u.values())x.bitmap&&m.push(x.bitmap);return u.size>0?{map:u,hash:f.hexdigest(),transfers:m}:a}}e.AnnotationStorage=l;class h extends l{#e;constructor(u){super();const{map:f,hash:m,transfers:v}=u.serializable,g=structuredClone(f,v?{transfer:v}:null);this.#e={map:g,hash:m,transfers:v}}get print(){(0,n.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}}e.PrintAnnotationStorage=h}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditor=void 0;var n=t(5),i=t(1),o=t(6);class a{#e="";#t=!1;#n=null;#r=null;#s=null;#o=!1;#i=null;#a=this.focusin.bind(this);#c=this.focusout.bind(this);#l=!1;#h=!1;#d=!1;_initialOptions=Object.create(null);_uiManager=null;_focusEventsAllowed=!0;_l10nPromise=null;#f=!1;#g=a._zIndex++;static _borderLineWidth=-1;static _colorManager=new n.ColorManager;static _zIndex=1;static SMALL_EDITOR_SIZE=0;constructor(d){this.constructor===a&&(0,i.unreachable)("Cannot initialize AnnotationEditor."),this.parent=d.parent,this.id=d.id,this.width=this.height=null,this.pageIndex=d.parent.pageIndex,this.name=d.name,this.div=null,this._uiManager=d.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=d.isCentered,this._structTreeParentId=null;const{rotation:u,rawDims:{pageWidth:f,pageHeight:m,pageX:v,pageY:g}}=this.parent.viewport;this.rotation=u,this.pageRotation=(360+u-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[f,m],this.pageTranslation=[v,g];const[x,E]=this.parentDimensions;this.x=d.x/x,this.y=d.y/E,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,i.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(d){const u=new l({id:d.parent.getNextId(),parent:d.parent,uiManager:d._uiManager});u.annotationElementId=d.annotationElementId,u.deleted=!0,u._uiManager.addToAnnotationStorage(u)}static initialize(d,u=null){if(a._l10nPromise||=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(m=>[m,d.get(m)])),u?.strings)for(const m of u.strings)a._l10nPromise.set(m,d.get(m));if(a._borderLineWidth!==-1)return;const f=getComputedStyle(document.documentElement);a._borderLineWidth=parseFloat(f.getPropertyValue("--outline-width"))||0}static updateDefaultParams(d,u){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(d){return!1}static paste(d,u){(0,i.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#f}set _isDraggable(d){this.#f=d,this.div?.classList.toggle("draggable",d)}center(){const[d,u]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*u/(d*2),this.y+=this.width*d/(u*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*u/(d*2),this.y-=this.width*d/(u*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(d){this._uiManager.addCommands(d)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#g}setParent(d){d!==null&&(this.pageIndex=d.pageIndex,this.pageDimensions=d.pageDimensions),this.parent=d}focusin(d){this._focusEventsAllowed&&(this.#l?this.#l=!1:this.parent.setSelected(this))}focusout(d){!this._focusEventsAllowed||!this.isAttachedToDOM||d.relatedTarget?.closest(`#${this.id}`)||(d.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(d,u,f,m){const[v,g]=this.parentDimensions;[f,m]=this.screenToPageTranslation(f,m),this.x=(d+f)/v,this.y=(u+m)/g,this.fixAndSetPosition()}#m([d,u],f,m){[f,m]=this.screenToPageTranslation(f,m),this.x+=f/d,this.y+=m/u,this.fixAndSetPosition()}translate(d,u){this.#m(this.parentDimensions,d,u)}translateInPage(d,u){this.#m(this.pageDimensions,d,u),this.div.scrollIntoView({block:"nearest"})}drag(d,u){const[f,m]=this.parentDimensions;if(this.x+=d/f,this.y+=u/m,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:b,y:_}=this.div.getBoundingClientRect();this.parent.findNewParent(this,b,_)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:v,y:g}=this;const[x,E]=this.#u();v+=x,g+=E,this.div.style.left=`${(100*v).toFixed(2)}%`,this.div.style.top=`${(100*g).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}#u(){const[d,u]=this.parentDimensions,{_borderLineWidth:f}=a,m=f/d,v=f/u;switch(this.rotation){case 90:return[-m,v];case 180:return[m,v];case 270:return[m,-v];default:return[-m,-v]}}fixAndSetPosition(){const[d,u]=this.pageDimensions;let{x:f,y:m,width:v,height:g}=this;switch(v*=d,g*=u,f*=d,m*=u,this.rotation){case 0:f=Math.max(0,Math.min(d-v,f)),m=Math.max(0,Math.min(u-g,m));break;case 90:f=Math.max(0,Math.min(d-g,f)),m=Math.min(u,Math.max(v,m));break;case 180:f=Math.min(d,Math.max(v,f)),m=Math.min(u,Math.max(g,m));break;case 270:f=Math.min(d,Math.max(g,f)),m=Math.max(0,Math.min(u-v,m));break}this.x=f/=d,this.y=m/=u;const[x,E]=this.#u();f+=x,m+=E;const{style:b}=this.div;b.left=`${(100*f).toFixed(2)}%`,b.top=`${(100*m).toFixed(2)}%`,this.moveInDOM()}static#p(d,u,f){switch(f){case 90:return[u,-d];case 180:return[-d,-u];case 270:return[-u,d];default:return[d,u]}}screenToPageTranslation(d,u){return a.#p(d,u,this.parentRotation)}pageTranslationToScreen(d,u){return a.#p(d,u,360-this.parentRotation)}#v(d){switch(d){case 90:{const[u,f]=this.pageDimensions;return[0,-u/f,f/u,0]}case 180:return[-1,0,0,-1];case 270:{const[u,f]=this.pageDimensions;return[0,u/f,-f/u,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:d,pageDimensions:[u,f]}=this,m=u*d,v=f*d;return i.FeatureTest.isCSSRoundSupported?[Math.round(m),Math.round(v)]:[m,v]}setDims(d,u){const[f,m]=this.parentDimensions;this.div.style.width=`${(100*d/f).toFixed(2)}%`,this.#o||(this.div.style.height=`${(100*u/m).toFixed(2)}%`),this.#n?.classList.toggle("small",d<a.SMALL_EDITOR_SIZE||u<a.SMALL_EDITOR_SIZE)}fixDims(){const{style:d}=this.div,{height:u,width:f}=d,m=f.endsWith("%"),v=!this.#o&&u.endsWith("%");if(m&&v)return;const[g,x]=this.parentDimensions;m||(d.width=`${(100*parseFloat(f)/g).toFixed(2)}%`),!this.#o&&!v&&(d.height=`${(100*parseFloat(u)/x).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#y(){if(this.#i)return;this.#i=document.createElement("div"),this.#i.classList.add("resizers");const d=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||d.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const u of d){const f=document.createElement("div");this.#i.append(f),f.classList.add("resizer",u),f.addEventListener("pointerdown",this.#x.bind(this,u)),f.addEventListener("contextmenu",o.noContextMenu)}this.div.prepend(this.#i)}#x(d,u){u.preventDefault();const{isMac:f}=i.FeatureTest.platform;if(u.button!==0||u.ctrlKey&&f)return;const m=this.#A.bind(this,d),v=this._isDraggable;this._isDraggable=!1;const g={passive:!0,capture:!0};window.addEventListener("pointermove",m,g);const x=this.x,E=this.y,b=this.width,_=this.height,S=this.parent.div.style.cursor,C=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(u.target).cursor;const A=()=>{this._isDraggable=v,window.removeEventListener("pointerup",A),window.removeEventListener("blur",A),window.removeEventListener("pointermove",m,g),this.parent.div.style.cursor=S,this.div.style.cursor=C;const R=this.x,L=this.y,j=this.width,F=this.height;R===x&&L===E&&j===b&&F===_||this.addCommands({cmd:()=>{this.width=j,this.height=F,this.x=R,this.y=L;const[W,K]=this.parentDimensions;this.setDims(W*j,K*F),this.fixAndSetPosition()},undo:()=>{this.width=b,this.height=_,this.x=x,this.y=E;const[W,K]=this.parentDimensions;this.setDims(W*b,K*_),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",A),window.addEventListener("blur",A)}#A(d,u){const[f,m]=this.parentDimensions,v=this.x,g=this.y,x=this.width,E=this.height,b=a.MIN_SIZE/f,_=a.MIN_SIZE/m,S=V=>Math.round(V*1e4)/1e4,C=this.#v(this.rotation),A=(V,P)=>[C[0]*V+C[2]*P,C[1]*V+C[3]*P],R=this.#v(360-this.rotation),L=(V,P)=>[R[0]*V+R[2]*P,R[1]*V+R[3]*P];let j,F,W=!1,K=!1;switch(d){case"topLeft":W=!0,j=(V,P)=>[0,0],F=(V,P)=>[V,P];break;case"topMiddle":j=(V,P)=>[V/2,0],F=(V,P)=>[V/2,P];break;case"topRight":W=!0,j=(V,P)=>[V,0],F=(V,P)=>[0,P];break;case"middleRight":K=!0,j=(V,P)=>[V,P/2],F=(V,P)=>[0,P/2];break;case"bottomRight":W=!0,j=(V,P)=>[V,P],F=(V,P)=>[0,0];break;case"bottomMiddle":j=(V,P)=>[V/2,P],F=(V,P)=>[V/2,0];break;case"bottomLeft":W=!0,j=(V,P)=>[0,P],F=(V,P)=>[V,0];break;case"middleLeft":K=!0,j=(V,P)=>[0,P/2],F=(V,P)=>[V,P/2];break}const ee=j(x,E),te=F(x,E);let re=A(...te);const ie=S(v+re[0]),Q=S(g+re[1]);let z=1,N=1,[k,I]=this.screenToPageTranslation(u.movementX,u.movementY);if([k,I]=L(k/f,I/m),W){const V=Math.hypot(x,E);z=N=Math.max(Math.min(Math.hypot(te[0]-ee[0]-k,te[1]-ee[1]-I)/V,1/x,1/E),b/x,_/E)}else K?z=Math.max(b,Math.min(1,Math.abs(te[0]-ee[0]-k)))/x:N=Math.max(_,Math.min(1,Math.abs(te[1]-ee[1]-I)))/E;const D=S(x*z),U=S(E*N);re=A(...F(D,U));const $=ie-re[0],q=Q-re[1];this.width=D,this.height=U,this.x=$,this.y=q,this.setDims(f*D,m*U),this.fixAndSetPosition()}async addAltTextButton(){if(this.#n)return;const d=this.#n=document.createElement("button");d.className="altText";const u=await a._l10nPromise.get("editor_alt_text_button_label");d.textContent=u,d.setAttribute("aria-label",u),d.tabIndex="0",d.addEventListener("contextmenu",o.noContextMenu),d.addEventListener("pointerdown",f=>f.stopPropagation()),d.addEventListener("click",f=>{f.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),d.addEventListener("keydown",f=>{f.target===d&&f.key==="Enter"&&(f.preventDefault(),this._uiManager.editAltText(this))}),this.#w(),this.div.append(d),a.SMALL_EDITOR_SIZE||(a.SMALL_EDITOR_SIZE=Math.min(128,Math.round(d.getBoundingClientRect().width*1.4)))}async#w(){const d=this.#n;if(!d)return;if(!this.#e&&!this.#t){d.classList.remove("done"),this.#r?.remove();return}a._l10nPromise.get("editor_alt_text_edit_button_label").then(f=>{d.setAttribute("aria-label",f)});let u=this.#r;if(!u){this.#r=u=document.createElement("span"),u.className="tooltip",u.setAttribute("role","tooltip");const f=u.id=`alt-text-tooltip-${this.id}`;d.setAttribute("aria-describedby",f);const m=100;d.addEventListener("mouseenter",()=>{this.#s=setTimeout(()=>{this.#s=null,this.#r.classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},m)}),d.addEventListener("mouseleave",()=>{clearTimeout(this.#s),this.#s=null,this.#r?.classList.remove("show")})}d.classList.add("done"),u.innerText=this.#t?await a._l10nPromise.get("editor_alt_text_decorative_tooltip"):this.#e,u.parentNode||d.append(u)}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:this.#e,decorative:this.#t}}set altTextData({altText:d,decorative:u}){this.#e===d&&this.#t===u||(this.#e=d,this.#t=u,this.#w())}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#a),this.div.addEventListener("focusout",this.#c);const[d,u]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*u/d).toFixed(2)}%`,this.div.style.maxHeight=`${(100*d/u).toFixed(2)}%`);const[f,m]=this.getInitialTranslation();return this.translate(f,m),(0,n.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(d){const{isMac:u}=i.FeatureTest.platform;if(d.button!==0||d.ctrlKey&&u){d.preventDefault();return}this.#l=!0,this.#b(d)}#b(d){if(!this._isDraggable)return;const u=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let f,m;u&&(f={passive:!0,capture:!0},m=g=>{const[x,E]=this.screenToPageTranslation(g.movementX,g.movementY);this._uiManager.dragSelectedEditors(x,E)},window.addEventListener("pointermove",m,f));const v=()=>{if(window.removeEventListener("pointerup",v),window.removeEventListener("blur",v),u&&window.removeEventListener("pointermove",m,f),this.#l=!1,!this._uiManager.endDragSession()){const{isMac:g}=i.FeatureTest.platform;d.ctrlKey&&!g||d.shiftKey||d.metaKey&&g?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",v),window.addEventListener("blur",v)}moveInDOM(){this.parent?.moveEditorInDOM(this)}_setParentAndPosition(d,u,f){d.changeParent(this),this.x=u,this.y=f,this.fixAndSetPosition()}getRect(d,u){const f=this.parentScale,[m,v]=this.pageDimensions,[g,x]=this.pageTranslation,E=d/f,b=u/f,_=this.x*m,S=this.y*v,C=this.width*m,A=this.height*v;switch(this.rotation){case 0:return[_+E+g,v-S-b-A+x,_+E+C+g,v-S-b+x];case 90:return[_+b+g,v-S+E+x,_+b+A+g,v-S+E+C+x];case 180:return[_-E-C+g,v-S+b+x,_-E+g,v-S+b+A+x];case 270:return[_-b-A+g,v-S-E-C+x,_-b+g,v-S-E+x];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(d,u){const[f,m,v,g]=d,x=v-f,E=g-m;switch(this.rotation){case 0:return[f,u-g,x,E];case 90:return[f,u-m,E,x];case 180:return[v,u-m,x,E];case 270:return[v,u-g,E,x];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#d=!0}disableEditMode(){this.#d=!1}isInEditMode(){return this.#d}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#a),this.div?.addEventListener("focusout",this.#c)}serialize(d=!1,u=null){(0,i.unreachable)("An editor must be serializable")}static deserialize(d,u,f){const m=new this.prototype.constructor({parent:u,id:u.getNextId(),uiManager:f});m.rotation=d.rotation;const[v,g]=m.pageDimensions,[x,E,b,_]=m.getRectInCurrentCoords(d.rect,g);return m.x=x/v,m.y=E/g,m.width=b/v,m.height=_/g,m}remove(){this.div.removeEventListener("focusin",this.#a),this.div.removeEventListener("focusout",this.#c),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#n?.remove(),this.#n=null,this.#r=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#y(),this.#i.classList.remove("hidden"))}select(){this.makeResizable(),this.div?.classList.add("selectedEditor")}unselect(){this.#i?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(d,u){}disableEditing(){this.#n&&(this.#n.hidden=!0)}enableEditing(){this.#n&&(this.#n.hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return this.#h}set isEditing(d){this.#h=d,this.parent&&(d?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(d,u){this.#o=!0;const f=d/u,{style:m}=this.div;m.aspectRatio=f,m.height="auto"}static get MIN_SIZE(){return 16}}e.AnnotationEditor=a;class l extends a{constructor(d){super(d),this.annotationElementId=d.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.KeyboardManager=e.CommandManager=e.ColorManager=e.AnnotationEditorUIManager=void 0,e.bindEvents=o,e.opacityToHex=a;var n=t(1),i=t(6);function o(v,g,x){for(const E of x)g.addEventListener(E,v[E].bind(v))}function a(v){return Math.round(Math.min(255,Math.max(1,255*v))).toString(16).padStart(2,"0")}class l{#e=0;getId(){return`${n.AnnotationEditorPrefix}${this.#e++}`}}class h{#e=(0,n.getUuid)();#t=0;#n=null;static get _isSVGFittingCanvas(){const g='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',E=new OffscreenCanvas(1,3).getContext("2d"),b=new Image;b.src=g;const _=b.decode().then(()=>(E.drawImage(b,0,0,1,1,0,0,1,3),new Uint32Array(E.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,n.shadow)(this,"_isSVGFittingCanvas",_)}async#r(g,x){this.#n||=new Map;let E=this.#n.get(g);if(E===null)return null;if(E?.bitmap)return E.refCounter+=1,E;try{E||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let b;if(typeof x=="string"){E.url=x;const _=await fetch(x);if(!_.ok)throw new Error(_.statusText);b=await _.blob()}else b=E.file=x;if(b.type==="image/svg+xml"){const _=h._isSVGFittingCanvas,S=new FileReader,C=new Image,A=new Promise((R,L)=>{C.onload=()=>{E.bitmap=C,E.isSvg=!0,R()},S.onload=async()=>{const j=E.svgUrl=S.result;C.src=await _?`${j}#svgView(preserveAspectRatio(none))`:j},C.onerror=S.onerror=L});S.readAsDataURL(b),await A}else E.bitmap=await createImageBitmap(b);E.refCounter=1}catch(b){console.error(b),E=null}return this.#n.set(g,E),E&&this.#n.set(E.id,E),E}async getFromFile(g){const{lastModified:x,name:E,size:b,type:_}=g;return this.#r(`${x}_${E}_${b}_${_}`,g)}async getFromUrl(g){return this.#r(g,g)}async getFromId(g){this.#n||=new Map;const x=this.#n.get(g);return x?x.bitmap?(x.refCounter+=1,x):x.file?this.getFromFile(x.file):this.getFromUrl(x.url):null}getSvgUrl(g){const x=this.#n.get(g);return x?.isSvg?x.svgUrl:null}deleteId(g){this.#n||=new Map;const x=this.#n.get(g);x&&(x.refCounter-=1,x.refCounter===0&&(x.bitmap=null))}isValidId(g){return g.startsWith(`image_${this.#e}_`)}}class d{#e=[];#t=!1;#n;#r=-1;constructor(g=128){this.#n=g}add({cmd:g,undo:x,mustExec:E,type:b=NaN,overwriteIfSameType:_=!1,keepUndo:S=!1}){if(E&&g(),this.#t)return;const C={cmd:g,undo:x,type:b};if(this.#r===-1){this.#e.length>0&&(this.#e.length=0),this.#r=0,this.#e.push(C);return}if(_&&this.#e[this.#r].type===b){S&&(C.undo=this.#e[this.#r].undo),this.#e[this.#r]=C;return}const A=this.#r+1;A===this.#n?this.#e.splice(0,1):(this.#r=A,A<this.#e.length&&this.#e.splice(A)),this.#e.push(C)}undo(){this.#r!==-1&&(this.#t=!0,this.#e[this.#r].undo(),this.#t=!1,this.#r-=1)}redo(){this.#r<this.#e.length-1&&(this.#r+=1,this.#t=!0,this.#e[this.#r].cmd(),this.#t=!1)}hasSomethingToUndo(){return this.#r!==-1}hasSomethingToRedo(){return this.#r<this.#e.length-1}destroy(){this.#e=null}}e.CommandManager=d;class u{constructor(g){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:x}=n.FeatureTest.platform;for(const[E,b,_={}]of g)for(const S of E){const C=S.startsWith("mac+");x&&C?(this.callbacks.set(S.slice(4),{callback:b,options:_}),this.allKeys.add(S.split("+").at(-1))):!x&&!C&&(this.callbacks.set(S,{callback:b,options:_}),this.allKeys.add(S.split("+").at(-1)))}}#e(g){g.altKey&&this.buffer.push("alt"),g.ctrlKey&&this.buffer.push("ctrl"),g.metaKey&&this.buffer.push("meta"),g.shiftKey&&this.buffer.push("shift"),this.buffer.push(g.key);const x=this.buffer.join("+");return this.buffer.length=0,x}exec(g,x){if(!this.allKeys.has(x.key))return;const E=this.callbacks.get(this.#e(x));if(!E)return;const{callback:b,options:{bubbles:_=!1,args:S=[],checker:C=null}}=E;C&&!C(g,x)||(b.bind(g,...S)(),_||(x.stopPropagation(),x.preventDefault()))}}e.KeyboardManager=u;class f{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const g=new Map([["CanvasText",null],["Canvas",null]]);return(0,i.getColorValues)(g),(0,n.shadow)(this,"_colors",g)}convert(g){const x=(0,i.getRGB)(g);if(!window.matchMedia("(forced-colors: active)").matches)return x;for(const[E,b]of this._colors)if(b.every((_,S)=>_===x[S]))return f._colorsMapping.get(E);return x}getHexCode(g){const x=this._colors.get(g);return x?n.Util.makeHexColor(...x):g}}e.ColorManager=f;class m{#e=null;#t=new Map;#n=new Map;#r=null;#s=null;#o=new d;#i=0;#a=new Set;#c=null;#l=null;#h=new Set;#d=null;#f=new l;#g=!1;#m=!1;#u=null;#p=n.AnnotationEditorType.NONE;#v=new Set;#y=null;#x=this.blur.bind(this);#A=this.focus.bind(this);#w=this.copy.bind(this);#b=this.cut.bind(this);#P=this.paste.bind(this);#_=this.keydown.bind(this);#S=this.onEditingAction.bind(this);#T=this.onPageChanging.bind(this);#k=this.onScaleChanging.bind(this);#M=this.onRotationChanging.bind(this);#N={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#R=[0,0];#D=null;#I=null;#L=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const g=m.prototype,x=_=>{const{activeElement:S}=document;return S&&_.#I.contains(S)&&_.hasSomethingToControl()},E=this.TRANSLATE_SMALL,b=this.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new u([[["ctrl+a","mac+meta+a"],g.selectAll],[["ctrl+z","mac+meta+z"],g.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],g.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],g.delete],[["Escape","mac+Escape"],g.unselectAll],[["ArrowLeft","mac+ArrowLeft"],g.translateSelectedEditors,{args:[-E,0],checker:x}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],g.translateSelectedEditors,{args:[-b,0],checker:x}],[["ArrowRight","mac+ArrowRight"],g.translateSelectedEditors,{args:[E,0],checker:x}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],g.translateSelectedEditors,{args:[b,0],checker:x}],[["ArrowUp","mac+ArrowUp"],g.translateSelectedEditors,{args:[0,-E],checker:x}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],g.translateSelectedEditors,{args:[0,-b],checker:x}],[["ArrowDown","mac+ArrowDown"],g.translateSelectedEditors,{args:[0,E],checker:x}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],g.translateSelectedEditors,{args:[0,b],checker:x}]]))}constructor(g,x,E,b,_,S){this.#I=g,this.#L=x,this.#r=E,this._eventBus=b,this._eventBus._on("editingaction",this.#S),this._eventBus._on("pagechanging",this.#T),this._eventBus._on("scalechanging",this.#k),this._eventBus._on("rotationchanging",this.#M),this.#s=_.annotationStorage,this.#d=_.filterFactory,this.#y=S,this.viewParameters={realScale:i.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){this.#O(),this.#C(),this._eventBus._off("editingaction",this.#S),this._eventBus._off("pagechanging",this.#T),this._eventBus._off("scalechanging",this.#k),this._eventBus._off("rotationchanging",this.#M);for(const g of this.#n.values())g.destroy();this.#n.clear(),this.#t.clear(),this.#h.clear(),this.#e=null,this.#v.clear(),this.#o.destroy(),this.#r.destroy()}get hcmFilter(){return(0,n.shadow)(this,"hcmFilter",this.#y?this.#d.addHCMFilter(this.#y.foreground,this.#y.background):"none")}get direction(){return(0,n.shadow)(this,"direction",getComputedStyle(this.#I).direction)}editAltText(g){this.#r?.editAltText(this,g)}onPageChanging({pageNumber:g}){this.#i=g-1}focusMainContainer(){this.#I.focus()}findParent(g,x){for(const E of this.#n.values()){const{x:b,y:_,width:S,height:C}=E.div.getBoundingClientRect();if(g>=b&&g<=b+S&&x>=_&&x<=_+C)return E}return null}disableUserSelect(g=!1){this.#L.classList.toggle("noUserSelect",g)}addShouldRescale(g){this.#h.add(g)}removeShouldRescale(g){this.#h.delete(g)}onScaleChanging({scale:g}){this.commitOrRemove(),this.viewParameters.realScale=g*i.PixelsPerInch.PDF_TO_CSS_UNITS;for(const x of this.#h)x.onScaleChanging()}onRotationChanging({pagesRotation:g}){this.commitOrRemove(),this.viewParameters.rotation=g}addToAnnotationStorage(g){!g.isEmpty()&&this.#s&&!this.#s.has(g.id)&&this.#s.setValue(g.id,g)}#z(){window.addEventListener("focus",this.#A),window.addEventListener("blur",this.#x)}#C(){window.removeEventListener("focus",this.#A),window.removeEventListener("blur",this.#x)}blur(){if(!this.hasSelection)return;const{activeElement:g}=document;for(const x of this.#v)if(x.div.contains(g)){this.#u=[x,g],x._focusEventsAllowed=!1;break}}focus(){if(!this.#u)return;const[g,x]=this.#u;this.#u=null,x.addEventListener("focusin",()=>{g._focusEventsAllowed=!0},{once:!0}),x.focus()}#E(){window.addEventListener("keydown",this.#_,{capture:!0})}#O(){window.removeEventListener("keydown",this.#_,{capture:!0})}#F(){document.addEventListener("copy",this.#w),document.addEventListener("cut",this.#b),document.addEventListener("paste",this.#P)}#j(){document.removeEventListener("copy",this.#w),document.removeEventListener("cut",this.#b),document.removeEventListener("paste",this.#P)}addEditListeners(){this.#E(),this.#F()}removeEditListeners(){this.#O(),this.#j()}copy(g){if(g.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const x=[];for(const E of this.#v){const b=E.serialize(!0);b&&x.push(b)}x.length!==0&&g.clipboardData.setData("application/pdfjs",JSON.stringify(x))}cut(g){this.copy(g),this.delete()}paste(g){g.preventDefault();const{clipboardData:x}=g;for(const _ of x.items)for(const S of this.#l)if(S.isHandlingMimeForPasting(_.type)){S.paste(_,this.currentLayer);return}let E=x.getData("application/pdfjs");if(!E)return;try{E=JSON.parse(E)}catch(_){(0,n.warn)(`paste: "${_.message}".`);return}if(!Array.isArray(E))return;this.unselectAll();const b=this.currentLayer;try{const _=[];for(const A of E){const R=b.deserialize(A);if(!R)return;_.push(R)}const S=()=>{for(const A of _)this.#$(A);this.#X(_)},C=()=>{for(const A of _)A.remove()};this.addCommands({cmd:S,undo:C,mustExec:!0})}catch(_){(0,n.warn)(`paste: "${_.message}".`)}}keydown(g){this.getActive()?.shouldGetKeyboardEvents()||m._keyboardManager.exec(this,g)}onEditingAction(g){["undo","redo","delete","selectAll"].includes(g.name)&&this[g.name]()}#B(g){Object.entries(g).some(([E,b])=>this.#N[E]!==b)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#N,g)})}#H(g){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:g})}setEditingState(g){g?(this.#z(),this.#E(),this.#F(),this.#B({isEditing:this.#p!==n.AnnotationEditorType.NONE,isEmpty:this.#V(),hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:this.#o.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#C(),this.#O(),this.#j(),this.#B({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(g){if(!this.#l){this.#l=g;for(const x of this.#l)this.#H(x.defaultPropertiesToUpdate)}}getId(){return this.#f.getId()}get currentLayer(){return this.#n.get(this.#i)}getLayer(g){return this.#n.get(g)}get currentPageIndex(){return this.#i}addLayer(g){this.#n.set(g.pageIndex,g),this.#g?g.enable():g.disable()}removeLayer(g){this.#n.delete(g.pageIndex)}updateMode(g,x=null){if(this.#p!==g){if(this.#p=g,g===n.AnnotationEditorType.NONE){this.setEditingState(!1),this.#W();return}this.setEditingState(!0),this.#K(),this.unselectAll();for(const E of this.#n.values())E.updateMode(g);if(x){for(const E of this.#t.values())if(E.annotationElementId===x){this.setSelected(E),E.enterInEditMode();break}}}}updateToolbar(g){g!==this.#p&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:g})}updateParams(g,x){if(this.#l){if(g===n.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(g);return}for(const E of this.#v)E.updateParams(g,x);for(const E of this.#l)E.updateDefaultParams(g,x)}}enableWaiting(g=!1){if(this.#m!==g){this.#m=g;for(const x of this.#n.values())g?x.disableClick():x.enableClick(),x.div.classList.toggle("waiting",g)}}#K(){if(!this.#g){this.#g=!0;for(const g of this.#n.values())g.enable()}}#W(){if(this.unselectAll(),this.#g){this.#g=!1;for(const g of this.#n.values())g.disable()}}getEditors(g){const x=[];for(const E of this.#t.values())E.pageIndex===g&&x.push(E);return x}getEditor(g){return this.#t.get(g)}addEditor(g){this.#t.set(g.id,g)}removeEditor(g){this.#t.delete(g.id),this.unselect(g),(!g.annotationElementId||!this.#a.has(g.annotationElementId))&&this.#s?.remove(g.id)}addDeletedAnnotationElement(g){this.#a.add(g.annotationElementId),g.deleted=!0}isDeletedAnnotationElement(g){return this.#a.has(g)}removeDeletedAnnotationElement(g){this.#a.delete(g.annotationElementId),g.deleted=!1}#$(g){const x=this.#n.get(g.pageIndex);x?x.addOrRebuild(g):this.addEditor(g)}setActiveEditor(g){this.#e!==g&&(this.#e=g,g&&this.#H(g.propertiesToUpdate))}toggleSelected(g){if(this.#v.has(g)){this.#v.delete(g),g.unselect(),this.#B({hasSelectedEditor:this.hasSelection});return}this.#v.add(g),g.select(),this.#H(g.propertiesToUpdate),this.#B({hasSelectedEditor:!0})}setSelected(g){for(const x of this.#v)x!==g&&x.unselect();this.#v.clear(),this.#v.add(g),g.select(),this.#H(g.propertiesToUpdate),this.#B({hasSelectedEditor:!0})}isSelected(g){return this.#v.has(g)}unselect(g){g.unselect(),this.#v.delete(g),this.#B({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#v.size!==0}undo(){this.#o.undo(),this.#B({hasSomethingToUndo:this.#o.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#V()})}redo(){this.#o.redo(),this.#B({hasSomethingToUndo:!0,hasSomethingToRedo:this.#o.hasSomethingToRedo(),isEmpty:this.#V()})}addCommands(g){this.#o.add(g),this.#B({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#V()})}#V(){if(this.#t.size===0)return!0;if(this.#t.size===1)for(const g of this.#t.values())return g.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const g=[...this.#v],x=()=>{for(const b of g)b.remove()},E=()=>{for(const b of g)this.#$(b)};this.addCommands({cmd:x,undo:E,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#X(g){this.#v.clear();for(const x of g)x.isEmpty()||(this.#v.add(x),x.select());this.#B({hasSelectedEditor:!0})}selectAll(){for(const g of this.#v)g.commit();this.#X(this.#t.values())}unselectAll(){if(this.#e){this.#e.commitOrRemove();return}if(this.hasSelection){for(const g of this.#v)g.unselect();this.#v.clear(),this.#B({hasSelectedEditor:!1})}}translateSelectedEditors(g,x,E=!1){if(E||this.commitOrRemove(),!this.hasSelection)return;this.#R[0]+=g,this.#R[1]+=x;const[b,_]=this.#R,S=[...this.#v],C=1e3;this.#D&&clearTimeout(this.#D),this.#D=setTimeout(()=>{this.#D=null,this.#R[0]=this.#R[1]=0,this.addCommands({cmd:()=>{for(const A of S)this.#t.has(A.id)&&A.translateInPage(b,_)},undo:()=>{for(const A of S)this.#t.has(A.id)&&A.translateInPage(-b,-_)},mustExec:!1})},C);for(const A of S)A.translateInPage(g,x)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#c=new Map;for(const g of this.#v)this.#c.set(g,{savedX:g.x,savedY:g.y,savedPageIndex:g.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#c)return!1;this.disableUserSelect(!1);const g=this.#c;this.#c=null;let x=!1;for(const[{x:b,y:_,pageIndex:S},C]of g)C.newX=b,C.newY=_,C.newPageIndex=S,x||=b!==C.savedX||_!==C.savedY||S!==C.savedPageIndex;if(!x)return!1;const E=(b,_,S,C)=>{if(this.#t.has(b.id)){const A=this.#n.get(C);A?b._setParentAndPosition(A,_,S):(b.pageIndex=C,b.x=_,b.y=S)}};return this.addCommands({cmd:()=>{for(const[b,{newX:_,newY:S,newPageIndex:C}]of g)E(b,_,S,C)},undo:()=>{for(const[b,{savedX:_,savedY:S,savedPageIndex:C}]of g)E(b,_,S,C)},mustExec:!0}),!0}dragSelectedEditors(g,x){if(this.#c)for(const E of this.#c.keys())E.drag(g,x)}rebuild(g){if(g.parent===null){const x=this.getLayer(g.pageIndex);x?(x.changeParent(g),x.addOrRebuild(g)):(this.addEditor(g),this.addToAnnotationStorage(g),g.rebuild())}else g.parent.addOrRebuild(g)}isActive(g){return this.#e===g}getActive(){return this.#e}getMode(){return this.#p}get imageManager(){return(0,n.shadow)(this,"imageManager",new h)}}e.AnnotationEditorUIManager=m}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.StatTimer=e.RenderingCancelledException=e.PixelsPerInch=e.PageViewport=e.PDFDateString=e.DOMStandardFontDataFactory=e.DOMSVGFactory=e.DOMFilterFactory=e.DOMCanvasFactory=e.DOMCMapReaderFactory=void 0,e.deprecated=L,e.getColorValues=ee,e.getCurrentTransform=te,e.getCurrentTransformInverse=re,e.getFilenameFromUrl=b,e.getPdfFilenameFromUrl=_,e.getRGB=K,e.getXfaPageViewport=W,e.isDataScheme=x,e.isPdfFile=E,e.isValidFetchUrl=C,e.loadScript=R,e.noContextMenu=A,e.setLayerDimensions=ie;var n=t(7),i=t(1);const o="http://www.w3.org/2000/svg";class a{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}e.PixelsPerInch=a;class l extends n.BaseFilterFactory{#e;#t;#n;#r;#s;#o;#i;#a;#c;#l;#h=0;constructor({docId:z,ownerDocument:N=globalThis.document}={}){super(),this.#n=z,this.#r=N}get#d(){return this.#e||=new Map}get#f(){if(!this.#t){const z=this.#r.createElement("div"),{style:N}=z;N.visibility="hidden",N.contain="strict",N.width=N.height=0,N.position="absolute",N.top=N.left=0,N.zIndex=-1;const k=this.#r.createElementNS(o,"svg");k.setAttribute("width",0),k.setAttribute("height",0),this.#t=this.#r.createElementNS(o,"defs"),z.append(k),k.append(this.#t),this.#r.body.append(z)}return this.#t}addFilter(z){if(!z)return"none";let N=this.#d.get(z);if(N)return N;let k,I,D,U;if(z.length===1){const P=z[0],O=new Array(256);for(let B=0;B<256;B++)O[B]=P[B]/255;U=k=I=D=O.join(",")}else{const[P,O,B]=z,G=new Array(256),Y=new Array(256),J=new Array(256);for(let Z=0;Z<256;Z++)G[Z]=P[Z]/255,Y[Z]=O[Z]/255,J[Z]=B[Z]/255;k=G.join(","),I=Y.join(","),D=J.join(","),U=`${k}${I}${D}`}if(N=this.#d.get(U),N)return this.#d.set(z,N),N;const $=`g_${this.#n}_transfer_map_${this.#h++}`,q=`url(#${$})`;this.#d.set(z,q),this.#d.set(U,q);const V=this.#m($);return this.#p(k,I,D,V),q}addHCMFilter(z,N){const k=`${z}-${N}`;if(this.#o===k)return this.#i;if(this.#o=k,this.#i="none",this.#s?.remove(),!z||!N)return this.#i;const I=this.#v(z);z=i.Util.makeHexColor(...I);const D=this.#v(N);if(N=i.Util.makeHexColor(...D),this.#f.style.color="",z==="#000000"&&N==="#ffffff"||z===N)return this.#i;const U=new Array(256);for(let O=0;O<=255;O++){const B=O/255;U[O]=B<=.03928?B/12.92:((B+.055)/1.055)**2.4}const $=U.join(","),q=`g_${this.#n}_hcm_filter`,V=this.#a=this.#m(q);this.#p($,$,$,V),this.#g(V);const P=(O,B)=>{const G=I[O]/255,Y=D[O]/255,J=new Array(B+1);for(let Z=0;Z<=B;Z++)J[Z]=G+Z/B*(Y-G);return J.join(",")};return this.#p(P(0,5),P(1,5),P(2,5),V),this.#i=`url(#${q})`,this.#i}addHighlightHCMFilter(z,N,k,I){const D=`${z}-${N}-${k}-${I}`;if(this.#c===D)return this.#l;if(this.#c=D,this.#l="none",this.#a?.remove(),!z||!N)return this.#l;const[U,$]=[z,N].map(this.#v.bind(this));let q=Math.round(.2126*U[0]+.7152*U[1]+.0722*U[2]),V=Math.round(.2126*$[0]+.7152*$[1]+.0722*$[2]),[P,O]=[k,I].map(this.#v.bind(this));V<q&&([q,V,P,O]=[V,q,O,P]),this.#f.style.color="";const B=(J,Z,oe)=>{const ve=new Array(256),ce=(V-q)/oe,ue=J/255,de=(Z-J)/(255*oe);let pe=0;for(let ye=0;ye<=oe;ye++){const Ae=Math.round(q+ye*ce),Ce=ue+ye*de;for(let Pe=pe;Pe<=Ae;Pe++)ve[Pe]=Ce;pe=Ae+1}for(let ye=pe;ye<256;ye++)ve[ye]=ve[pe-1];return ve.join(",")},G=`g_${this.#n}_hcm_highlight_filter`,Y=this.#a=this.#m(G);return this.#g(Y),this.#p(B(P[0],O[0],5),B(P[1],O[1],5),B(P[2],O[2],5),Y),this.#l=`url(#${G})`,this.#l}destroy(z=!1){z&&(this.#i||this.#l)||(this.#t&&(this.#t.parentNode.parentNode.remove(),this.#t=null),this.#e&&(this.#e.clear(),this.#e=null),this.#h=0)}#g(z){const N=this.#r.createElementNS(o,"feColorMatrix");N.setAttribute("type","matrix"),N.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),z.append(N)}#m(z){const N=this.#r.createElementNS(o,"filter");return N.setAttribute("color-interpolation-filters","sRGB"),N.setAttribute("id",z),this.#f.append(N),N}#u(z,N,k){const I=this.#r.createElementNS(o,N);I.setAttribute("type","discrete"),I.setAttribute("tableValues",k),z.append(I)}#p(z,N,k,I){const D=this.#r.createElementNS(o,"feComponentTransfer");I.append(D),this.#u(D,"feFuncR",z),this.#u(D,"feFuncG",N),this.#u(D,"feFuncB",k)}#v(z){return this.#f.style.color=z,K(getComputedStyle(this.#f).getPropertyValue("color"))}}e.DOMFilterFactory=l;class h extends n.BaseCanvasFactory{constructor({ownerDocument:z=globalThis.document}={}){super(),this._document=z}_createCanvas(z,N){const k=this._document.createElement("canvas");return k.width=z,k.height=N,k}}e.DOMCanvasFactory=h;async function d(Q,z=!1){if(C(Q,document.baseURI)){const N=await fetch(Q);if(!N.ok)throw new Error(N.statusText);return z?new Uint8Array(await N.arrayBuffer()):(0,i.stringToBytes)(await N.text())}return new Promise((N,k)=>{const I=new XMLHttpRequest;I.open("GET",Q,!0),z&&(I.responseType="arraybuffer"),I.onreadystatechange=()=>{if(I.readyState===XMLHttpRequest.DONE){if(I.status===200||I.status===0){let D;if(z&&I.response?D=new Uint8Array(I.response):!z&&I.responseText&&(D=(0,i.stringToBytes)(I.responseText)),D){N(D);return}}k(new Error(I.statusText))}},I.send(null)})}class u extends n.BaseCMapReaderFactory{_fetchData(z,N){return d(z,this.isCompressed).then(k=>({cMapData:k,compressionType:N}))}}e.DOMCMapReaderFactory=u;class f extends n.BaseStandardFontDataFactory{_fetchData(z){return d(z,!0)}}e.DOMStandardFontDataFactory=f;class m extends n.BaseSVGFactory{_createSVG(z){return document.createElementNS(o,z)}}e.DOMSVGFactory=m;class v{constructor({viewBox:z,scale:N,rotation:k,offsetX:I=0,offsetY:D=0,dontFlip:U=!1}){this.viewBox=z,this.scale=N,this.rotation=k,this.offsetX=I,this.offsetY=D;const $=(z[2]+z[0])/2,q=(z[3]+z[1])/2;let V,P,O,B;switch(k%=360,k<0&&(k+=360),k){case 180:V=-1,P=0,O=0,B=1;break;case 90:V=0,P=1,O=1,B=0;break;case 270:V=0,P=-1,O=-1,B=0;break;case 0:V=1,P=0,O=0,B=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}U&&(O=-O,B=-B);let G,Y,J,Z;V===0?(G=Math.abs(q-z[1])*N+I,Y=Math.abs($-z[0])*N+D,J=(z[3]-z[1])*N,Z=(z[2]-z[0])*N):(G=Math.abs($-z[0])*N+I,Y=Math.abs(q-z[1])*N+D,J=(z[2]-z[0])*N,Z=(z[3]-z[1])*N),this.transform=[V*N,P*N,O*N,B*N,G-V*N*$-O*N*q,Y-P*N*$-B*N*q],this.width=J,this.height=Z}get rawDims(){const{viewBox:z}=this;return(0,i.shadow)(this,"rawDims",{pageWidth:z[2]-z[0],pageHeight:z[3]-z[1],pageX:z[0],pageY:z[1]})}clone({scale:z=this.scale,rotation:N=this.rotation,offsetX:k=this.offsetX,offsetY:I=this.offsetY,dontFlip:D=!1}={}){return new v({viewBox:this.viewBox.slice(),scale:z,rotation:N,offsetX:k,offsetY:I,dontFlip:D})}convertToViewportPoint(z,N){return i.Util.applyTransform([z,N],this.transform)}convertToViewportRectangle(z){const N=i.Util.applyTransform([z[0],z[1]],this.transform),k=i.Util.applyTransform([z[2],z[3]],this.transform);return[N[0],N[1],k[0],k[1]]}convertToPdfPoint(z,N){return i.Util.applyInverseTransform([z,N],this.transform)}}e.PageViewport=v;class g extends i.BaseException{constructor(z,N=0){super(z,"RenderingCancelledException"),this.extraDelay=N}}e.RenderingCancelledException=g;function x(Q){const z=Q.length;let N=0;for(;N<z&&Q[N].trim()==="";)N++;return Q.substring(N,N+5).toLowerCase()==="data:"}function E(Q){return typeof Q=="string"&&/\.pdf$/i.test(Q)}function b(Q,z=!1){return z||([Q]=Q.split(/[#?]/,1)),Q.substring(Q.lastIndexOf("/")+1)}function _(Q,z="document.pdf"){if(typeof Q!="string")return z;if(x(Q))return(0,i.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),z;const N=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,k=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,I=N.exec(Q);let D=k.exec(I[1])||k.exec(I[2])||k.exec(I[3]);if(D&&(D=D[0],D.includes("%")))try{D=k.exec(decodeURIComponent(D))[0]}catch{}return D||z}class S{started=Object.create(null);times=[];time(z){z in this.started&&(0,i.warn)(`Timer is already running for ${z}`),this.started[z]=Date.now()}timeEnd(z){z in this.started||(0,i.warn)(`Timer has not been started for ${z}`),this.times.push({name:z,start:this.started[z],end:Date.now()}),delete this.started[z]}toString(){const z=[];let N=0;for(const{name:k}of this.times)N=Math.max(k.length,N);for(const{name:k,start:I,end:D}of this.times)z.push(`${k.padEnd(N)} ${D-I}ms
`);return z.join("")}}e.StatTimer=S;function C(Q,z){try{const{protocol:N}=z?new URL(Q,z):new URL(Q);return N==="http:"||N==="https:"}catch{return!1}}function A(Q){Q.preventDefault()}function R(Q,z=!1){return new Promise((N,k)=>{const I=document.createElement("script");I.src=Q,I.onload=function(D){z&&I.remove(),N(D)},I.onerror=function(){k(new Error(`Cannot load script at: ${I.src}`))},(document.head||document.documentElement).append(I)})}function L(Q){console.log("Deprecated API usage: "+Q)}let j;class F{static toDateObject(z){if(!z||typeof z!="string")return null;j||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const N=j.exec(z);if(!N)return null;const k=parseInt(N[1],10);let I=parseInt(N[2],10);I=I>=1&&I<=12?I-1:0;let D=parseInt(N[3],10);D=D>=1&&D<=31?D:1;let U=parseInt(N[4],10);U=U>=0&&U<=23?U:0;let $=parseInt(N[5],10);$=$>=0&&$<=59?$:0;let q=parseInt(N[6],10);q=q>=0&&q<=59?q:0;const V=N[7]||"Z";let P=parseInt(N[8],10);P=P>=0&&P<=23?P:0;let O=parseInt(N[9],10)||0;return O=O>=0&&O<=59?O:0,V==="-"?(U+=P,$+=O):V==="+"&&(U-=P,$-=O),new Date(Date.UTC(k,I,D,U,$,q))}}e.PDFDateString=F;function W(Q,{scale:z=1,rotation:N=0}){const{width:k,height:I}=Q.attributes.style,D=[0,0,parseInt(k),parseInt(I)];return new v({viewBox:D,scale:z,rotation:N})}function K(Q){if(Q.startsWith("#")){const z=parseInt(Q.slice(1),16);return[(z&16711680)>>16,(z&65280)>>8,z&255]}return Q.startsWith("rgb(")?Q.slice(4,-1).split(",").map(z=>parseInt(z)):Q.startsWith("rgba(")?Q.slice(5,-1).split(",").map(z=>parseInt(z)).slice(0,3):((0,i.warn)(`Not a valid color format: "${Q}"`),[0,0,0])}function ee(Q){const z=document.createElement("span");z.style.visibility="hidden",document.body.append(z);for(const N of Q.keys()){z.style.color=N;const k=window.getComputedStyle(z).color;Q.set(N,K(k))}z.remove()}function te(Q){const{a:z,b:N,c:k,d:I,e:D,f:U}=Q.getTransform();return[z,N,k,I,D,U]}function re(Q){const{a:z,b:N,c:k,d:I,e:D,f:U}=Q.getTransform().invertSelf();return[z,N,k,I,D,U]}function ie(Q,z,N=!1,k=!0){if(z instanceof v){const{pageWidth:I,pageHeight:D}=z.rawDims,{style:U}=Q,$=i.FeatureTest.isCSSRoundSupported,q=`var(--scale-factor) * ${I}px`,V=`var(--scale-factor) * ${D}px`,P=$?`round(${q}, 1px)`:`calc(${q})`,O=$?`round(${V}, 1px)`:`calc(${V})`;!N||z.rotation%180===0?(U.width=P,U.height=O):(U.width=O,U.height=P)}k&&Q.setAttribute("data-main-rotation",z.rotation)}}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BaseStandardFontDataFactory=e.BaseSVGFactory=e.BaseFilterFactory=e.BaseCanvasFactory=e.BaseCMapReaderFactory=void 0;var n=t(1);class i{constructor(){this.constructor===i&&(0,n.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(u){return"none"}addHCMFilter(u,f){return"none"}addHighlightHCMFilter(u,f,m,v){return"none"}destroy(u=!1){}}e.BaseFilterFactory=i;class o{constructor(){this.constructor===o&&(0,n.unreachable)("Cannot initialize BaseCanvasFactory.")}create(u,f){if(u<=0||f<=0)throw new Error("Invalid canvas size");const m=this._createCanvas(u,f);return{canvas:m,context:m.getContext("2d")}}reset(u,f,m){if(!u.canvas)throw new Error("Canvas is not specified");if(f<=0||m<=0)throw new Error("Invalid canvas size");u.canvas.width=f,u.canvas.height=m}destroy(u){if(!u.canvas)throw new Error("Canvas is not specified");u.canvas.width=0,u.canvas.height=0,u.canvas=null,u.context=null}_createCanvas(u,f){(0,n.unreachable)("Abstract method `_createCanvas` called.")}}e.BaseCanvasFactory=o;class a{constructor({baseUrl:u=null,isCompressed:f=!0}){this.constructor===a&&(0,n.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=u,this.isCompressed=f}async fetch({name:u}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!u)throw new Error("CMap name must be specified.");const f=this.baseUrl+u+(this.isCompressed?".bcmap":""),m=this.isCompressed?n.CMapCompressionType.BINARY:n.CMapCompressionType.NONE;return this._fetchData(f,m).catch(v=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${f}`)})}_fetchData(u,f){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseCMapReaderFactory=a;class l{constructor({baseUrl:u=null}){this.constructor===l&&(0,n.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=u}async fetch({filename:u}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!u)throw new Error("Font filename must be specified.");const f=`${this.baseUrl}${u}`;return this._fetchData(f).catch(m=>{throw new Error(`Unable to load font data at: ${f}`)})}_fetchData(u){(0,n.unreachable)("Abstract method `_fetchData` called.")}}e.BaseStandardFontDataFactory=l;class h{constructor(){this.constructor===h&&(0,n.unreachable)("Cannot initialize BaseSVGFactory.")}create(u,f,m=!1){if(u<=0||f<=0)throw new Error("Invalid SVG dimensions");const v=this._createSVG("svg:svg");return v.setAttribute("version","1.1"),m||(v.setAttribute("width",`${u}px`),v.setAttribute("height",`${f}px`)),v.setAttribute("preserveAspectRatio","none"),v.setAttribute("viewBox",`0 0 ${u} ${f}`),v}createElement(u){if(typeof u!="string")throw new Error("Invalid SVG element type");return this._createSVG(u)}_createSVG(u){(0,n.unreachable)("Abstract method `_createSVG` called.")}}e.BaseSVGFactory=h}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MurmurHash3_64=void 0;var n=t(1);const i=3285377520,o=4294901760,a=65535;class l{constructor(d){this.h1=d?d&4294967295:i,this.h2=d?d&4294967295:i}update(d){let u,f;if(typeof d=="string"){u=new Uint8Array(d.length*2),f=0;for(let L=0,j=d.length;L<j;L++){const F=d.charCodeAt(L);F<=255?u[f++]=F:(u[f++]=F>>>8,u[f++]=F&255)}}else if((0,n.isArrayBuffer)(d))u=d.slice(),f=u.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const m=f>>2,v=f-m*4,g=new Uint32Array(u.buffer,0,m);let x=0,E=0,b=this.h1,_=this.h2;const S=3432918353,C=461845907,A=S&a,R=C&a;for(let L=0;L<m;L++)L&1?(x=g[L],x=x*S&o|x*A&a,x=x<<15|x>>>17,x=x*C&o|x*R&a,b^=x,b=b<<13|b>>>19,b=b*5+3864292196):(E=g[L],E=E*S&o|E*A&a,E=E<<15|E>>>17,E=E*C&o|E*R&a,_^=E,_=_<<13|_>>>19,_=_*5+3864292196);switch(x=0,v){case 3:x^=u[m*4+2]<<16;case 2:x^=u[m*4+1]<<8;case 1:x^=u[m*4],x=x*S&o|x*A&a,x=x<<15|x>>>17,x=x*C&o|x*R&a,m&1?b^=x:_^=x}this.h1=b,this.h2=_}hexdigest(){let d=this.h1,u=this.h2;return d^=u>>>1,d=d*3981806797&o|d*36045&a,u=u*4283543511&o|((u<<16|d>>>16)*2950163797&o)>>>16,d^=u>>>1,d=d*444984403&o|d*60499&a,u=u*3301882366&o|((u<<16|d>>>16)*3120437893&o)>>>16,d^=u>>>1,(d>>>0).toString(16).padStart(8,"0")+(u>>>0).toString(16).padStart(8,"0")}}e.MurmurHash3_64=l}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FontLoader=e.FontFaceObject=void 0;var n=t(1);class i{#e=new Set;constructor({ownerDocument:l=globalThis.document,styleElement:h=null}){this._document=l,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(l){this.nativeFontFaces.add(l),this._document.fonts.add(l)}removeNativeFontFace(l){this.nativeFontFaces.delete(l),this._document.fonts.delete(l)}insertRule(l){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const h=this.styleElement.sheet;h.insertRule(l,h.cssRules.length)}clear(){for(const l of this.nativeFontFaces)this._document.fonts.delete(l);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(l){if(!(!l||this.#e.has(l.loadedName))){if((0,n.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:h,src:d,style:u}=l,f=new FontFace(h,d,u);this.addNativeFontFace(f);try{await f.load(),this.#e.add(h)}catch{(0,n.warn)(`Cannot load system font: ${l.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(f)}return}(0,n.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(l){if(l.attached||l.missingFile&&!l.systemFontInfo)return;if(l.attached=!0,l.systemFontInfo){await this.loadSystemFont(l.systemFontInfo);return}if(this.isFontLoadingAPISupported){const d=l.createNativeFontFace();if(d){this.addNativeFontFace(d);try{await d.loaded}catch(u){throw(0,n.warn)(`Failed to load font '${d.family}': '${u}'.`),l.disableFontFace=!0,u}}return}const h=l.createFontFaceRule();if(h){if(this.insertRule(h),this.isSyncFontLoadingSupported)return;await new Promise(d=>{const u=this._queueLoadingCallback(d);this._prepareFontLoadEvent(l,u)})}}get isFontLoadingAPISupported(){const l=!!this._document?.fonts;return(0,n.shadow)(this,"isFontLoadingAPISupported",l)}get isSyncFontLoadingSupported(){let l=!1;return(n.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(l=!0),(0,n.shadow)(this,"isSyncFontLoadingSupported",l)}_queueLoadingCallback(l){function h(){for((0,n.assert)(!u.done,"completeRequest() cannot be called twice."),u.done=!0;d.length>0&&d[0].done;){const f=d.shift();setTimeout(f.callback,0)}}const{loadingRequests:d}=this,u={done:!1,complete:h,callback:l};return d.push(u),u}get _loadTestFont(){const l=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,n.shadow)(this,"_loadTestFont",l)}_prepareFontLoadEvent(l,h){function d(W,K){return W.charCodeAt(K)<<24|W.charCodeAt(K+1)<<16|W.charCodeAt(K+2)<<8|W.charCodeAt(K+3)&255}function u(W,K,ee,te){const re=W.substring(0,K),ie=W.substring(K+ee);return re+te+ie}let f,m;const v=this._document.createElement("canvas");v.width=1,v.height=1;const g=v.getContext("2d");let x=0;function E(W,K){if(++x>30){(0,n.warn)("Load test font never loaded."),K();return}if(g.font="30px "+W,g.fillText(".",0,20),g.getImageData(0,0,1,1).data[3]>0){K();return}setTimeout(E.bind(null,W,K))}const b=`lt${Date.now()}${this.loadTestFontId++}`;let _=this._loadTestFont;_=u(_,976,b.length,b);const C=16,A=1482184792;let R=d(_,C);for(f=0,m=b.length-3;f<m;f+=4)R=R-A+d(b,f)|0;f<b.length&&(R=R-A+d(b+"XXX",f)|0),_=u(_,C,4,(0,n.string32)(R));const L=`url(data:font/opentype;base64,${btoa(_)});`,j=`@font-face {font-family:"${b}";src:${L}}`;this.insertRule(j);const F=this._document.createElement("div");F.style.visibility="hidden",F.style.width=F.style.height="10px",F.style.position="absolute",F.style.top=F.style.left="0px";for(const W of[l.loadedName,b]){const K=this._document.createElement("span");K.textContent="Hi",K.style.fontFamily=W,F.append(K)}this._document.body.append(F),E(b,()=>{F.remove(),h.complete()})}}e.FontLoader=i;class o{constructor(l,{isEvalSupported:h=!0,disableFontFace:d=!1,ignoreErrors:u=!1,inspectFont:f=null}){this.compiledGlyphs=Object.create(null);for(const m in l)this[m]=l[m];this.isEvalSupported=h!==!1,this.disableFontFace=d===!0,this.ignoreErrors=u===!0,this._inspectFont=f}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let l;if(!this.cssFontInfo)l=new FontFace(this.loadedName,this.data,{});else{const h={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(h.style=`oblique ${this.cssFontInfo.italicAngle}deg`),l=new FontFace(this.cssFontInfo.fontFamily,this.data,h)}return this._inspectFont?.(this),l}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const l=(0,n.bytesToString)(this.data),h=`url(data:${this.mimetype};base64,${btoa(l)});`;let d;if(!this.cssFontInfo)d=`@font-face {font-family:"${this.loadedName}";src:${h}}`;else{let u=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(u+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),d=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${u}src:${h}}`}return this._inspectFont?.(this,h),d}getPathGenerator(l,h){if(this.compiledGlyphs[h]!==void 0)return this.compiledGlyphs[h];let d;try{d=l.get(this.loadedName+"_path_"+h)}catch(u){if(!this.ignoreErrors)throw u;return(0,n.warn)(`getPathGenerator - ignoring character: "${u}".`),this.compiledGlyphs[h]=function(f,m){}}if(this.isEvalSupported&&n.FeatureTest.isEvalSupported){const u=[];for(const f of d){const m=f.args!==void 0?f.args.join(","):"";u.push("c.",f.cmd,"(",m,`);
`)}return this.compiledGlyphs[h]=new Function("c","size",u.join(""))}return this.compiledGlyphs[h]=function(u,f){for(const m of d)m.cmd==="scale"&&(m.args=[f,-f]),u[m.cmd].apply(u,m.args)}}}e.FontFaceObject=o}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NodeStandardFontDataFactory=e.NodeFilterFactory=e.NodeCanvasFactory=e.NodeCMapReaderFactory=void 0;var n=t(7);t(1);const i=function(d){return new Promise((u,f)=>{require$$5.readFile(d,(v,g)=>{if(v||!g){f(new Error(v));return}u(new Uint8Array(g))})})};class o extends n.BaseFilterFactory{}e.NodeFilterFactory=o;class a extends n.BaseCanvasFactory{_createCanvas(u,f){return require$$5.createCanvas(u,f)}}e.NodeCanvasFactory=a;class l extends n.BaseCMapReaderFactory{_fetchData(u,f){return i(u).then(m=>({cMapData:m,compressionType:f}))}}e.NodeCMapReaderFactory=l;class h extends n.BaseStandardFontDataFactory{_fetchData(u){return i(u)}}e.NodeStandardFontDataFactory=h}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.CanvasGraphics=void 0;var n=t(1),i=t(6),o=t(12),a=t(13);const l=16,h=100,d=4096,u=15,f=10,m=1e3,v=16;function g(N,k){if(N._removeMirroring)throw new Error("Context is already forwarding operations.");N.__originalSave=N.save,N.__originalRestore=N.restore,N.__originalRotate=N.rotate,N.__originalScale=N.scale,N.__originalTranslate=N.translate,N.__originalTransform=N.transform,N.__originalSetTransform=N.setTransform,N.__originalResetTransform=N.resetTransform,N.__originalClip=N.clip,N.__originalMoveTo=N.moveTo,N.__originalLineTo=N.lineTo,N.__originalBezierCurveTo=N.bezierCurveTo,N.__originalRect=N.rect,N.__originalClosePath=N.closePath,N.__originalBeginPath=N.beginPath,N._removeMirroring=()=>{N.save=N.__originalSave,N.restore=N.__originalRestore,N.rotate=N.__originalRotate,N.scale=N.__originalScale,N.translate=N.__originalTranslate,N.transform=N.__originalTransform,N.setTransform=N.__originalSetTransform,N.resetTransform=N.__originalResetTransform,N.clip=N.__originalClip,N.moveTo=N.__originalMoveTo,N.lineTo=N.__originalLineTo,N.bezierCurveTo=N.__originalBezierCurveTo,N.rect=N.__originalRect,N.closePath=N.__originalClosePath,N.beginPath=N.__originalBeginPath,delete N._removeMirroring},N.save=function(){k.save(),this.__originalSave()},N.restore=function(){k.restore(),this.__originalRestore()},N.translate=function(D,U){k.translate(D,U),this.__originalTranslate(D,U)},N.scale=function(D,U){k.scale(D,U),this.__originalScale(D,U)},N.transform=function(D,U,$,q,V,P){k.transform(D,U,$,q,V,P),this.__originalTransform(D,U,$,q,V,P)},N.setTransform=function(D,U,$,q,V,P){k.setTransform(D,U,$,q,V,P),this.__originalSetTransform(D,U,$,q,V,P)},N.resetTransform=function(){k.resetTransform(),this.__originalResetTransform()},N.rotate=function(D){k.rotate(D),this.__originalRotate(D)},N.clip=function(D){k.clip(D),this.__originalClip(D)},N.moveTo=function(I,D){k.moveTo(I,D),this.__originalMoveTo(I,D)},N.lineTo=function(I,D){k.lineTo(I,D),this.__originalLineTo(I,D)},N.bezierCurveTo=function(I,D,U,$,q,V){k.bezierCurveTo(I,D,U,$,q,V),this.__originalBezierCurveTo(I,D,U,$,q,V)},N.rect=function(I,D,U,$){k.rect(I,D,U,$),this.__originalRect(I,D,U,$)},N.closePath=function(){k.closePath(),this.__originalClosePath()},N.beginPath=function(){k.beginPath(),this.__originalBeginPath()}}class x{constructor(k){this.canvasFactory=k,this.cache=Object.create(null)}getCanvas(k,I,D){let U;return this.cache[k]!==void 0?(U=this.cache[k],this.canvasFactory.reset(U,I,D)):(U=this.canvasFactory.create(I,D),this.cache[k]=U),U}delete(k){delete this.cache[k]}clear(){for(const k in this.cache){const I=this.cache[k];this.canvasFactory.destroy(I),delete this.cache[k]}}}function E(N,k,I,D,U,$,q,V,P,O){const[B,G,Y,J,Z,oe]=(0,i.getCurrentTransform)(N);if(G===0&&Y===0){const ue=q*B+Z,de=Math.round(ue),pe=V*J+oe,ye=Math.round(pe),Ae=(q+P)*B+Z,Ce=Math.abs(Math.round(Ae)-de)||1,Pe=(V+O)*J+oe,Oe=Math.abs(Math.round(Pe)-ye)||1;return N.setTransform(Math.sign(B),0,0,Math.sign(J),de,ye),N.drawImage(k,I,D,U,$,0,0,Ce,Oe),N.setTransform(B,G,Y,J,Z,oe),[Ce,Oe]}if(B===0&&J===0){const ue=V*Y+Z,de=Math.round(ue),pe=q*G+oe,ye=Math.round(pe),Ae=(V+O)*Y+Z,Ce=Math.abs(Math.round(Ae)-de)||1,Pe=(q+P)*G+oe,Oe=Math.abs(Math.round(Pe)-ye)||1;return N.setTransform(0,Math.sign(G),Math.sign(Y),0,de,ye),N.drawImage(k,I,D,U,$,0,0,Oe,Ce),N.setTransform(B,G,Y,J,Z,oe),[Oe,Ce]}N.drawImage(k,I,D,U,$,q,V,P,O);const ve=Math.hypot(B,G),ce=Math.hypot(Y,J);return[ve*P,ce*O]}function b(N){const{width:k,height:I}=N;if(k>m||I>m)return null;const D=1e3,U=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),$=k+1;let q=new Uint8Array($*(I+1)),V,P,O;const B=k+7&-8;let G=new Uint8Array(B*I),Y=0;for(const ce of N.data){let ue=128;for(;ue>0;)G[Y++]=ce&ue?0:255,ue>>=1}let J=0;for(Y=0,G[Y]!==0&&(q[0]=1,++J),P=1;P<k;P++)G[Y]!==G[Y+1]&&(q[P]=G[Y]?2:1,++J),Y++;for(G[Y]!==0&&(q[P]=2,++J),V=1;V<I;V++){Y=V*B,O=V*$,G[Y-B]!==G[Y]&&(q[O]=G[Y]?1:8,++J);let ce=(G[Y]?4:0)+(G[Y-B]?8:0);for(P=1;P<k;P++)ce=(ce>>2)+(G[Y+1]?4:0)+(G[Y-B+1]?8:0),U[ce]&&(q[O+P]=U[ce],++J),Y++;if(G[Y-B]!==G[Y]&&(q[O+P]=G[Y]?2:4,++J),J>D)return null}for(Y=B*(I-1),O=V*$,G[Y]!==0&&(q[O]=8,++J),P=1;P<k;P++)G[Y]!==G[Y+1]&&(q[O+P]=G[Y]?4:8,++J),Y++;if(G[Y]!==0&&(q[O+P]=4,++J),J>D)return null;const Z=new Int32Array([0,$,-1,0,-$,0,0,0,1]),oe=new Path2D;for(V=0;J&&V<=I;V++){let ce=V*$;const ue=ce+k;for(;ce<ue&&!q[ce];)ce++;if(ce===ue)continue;oe.moveTo(ce%$,V);const de=ce;let pe=q[ce];do{const ye=Z[pe];do ce+=ye;while(!q[ce]);const Ae=q[ce];Ae!==5&&Ae!==10?(pe=Ae,q[ce]=0):(pe=Ae&51*pe>>4,q[ce]&=pe>>2|pe<<2),oe.lineTo(ce%$,ce/$|0),q[ce]||--J}while(de!==ce);--V}return G=null,q=null,function(ce){ce.save(),ce.scale(1/k,-1/I),ce.translate(0,-I),ce.fill(oe),ce.beginPath(),ce.restore()}}class _{constructor(k,I){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=n.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=n.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=n.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,k,I])}clone(){const k=Object.create(this);return k.clipBox=this.clipBox.slice(),k}setCurrentPoint(k,I){this.x=k,this.y=I}updatePathMinMax(k,I,D){[I,D]=n.Util.applyTransform([I,D],k),this.minX=Math.min(this.minX,I),this.minY=Math.min(this.minY,D),this.maxX=Math.max(this.maxX,I),this.maxY=Math.max(this.maxY,D)}updateRectMinMax(k,I){const D=n.Util.applyTransform(I,k),U=n.Util.applyTransform(I.slice(2),k);this.minX=Math.min(this.minX,D[0],U[0]),this.minY=Math.min(this.minY,D[1],U[1]),this.maxX=Math.max(this.maxX,D[0],U[0]),this.maxY=Math.max(this.maxY,D[1],U[1])}updateScalingPathMinMax(k,I){n.Util.scaleMinMax(k,I),this.minX=Math.min(this.minX,I[0]),this.maxX=Math.max(this.maxX,I[1]),this.minY=Math.min(this.minY,I[2]),this.maxY=Math.max(this.maxY,I[3])}updateCurvePathMinMax(k,I,D,U,$,q,V,P,O,B){const G=n.Util.bezierBoundingBox(I,D,U,$,q,V,P,O);if(B){B[0]=Math.min(B[0],G[0],G[2]),B[1]=Math.max(B[1],G[0],G[2]),B[2]=Math.min(B[2],G[1],G[3]),B[3]=Math.max(B[3],G[1],G[3]);return}this.updateRectMinMax(k,G)}getPathBoundingBox(k=o.PathType.FILL,I=null){const D=[this.minX,this.minY,this.maxX,this.maxY];if(k===o.PathType.STROKE){I||(0,n.unreachable)("Stroke bounding box must include transform.");const U=n.Util.singularValueDecompose2dScale(I),$=U[0]*this.lineWidth/2,q=U[1]*this.lineWidth/2;D[0]-=$,D[1]-=q,D[2]+=$,D[3]+=q}return D}updateClipFromPath(){const k=n.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(k||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(k){this.clipBox=k,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(k=o.PathType.FILL,I=null){return n.Util.intersect(this.clipBox,this.getPathBoundingBox(k,I))}}function S(N,k){if(typeof ImageData<"u"&&k instanceof ImageData){N.putImageData(k,0,0);return}const I=k.height,D=k.width,U=I%v,$=(I-U)/v,q=U===0?$:$+1,V=N.createImageData(D,v);let P=0,O;const B=k.data,G=V.data;let Y,J,Z,oe;if(k.kind===n.ImageKind.GRAYSCALE_1BPP){const ve=B.byteLength,ce=new Uint32Array(G.buffer,0,G.byteLength>>2),ue=ce.length,de=D+7>>3,pe=4294967295,ye=n.FeatureTest.isLittleEndian?4278190080:255;for(Y=0;Y<q;Y++){for(Z=Y<$?v:U,O=0,J=0;J<Z;J++){const Ae=ve-P;let Ce=0;const Pe=Ae>de?D:Ae*8-7,Oe=Pe&-8;let xe=0,Te=0;for(;Ce<Oe;Ce+=8)Te=B[P++],ce[O++]=Te&128?pe:ye,ce[O++]=Te&64?pe:ye,ce[O++]=Te&32?pe:ye,ce[O++]=Te&16?pe:ye,ce[O++]=Te&8?pe:ye,ce[O++]=Te&4?pe:ye,ce[O++]=Te&2?pe:ye,ce[O++]=Te&1?pe:ye;for(;Ce<Pe;Ce++)xe===0&&(Te=B[P++],xe=128),ce[O++]=Te&xe?pe:ye,xe>>=1}for(;O<ue;)ce[O++]=0;N.putImageData(V,0,Y*v)}}else if(k.kind===n.ImageKind.RGBA_32BPP){for(J=0,oe=D*v*4,Y=0;Y<$;Y++)G.set(B.subarray(P,P+oe)),P+=oe,N.putImageData(V,0,J),J+=v;Y<q&&(oe=D*U*4,G.set(B.subarray(P,P+oe)),N.putImageData(V,0,J))}else if(k.kind===n.ImageKind.RGB_24BPP)for(Z=v,oe=D*Z,Y=0;Y<q;Y++){for(Y>=$&&(Z=U,oe=D*Z),O=0,J=oe;J--;)G[O++]=B[P++],G[O++]=B[P++],G[O++]=B[P++],G[O++]=255;N.putImageData(V,0,Y*v)}else throw new Error(`bad image kind: ${k.kind}`)}function C(N,k){if(k.bitmap){N.drawImage(k.bitmap,0,0);return}const I=k.height,D=k.width,U=I%v,$=(I-U)/v,q=U===0?$:$+1,V=N.createImageData(D,v);let P=0;const O=k.data,B=V.data;for(let G=0;G<q;G++){const Y=G<$?v:U;({srcPos:P}=(0,a.convertBlackAndWhiteToRGBA)({src:O,srcPos:P,dest:B,width:D,height:Y,nonBlackColor:0})),N.putImageData(V,0,G*v)}}function A(N,k){const I=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const D of I)N[D]!==void 0&&(k[D]=N[D]);N.setLineDash!==void 0&&(k.setLineDash(N.getLineDash()),k.lineDashOffset=N.lineDashOffset)}function R(N){if(N.strokeStyle=N.fillStyle="#000000",N.fillRule="nonzero",N.globalAlpha=1,N.lineWidth=1,N.lineCap="butt",N.lineJoin="miter",N.miterLimit=10,N.globalCompositeOperation="source-over",N.font="10px sans-serif",N.setLineDash!==void 0&&(N.setLineDash([]),N.lineDashOffset=0),!n.isNodeJS){const{filter:k}=N;k!=="none"&&k!==""&&(N.filter="none")}}function L(N,k,I,D){const U=N.length;for(let $=3;$<U;$+=4){const q=N[$];if(q===0)N[$-3]=k,N[$-2]=I,N[$-1]=D;else if(q<255){const V=255-q;N[$-3]=N[$-3]*q+k*V>>8,N[$-2]=N[$-2]*q+I*V>>8,N[$-1]=N[$-1]*q+D*V>>8}}}function j(N,k,I){const D=N.length,U=1/255;for(let $=3;$<D;$+=4){const q=I?I[N[$]]:N[$];k[$]=k[$]*q*U|0}}function F(N,k,I){const D=N.length;for(let U=3;U<D;U+=4){const $=N[U-3]*77+N[U-2]*152+N[U-1]*28;k[U]=I?k[U]*I[$>>8]>>8:k[U]*$>>16}}function W(N,k,I,D,U,$,q,V,P,O,B){const G=!!$,Y=G?$[0]:0,J=G?$[1]:0,Z=G?$[2]:0,oe=U==="Luminosity"?F:j,ce=Math.min(D,Math.ceil(1048576/I));for(let ue=0;ue<D;ue+=ce){const de=Math.min(ce,D-ue),pe=N.getImageData(V-O,ue+(P-B),I,de),ye=k.getImageData(V,ue+P,I,de);G&&L(pe.data,Y,J,Z),oe(pe.data,ye.data,q),k.putImageData(ye,V,ue+P)}}function K(N,k,I,D){const U=D[0],$=D[1],q=D[2]-U,V=D[3]-$;q===0||V===0||(W(k.context,I,q,V,k.subtype,k.backdrop,k.transferMap,U,$,k.offsetX,k.offsetY),N.save(),N.globalAlpha=1,N.globalCompositeOperation="source-over",N.setTransform(1,0,0,1,0,0),N.drawImage(I.canvas,0,0),N.restore())}function ee(N,k){const I=n.Util.singularValueDecompose2dScale(N);I[0]=Math.fround(I[0]),I[1]=Math.fround(I[1]);const D=Math.fround((globalThis.devicePixelRatio||1)*i.PixelsPerInch.PDF_TO_CSS_UNITS);return k!==void 0?k:I[0]<=D||I[1]<=D}const te=["butt","round","square"],re=["miter","round","bevel"],ie={},Q={};class z{constructor(k,I,D,U,$,{optionalContentConfig:q,markedContentStack:V=null},P,O){this.ctx=k,this.current=new _(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=I,this.objs=D,this.canvasFactory=U,this.filterFactory=$,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=V||[],this.optionalContentConfig=q,this.cachedCanvases=new x(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=P,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=O,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(k,I=null){return typeof k=="string"?k.startsWith("g_")?this.commonObjs.get(k):this.objs.get(k):I}beginDrawing({transform:k,viewport:I,transparency:D=!1,background:U=null}){const $=this.ctx.canvas.width,q=this.ctx.canvas.height,V=this.ctx.fillStyle;if(this.ctx.fillStyle=U||"#ffffff",this.ctx.fillRect(0,0,$,q),this.ctx.fillStyle=V,D){const P=this.cachedCanvases.getCanvas("transparent",$,q);this.compositeCtx=this.ctx,this.transparentCanvas=P.canvas,this.ctx=P.context,this.ctx.save(),this.ctx.transform(...(0,i.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),R(this.ctx),k&&(this.ctx.transform(...k),this.outputScaleX=k[0],this.outputScaleY=k[0]),this.ctx.transform(...I.transform),this.viewportScale=I.scale,this.baseTransform=(0,i.getCurrentTransform)(this.ctx)}executeOperatorList(k,I,D,U){const $=k.argsArray,q=k.fnArray;let V=I||0;const P=$.length;if(P===V)return V;const O=P-V>f&&typeof D=="function",B=O?Date.now()+u:0;let G=0;const Y=this.commonObjs,J=this.objs;let Z;for(;;){if(U!==void 0&&V===U.nextBreakPoint)return U.breakIt(V,D),V;if(Z=q[V],Z!==n.OPS.dependency)this[Z].apply(this,$[V]);else for(const oe of $[V]){const ve=oe.startsWith("g_")?Y:J;if(!ve.has(oe))return ve.get(oe,D),V}if(V++,V===P)return V;if(O&&++G>f){if(Date.now()>B)return D(),V;G=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const k of this._cachedBitmapsMap.values()){for(const I of k.values())typeof HTMLCanvasElement<"u"&&I instanceof HTMLCanvasElement&&(I.width=I.height=0);k.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const k=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(k!=="none"){const I=this.ctx.filter;this.ctx.filter=k,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=I}}}_scaleImage(k,I){const D=k.width,U=k.height;let $=Math.max(Math.hypot(I[0],I[1]),1),q=Math.max(Math.hypot(I[2],I[3]),1),V=D,P=U,O="prescale1",B,G;for(;$>2&&V>1||q>2&&P>1;){let Y=V,J=P;$>2&&V>1&&(Y=V>=16384?Math.floor(V/2)-1||1:Math.ceil(V/2),$/=V/Y),q>2&&P>1&&(J=P>=16384?Math.floor(P/2)-1||1:Math.ceil(P)/2,q/=P/J),B=this.cachedCanvases.getCanvas(O,Y,J),G=B.context,G.clearRect(0,0,Y,J),G.drawImage(k,0,0,V,P,0,0,Y,J),k=B.canvas,V=Y,P=J,O=O==="prescale1"?"prescale2":"prescale1"}return{img:k,paintWidth:V,paintHeight:P}}_createMaskCanvas(k){const I=this.ctx,{width:D,height:U}=k,$=this.current.fillColor,q=this.current.patternFill,V=(0,i.getCurrentTransform)(I);let P,O,B,G;if((k.bitmap||k.data)&&k.count>1){const Ce=k.bitmap||k.data.buffer;O=JSON.stringify(q?V:[V.slice(0,4),$]),P=this._cachedBitmapsMap.get(Ce),P||(P=new Map,this._cachedBitmapsMap.set(Ce,P));const Pe=P.get(O);if(Pe&&!q){const Oe=Math.round(Math.min(V[0],V[2])+V[4]),xe=Math.round(Math.min(V[1],V[3])+V[5]);return{canvas:Pe,offsetX:Oe,offsetY:xe}}B=Pe}B||(G=this.cachedCanvases.getCanvas("maskCanvas",D,U),C(G.context,k));let Y=n.Util.transform(V,[1/D,0,0,-1/U,0,0]);Y=n.Util.transform(Y,[1,0,0,1,0,-U]);const J=n.Util.applyTransform([0,0],Y),Z=n.Util.applyTransform([D,U],Y),oe=n.Util.normalizeRect([J[0],J[1],Z[0],Z[1]]),ve=Math.round(oe[2]-oe[0])||1,ce=Math.round(oe[3]-oe[1])||1,ue=this.cachedCanvases.getCanvas("fillCanvas",ve,ce),de=ue.context,pe=Math.min(J[0],Z[0]),ye=Math.min(J[1],Z[1]);de.translate(-pe,-ye),de.transform(...Y),B||(B=this._scaleImage(G.canvas,(0,i.getCurrentTransformInverse)(de)),B=B.img,P&&q&&P.set(O,B)),de.imageSmoothingEnabled=ee((0,i.getCurrentTransform)(de),k.interpolate),E(de,B,0,0,B.width,B.height,0,0,D,U),de.globalCompositeOperation="source-in";const Ae=n.Util.transform((0,i.getCurrentTransformInverse)(de),[1,0,0,1,-pe,-ye]);return de.fillStyle=q?$.getPattern(I,this,Ae,o.PathType.FILL):$,de.fillRect(0,0,D,U),P&&!q&&(this.cachedCanvases.delete("fillCanvas"),P.set(O,ue.canvas)),{canvas:ue.canvas,offsetX:Math.round(pe),offsetY:Math.round(ye)}}setLineWidth(k){k!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=k,this.ctx.lineWidth=k}setLineCap(k){this.ctx.lineCap=te[k]}setLineJoin(k){this.ctx.lineJoin=re[k]}setMiterLimit(k){this.ctx.miterLimit=k}setDash(k,I){const D=this.ctx;D.setLineDash!==void 0&&(D.setLineDash(k),D.lineDashOffset=I)}setRenderingIntent(k){}setFlatness(k){}setGState(k){for(const[I,D]of k)switch(I){case"LW":this.setLineWidth(D);break;case"LC":this.setLineCap(D);break;case"LJ":this.setLineJoin(D);break;case"ML":this.setMiterLimit(D);break;case"D":this.setDash(D[0],D[1]);break;case"RI":this.setRenderingIntent(D);break;case"FL":this.setFlatness(D);break;case"Font":this.setFont(D[0],D[1]);break;case"CA":this.current.strokeAlpha=D;break;case"ca":this.current.fillAlpha=D,this.ctx.globalAlpha=D;break;case"BM":this.ctx.globalCompositeOperation=D;break;case"SMask":this.current.activeSMask=D?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(D);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const k=this.inSMaskMode;this.current.activeSMask&&!k?this.beginSMaskMode():!this.current.activeSMask&&k&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const k=this.ctx.canvas.width,I=this.ctx.canvas.height,D="smaskGroupAt"+this.groupLevel,U=this.cachedCanvases.getCanvas(D,k,I);this.suspendedCtx=this.ctx,this.ctx=U.context;const $=this.ctx;$.setTransform(...(0,i.getCurrentTransform)(this.suspendedCtx)),A(this.suspendedCtx,$),g($,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),A(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(k){if(!this.current.activeSMask)return;k?(k[0]=Math.floor(k[0]),k[1]=Math.floor(k[1]),k[2]=Math.ceil(k[2]),k[3]=Math.ceil(k[3])):k=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const I=this.current.activeSMask,D=this.suspendedCtx;K(D,I,this.ctx,k),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(A(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const k=this.current;this.stateStack.push(k),this.current=k.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),A(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(k,I,D,U,$,q){this.ctx.transform(k,I,D,U,$,q),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(k,I,D){const U=this.ctx,$=this.current;let q=$.x,V=$.y,P,O;const B=(0,i.getCurrentTransform)(U),G=B[0]===0&&B[3]===0||B[1]===0&&B[2]===0,Y=G?D.slice(0):null;for(let J=0,Z=0,oe=k.length;J<oe;J++)switch(k[J]|0){case n.OPS.rectangle:q=I[Z++],V=I[Z++];const ve=I[Z++],ce=I[Z++],ue=q+ve,de=V+ce;U.moveTo(q,V),ve===0||ce===0?U.lineTo(ue,de):(U.lineTo(ue,V),U.lineTo(ue,de),U.lineTo(q,de)),G||$.updateRectMinMax(B,[q,V,ue,de]),U.closePath();break;case n.OPS.moveTo:q=I[Z++],V=I[Z++],U.moveTo(q,V),G||$.updatePathMinMax(B,q,V);break;case n.OPS.lineTo:q=I[Z++],V=I[Z++],U.lineTo(q,V),G||$.updatePathMinMax(B,q,V);break;case n.OPS.curveTo:P=q,O=V,q=I[Z+4],V=I[Z+5],U.bezierCurveTo(I[Z],I[Z+1],I[Z+2],I[Z+3],q,V),$.updateCurvePathMinMax(B,P,O,I[Z],I[Z+1],I[Z+2],I[Z+3],q,V,Y),Z+=6;break;case n.OPS.curveTo2:P=q,O=V,U.bezierCurveTo(q,V,I[Z],I[Z+1],I[Z+2],I[Z+3]),$.updateCurvePathMinMax(B,P,O,q,V,I[Z],I[Z+1],I[Z+2],I[Z+3],Y),q=I[Z+2],V=I[Z+3],Z+=4;break;case n.OPS.curveTo3:P=q,O=V,q=I[Z+2],V=I[Z+3],U.bezierCurveTo(I[Z],I[Z+1],q,V,q,V),$.updateCurvePathMinMax(B,P,O,I[Z],I[Z+1],q,V,q,V,Y),Z+=4;break;case n.OPS.closePath:U.closePath();break}G&&$.updateScalingPathMinMax(B,Y),$.setCurrentPoint(q,V)}closePath(){this.ctx.closePath()}stroke(k=!0){const I=this.ctx,D=this.current.strokeColor;I.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof D=="object"&&D?.getPattern?(I.save(),I.strokeStyle=D.getPattern(I,this,(0,i.getCurrentTransformInverse)(I),o.PathType.STROKE),this.rescaleAndStroke(!1),I.restore()):this.rescaleAndStroke(!0)),k&&this.consumePath(this.current.getClippedPathBoundingBox()),I.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(k=!0){const I=this.ctx,D=this.current.fillColor,U=this.current.patternFill;let $=!1;U&&(I.save(),I.fillStyle=D.getPattern(I,this,(0,i.getCurrentTransformInverse)(I),o.PathType.FILL),$=!0);const q=this.current.getClippedPathBoundingBox();this.contentVisible&&q!==null&&(this.pendingEOFill?(I.fill("evenodd"),this.pendingEOFill=!1):I.fill()),$&&I.restore(),k&&this.consumePath(q)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=ie}eoClip(){this.pendingClip=Q}beginText(){this.current.textMatrix=n.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const k=this.pendingTextPaths,I=this.ctx;if(k===void 0){I.beginPath();return}I.save(),I.beginPath();for(const D of k)I.setTransform(...D.transform),I.translate(D.x,D.y),D.addToPath(I,D.fontSize);I.restore(),I.clip(),I.beginPath(),delete this.pendingTextPaths}setCharSpacing(k){this.current.charSpacing=k}setWordSpacing(k){this.current.wordSpacing=k}setHScale(k){this.current.textHScale=k/100}setLeading(k){this.current.leading=-k}setFont(k,I){const D=this.commonObjs.get(k),U=this.current;if(!D)throw new Error(`Can't find font for ${k}`);if(U.fontMatrix=D.fontMatrix||n.FONT_IDENTITY_MATRIX,(U.fontMatrix[0]===0||U.fontMatrix[3]===0)&&(0,n.warn)("Invalid font matrix for font "+k),I<0?(I=-I,U.fontDirection=-1):U.fontDirection=1,this.current.font=D,this.current.fontSize=I,D.isType3Font)return;const $=D.loadedName||"sans-serif",q=D.systemFontInfo?.css||`"${$}", ${D.fallbackName}`;let V="normal";D.black?V="900":D.bold&&(V="bold");const P=D.italic?"italic":"normal";let O=I;I<l?O=l:I>h&&(O=h),this.current.fontSizeScale=I/O,this.ctx.font=`${P} ${V} ${O}px ${q}`}setTextRenderingMode(k){this.current.textRenderingMode=k}setTextRise(k){this.current.textRise=k}moveText(k,I){this.current.x=this.current.lineX+=k,this.current.y=this.current.lineY+=I}setLeadingMoveText(k,I){this.setLeading(-I),this.moveText(k,I)}setTextMatrix(k,I,D,U,$,q){this.current.textMatrix=[k,I,D,U,$,q],this.current.textMatrixScale=Math.hypot(k,I),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(k,I,D,U){const $=this.ctx,q=this.current,V=q.font,P=q.textRenderingMode,O=q.fontSize/q.fontSizeScale,B=P&n.TextRenderingMode.FILL_STROKE_MASK,G=!!(P&n.TextRenderingMode.ADD_TO_PATH_FLAG),Y=q.patternFill&&!V.missingFile;let J;(V.disableFontFace||G||Y)&&(J=V.getPathGenerator(this.commonObjs,k)),V.disableFontFace||Y?($.save(),$.translate(I,D),$.beginPath(),J($,O),U&&$.setTransform(...U),(B===n.TextRenderingMode.FILL||B===n.TextRenderingMode.FILL_STROKE)&&$.fill(),(B===n.TextRenderingMode.STROKE||B===n.TextRenderingMode.FILL_STROKE)&&$.stroke(),$.restore()):((B===n.TextRenderingMode.FILL||B===n.TextRenderingMode.FILL_STROKE)&&$.fillText(k,I,D),(B===n.TextRenderingMode.STROKE||B===n.TextRenderingMode.FILL_STROKE)&&$.strokeText(k,I,D)),G&&(this.pendingTextPaths||=[]).push({transform:(0,i.getCurrentTransform)($),x:I,y:D,fontSize:O,addToPath:J})}get isFontSubpixelAAEnabled(){const{context:k}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);k.scale(1.5,1),k.fillText("I",0,10);const I=k.getImageData(0,0,10,10).data;let D=!1;for(let U=3;U<I.length;U+=4)if(I[U]>0&&I[U]<255){D=!0;break}return(0,n.shadow)(this,"isFontSubpixelAAEnabled",D)}showText(k){const I=this.current,D=I.font;if(D.isType3Font)return this.showType3Text(k);const U=I.fontSize;if(U===0)return;const $=this.ctx,q=I.fontSizeScale,V=I.charSpacing,P=I.wordSpacing,O=I.fontDirection,B=I.textHScale*O,G=k.length,Y=D.vertical,J=Y?1:-1,Z=D.defaultVMetrics,oe=U*I.fontMatrix[0],ve=I.textRenderingMode===n.TextRenderingMode.FILL&&!D.disableFontFace&&!I.patternFill;$.save(),$.transform(...I.textMatrix),$.translate(I.x,I.y+I.textRise),O>0?$.scale(B,-1):$.scale(B,1);let ce;if(I.patternFill){$.save();const Ae=I.fillColor.getPattern($,this,(0,i.getCurrentTransformInverse)($),o.PathType.FILL);ce=(0,i.getCurrentTransform)($),$.restore(),$.fillStyle=Ae}let ue=I.lineWidth;const de=I.textMatrixScale;if(de===0||ue===0){const Ae=I.textRenderingMode&n.TextRenderingMode.FILL_STROKE_MASK;(Ae===n.TextRenderingMode.STROKE||Ae===n.TextRenderingMode.FILL_STROKE)&&(ue=this.getSinglePixelWidth())}else ue/=de;if(q!==1&&($.scale(q,q),ue/=q),$.lineWidth=ue,D.isInvalidPDFjsFont){const Ae=[];let Ce=0;for(const Pe of k)Ae.push(Pe.unicode),Ce+=Pe.width;$.fillText(Ae.join(""),0,0),I.x+=Ce*oe*B,$.restore(),this.compose();return}let pe=0,ye;for(ye=0;ye<G;++ye){const Ae=k[ye];if(typeof Ae=="number"){pe+=J*Ae*U/1e3;continue}let Ce=!1;const Pe=(Ae.isSpace?P:0)+V,Oe=Ae.fontChar,xe=Ae.accent;let Te,$e,Ue=Ae.width;if(Y){const Ke=Ae.vmetric||Z,Ge=-(Ae.vmetric?Ke[1]:Ue*.5)*oe,xt=Ke[2]*oe;Ue=Ke?-Ke[0]:Ue,Te=Ge/q,$e=(pe+xt)/q}else Te=pe/q,$e=0;if(D.remeasure&&Ue>0){const Ke=$.measureText(Oe).width*1e3/U*q;if(Ue<Ke&&this.isFontSubpixelAAEnabled){const Ge=Ue/Ke;Ce=!0,$.save(),$.scale(Ge,1),Te/=Ge}else Ue!==Ke&&(Te+=(Ue-Ke)/2e3*U/q)}if(this.contentVisible&&(Ae.isInFont||D.missingFile)){if(ve&&!xe)$.fillText(Oe,Te,$e);else if(this.paintChar(Oe,Te,$e,ce),xe){const Ke=Te+U*xe.offset.x/q,Ge=$e-U*xe.offset.y/q;this.paintChar(xe.fontChar,Ke,Ge,ce)}}const qe=Y?Ue*oe-Pe*O:Ue*oe+Pe*O;pe+=qe,Ce&&$.restore()}Y?I.y-=pe:I.x+=pe*B,$.restore(),this.compose()}showType3Text(k){const I=this.ctx,D=this.current,U=D.font,$=D.fontSize,q=D.fontDirection,V=U.vertical?1:-1,P=D.charSpacing,O=D.wordSpacing,B=D.textHScale*q,G=D.fontMatrix||n.FONT_IDENTITY_MATRIX,Y=k.length,J=D.textRenderingMode===n.TextRenderingMode.INVISIBLE;let Z,oe,ve,ce;if(!(J||$===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,I.save(),I.transform(...D.textMatrix),I.translate(D.x,D.y),I.scale(B,q),Z=0;Z<Y;++Z){if(oe=k[Z],typeof oe=="number"){ce=V*oe*$/1e3,this.ctx.translate(ce,0),D.x+=ce*B;continue}const ue=(oe.isSpace?O:0)+P,de=U.charProcOperatorList[oe.operatorListId];if(!de){(0,n.warn)(`Type3 character "${oe.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=oe,this.save(),I.scale($,$),I.transform(...G),this.executeOperatorList(de),this.restore()),ve=n.Util.applyTransform([oe.width,0],G)[0]*$+ue,I.translate(ve,0),D.x+=ve*B}I.restore(),this.processingType3=null}}setCharWidth(k,I){}setCharWidthAndBounds(k,I,D,U,$,q){this.ctx.rect(D,U,$-D,q-U),this.ctx.clip(),this.endPath()}getColorN_Pattern(k){let I;if(k[0]==="TilingPattern"){const D=k[1],U=this.baseTransform||(0,i.getCurrentTransform)(this.ctx),$={createCanvasGraphics:q=>new z(q,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};I=new o.TilingPattern(k,D,this.ctx,$,U)}else I=this._getPattern(k[1],k[2]);return I}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(k,I,D){const U=n.Util.makeHexColor(k,I,D);this.ctx.strokeStyle=U,this.current.strokeColor=U}setFillRGBColor(k,I,D){const U=n.Util.makeHexColor(k,I,D);this.ctx.fillStyle=U,this.current.fillColor=U,this.current.patternFill=!1}_getPattern(k,I=null){let D;return this.cachedPatterns.has(k)?D=this.cachedPatterns.get(k):(D=(0,o.getShadingPattern)(this.getObject(k)),this.cachedPatterns.set(k,D)),I&&(D.matrix=I),D}shadingFill(k){if(!this.contentVisible)return;const I=this.ctx;this.save();const D=this._getPattern(k);I.fillStyle=D.getPattern(I,this,(0,i.getCurrentTransformInverse)(I),o.PathType.SHADING);const U=(0,i.getCurrentTransformInverse)(I);if(U){const{width:$,height:q}=I.canvas,[V,P,O,B]=n.Util.getAxialAlignedBoundingBox([0,0,$,q],U);this.ctx.fillRect(V,P,O-V,B-P)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,n.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,n.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(k,I){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(k)&&k.length===6&&this.transform(...k),this.baseTransform=(0,i.getCurrentTransform)(this.ctx),I)){const D=I[2]-I[0],U=I[3]-I[1];this.ctx.rect(I[0],I[1],D,U),this.current.updateRectMinMax((0,i.getCurrentTransform)(this.ctx),I),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(k){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const I=this.ctx;k.isolated||(0,n.info)("TODO: Support non-isolated groups."),k.knockout&&(0,n.warn)("Knockout groups not supported.");const D=(0,i.getCurrentTransform)(I);if(k.matrix&&I.transform(...k.matrix),!k.bbox)throw new Error("Bounding box is required.");let U=n.Util.getAxialAlignedBoundingBox(k.bbox,(0,i.getCurrentTransform)(I));const $=[0,0,I.canvas.width,I.canvas.height];U=n.Util.intersect(U,$)||[0,0,0,0];const q=Math.floor(U[0]),V=Math.floor(U[1]);let P=Math.max(Math.ceil(U[2])-q,1),O=Math.max(Math.ceil(U[3])-V,1),B=1,G=1;P>d&&(B=P/d,P=d),O>d&&(G=O/d,O=d),this.current.startNewPathAndClipBox([0,0,P,O]);let Y="groupAt"+this.groupLevel;k.smask&&(Y+="_smask_"+this.smaskCounter++%2);const J=this.cachedCanvases.getCanvas(Y,P,O),Z=J.context;Z.scale(1/B,1/G),Z.translate(-q,-V),Z.transform(...D),k.smask?this.smaskStack.push({canvas:J.canvas,context:Z,offsetX:q,offsetY:V,scaleX:B,scaleY:G,subtype:k.smask.subtype,backdrop:k.smask.backdrop,transferMap:k.smask.transferMap||null,startTransformInverse:null}):(I.setTransform(1,0,0,1,0,0),I.translate(q,V),I.scale(B,G),I.save()),A(I,Z),this.ctx=Z,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(I),this.groupLevel++}endGroup(k){if(!this.contentVisible)return;this.groupLevel--;const I=this.ctx,D=this.groupStack.pop();if(this.ctx=D,this.ctx.imageSmoothingEnabled=!1,k.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const U=(0,i.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...U);const $=n.Util.getAxialAlignedBoundingBox([0,0,I.canvas.width,I.canvas.height],U);this.ctx.drawImage(I.canvas,0,0),this.ctx.restore(),this.compose($)}}beginAnnotation(k,I,D,U,$){if(this.#e(),R(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(I)&&I.length===4){const q=I[2]-I[0],V=I[3]-I[1];if($&&this.annotationCanvasMap){D=D.slice(),D[4]-=I[0],D[5]-=I[1],I=I.slice(),I[0]=I[1]=0,I[2]=q,I[3]=V;const[P,O]=n.Util.singularValueDecompose2dScale((0,i.getCurrentTransform)(this.ctx)),{viewportScale:B}=this,G=Math.ceil(q*this.outputScaleX*B),Y=Math.ceil(V*this.outputScaleY*B);this.annotationCanvas=this.canvasFactory.create(G,Y);const{canvas:J,context:Z}=this.annotationCanvas;this.annotationCanvasMap.set(k,J),this.annotationCanvas.savedCtx=this.ctx,this.ctx=Z,this.ctx.save(),this.ctx.setTransform(P,0,0,-O,0,V*O),R(this.ctx)}else R(this.ctx),this.ctx.rect(I[0],I[1],q,V),this.ctx.clip(),this.endPath()}this.current=new _(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...D),this.transform(...U)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(k){if(!this.contentVisible)return;const I=k.count;k=this.getObject(k.data,k),k.count=I;const D=this.ctx,U=this.processingType3;if(U&&(U.compiled===void 0&&(U.compiled=b(k)),U.compiled)){U.compiled(D);return}const $=this._createMaskCanvas(k),q=$.canvas;D.save(),D.setTransform(1,0,0,1,0,0),D.drawImage(q,$.offsetX,$.offsetY),D.restore(),this.compose()}paintImageMaskXObjectRepeat(k,I,D=0,U=0,$,q){if(!this.contentVisible)return;k=this.getObject(k.data,k);const V=this.ctx;V.save();const P=(0,i.getCurrentTransform)(V);V.transform(I,D,U,$,0,0);const O=this._createMaskCanvas(k);V.setTransform(1,0,0,1,O.offsetX-P[4],O.offsetY-P[5]);for(let B=0,G=q.length;B<G;B+=2){const Y=n.Util.transform(P,[I,D,U,$,q[B],q[B+1]]),[J,Z]=n.Util.applyTransform([0,0],Y);V.drawImage(O.canvas,J,Z)}V.restore(),this.compose()}paintImageMaskXObjectGroup(k){if(!this.contentVisible)return;const I=this.ctx,D=this.current.fillColor,U=this.current.patternFill;for(const $ of k){const{data:q,width:V,height:P,transform:O}=$,B=this.cachedCanvases.getCanvas("maskCanvas",V,P),G=B.context;G.save();const Y=this.getObject(q,$);C(G,Y),G.globalCompositeOperation="source-in",G.fillStyle=U?D.getPattern(G,this,(0,i.getCurrentTransformInverse)(I),o.PathType.FILL):D,G.fillRect(0,0,V,P),G.restore(),I.save(),I.transform(...O),I.scale(1,-1),E(I,B.canvas,0,0,V,P,0,-1,1,1),I.restore()}this.compose()}paintImageXObject(k){if(!this.contentVisible)return;const I=this.getObject(k);if(!I){(0,n.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(I)}paintImageXObjectRepeat(k,I,D,U){if(!this.contentVisible)return;const $=this.getObject(k);if(!$){(0,n.warn)("Dependent image isn't ready yet");return}const q=$.width,V=$.height,P=[];for(let O=0,B=U.length;O<B;O+=2)P.push({transform:[I,0,0,D,U[O],U[O+1]],x:0,y:0,w:q,h:V});this.paintInlineImageXObjectGroup($,P)}applyTransferMapsToCanvas(k){return this.current.transferMaps!=="none"&&(k.filter=this.current.transferMaps,k.drawImage(k.canvas,0,0),k.filter="none"),k.canvas}applyTransferMapsToBitmap(k){if(this.current.transferMaps==="none")return k.bitmap;const{bitmap:I,width:D,height:U}=k,$=this.cachedCanvases.getCanvas("inlineImage",D,U),q=$.context;return q.filter=this.current.transferMaps,q.drawImage(I,0,0),q.filter="none",$.canvas}paintInlineImageXObject(k){if(!this.contentVisible)return;const I=k.width,D=k.height,U=this.ctx;if(this.save(),!n.isNodeJS){const{filter:V}=U;V!=="none"&&V!==""&&(U.filter="none")}U.scale(1/I,-1/D);let $;if(k.bitmap)$=this.applyTransferMapsToBitmap(k);else if(typeof HTMLElement=="function"&&k instanceof HTMLElement||!k.data)$=k;else{const P=this.cachedCanvases.getCanvas("inlineImage",I,D).context;S(P,k),$=this.applyTransferMapsToCanvas(P)}const q=this._scaleImage($,(0,i.getCurrentTransformInverse)(U));U.imageSmoothingEnabled=ee((0,i.getCurrentTransform)(U),k.interpolate),E(U,q.img,0,0,q.paintWidth,q.paintHeight,0,-D,I,D),this.compose(),this.restore()}paintInlineImageXObjectGroup(k,I){if(!this.contentVisible)return;const D=this.ctx;let U;if(k.bitmap)U=k.bitmap;else{const $=k.width,q=k.height,P=this.cachedCanvases.getCanvas("inlineImage",$,q).context;S(P,k),U=this.applyTransferMapsToCanvas(P)}for(const $ of I)D.save(),D.transform(...$.transform),D.scale(1,-1),E(D,U,$.x,$.y,$.w,$.h,0,-1,1,1),D.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(k){}markPointProps(k,I){}beginMarkedContent(k){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(k,I){k==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(I)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(k){const I=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(k);const D=this.ctx;this.pendingClip&&(I||(this.pendingClip===Q?D.clip("evenodd"):D.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),D.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const k=(0,i.getCurrentTransform)(this.ctx);if(k[1]===0&&k[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(k[0]),Math.abs(k[3]));else{const I=Math.abs(k[0]*k[3]-k[2]*k[1]),D=Math.hypot(k[0],k[2]),U=Math.hypot(k[1],k[3]);this._cachedGetSinglePixelWidth=Math.max(D,U)/I}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:k}=this.current,{a:I,b:D,c:U,d:$}=this.ctx.getTransform();let q,V;if(D===0&&U===0){const P=Math.abs(I),O=Math.abs($);if(P===O)if(k===0)q=V=1/P;else{const B=P*k;q=V=B<1?1/B:1}else if(k===0)q=1/P,V=1/O;else{const B=P*k,G=O*k;q=B<1?1/B:1,V=G<1?1/G:1}}else{const P=Math.abs(I*$-D*U),O=Math.hypot(I,D),B=Math.hypot(U,$);if(k===0)q=B/P,V=O/P;else{const G=k*P;q=B>G?B/G:1,V=O>G?O/G:1}}this._cachedScaleForStroking[0]=q,this._cachedScaleForStroking[1]=V}return this._cachedScaleForStroking}rescaleAndStroke(k){const{ctx:I}=this,{lineWidth:D}=this.current,[U,$]=this.getScaleForStroking();if(I.lineWidth=D||1,U===1&&$===1){I.stroke();return}const q=I.getLineDash();if(k&&I.save(),I.scale(U,$),q.length>0){const V=Math.max(U,$);I.setLineDash(q.map(P=>P/V)),I.lineDashOffset/=V}I.stroke(),k&&I.restore()}isContentVisible(){for(let k=this.markedContentStack.length-1;k>=0;k--)if(!this.markedContentStack[k].visible)return!1;return!0}}e.CanvasGraphics=z;for(const N in n.OPS)z.prototype[N]!==void 0&&(z.prototype[n.OPS[N]]=z.prototype[N])}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TilingPattern=e.PathType=void 0,e.getShadingPattern=v;var n=t(1),i=t(6);const o={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};e.PathType=o;function a(E,b){if(!b)return;const _=b[2]-b[0],S=b[3]-b[1],C=new Path2D;C.rect(b[0],b[1],_,S),E.clip(C)}class l{constructor(){this.constructor===l&&(0,n.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,n.unreachable)("Abstract method `getPattern` called.")}}class h extends l{constructor(b){super(),this._type=b[1],this._bbox=b[2],this._colorStops=b[3],this._p0=b[4],this._p1=b[5],this._r0=b[6],this._r1=b[7],this.matrix=null}_createGradient(b){let _;this._type==="axial"?_=b.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(_=b.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const S of this._colorStops)_.addColorStop(S[0],S[1]);return _}getPattern(b,_,S,C){let A;if(C===o.STROKE||C===o.FILL){const R=_.current.getClippedPathBoundingBox(C,(0,i.getCurrentTransform)(b))||[0,0,0,0],L=Math.ceil(R[2]-R[0])||1,j=Math.ceil(R[3]-R[1])||1,F=_.cachedCanvases.getCanvas("pattern",L,j,!0),W=F.context;W.clearRect(0,0,W.canvas.width,W.canvas.height),W.beginPath(),W.rect(0,0,W.canvas.width,W.canvas.height),W.translate(-R[0],-R[1]),S=n.Util.transform(S,[1,0,0,1,R[0],R[1]]),W.transform(..._.baseTransform),this.matrix&&W.transform(...this.matrix),a(W,this._bbox),W.fillStyle=this._createGradient(W),W.fill(),A=b.createPattern(F.canvas,"no-repeat");const K=new DOMMatrix(S);A.setTransform(K)}else a(b,this._bbox),A=this._createGradient(b);return A}}function d(E,b,_,S,C,A,R,L){const j=b.coords,F=b.colors,W=E.data,K=E.width*4;let ee;j[_+1]>j[S+1]&&(ee=_,_=S,S=ee,ee=A,A=R,R=ee),j[S+1]>j[C+1]&&(ee=S,S=C,C=ee,ee=R,R=L,L=ee),j[_+1]>j[S+1]&&(ee=_,_=S,S=ee,ee=A,A=R,R=ee);const te=(j[_]+b.offsetX)*b.scaleX,re=(j[_+1]+b.offsetY)*b.scaleY,ie=(j[S]+b.offsetX)*b.scaleX,Q=(j[S+1]+b.offsetY)*b.scaleY,z=(j[C]+b.offsetX)*b.scaleX,N=(j[C+1]+b.offsetY)*b.scaleY;if(re>=N)return;const k=F[A],I=F[A+1],D=F[A+2],U=F[R],$=F[R+1],q=F[R+2],V=F[L],P=F[L+1],O=F[L+2],B=Math.round(re),G=Math.round(N);let Y,J,Z,oe,ve,ce,ue,de;for(let pe=B;pe<=G;pe++){if(pe<Q){const Oe=pe<re?0:(re-pe)/(re-Q);Y=te-(te-ie)*Oe,J=k-(k-U)*Oe,Z=I-(I-$)*Oe,oe=D-(D-q)*Oe}else{let Oe;pe>N?Oe=1:Q===N?Oe=0:Oe=(Q-pe)/(Q-N),Y=ie-(ie-z)*Oe,J=U-(U-V)*Oe,Z=$-($-P)*Oe,oe=q-(q-O)*Oe}let ye;pe<re?ye=0:pe>N?ye=1:ye=(re-pe)/(re-N),ve=te-(te-z)*ye,ce=k-(k-V)*ye,ue=I-(I-P)*ye,de=D-(D-O)*ye;const Ae=Math.round(Math.min(Y,ve)),Ce=Math.round(Math.max(Y,ve));let Pe=K*pe+Ae*4;for(let Oe=Ae;Oe<=Ce;Oe++)ye=(Y-Oe)/(Y-ve),ye<0?ye=0:ye>1&&(ye=1),W[Pe++]=J-(J-ce)*ye|0,W[Pe++]=Z-(Z-ue)*ye|0,W[Pe++]=oe-(oe-de)*ye|0,W[Pe++]=255}}function u(E,b,_){const S=b.coords,C=b.colors;let A,R;switch(b.type){case"lattice":const L=b.verticesPerRow,j=Math.floor(S.length/L)-1,F=L-1;for(A=0;A<j;A++){let W=A*L;for(let K=0;K<F;K++,W++)d(E,_,S[W],S[W+1],S[W+L],C[W],C[W+1],C[W+L]),d(E,_,S[W+L+1],S[W+1],S[W+L],C[W+L+1],C[W+1],C[W+L])}break;case"triangles":for(A=0,R=S.length;A<R;A+=3)d(E,_,S[A],S[A+1],S[A+2],C[A],C[A+1],C[A+2]);break;default:throw new Error("illegal figure")}}class f extends l{constructor(b){super(),this._coords=b[2],this._colors=b[3],this._figures=b[4],this._bounds=b[5],this._bbox=b[7],this._background=b[8],this.matrix=null}_createMeshCanvas(b,_,S){const L=Math.floor(this._bounds[0]),j=Math.floor(this._bounds[1]),F=Math.ceil(this._bounds[2])-L,W=Math.ceil(this._bounds[3])-j,K=Math.min(Math.ceil(Math.abs(F*b[0]*1.1)),3e3),ee=Math.min(Math.ceil(Math.abs(W*b[1]*1.1)),3e3),te=F/K,re=W/ee,ie={coords:this._coords,colors:this._colors,offsetX:-L,offsetY:-j,scaleX:1/te,scaleY:1/re},Q=K+4,z=ee+4,N=S.getCanvas("mesh",Q,z,!1),k=N.context,I=k.createImageData(K,ee);if(_){const U=I.data;for(let $=0,q=U.length;$<q;$+=4)U[$]=_[0],U[$+1]=_[1],U[$+2]=_[2],U[$+3]=255}for(const U of this._figures)u(I,U,ie);return k.putImageData(I,2,2),{canvas:N.canvas,offsetX:L-2*te,offsetY:j-2*re,scaleX:te,scaleY:re}}getPattern(b,_,S,C){a(b,this._bbox);let A;if(C===o.SHADING)A=n.Util.singularValueDecompose2dScale((0,i.getCurrentTransform)(b));else if(A=n.Util.singularValueDecompose2dScale(_.baseTransform),this.matrix){const L=n.Util.singularValueDecompose2dScale(this.matrix);A=[A[0]*L[0],A[1]*L[1]]}const R=this._createMeshCanvas(A,C===o.SHADING?null:this._background,_.cachedCanvases);return C!==o.SHADING&&(b.setTransform(..._.baseTransform),this.matrix&&b.transform(...this.matrix)),b.translate(R.offsetX,R.offsetY),b.scale(R.scaleX,R.scaleY),b.createPattern(R.canvas,"no-repeat")}}class m extends l{getPattern(){return"hotpink"}}function v(E){switch(E[0]){case"RadialAxial":return new h(E);case"Mesh":return new f(E);case"Dummy":return new m}throw new Error(`Unknown IR type: ${E[0]}`)}const g={COLORED:1,UNCOLORED:2};class x{static MAX_PATTERN_SIZE=3e3;constructor(b,_,S,C,A){this.operatorList=b[2],this.matrix=b[3]||[1,0,0,1,0,0],this.bbox=b[4],this.xstep=b[5],this.ystep=b[6],this.paintType=b[7],this.tilingType=b[8],this.color=_,this.ctx=S,this.canvasGraphicsFactory=C,this.baseTransform=A}createPatternCanvas(b){const _=this.operatorList,S=this.bbox,C=this.xstep,A=this.ystep,R=this.paintType,L=this.tilingType,j=this.color,F=this.canvasGraphicsFactory;(0,n.info)("TilingType: "+L);const W=S[0],K=S[1],ee=S[2],te=S[3],re=n.Util.singularValueDecompose2dScale(this.matrix),ie=n.Util.singularValueDecompose2dScale(this.baseTransform),Q=[re[0]*ie[0],re[1]*ie[1]],z=this.getSizeAndScale(C,this.ctx.canvas.width,Q[0]),N=this.getSizeAndScale(A,this.ctx.canvas.height,Q[1]),k=b.cachedCanvases.getCanvas("pattern",z.size,N.size,!0),I=k.context,D=F.createCanvasGraphics(I);D.groupLevel=b.groupLevel,this.setFillAndStrokeStyleToContext(D,R,j);let U=W,$=K,q=ee,V=te;return W<0&&(U=0,q+=Math.abs(W)),K<0&&($=0,V+=Math.abs(K)),I.translate(-(z.scale*U),-(N.scale*$)),D.transform(z.scale,0,0,N.scale,0,0),I.save(),this.clipBbox(D,U,$,q,V),D.baseTransform=(0,i.getCurrentTransform)(D.ctx),D.executeOperatorList(_),D.endDrawing(),{canvas:k.canvas,scaleX:z.scale,scaleY:N.scale,offsetX:U,offsetY:$}}getSizeAndScale(b,_,S){b=Math.abs(b);const C=Math.max(x.MAX_PATTERN_SIZE,_);let A=Math.ceil(b*S);return A>=C?A=C:S=A/b,{scale:S,size:A}}clipBbox(b,_,S,C,A){const R=C-_,L=A-S;b.ctx.rect(_,S,R,L),b.current.updateRectMinMax((0,i.getCurrentTransform)(b.ctx),[_,S,C,A]),b.clip(),b.endPath()}setFillAndStrokeStyleToContext(b,_,S){const C=b.ctx,A=b.current;switch(_){case g.COLORED:const R=this.ctx;C.fillStyle=R.fillStyle,C.strokeStyle=R.strokeStyle,A.fillColor=R.fillStyle,A.strokeColor=R.strokeStyle;break;case g.UNCOLORED:const L=n.Util.makeHexColor(S[0],S[1],S[2]);C.fillStyle=L,C.strokeStyle=L,A.fillColor=L,A.strokeColor=L;break;default:throw new n.FormatError(`Unsupported paint type: ${_}`)}}getPattern(b,_,S,C){let A=S;C!==o.SHADING&&(A=n.Util.transform(A,_.baseTransform),this.matrix&&(A=n.Util.transform(A,this.matrix)));const R=this.createPatternCanvas(_);let L=new DOMMatrix(A);L=L.translate(R.offsetX,R.offsetY),L=L.scale(1/R.scaleX,1/R.scaleY);const j=b.createPattern(R.canvas,"repeat");return j.setTransform(L),j}}e.TilingPattern=x}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.convertBlackAndWhiteToRGBA=o,e.convertToRGBA=i,e.grayToRGBA=l;var n=t(1);function i(h){switch(h.kind){case n.ImageKind.GRAYSCALE_1BPP:return o(h);case n.ImageKind.RGB_24BPP:return a(h)}return null}function o({src:h,srcPos:d=0,dest:u,width:f,height:m,nonBlackColor:v=4294967295,inverseDecode:g=!1}){const x=n.FeatureTest.isLittleEndian?4278190080:255,[E,b]=g?[v,x]:[x,v],_=f>>3,S=f&7,C=h.length;u=new Uint32Array(u.buffer);let A=0;for(let R=0;R<m;R++){for(const j=d+_;d<j;d++){const F=d<C?h[d]:255;u[A++]=F&128?b:E,u[A++]=F&64?b:E,u[A++]=F&32?b:E,u[A++]=F&16?b:E,u[A++]=F&8?b:E,u[A++]=F&4?b:E,u[A++]=F&2?b:E,u[A++]=F&1?b:E}if(S===0)continue;const L=d<C?h[d++]:255;for(let j=0;j<S;j++)u[A++]=L&1<<7-j?b:E}return{srcPos:d,destPos:A}}function a({src:h,srcPos:d=0,dest:u,destPos:f=0,width:m,height:v}){let g=0;const x=h.length>>2,E=new Uint32Array(h.buffer,d,x);if(n.FeatureTest.isLittleEndian){for(;g<x-2;g+=3,f+=4){const b=E[g],_=E[g+1],S=E[g+2];u[f]=b|4278190080,u[f+1]=b>>>24|_<<8|4278190080,u[f+2]=_>>>16|S<<16|4278190080,u[f+3]=S>>>8|4278190080}for(let b=g*4,_=h.length;b<_;b+=3)u[f++]=h[b]|h[b+1]<<8|h[b+2]<<16|4278190080}else{for(;g<x-2;g+=3,f+=4){const b=E[g],_=E[g+1],S=E[g+2];u[f]=b|255,u[f+1]=b<<24|_>>>8|255,u[f+2]=_<<16|S>>>16|255,u[f+3]=S<<8|255}for(let b=g*4,_=h.length;b<_;b+=3)u[f++]=h[b]<<24|h[b+1]<<16|h[b+2]<<8|255}return{srcPos:d,destPos:f}}function l(h,d){if(n.FeatureTest.isLittleEndian)for(let u=0,f=h.length;u<f;u++)d[u]=h[u]*65793|4278190080;else for(let u=0,f=h.length;u<f;u++)d[u]=h[u]*16843008|255}}),((s,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.GlobalWorkerOptions=void 0;const t=Object.create(null);e.GlobalWorkerOptions=t,t.workerPort=null,t.workerSrc=""}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MessageHandler=void 0;var n=t(1);const i={DATA:1,ERROR:2},o={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function a(h){switch(h instanceof Error||typeof h=="object"&&h!==null||(0,n.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),h.name){case"AbortException":return new n.AbortException(h.message);case"MissingPDFException":return new n.MissingPDFException(h.message);case"PasswordException":return new n.PasswordException(h.message,h.code);case"UnexpectedResponseException":return new n.UnexpectedResponseException(h.message,h.status);case"UnknownErrorException":return new n.UnknownErrorException(h.message,h.details);default:return new n.UnknownErrorException(h.message,h.toString())}}class l{constructor(d,u,f){this.sourceName=d,this.targetName=u,this.comObj=f,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=m=>{const v=m.data;if(v.targetName!==this.sourceName)return;if(v.stream){this.#t(v);return}if(v.callback){const x=v.callbackId,E=this.callbackCapabilities[x];if(!E)throw new Error(`Cannot resolve callback ${x}`);if(delete this.callbackCapabilities[x],v.callback===i.DATA)E.resolve(v.data);else if(v.callback===i.ERROR)E.reject(a(v.reason));else throw new Error("Unexpected callback case");return}const g=this.actionHandler[v.action];if(!g)throw new Error(`Unknown action from worker: ${v.action}`);if(v.callbackId){const x=this.sourceName,E=v.sourceName;new Promise(function(b){b(g(v.data))}).then(function(b){f.postMessage({sourceName:x,targetName:E,callback:i.DATA,callbackId:v.callbackId,data:b})},function(b){f.postMessage({sourceName:x,targetName:E,callback:i.ERROR,callbackId:v.callbackId,reason:a(b)})});return}if(v.streamId){this.#e(v);return}g(v.data)},f.addEventListener("message",this._onComObjOnMessage)}on(d,u){const f=this.actionHandler;if(f[d])throw new Error(`There is already an actionName called "${d}"`);f[d]=u}send(d,u,f){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:d,data:u},f)}sendWithPromise(d,u,f){const m=this.callbackId++,v=new n.PromiseCapability;this.callbackCapabilities[m]=v;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:d,callbackId:m,data:u},f)}catch(g){v.reject(g)}return v.promise}sendWithStream(d,u,f,m){const v=this.streamId++,g=this.sourceName,x=this.targetName,E=this.comObj;return new ReadableStream({start:b=>{const _=new n.PromiseCapability;return this.streamControllers[v]={controller:b,startCall:_,pullCall:null,cancelCall:null,isClosed:!1},E.postMessage({sourceName:g,targetName:x,action:d,streamId:v,data:u,desiredSize:b.desiredSize},m),_.promise},pull:b=>{const _=new n.PromiseCapability;return this.streamControllers[v].pullCall=_,E.postMessage({sourceName:g,targetName:x,stream:o.PULL,streamId:v,desiredSize:b.desiredSize}),_.promise},cancel:b=>{(0,n.assert)(b instanceof Error,"cancel must have a valid reason");const _=new n.PromiseCapability;return this.streamControllers[v].cancelCall=_,this.streamControllers[v].isClosed=!0,E.postMessage({sourceName:g,targetName:x,stream:o.CANCEL,streamId:v,reason:a(b)}),_.promise}},f)}#e(d){const u=d.streamId,f=this.sourceName,m=d.sourceName,v=this.comObj,g=this,x=this.actionHandler[d.action],E={enqueue(b,_=1,S){if(this.isCancelled)return;const C=this.desiredSize;this.desiredSize-=_,C>0&&this.desiredSize<=0&&(this.sinkCapability=new n.PromiseCapability,this.ready=this.sinkCapability.promise),v.postMessage({sourceName:f,targetName:m,stream:o.ENQUEUE,streamId:u,chunk:b},S)},close(){this.isCancelled||(this.isCancelled=!0,v.postMessage({sourceName:f,targetName:m,stream:o.CLOSE,streamId:u}),delete g.streamSinks[u])},error(b){(0,n.assert)(b instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,v.postMessage({sourceName:f,targetName:m,stream:o.ERROR,streamId:u,reason:a(b)}))},sinkCapability:new n.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:d.desiredSize,ready:null};E.sinkCapability.resolve(),E.ready=E.sinkCapability.promise,this.streamSinks[u]=E,new Promise(function(b){b(x(d.data,E))}).then(function(){v.postMessage({sourceName:f,targetName:m,stream:o.START_COMPLETE,streamId:u,success:!0})},function(b){v.postMessage({sourceName:f,targetName:m,stream:o.START_COMPLETE,streamId:u,reason:a(b)})})}#t(d){const u=d.streamId,f=this.sourceName,m=d.sourceName,v=this.comObj,g=this.streamControllers[u],x=this.streamSinks[u];switch(d.stream){case o.START_COMPLETE:d.success?g.startCall.resolve():g.startCall.reject(a(d.reason));break;case o.PULL_COMPLETE:d.success?g.pullCall.resolve():g.pullCall.reject(a(d.reason));break;case o.PULL:if(!x){v.postMessage({sourceName:f,targetName:m,stream:o.PULL_COMPLETE,streamId:u,success:!0});break}x.desiredSize<=0&&d.desiredSize>0&&x.sinkCapability.resolve(),x.desiredSize=d.desiredSize,new Promise(function(E){E(x.onPull?.())}).then(function(){v.postMessage({sourceName:f,targetName:m,stream:o.PULL_COMPLETE,streamId:u,success:!0})},function(E){v.postMessage({sourceName:f,targetName:m,stream:o.PULL_COMPLETE,streamId:u,reason:a(E)})});break;case o.ENQUEUE:if((0,n.assert)(g,"enqueue should have stream controller"),g.isClosed)break;g.controller.enqueue(d.chunk);break;case o.CLOSE:if((0,n.assert)(g,"close should have stream controller"),g.isClosed)break;g.isClosed=!0,g.controller.close(),this.#n(g,u);break;case o.ERROR:(0,n.assert)(g,"error should have stream controller"),g.controller.error(a(d.reason)),this.#n(g,u);break;case o.CANCEL_COMPLETE:d.success?g.cancelCall.resolve():g.cancelCall.reject(a(d.reason)),this.#n(g,u);break;case o.CANCEL:if(!x)break;new Promise(function(E){E(x.onCancel?.(a(d.reason)))}).then(function(){v.postMessage({sourceName:f,targetName:m,stream:o.CANCEL_COMPLETE,streamId:u,success:!0})},function(E){v.postMessage({sourceName:f,targetName:m,stream:o.CANCEL_COMPLETE,streamId:u,reason:a(E)})}),x.sinkCapability.reject(a(d.reason)),x.isCancelled=!0,delete this.streamSinks[u];break;default:throw new Error("Unexpected stream case")}}async#n(d,u){await Promise.allSettled([d.startCall?.promise,d.pullCall?.promise,d.cancelCall?.promise]),delete this.streamControllers[u]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}e.MessageHandler=l}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Metadata=void 0;var n=t(1);class i{#e;#t;constructor({parsedData:a,rawData:l}){this.#e=a,this.#t=l}getRaw(){return this.#t}get(a){return this.#e.get(a)??null}getAll(){return(0,n.objectFromMap)(this.#e)}has(a){return this.#e.has(a)}}e.Metadata=i}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.OptionalContentConfig=void 0;var n=t(1),i=t(8);const o=Symbol("INTERNAL");class a{#e=!0;constructor(d,u){this.name=d,this.intent=u}get visible(){return this.#e}_setVisible(d,u){d!==o&&(0,n.unreachable)("Internal method `_setVisible` called."),this.#e=u}}class l{#e=null;#t=new Map;#n=null;#r=null;constructor(d){if(this.name=null,this.creator=null,d!==null){this.name=d.name,this.creator=d.creator,this.#r=d.order;for(const u of d.groups)this.#t.set(u.id,new a(u.name,u.intent));if(d.baseState==="OFF")for(const u of this.#t.values())u._setVisible(o,!1);for(const u of d.on)this.#t.get(u)._setVisible(o,!0);for(const u of d.off)this.#t.get(u)._setVisible(o,!1);this.#n=this.getHash()}}#s(d){const u=d.length;if(u<2)return!0;const f=d[0];for(let m=1;m<u;m++){const v=d[m];let g;if(Array.isArray(v))g=this.#s(v);else if(this.#t.has(v))g=this.#t.get(v).visible;else return(0,n.warn)(`Optional content group not found: ${v}`),!0;switch(f){case"And":if(!g)return!1;break;case"Or":if(g)return!0;break;case"Not":return!g;default:return!0}}return f==="And"}isVisible(d){if(this.#t.size===0)return!0;if(!d)return(0,n.warn)("Optional content group not defined."),!0;if(d.type==="OCG")return this.#t.has(d.id)?this.#t.get(d.id).visible:((0,n.warn)(`Optional content group not found: ${d.id}`),!0);if(d.type==="OCMD"){if(d.expression)return this.#s(d.expression);if(!d.policy||d.policy==="AnyOn"){for(const u of d.ids){if(!this.#t.has(u))return(0,n.warn)(`Optional content group not found: ${u}`),!0;if(this.#t.get(u).visible)return!0}return!1}else if(d.policy==="AllOn"){for(const u of d.ids){if(!this.#t.has(u))return(0,n.warn)(`Optional content group not found: ${u}`),!0;if(!this.#t.get(u).visible)return!1}return!0}else if(d.policy==="AnyOff"){for(const u of d.ids){if(!this.#t.has(u))return(0,n.warn)(`Optional content group not found: ${u}`),!0;if(!this.#t.get(u).visible)return!0}return!1}else if(d.policy==="AllOff"){for(const u of d.ids){if(!this.#t.has(u))return(0,n.warn)(`Optional content group not found: ${u}`),!0;if(this.#t.get(u).visible)return!1}return!0}return(0,n.warn)(`Unknown optional content policy ${d.policy}.`),!0}return(0,n.warn)(`Unknown group type ${d.type}.`),!0}setVisibility(d,u=!0){if(!this.#t.has(d)){(0,n.warn)(`Optional content group not found: ${d}`);return}this.#t.get(d)._setVisible(o,!!u),this.#e=null}get hasInitialVisibility(){return this.#n===null||this.getHash()===this.#n}getOrder(){return this.#t.size?this.#r?this.#r.slice():[...this.#t.keys()]:null}getGroups(){return this.#t.size>0?(0,n.objectFromMap)(this.#t):null}getGroup(d){return this.#t.get(d)||null}getHash(){if(this.#e!==null)return this.#e;const d=new i.MurmurHash3_64;for(const[u,f]of this.#t)d.update(`${u}:${f.visible}`);return this.#e=d.hexdigest()}}e.OptionalContentConfig=l}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFDataTransportStream=void 0;var n=t(1),i=t(6);class o{constructor({length:d,initialData:u,progressiveDone:f=!1,contentDispositionFilename:m=null,disableRange:v=!1,disableStream:g=!1},x){if((0,n.assert)(x,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=f,this._contentDispositionFilename=m,u?.length>0){const E=u instanceof Uint8Array&&u.byteLength===u.buffer.byteLength?u.buffer:new Uint8Array(u).buffer;this._queuedChunks.push(E)}this._pdfDataRangeTransport=x,this._isStreamingSupported=!g,this._isRangeSupported=!v,this._contentLength=d,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((E,b)=>{this._onReceiveData({begin:E,chunk:b})}),this._pdfDataRangeTransport.addProgressListener((E,b)=>{this._onProgress({loaded:E,total:b})}),this._pdfDataRangeTransport.addProgressiveReadListener(E=>{this._onReceiveData({chunk:E})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:d,chunk:u}){const f=u instanceof Uint8Array&&u.byteLength===u.buffer.byteLength?u.buffer:new Uint8Array(u).buffer;if(d===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(f):this._queuedChunks.push(f);else{const m=this._rangeReaders.some(function(v){return v._begin!==d?!1:(v._enqueue(f),!0)});(0,n.assert)(m,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(d){d.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:d.loaded}):this._fullRequestReader?.onProgress?.({loaded:d.loaded,total:d.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(d){const u=this._rangeReaders.indexOf(d);u>=0&&this._rangeReaders.splice(u,1)}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const d=this._queuedChunks;return this._queuedChunks=null,new a(this,d,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(d,u){if(u<=this._progressiveDataLength)return null;const f=new l(this,d,u);return this._pdfDataRangeTransport.requestDataRange(d,u),this._rangeReaders.push(f),f}cancelAllRequests(d){this._fullRequestReader?.cancel(d);for(const u of this._rangeReaders.slice(0))u.cancel(d);this._pdfDataRangeTransport.abort()}}e.PDFDataTransportStream=o;class a{constructor(d,u,f=!1,m=null){this._stream=d,this._done=f||!1,this._filename=(0,i.isPdfFile)(m)?m:null,this._queuedChunks=u||[],this._loaded=0;for(const v of this._queuedChunks)this._loaded+=v.byteLength;this._requests=[],this._headersReady=Promise.resolve(),d._fullRequestReader=this,this.onProgress=null}_enqueue(d){this._done||(this._requests.length>0?this._requests.shift().resolve({value:d,done:!1}):this._queuedChunks.push(d),this._loaded+=d.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const d=new n.PromiseCapability;return this._requests.push(d),d.promise}cancel(d){this._done=!0;for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class l{constructor(d,u,f){this._stream=d,this._begin=u,this._end=f,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(d){if(!this._done){if(this._requests.length===0)this._queuedChunk=d;else{this._requests.shift().resolve({value:d,done:!1});for(const f of this._requests)f.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const u=this._queuedChunk;return this._queuedChunk=null,{value:u,done:!1}}if(this._done)return{value:void 0,done:!0};const d=new n.PromiseCapability;return this._requests.push(d),d.promise}cancel(d){this._done=!0;for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFFetchStream=void 0;var n=t(1),i=t(20);function o(f,m,v){return{method:"GET",headers:f,signal:v.signal,mode:"cors",credentials:m?"include":"same-origin",redirect:"follow"}}function a(f){const m=new Headers;for(const v in f){const g=f[v];g!==void 0&&m.append(v,g)}return m}function l(f){return f instanceof Uint8Array?f.buffer:f instanceof ArrayBuffer?f:((0,n.warn)(`getArrayBuffer - unexpected data format: ${f}`),new Uint8Array(f).buffer)}class h{constructor(m){this.source=m,this.isHttp=/^https?:/i.test(m.url),this.httpHeaders=this.isHttp&&m.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new d(this),this._fullRequestReader}getRangeReader(m,v){if(v<=this._progressiveDataLength)return null;const g=new u(this,m,v);return this._rangeRequestReaders.push(g),g}cancelAllRequests(m){this._fullRequestReader?.cancel(m);for(const v of this._rangeRequestReaders.slice(0))v.cancel(m)}}e.PDFFetchStream=h;class d{constructor(m){this._stream=m,this._reader=null,this._loaded=0,this._filename=null;const v=m.source;this._withCredentials=v.withCredentials||!1,this._contentLength=v.length,this._headersCapability=new n.PromiseCapability,this._disableRange=v.disableRange||!1,this._rangeChunkSize=v.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!v.disableStream,this._isRangeSupported=!v.disableRange,this._headers=a(this._stream.httpHeaders);const g=v.url;fetch(g,o(this._headers,this._withCredentials,this._abortController)).then(x=>{if(!(0,i.validateResponseStatus)(x.status))throw(0,i.createResponseStatusError)(x.status,g);this._reader=x.body.getReader(),this._headersCapability.resolve();const E=S=>x.headers.get(S),{allowRangeRequests:b,suggestedLength:_}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:E,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=b,this._contentLength=_||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(E),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new n.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:m,done:v}=await this._reader.read();return v?{value:m,done:v}:(this._loaded+=m.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:l(m),done:!1})}cancel(m){this._reader?.cancel(m),this._abortController.abort()}}class u{constructor(m,v,g){this._stream=m,this._reader=null,this._loaded=0;const x=m.source;this._withCredentials=x.withCredentials||!1,this._readCapability=new n.PromiseCapability,this._isStreamingSupported=!x.disableStream,this._abortController=new AbortController,this._headers=a(this._stream.httpHeaders),this._headers.append("Range",`bytes=${v}-${g-1}`);const E=x.url;fetch(E,o(this._headers,this._withCredentials,this._abortController)).then(b=>{if(!(0,i.validateResponseStatus)(b.status))throw(0,i.createResponseStatusError)(b.status,E);this._readCapability.resolve(),this._reader=b.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:m,done:v}=await this._reader.read();return v?{value:m,done:v}:(this._loaded+=m.byteLength,this.onProgress?.({loaded:this._loaded}),{value:l(m),done:!1})}cancel(m){this._reader?.cancel(m),this._abortController.abort()}}}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createResponseStatusError=h,e.extractFilenameFromHeader=l,e.validateRangeRequestCapabilities=a,e.validateResponseStatus=d;var n=t(1),i=t(21),o=t(6);function a({getResponseHeader:u,isHttp:f,rangeChunkSize:m,disableRange:v}){const g={allowRangeRequests:!1,suggestedLength:void 0},x=parseInt(u("Content-Length"),10);return!Number.isInteger(x)||(g.suggestedLength=x,x<=2*m)||v||!f||u("Accept-Ranges")!=="bytes"||(u("Content-Encoding")||"identity")!=="identity"||(g.allowRangeRequests=!0),g}function l(u){const f=u("Content-Disposition");if(f){let m=(0,i.getFilenameFromContentDispositionHeader)(f);if(m.includes("%"))try{m=decodeURIComponent(m)}catch{}if((0,o.isPdfFile)(m))return m}return null}function h(u,f){return u===404||u===0&&f.startsWith("file:")?new n.MissingPDFException('Missing PDF "'+f+'".'):new n.UnexpectedResponseException(`Unexpected server response (${u}) while retrieving PDF "${f}".`,u)}function d(u){return u===200||u===206}}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getFilenameFromContentDispositionHeader=i;var n=t(1);function i(o){let a=!0,l=h("filename\\*","i").exec(o);if(l){l=l[1];let x=m(l);return x=unescape(x),x=v(x),x=g(x),u(x)}if(l=f(o),l){const x=g(l);return u(x)}if(l=h("filename","i").exec(o),l){l=l[1];let x=m(l);return x=g(x),u(x)}function h(x,E){return new RegExp("(?:^|;)\\s*"+x+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',E)}function d(x,E){if(x){if(!/^[\x00-\xFF]+$/.test(E))return E;try{const b=new TextDecoder(x,{fatal:!0}),_=(0,n.stringToBytes)(E);E=b.decode(_),a=!1}catch{}}return E}function u(x){return a&&/[\x80-\xff]/.test(x)&&(x=d("utf-8",x),a&&(x=d("iso-8859-1",x))),x}function f(x){const E=[];let b;const _=h("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(b=_.exec(x))!==null;){let[,C,A,R]=b;if(C=parseInt(C,10),C in E){if(C===0)break;continue}E[C]=[A,R]}const S=[];for(let C=0;C<E.length&&C in E;++C){let[A,R]=E[C];R=m(R),A&&(R=unescape(R),C===0&&(R=v(R))),S.push(R)}return S.join("")}function m(x){if(x.startsWith('"')){const E=x.slice(1).split('\\"');for(let b=0;b<E.length;++b){const _=E[b].indexOf('"');_!==-1&&(E[b]=E[b].slice(0,_),E.length=b+1),E[b]=E[b].replaceAll(/\\(.)/g,"$1")}x=E.join('"')}return x}function v(x){const E=x.indexOf("'");if(E===-1)return x;const b=x.slice(0,E),S=x.slice(E+1).replace(/^[^']*'/,"");return d(b,S)}function g(x){return!x.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(x)?x:x.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(E,b,_,S){if(_==="q"||_==="Q")return S=S.replaceAll("_"," "),S=S.replaceAll(/=([0-9a-fA-F]{2})/g,function(C,A){return String.fromCharCode(parseInt(A,16))}),d(b,S);try{S=atob(S)}catch{}return d(b,S)})}return""}}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNetworkStream=void 0;var n=t(1),i=t(20);const o=200,a=206;function l(m){const v=m.response;return typeof v!="string"?v:(0,n.stringToBytes)(v).buffer}class h{constructor(v,g={}){this.url=v,this.isHttp=/^https?:/i.test(v),this.httpHeaders=this.isHttp&&g.httpHeaders||Object.create(null),this.withCredentials=g.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(v,g,x){const E={begin:v,end:g};for(const b in x)E[b]=x[b];return this.request(E)}requestFull(v){return this.request(v)}request(v){const g=new XMLHttpRequest,x=this.currXhrId++,E=this.pendingRequests[x]={xhr:g};g.open("GET",this.url),g.withCredentials=this.withCredentials;for(const b in this.httpHeaders){const _=this.httpHeaders[b];_!==void 0&&g.setRequestHeader(b,_)}return this.isHttp&&"begin"in v&&"end"in v?(g.setRequestHeader("Range",`bytes=${v.begin}-${v.end-1}`),E.expectedStatus=a):E.expectedStatus=o,g.responseType="arraybuffer",v.onError&&(g.onerror=function(b){v.onError(g.status)}),g.onreadystatechange=this.onStateChange.bind(this,x),g.onprogress=this.onProgress.bind(this,x),E.onHeadersReceived=v.onHeadersReceived,E.onDone=v.onDone,E.onError=v.onError,E.onProgress=v.onProgress,g.send(null),x}onProgress(v,g){const x=this.pendingRequests[v];x&&x.onProgress?.(g)}onStateChange(v,g){const x=this.pendingRequests[v];if(!x)return;const E=x.xhr;if(E.readyState>=2&&x.onHeadersReceived&&(x.onHeadersReceived(),delete x.onHeadersReceived),E.readyState!==4||!(v in this.pendingRequests))return;if(delete this.pendingRequests[v],E.status===0&&this.isHttp){x.onError?.(E.status);return}const b=E.status||o;if(!(b===o&&x.expectedStatus===a)&&b!==x.expectedStatus){x.onError?.(E.status);return}const S=l(E);if(b===a){const C=E.getResponseHeader("Content-Range"),A=/bytes (\d+)-(\d+)\/(\d+)/.exec(C);x.onDone({begin:parseInt(A[1],10),chunk:S})}else S?x.onDone({begin:0,chunk:S}):x.onError?.(E.status)}getRequestXhr(v){return this.pendingRequests[v].xhr}isPendingRequest(v){return v in this.pendingRequests}abortRequest(v){const g=this.pendingRequests[v].xhr;delete this.pendingRequests[v],g.abort()}}class d{constructor(v){this._source=v,this._manager=new h(v.url,{httpHeaders:v.httpHeaders,withCredentials:v.withCredentials}),this._rangeChunkSize=v.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(v){const g=this._rangeRequestReaders.indexOf(v);g>=0&&this._rangeRequestReaders.splice(g,1)}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new u(this._manager,this._source),this._fullRequestReader}getRangeReader(v,g){const x=new f(this._manager,v,g);return x.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(x),x}cancelAllRequests(v){this._fullRequestReader?.cancel(v);for(const g of this._rangeRequestReaders.slice(0))g.cancel(v)}}e.PDFNetworkStream=d;class u{constructor(v,g){this._manager=v;const x={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=g.url,this._fullRequestId=v.requestFull(x),this._headersReceivedCapability=new n.PromiseCapability,this._disableRange=g.disableRange||!1,this._contentLength=g.length,this._rangeChunkSize=g.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const v=this._fullRequestId,g=this._manager.getRequestXhr(v),x=_=>g.getResponseHeader(_),{allowRangeRequests:E,suggestedLength:b}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:x,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});E&&(this._isRangeSupported=!0),this._contentLength=b||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(x),this._isRangeSupported&&this._manager.abortRequest(v),this._headersReceivedCapability.resolve()}_onDone(v){if(v&&(this._requests.length>0?this._requests.shift().resolve({value:v.chunk,done:!1}):this._cachedChunks.push(v.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(v){this._storedError=(0,i.createResponseStatusError)(v,this._url),this._headersReceivedCapability.reject(this._storedError);for(const g of this._requests)g.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(v){this.onProgress?.({loaded:v.loaded,total:v.lengthComputable?v.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const v=new n.PromiseCapability;return this._requests.push(v),v.promise}cancel(v){this._done=!0,this._headersReceivedCapability.reject(v);for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class f{constructor(v,g,x){this._manager=v;const E={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=v.url,this._requestId=v.requestRange(g,x,E),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(v){const g=v.chunk;this._requests.length>0?this._requests.shift().resolve({value:g,done:!1}):this._queuedChunk=g,this._done=!0;for(const x of this._requests)x.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(v){this._storedError=(0,i.createResponseStatusError)(v,this._url);for(const g of this._requests)g.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(v){this.isStreamingSupported||this.onProgress?.({loaded:v.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const g=this._queuedChunk;return this._queuedChunk=null,{value:g,done:!1}}if(this._done)return{value:void 0,done:!0};const v=new n.PromiseCapability;return this._requests.push(v),v.promise}cancel(v){this._done=!0;for(const g of this._requests)g.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PDFNodeStream=void 0;var n=t(1),i=t(20);const o=/^file:\/\/\/[a-zA-Z]:\//;function a(x){const E=require$$5,b=E.parse(x);return b.protocol==="file:"||b.host?b:/^[a-z]:[/\\]/i.test(x)?E.parse(`file:///${x}`):(b.host||(b.protocol="file:"),b)}class l{constructor(E){this.source=E,this.url=a(E.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&E.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new v(this):new f(this),this._fullRequestReader}getRangeReader(E,b){if(b<=this._progressiveDataLength)return null;const _=this.isFsUrl?new g(this,E,b):new m(this,E,b);return this._rangeRequestReaders.push(_),_}cancelAllRequests(E){this._fullRequestReader?.cancel(E);for(const b of this._rangeRequestReaders.slice(0))b.cancel(E)}}e.PDFNodeStream=l;class h{constructor(E){this._url=E.url,this._done=!1,this._storedError=null,this.onProgress=null;const b=E.source;this._contentLength=b.length,this._loaded=0,this._filename=null,this._disableRange=b.disableRange||!1,this._rangeChunkSize=b.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!b.disableStream,this._isRangeSupported=!b.disableRange,this._readableStream=null,this._readCapability=new n.PromiseCapability,this._headersCapability=new n.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const E=this._readableStream.read();return E===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=E.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(E).buffer,done:!1})}cancel(E){if(!this._readableStream){this._error(E);return}this._readableStream.destroy(E)}_error(E){this._storedError=E,this._readCapability.resolve()}_setReadableStream(E){this._readableStream=E,E.on("readable",()=>{this._readCapability.resolve()}),E.on("end",()=>{E.destroy(),this._done=!0,this._readCapability.resolve()}),E.on("error",b=>{this._error(b)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new n.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class d{constructor(E){this._url=E.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new n.PromiseCapability;const b=E.source;this._isStreamingSupported=!b.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const E=this._readableStream.read();return E===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=E.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(E).buffer,done:!1})}cancel(E){if(!this._readableStream){this._error(E);return}this._readableStream.destroy(E)}_error(E){this._storedError=E,this._readCapability.resolve()}_setReadableStream(E){this._readableStream=E,E.on("readable",()=>{this._readCapability.resolve()}),E.on("end",()=>{E.destroy(),this._done=!0,this._readCapability.resolve()}),E.on("error",b=>{this._error(b)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function u(x,E){return{protocol:x.protocol,auth:x.auth,host:x.hostname,port:x.port,path:x.path,method:"GET",headers:E}}class f extends h{constructor(E){super(E);const b=_=>{if(_.statusCode===404){const R=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=R,this._headersCapability.reject(R);return}this._headersCapability.resolve(),this._setReadableStream(_);const S=R=>this._readableStream.headers[R.toLowerCase()],{allowRangeRequests:C,suggestedLength:A}=(0,i.validateRangeRequestCapabilities)({getResponseHeader:S,isHttp:E.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=C,this._contentLength=A||this._contentLength,this._filename=(0,i.extractFilenameFromHeader)(S)};if(this._request=null,this._url.protocol==="http:"){const _=require$$5;this._request=_.request(u(this._url,E.httpHeaders),b)}else{const _=require$$5;this._request=_.request(u(this._url,E.httpHeaders),b)}this._request.on("error",_=>{this._storedError=_,this._headersCapability.reject(_)}),this._request.end()}}class m extends d{constructor(E,b,_){super(E),this._httpHeaders={};for(const C in E.httpHeaders){const A=E.httpHeaders[C];A!==void 0&&(this._httpHeaders[C]=A)}this._httpHeaders.Range=`bytes=${b}-${_-1}`;const S=C=>{if(C.statusCode===404){const A=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=A;return}this._setReadableStream(C)};if(this._request=null,this._url.protocol==="http:"){const C=require$$5;this._request=C.request(u(this._url,this._httpHeaders),S)}else{const C=require$$5;this._request=C.request(u(this._url,this._httpHeaders),S)}this._request.on("error",C=>{this._storedError=C}),this._request.end()}}class v extends h{constructor(E){super(E);let b=decodeURIComponent(this._url.path);o.test(this._url.href)&&(b=b.replace(/^\//,""));const _=require$$5;_.lstat(b,(S,C)=>{if(S){S.code==="ENOENT"&&(S=new n.MissingPDFException(`Missing PDF "${b}".`)),this._storedError=S,this._headersCapability.reject(S);return}this._contentLength=C.size,this._setReadableStream(_.createReadStream(b)),this._headersCapability.resolve()})}}class g extends d{constructor(E,b,_){super(E);let S=decodeURIComponent(this._url.path);o.test(this._url.href)&&(S=S.replace(/^\//,""));const C=require$$5;this._setReadableStream(C.createReadStream(S,{start:b,end:_-1}))}}}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SVGGraphics=void 0;var n=t(6),i=t(1);const o={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},a="http://www.w3.org/XML/1998/namespace",l="http://www.w3.org/1999/xlink",h=["butt","round","square"],d=["miter","round","bevel"],u=function(C,A="",R=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!R)return URL.createObjectURL(new Blob([C],{type:A}));const L="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let j=`data:${A};base64,`;for(let F=0,W=C.length;F<W;F+=3){const K=C[F]&255,ee=C[F+1]&255,te=C[F+2]&255,re=K>>2,ie=(K&3)<<4|ee>>4,Q=F+1<W?(ee&15)<<2|te>>6:64,z=F+2<W?te&63:64;j+=L[re]+L[ie]+L[Q]+L[z]}return j},f=(function(){const C=new Uint8Array([137,80,78,71,13,10,26,10]),A=12,R=new Int32Array(256);for(let te=0;te<256;te++){let re=te;for(let ie=0;ie<8;ie++)re=re&1?3988292384^re>>1&2147483647:re>>1&2147483647;R[te]=re}function L(te,re,ie){let Q=-1;for(let z=re;z<ie;z++){const N=(Q^te[z])&255,k=R[N];Q=Q>>>8^k}return Q^-1}function j(te,re,ie,Q){let z=Q;const N=re.length;ie[z]=N>>24&255,ie[z+1]=N>>16&255,ie[z+2]=N>>8&255,ie[z+3]=N&255,z+=4,ie[z]=te.charCodeAt(0)&255,ie[z+1]=te.charCodeAt(1)&255,ie[z+2]=te.charCodeAt(2)&255,ie[z+3]=te.charCodeAt(3)&255,z+=4,ie.set(re,z),z+=re.length;const k=L(ie,Q+4,z);ie[z]=k>>24&255,ie[z+1]=k>>16&255,ie[z+2]=k>>8&255,ie[z+3]=k&255}function F(te,re,ie){let Q=1,z=0;for(let N=re;N<ie;++N)Q=(Q+(te[N]&255))%65521,z=(z+Q)%65521;return z<<16|Q}function W(te){if(!i.isNodeJS)return K(te);try{const re=parseInt(process.versions.node)>=8?te:Buffer.from(te),ie=require$$5.deflateSync(re,{level:9});return ie instanceof Uint8Array?ie:new Uint8Array(ie)}catch(re){(0,i.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+re)}return K(te)}function K(te){let re=te.length;const ie=65535,Q=Math.ceil(re/ie),z=new Uint8Array(2+re+Q*5+4);let N=0;z[N++]=120,z[N++]=156;let k=0;for(;re>ie;)z[N++]=0,z[N++]=255,z[N++]=255,z[N++]=0,z[N++]=0,z.set(te.subarray(k,k+ie),N),N+=ie,k+=ie,re-=ie;z[N++]=1,z[N++]=re&255,z[N++]=re>>8&255,z[N++]=~re&65535&255,z[N++]=(~re&65535)>>8&255,z.set(te.subarray(k),N),N+=te.length-k;const I=F(te,0,te.length);return z[N++]=I>>24&255,z[N++]=I>>16&255,z[N++]=I>>8&255,z[N++]=I&255,z}function ee(te,re,ie,Q){const z=te.width,N=te.height;let k,I,D;const U=te.data;switch(re){case i.ImageKind.GRAYSCALE_1BPP:I=0,k=1,D=z+7>>3;break;case i.ImageKind.RGB_24BPP:I=2,k=8,D=z*3;break;case i.ImageKind.RGBA_32BPP:I=6,k=8,D=z*4;break;default:throw new Error("invalid format")}const $=new Uint8Array((1+D)*N);let q=0,V=0;for(let J=0;J<N;++J)$[q++]=0,$.set(U.subarray(V,V+D),q),V+=D,q+=D;if(re===i.ImageKind.GRAYSCALE_1BPP&&Q){q=0;for(let J=0;J<N;J++){q++;for(let Z=0;Z<D;Z++)$[q++]^=255}}const P=new Uint8Array([z>>24&255,z>>16&255,z>>8&255,z&255,N>>24&255,N>>16&255,N>>8&255,N&255,k,I,0,0,0]),O=W($),B=C.length+A*3+P.length+O.length,G=new Uint8Array(B);let Y=0;return G.set(C,Y),Y+=C.length,j("IHDR",P,G,Y),Y+=A+P.length,j("IDATA",O,G,Y),Y+=A+O.length,j("IEND",new Uint8Array(0),G,Y),u(G,"image/png",ie)}return function(re,ie,Q){const z=re.kind===void 0?i.ImageKind.GRAYSCALE_1BPP:re.kind;return ee(re,z,ie,Q)}})();class m{constructor(){this.fontSizeScale=1,this.fontWeight=o.fontWeight,this.fontSize=0,this.textMatrix=i.IDENTITY_MATRIX,this.fontMatrix=i.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=i.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=o.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(A,R){this.x=A,this.y=R}}function v(C){let A=[];const R=[];for(const L of C){if(L.fn==="save"){A.push({fnId:92,fn:"group",items:[]}),R.push(A),A=A.at(-1).items;continue}L.fn==="restore"?A=R.pop():A.push(L)}return A}function g(C){if(Number.isInteger(C))return C.toString();const A=C.toFixed(10);let R=A.length-1;if(A[R]!=="0")return A;do R--;while(A[R]==="0");return A.substring(0,A[R]==="."?R:R+1)}function x(C){if(C[4]===0&&C[5]===0){if(C[1]===0&&C[2]===0)return C[0]===1&&C[3]===1?"":`scale(${g(C[0])} ${g(C[3])})`;if(C[0]===C[3]&&C[1]===-C[2]){const A=Math.acos(C[0])*180/Math.PI;return`rotate(${g(A)})`}}else if(C[0]===1&&C[1]===0&&C[2]===0&&C[3]===1)return`translate(${g(C[4])} ${g(C[5])})`;return`matrix(${g(C[0])} ${g(C[1])} ${g(C[2])} ${g(C[3])} ${g(C[4])} ${g(C[5])})`}let E=0,b=0,_=0;class S{constructor(A,R,L=!1){(0,n.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new n.DOMSVGFactory,this.current=new m,this.transformMatrix=i.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=A,this.objs=R,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!L,this._operatorIdMapping=[];for(const j in i.OPS)this._operatorIdMapping[i.OPS[j]]=j}getObject(A,R=null){return typeof A=="string"?A.startsWith("g_")?this.commonObjs.get(A):this.objs.get(A):R}save(){this.transformStack.push(this.transformMatrix);const A=this.current;this.extraStack.push(A),this.current=A.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(A){this.save(),this.executeOpTree(A),this.restore()}loadDependencies(A){const R=A.fnArray,L=A.argsArray;for(let j=0,F=R.length;j<F;j++)if(R[j]===i.OPS.dependency)for(const W of L[j]){const K=W.startsWith("g_")?this.commonObjs:this.objs,ee=new Promise(te=>{K.get(W,te)});this.current.dependencies.push(ee)}return Promise.all(this.current.dependencies)}transform(A,R,L,j,F,W){const K=[A,R,L,j,F,W];this.transformMatrix=i.Util.transform(this.transformMatrix,K),this.tgrp=null}getSVG(A,R){this.viewport=R;const L=this._initialize(R);return this.loadDependencies(A).then(()=>(this.transformMatrix=i.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(A)),L))}convertOpList(A){const R=this._operatorIdMapping,L=A.argsArray,j=A.fnArray,F=[];for(let W=0,K=j.length;W<K;W++){const ee=j[W];F.push({fnId:ee,fn:R[ee],args:L[W]})}return v(F)}executeOpTree(A){for(const R of A){const L=R.fn,j=R.fnId,F=R.args;switch(j|0){case i.OPS.beginText:this.beginText();break;case i.OPS.dependency:break;case i.OPS.setLeading:this.setLeading(F);break;case i.OPS.setLeadingMoveText:this.setLeadingMoveText(F[0],F[1]);break;case i.OPS.setFont:this.setFont(F);break;case i.OPS.showText:this.showText(F[0]);break;case i.OPS.showSpacedText:this.showText(F[0]);break;case i.OPS.endText:this.endText();break;case i.OPS.moveText:this.moveText(F[0],F[1]);break;case i.OPS.setCharSpacing:this.setCharSpacing(F[0]);break;case i.OPS.setWordSpacing:this.setWordSpacing(F[0]);break;case i.OPS.setHScale:this.setHScale(F[0]);break;case i.OPS.setTextMatrix:this.setTextMatrix(F[0],F[1],F[2],F[3],F[4],F[5]);break;case i.OPS.setTextRise:this.setTextRise(F[0]);break;case i.OPS.setTextRenderingMode:this.setTextRenderingMode(F[0]);break;case i.OPS.setLineWidth:this.setLineWidth(F[0]);break;case i.OPS.setLineJoin:this.setLineJoin(F[0]);break;case i.OPS.setLineCap:this.setLineCap(F[0]);break;case i.OPS.setMiterLimit:this.setMiterLimit(F[0]);break;case i.OPS.setFillRGBColor:this.setFillRGBColor(F[0],F[1],F[2]);break;case i.OPS.setStrokeRGBColor:this.setStrokeRGBColor(F[0],F[1],F[2]);break;case i.OPS.setStrokeColorN:this.setStrokeColorN(F);break;case i.OPS.setFillColorN:this.setFillColorN(F);break;case i.OPS.shadingFill:this.shadingFill(F[0]);break;case i.OPS.setDash:this.setDash(F[0],F[1]);break;case i.OPS.setRenderingIntent:this.setRenderingIntent(F[0]);break;case i.OPS.setFlatness:this.setFlatness(F[0]);break;case i.OPS.setGState:this.setGState(F[0]);break;case i.OPS.fill:this.fill();break;case i.OPS.eoFill:this.eoFill();break;case i.OPS.stroke:this.stroke();break;case i.OPS.fillStroke:this.fillStroke();break;case i.OPS.eoFillStroke:this.eoFillStroke();break;case i.OPS.clip:this.clip("nonzero");break;case i.OPS.eoClip:this.clip("evenodd");break;case i.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case i.OPS.paintImageXObject:this.paintImageXObject(F[0]);break;case i.OPS.paintInlineImageXObject:this.paintInlineImageXObject(F[0]);break;case i.OPS.paintImageMaskXObject:this.paintImageMaskXObject(F[0]);break;case i.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(F[0],F[1]);break;case i.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case i.OPS.closePath:this.closePath();break;case i.OPS.closeStroke:this.closeStroke();break;case i.OPS.closeFillStroke:this.closeFillStroke();break;case i.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case i.OPS.nextLine:this.nextLine();break;case i.OPS.transform:this.transform(F[0],F[1],F[2],F[3],F[4],F[5]);break;case i.OPS.constructPath:this.constructPath(F[0],F[1]);break;case i.OPS.endPath:this.endPath();break;case 92:this.group(R.items);break;default:(0,i.warn)(`Unimplemented operator ${L}`);break}}}setWordSpacing(A){this.current.wordSpacing=A}setCharSpacing(A){this.current.charSpacing=A}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(A,R,L,j,F,W){const K=this.current;K.textMatrix=K.lineMatrix=[A,R,L,j,F,W],K.textMatrixScale=Math.hypot(A,R),K.x=K.lineX=0,K.y=K.lineY=0,K.xcoords=[],K.ycoords=[],K.tspan=this.svgFactory.createElement("svg:tspan"),K.tspan.setAttributeNS(null,"font-family",K.fontFamily),K.tspan.setAttributeNS(null,"font-size",`${g(K.fontSize)}px`),K.tspan.setAttributeNS(null,"y",g(-K.y)),K.txtElement=this.svgFactory.createElement("svg:text"),K.txtElement.append(K.tspan)}beginText(){const A=this.current;A.x=A.lineX=0,A.y=A.lineY=0,A.textMatrix=i.IDENTITY_MATRIX,A.lineMatrix=i.IDENTITY_MATRIX,A.textMatrixScale=1,A.tspan=this.svgFactory.createElement("svg:tspan"),A.txtElement=this.svgFactory.createElement("svg:text"),A.txtgrp=this.svgFactory.createElement("svg:g"),A.xcoords=[],A.ycoords=[]}moveText(A,R){const L=this.current;L.x=L.lineX+=A,L.y=L.lineY+=R,L.xcoords=[],L.ycoords=[],L.tspan=this.svgFactory.createElement("svg:tspan"),L.tspan.setAttributeNS(null,"font-family",L.fontFamily),L.tspan.setAttributeNS(null,"font-size",`${g(L.fontSize)}px`),L.tspan.setAttributeNS(null,"y",g(-L.y))}showText(A){const R=this.current,L=R.font,j=R.fontSize;if(j===0)return;const F=R.fontSizeScale,W=R.charSpacing,K=R.wordSpacing,ee=R.fontDirection,te=R.textHScale*ee,re=L.vertical,ie=re?1:-1,Q=L.defaultVMetrics,z=j*R.fontMatrix[0];let N=0;for(const D of A){if(D===null){N+=ee*K;continue}else if(typeof D=="number"){N+=ie*D*j/1e3;continue}const U=(D.isSpace?K:0)+W,$=D.fontChar;let q,V,P=D.width;if(re){let B;const G=D.vmetric||Q;B=D.vmetric?G[1]:P*.5,B=-B*z;const Y=G[2]*z;P=G?-G[0]:P,q=B/F,V=(N+Y)/F}else q=N/F,V=0;(D.isInFont||L.missingFile)&&(R.xcoords.push(R.x+q),re&&R.ycoords.push(-R.y+V),R.tspan.textContent+=$);const O=re?P*z-U*ee:P*z+U*ee;N+=O}R.tspan.setAttributeNS(null,"x",R.xcoords.map(g).join(" ")),re?R.tspan.setAttributeNS(null,"y",R.ycoords.map(g).join(" ")):R.tspan.setAttributeNS(null,"y",g(-R.y)),re?R.y-=N:R.x+=N*te,R.tspan.setAttributeNS(null,"font-family",R.fontFamily),R.tspan.setAttributeNS(null,"font-size",`${g(R.fontSize)}px`),R.fontStyle!==o.fontStyle&&R.tspan.setAttributeNS(null,"font-style",R.fontStyle),R.fontWeight!==o.fontWeight&&R.tspan.setAttributeNS(null,"font-weight",R.fontWeight);const k=R.textRenderingMode&i.TextRenderingMode.FILL_STROKE_MASK;if(k===i.TextRenderingMode.FILL||k===i.TextRenderingMode.FILL_STROKE?(R.fillColor!==o.fillColor&&R.tspan.setAttributeNS(null,"fill",R.fillColor),R.fillAlpha<1&&R.tspan.setAttributeNS(null,"fill-opacity",R.fillAlpha)):R.textRenderingMode===i.TextRenderingMode.ADD_TO_PATH?R.tspan.setAttributeNS(null,"fill","transparent"):R.tspan.setAttributeNS(null,"fill","none"),k===i.TextRenderingMode.STROKE||k===i.TextRenderingMode.FILL_STROKE){const D=1/(R.textMatrixScale||1);this._setStrokeAttributes(R.tspan,D)}let I=R.textMatrix;R.textRise!==0&&(I=I.slice(),I[5]+=R.textRise),R.txtElement.setAttributeNS(null,"transform",`${x(I)} scale(${g(te)}, -1)`),R.txtElement.setAttributeNS(a,"xml:space","preserve"),R.txtElement.append(R.tspan),R.txtgrp.append(R.txtElement),this._ensureTransformGroup().append(R.txtElement)}setLeadingMoveText(A,R){this.setLeading(-R),this.moveText(A,R)}addFontStyle(A){if(!A.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const R=u(A.data,A.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${A.loadedName}"; src: url(${R}); }
`}setFont(A){const R=this.current,L=this.commonObjs.get(A[0]);let j=A[1];R.font=L,this.embedFonts&&!L.missingFile&&!this.embeddedFonts[L.loadedName]&&(this.addFontStyle(L),this.embeddedFonts[L.loadedName]=L),R.fontMatrix=L.fontMatrix||i.FONT_IDENTITY_MATRIX;let F="normal";L.black?F="900":L.bold&&(F="bold");const W=L.italic?"italic":"normal";j<0?(j=-j,R.fontDirection=-1):R.fontDirection=1,R.fontSize=j,R.fontFamily=L.loadedName,R.fontWeight=F,R.fontStyle=W,R.tspan=this.svgFactory.createElement("svg:tspan"),R.tspan.setAttributeNS(null,"y",g(-R.y)),R.xcoords=[],R.ycoords=[]}endText(){const A=this.current;A.textRenderingMode&i.TextRenderingMode.ADD_TO_PATH_FLAG&&A.txtElement?.hasChildNodes()&&(A.element=A.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(A){A>0&&(this.current.lineWidth=A)}setLineCap(A){this.current.lineCap=h[A]}setLineJoin(A){this.current.lineJoin=d[A]}setMiterLimit(A){this.current.miterLimit=A}setStrokeAlpha(A){this.current.strokeAlpha=A}setStrokeRGBColor(A,R,L){this.current.strokeColor=i.Util.makeHexColor(A,R,L)}setFillAlpha(A){this.current.fillAlpha=A}setFillRGBColor(A,R,L){this.current.fillColor=i.Util.makeHexColor(A,R,L),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(A){this.current.strokeColor=this._makeColorN_Pattern(A)}setFillColorN(A){this.current.fillColor=this._makeColorN_Pattern(A)}shadingFill(A){const{width:R,height:L}=this.viewport,j=i.Util.inverseTransform(this.transformMatrix),[F,W,K,ee]=i.Util.getAxialAlignedBoundingBox([0,0,R,L],j),te=this.svgFactory.createElement("svg:rect");te.setAttributeNS(null,"x",F),te.setAttributeNS(null,"y",W),te.setAttributeNS(null,"width",K-F),te.setAttributeNS(null,"height",ee-W),te.setAttributeNS(null,"fill",this._makeShadingPattern(A)),this.current.fillAlpha<1&&te.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(te)}_makeColorN_Pattern(A){return A[0]==="TilingPattern"?this._makeTilingPattern(A):this._makeShadingPattern(A)}_makeTilingPattern(A){const R=A[1],L=A[2],j=A[3]||i.IDENTITY_MATRIX,[F,W,K,ee]=A[4],te=A[5],re=A[6],ie=A[7],Q=`shading${_++}`,[z,N,k,I]=i.Util.normalizeRect([...i.Util.applyTransform([F,W],j),...i.Util.applyTransform([K,ee],j)]),[D,U]=i.Util.singularValueDecompose2dScale(j),$=te*D,q=re*U,V=this.svgFactory.createElement("svg:pattern");V.setAttributeNS(null,"id",Q),V.setAttributeNS(null,"patternUnits","userSpaceOnUse"),V.setAttributeNS(null,"width",$),V.setAttributeNS(null,"height",q),V.setAttributeNS(null,"x",`${z}`),V.setAttributeNS(null,"y",`${N}`);const P=this.svg,O=this.transformMatrix,B=this.current.fillColor,G=this.current.strokeColor,Y=this.svgFactory.create(k-z,I-N);if(this.svg=Y,this.transformMatrix=j,ie===2){const J=i.Util.makeHexColor(...R);this.current.fillColor=J,this.current.strokeColor=J}return this.executeOpTree(this.convertOpList(L)),this.svg=P,this.transformMatrix=O,this.current.fillColor=B,this.current.strokeColor=G,V.append(Y.childNodes[0]),this.defs.append(V),`url(#${Q})`}_makeShadingPattern(A){switch(typeof A=="string"&&(A=this.objs.get(A)),A[0]){case"RadialAxial":const R=`shading${_++}`,L=A[3];let j;switch(A[1]){case"axial":const F=A[4],W=A[5];j=this.svgFactory.createElement("svg:linearGradient"),j.setAttributeNS(null,"id",R),j.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),j.setAttributeNS(null,"x1",F[0]),j.setAttributeNS(null,"y1",F[1]),j.setAttributeNS(null,"x2",W[0]),j.setAttributeNS(null,"y2",W[1]);break;case"radial":const K=A[4],ee=A[5],te=A[6],re=A[7];j=this.svgFactory.createElement("svg:radialGradient"),j.setAttributeNS(null,"id",R),j.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),j.setAttributeNS(null,"cx",ee[0]),j.setAttributeNS(null,"cy",ee[1]),j.setAttributeNS(null,"r",re),j.setAttributeNS(null,"fx",K[0]),j.setAttributeNS(null,"fy",K[1]),j.setAttributeNS(null,"fr",te);break;default:throw new Error(`Unknown RadialAxial type: ${A[1]}`)}for(const F of L){const W=this.svgFactory.createElement("svg:stop");W.setAttributeNS(null,"offset",F[0]),W.setAttributeNS(null,"stop-color",F[1]),j.append(W)}return this.defs.append(j),`url(#${R})`;case"Mesh":return(0,i.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${A[0]}`)}}setDash(A,R){this.current.dashArray=A,this.current.dashPhase=R}constructPath(A,R){const L=this.current;let j=L.x,F=L.y,W=[],K=0;for(const ee of A)switch(ee|0){case i.OPS.rectangle:j=R[K++],F=R[K++];const te=R[K++],re=R[K++],ie=j+te,Q=F+re;W.push("M",g(j),g(F),"L",g(ie),g(F),"L",g(ie),g(Q),"L",g(j),g(Q),"Z");break;case i.OPS.moveTo:j=R[K++],F=R[K++],W.push("M",g(j),g(F));break;case i.OPS.lineTo:j=R[K++],F=R[K++],W.push("L",g(j),g(F));break;case i.OPS.curveTo:j=R[K+4],F=R[K+5],W.push("C",g(R[K]),g(R[K+1]),g(R[K+2]),g(R[K+3]),g(j),g(F)),K+=6;break;case i.OPS.curveTo2:W.push("C",g(j),g(F),g(R[K]),g(R[K+1]),g(R[K+2]),g(R[K+3])),j=R[K+2],F=R[K+3],K+=4;break;case i.OPS.curveTo3:j=R[K+2],F=R[K+3],W.push("C",g(R[K]),g(R[K+1]),g(j),g(F),g(j),g(F)),K+=4;break;case i.OPS.closePath:W.push("Z");break}W=W.join(" "),L.path&&A.length>0&&A[0]!==i.OPS.rectangle&&A[0]!==i.OPS.moveTo?W=L.path.getAttributeNS(null,"d")+W:(L.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(L.path)),L.path.setAttributeNS(null,"d",W),L.path.setAttributeNS(null,"fill","none"),L.element=L.path,L.setCurrentPoint(j,F)}endPath(){const A=this.current;if(A.path=null,!this.pendingClip)return;if(!A.element){this.pendingClip=null;return}const R=`clippath${E++}`,L=this.svgFactory.createElement("svg:clipPath");L.setAttributeNS(null,"id",R),L.setAttributeNS(null,"transform",x(this.transformMatrix));const j=A.element.cloneNode(!0);if(this.pendingClip==="evenodd"?j.setAttributeNS(null,"clip-rule","evenodd"):j.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,L.append(j),this.defs.append(L),A.activeClipUrl){A.clipGroup=null;for(const F of this.extraStack)F.clipGroup=null;L.setAttributeNS(null,"clip-path",A.activeClipUrl)}A.activeClipUrl=`url(#${R})`,this.tgrp=null}clip(A){this.pendingClip=A}closePath(){const A=this.current;if(A.path){const R=`${A.path.getAttributeNS(null,"d")}Z`;A.path.setAttributeNS(null,"d",R)}}setLeading(A){this.current.leading=-A}setTextRise(A){this.current.textRise=A}setTextRenderingMode(A){this.current.textRenderingMode=A}setHScale(A){this.current.textHScale=A/100}setRenderingIntent(A){}setFlatness(A){}setGState(A){for(const[R,L]of A)switch(R){case"LW":this.setLineWidth(L);break;case"LC":this.setLineCap(L);break;case"LJ":this.setLineJoin(L);break;case"ML":this.setMiterLimit(L);break;case"D":this.setDash(L[0],L[1]);break;case"RI":this.setRenderingIntent(L);break;case"FL":this.setFlatness(L);break;case"Font":this.setFont(L);break;case"CA":this.setStrokeAlpha(L);break;case"ca":this.setFillAlpha(L);break;default:(0,i.warn)(`Unimplemented graphic state operator ${R}`);break}}fill(){const A=this.current;A.element&&(A.element.setAttributeNS(null,"fill",A.fillColor),A.element.setAttributeNS(null,"fill-opacity",A.fillAlpha),this.endPath())}stroke(){const A=this.current;A.element&&(this._setStrokeAttributes(A.element),A.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(A,R=1){const L=this.current;let j=L.dashArray;R!==1&&j.length>0&&(j=j.map(function(F){return R*F})),A.setAttributeNS(null,"stroke",L.strokeColor),A.setAttributeNS(null,"stroke-opacity",L.strokeAlpha),A.setAttributeNS(null,"stroke-miterlimit",g(L.miterLimit)),A.setAttributeNS(null,"stroke-linecap",L.lineCap),A.setAttributeNS(null,"stroke-linejoin",L.lineJoin),A.setAttributeNS(null,"stroke-width",g(R*L.lineWidth)+"px"),A.setAttributeNS(null,"stroke-dasharray",j.map(g).join(" ")),A.setAttributeNS(null,"stroke-dashoffset",g(R*L.dashPhase)+"px")}eoFill(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const A=this.svgFactory.createElement("svg:rect");A.setAttributeNS(null,"x","0"),A.setAttributeNS(null,"y","0"),A.setAttributeNS(null,"width","1px"),A.setAttributeNS(null,"height","1px"),A.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(A)}paintImageXObject(A){const R=this.getObject(A);if(!R){(0,i.warn)(`Dependent image with object ID ${A} is not ready yet`);return}this.paintInlineImageXObject(R)}paintInlineImageXObject(A,R){const L=A.width,j=A.height,F=f(A,this.forceDataSchema,!!R),W=this.svgFactory.createElement("svg:rect");W.setAttributeNS(null,"x","0"),W.setAttributeNS(null,"y","0"),W.setAttributeNS(null,"width",g(L)),W.setAttributeNS(null,"height",g(j)),this.current.element=W,this.clip("nonzero");const K=this.svgFactory.createElement("svg:image");K.setAttributeNS(l,"xlink:href",F),K.setAttributeNS(null,"x","0"),K.setAttributeNS(null,"y",g(-j)),K.setAttributeNS(null,"width",g(L)+"px"),K.setAttributeNS(null,"height",g(j)+"px"),K.setAttributeNS(null,"transform",`scale(${g(1/L)} ${g(-1/j)})`),R?R.append(K):this._ensureTransformGroup().append(K)}paintImageMaskXObject(A){const R=this.getObject(A.data,A);if(R.bitmap){(0,i.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const L=this.current,j=R.width,F=R.height,W=L.fillColor;L.maskId=`mask${b++}`;const K=this.svgFactory.createElement("svg:mask");K.setAttributeNS(null,"id",L.maskId);const ee=this.svgFactory.createElement("svg:rect");ee.setAttributeNS(null,"x","0"),ee.setAttributeNS(null,"y","0"),ee.setAttributeNS(null,"width",g(j)),ee.setAttributeNS(null,"height",g(F)),ee.setAttributeNS(null,"fill",W),ee.setAttributeNS(null,"mask",`url(#${L.maskId})`),this.defs.append(K),this._ensureTransformGroup().append(ee),this.paintInlineImageXObject(R,K)}paintFormXObjectBegin(A,R){if(Array.isArray(A)&&A.length===6&&this.transform(A[0],A[1],A[2],A[3],A[4],A[5]),R){const L=R[2]-R[0],j=R[3]-R[1],F=this.svgFactory.createElement("svg:rect");F.setAttributeNS(null,"x",R[0]),F.setAttributeNS(null,"y",R[1]),F.setAttributeNS(null,"width",g(L)),F.setAttributeNS(null,"height",g(j)),this.current.element=F,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(A){const R=this.svgFactory.create(A.width,A.height),L=this.svgFactory.createElement("svg:defs");R.append(L),this.defs=L;const j=this.svgFactory.createElement("svg:g");return j.setAttributeNS(null,"transform",x(A.transform)),R.append(j),this.svg=j,R}_ensureClipGroup(){if(!this.current.clipGroup){const A=this.svgFactory.createElement("svg:g");A.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(A),this.current.clipGroup=A}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",x(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}e.SVGGraphics=S}),((s,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaText=void 0;class t{static textContent(i){const o=[],a={items:o,styles:Object.create(null)};function l(h){if(!h)return;let d=null;const u=h.name;if(u==="#text")d=h.value;else if(t.shouldBuildText(u))h?.attributes?.textContent?d=h.attributes.textContent:h.value&&(d=h.value);else return;if(d!==null&&o.push({str:d}),!!h.children)for(const f of h.children)l(f)}return l(i),a}static shouldBuildText(i){return!(i==="textarea"||i==="input"||i==="option"||i==="select")}}e.XfaText=t}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TextLayerRenderTask=void 0,e.renderTextLayer=x,e.updateTextLayer=E;var n=t(1),i=t(6);const o=1e5,a=30,l=.8,h=new Map;function d(b,_){let S;if(_&&n.FeatureTest.isOffscreenCanvasSupported)S=new OffscreenCanvas(b,b).getContext("2d",{alpha:!1});else{const C=document.createElement("canvas");C.width=C.height=b,S=C.getContext("2d",{alpha:!1})}return S}function u(b,_){const S=h.get(b);if(S)return S;const C=d(a,_);C.font=`${a}px ${b}`;const A=C.measureText("");let R=A.fontBoundingBoxAscent,L=Math.abs(A.fontBoundingBoxDescent);if(R){const F=R/(R+L);return h.set(b,F),C.canvas.width=C.canvas.height=0,F}C.strokeStyle="red",C.clearRect(0,0,a,a),C.strokeText("g",0,0);let j=C.getImageData(0,0,a,a).data;L=0;for(let F=j.length-1-3;F>=0;F-=4)if(j[F]>0){L=Math.ceil(F/4/a);break}C.clearRect(0,0,a,a),C.strokeText("A",0,a),j=C.getImageData(0,0,a,a).data,R=0;for(let F=0,W=j.length;F<W;F+=4)if(j[F]>0){R=a-Math.floor(F/4/a);break}if(C.canvas.width=C.canvas.height=0,R){const F=R/(R+L);return h.set(b,F),F}return h.set(b,l),l}function f(b,_,S){const C=document.createElement("span"),A={angle:0,canvasWidth:0,hasText:_.str!=="",hasEOL:_.hasEOL,fontSize:0};b._textDivs.push(C);const R=n.Util.transform(b._transform,_.transform);let L=Math.atan2(R[1],R[0]);const j=S[_.fontName];j.vertical&&(L+=Math.PI/2);const F=Math.hypot(R[2],R[3]),W=F*u(j.fontFamily,b._isOffscreenCanvasSupported);let K,ee;L===0?(K=R[4],ee=R[5]-W):(K=R[4]+W*Math.sin(L),ee=R[5]-W*Math.cos(L));const te="calc(var(--scale-factor)*",re=C.style;b._container===b._rootContainer?(re.left=`${(100*K/b._pageWidth).toFixed(2)}%`,re.top=`${(100*ee/b._pageHeight).toFixed(2)}%`):(re.left=`${te}${K.toFixed(2)}px)`,re.top=`${te}${ee.toFixed(2)}px)`),re.fontSize=`${te}${F.toFixed(2)}px)`,re.fontFamily=j.fontFamily,A.fontSize=F,C.setAttribute("role","presentation"),C.textContent=_.str,C.dir=_.dir,b._fontInspectorEnabled&&(C.dataset.fontName=_.fontName),L!==0&&(A.angle=L*(180/Math.PI));let ie=!1;if(_.str.length>1)ie=!0;else if(_.str!==" "&&_.transform[0]!==_.transform[3]){const Q=Math.abs(_.transform[0]),z=Math.abs(_.transform[3]);Q!==z&&Math.max(Q,z)/Math.min(Q,z)>1.5&&(ie=!0)}ie&&(A.canvasWidth=j.vertical?_.height:_.width),b._textDivProperties.set(C,A),b._isReadableStream&&b._layoutText(C)}function m(b){const{div:_,scale:S,properties:C,ctx:A,prevFontSize:R,prevFontFamily:L}=b,{style:j}=_;let F="";if(C.canvasWidth!==0&&C.hasText){const{fontFamily:W}=j,{canvasWidth:K,fontSize:ee}=C;(R!==ee||L!==W)&&(A.font=`${ee*S}px ${W}`,b.prevFontSize=ee,b.prevFontFamily=W);const{width:te}=A.measureText(_.textContent);te>0&&(F=`scaleX(${K*S/te})`)}C.angle!==0&&(F=`rotate(${C.angle}deg) ${F}`),F.length>0&&(j.transform=F)}function v(b){if(b._canceled)return;const _=b._textDivs,S=b._capability;if(_.length>o){S.resolve();return}if(!b._isReadableStream)for(const A of _)b._layoutText(A);S.resolve()}class g{constructor({textContentSource:_,container:S,viewport:C,textDivs:A,textDivProperties:R,textContentItemsStr:L,isOffscreenCanvasSupported:j}){this._textContentSource=_,this._isReadableStream=_ instanceof ReadableStream,this._container=this._rootContainer=S,this._textDivs=A||[],this._textContentItemsStr=L||[],this._isOffscreenCanvasSupported=j,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._textDivProperties=R||new WeakMap,this._canceled=!1,this._capability=new n.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:C.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:d(0,j)};const{pageWidth:F,pageHeight:W,pageX:K,pageY:ee}=C.rawDims;this._transform=[1,0,0,-1,-K,ee+W],this._pageWidth=F,this._pageHeight=W,(0,i.setLayerDimensions)(S,C),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new n.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new n.AbortException("TextLayer task cancelled."))}_processItems(_,S){for(const C of _){if(C.str===void 0){if(C.type==="beginMarkedContentProps"||C.type==="beginMarkedContent"){const A=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),C.id!==null&&this._container.setAttribute("id",`${C.id}`),A.append(this._container)}else C.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(C.str),f(this,C,S)}}_layoutText(_){const S=this._layoutTextParams.properties=this._textDivProperties.get(_);if(this._layoutTextParams.div=_,m(this._layoutTextParams),S.hasText&&this._container.append(_),S.hasEOL){const C=document.createElement("br");C.setAttribute("role","presentation"),this._container.append(C)}}_render(){const _=new n.PromiseCapability;let S=Object.create(null);if(this._isReadableStream){const C=()=>{this._reader.read().then(({value:A,done:R})=>{if(R){_.resolve();return}Object.assign(S,A.styles),this._processItems(A.items,S),C()},_.reject)};this._reader=this._textContentSource.getReader(),C()}else if(this._textContentSource){const{items:C,styles:A}=this._textContentSource;this._processItems(C,A),_.resolve()}else throw new Error('No "textContentSource" parameter specified.');_.promise.then(()=>{S=null,v(this)},this._capability.reject)}}e.TextLayerRenderTask=g;function x(b){!b.textContentSource&&(b.textContent||b.textContentStream)&&((0,i.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),b.textContentSource=b.textContent||b.textContentStream);const{container:_,viewport:S}=b,C=getComputedStyle(_),A=C.getPropertyValue("visibility"),R=parseFloat(C.getPropertyValue("--scale-factor"));A==="visible"&&(!R||Math.abs(R-S.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const L=new g(b);return L._render(),L}function E({container:b,viewport:_,textDivs:S,textDivProperties:C,isOffscreenCanvasSupported:A,mustRotate:R=!0,mustRescale:L=!0}){if(R&&(0,i.setLayerDimensions)(b,{rotation:_.rotation}),L){const j=d(0,A),W={prevFontSize:null,prevFontFamily:null,div:null,scale:_.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:j};for(const K of S)W.properties=C.get(K),W.div=K,m(W)}}}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AnnotationEditorLayer=void 0;var n=t(1),i=t(4),o=t(28),a=t(33),l=t(6),h=t(34);class d{#e;#t=!1;#n=null;#r=this.pointerup.bind(this);#s=this.pointerdown.bind(this);#o=new Map;#i=!1;#a=!1;#c=!1;#l;static _initialized=!1;constructor({uiManager:f,pageIndex:m,div:v,accessibilityManager:g,annotationLayer:x,viewport:E,l10n:b}){const _=[o.FreeTextEditor,a.InkEditor,h.StampEditor];if(!d._initialized){d._initialized=!0;for(const S of _)S.initialize(b)}f.registerEditorTypes(_),this.#l=f,this.pageIndex=m,this.div=v,this.#e=g,this.#n=x,this.viewport=E,this.#l.addLayer(this)}get isEmpty(){return this.#o.size===0}updateToolbar(f){this.#l.updateToolbar(f)}updateMode(f=this.#l.getMode()){this.#g(),f===n.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),f!==n.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",f===n.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",f===n.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",f===n.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(f){if(!f&&this.#l.getMode()!==n.AnnotationEditorType.INK)return;if(!f){for(const v of this.#o.values())if(v.isEmpty()){v.setInBackground();return}}this.#d({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(f){this.#l.setEditingState(f)}addCommands(f){this.#l.addCommands(f)}enable(){this.div.style.pointerEvents="auto";const f=new Set;for(const v of this.#o.values())v.enableEditing(),v.annotationElementId&&f.add(v.annotationElementId);if(!this.#n)return;const m=this.#n.getEditableAnnotations();for(const v of m){if(v.hide(),this.#l.isDeletedAnnotationElement(v.data.id)||f.has(v.data.id))continue;const g=this.deserialize(v);g&&(this.addOrRebuild(g),g.enableEditing())}}disable(){this.#c=!0,this.div.style.pointerEvents="none";const f=new Set;for(const m of this.#o.values()){if(m.disableEditing(),!m.annotationElementId||m.serialize()!==null){f.add(m.annotationElementId);continue}this.getEditableAnnotation(m.annotationElementId)?.show(),m.remove()}if(this.#n){const m=this.#n.getEditableAnnotations();for(const v of m){const{id:g}=v.data;f.has(g)||this.#l.isDeletedAnnotationElement(g)||v.show()}}this.#g(),this.isEmpty&&(this.div.hidden=!0),this.#c=!1}getEditableAnnotation(f){return this.#n?.getEditableAnnotation(f)||null}setActiveEditor(f){this.#l.getActive()!==f&&this.#l.setActiveEditor(f)}enableClick(){this.div.addEventListener("pointerdown",this.#s),this.div.addEventListener("pointerup",this.#r)}disableClick(){this.div.removeEventListener("pointerdown",this.#s),this.div.removeEventListener("pointerup",this.#r)}attach(f){this.#o.set(f.id,f);const{annotationElementId:m}=f;m&&this.#l.isDeletedAnnotationElement(m)&&this.#l.removeDeletedAnnotationElement(f)}detach(f){this.#o.delete(f.id),this.#e?.removePointerInTextLayer(f.contentDiv),!this.#c&&f.annotationElementId&&this.#l.addDeletedAnnotationElement(f)}remove(f){this.detach(f),this.#l.removeEditor(f),f.div.contains(document.activeElement)&&setTimeout(()=>{this.#l.focusMainContainer()},0),f.div.remove(),f.isAttachedToDOM=!1,this.#a||this.addInkEditorIfNeeded(!1)}changeParent(f){f.parent!==this&&(f.annotationElementId&&(this.#l.addDeletedAnnotationElement(f.annotationElementId),i.AnnotationEditor.deleteAnnotationElement(f),f.annotationElementId=null),this.attach(f),f.parent?.detach(f),f.setParent(this),f.div&&f.isAttachedToDOM&&(f.div.remove(),this.div.append(f.div)))}add(f){if(this.changeParent(f),this.#l.addEditor(f),this.attach(f),!f.isAttachedToDOM){const m=f.render();this.div.append(m),f.isAttachedToDOM=!0}f.fixAndSetPosition(),f.onceAdded(),this.#l.addToAnnotationStorage(f)}moveEditorInDOM(f){if(!f.isAttachedToDOM)return;const{activeElement:m}=document;f.div.contains(m)&&(f._focusEventsAllowed=!1,setTimeout(()=>{f.div.contains(document.activeElement)?f._focusEventsAllowed=!0:(f.div.addEventListener("focusin",()=>{f._focusEventsAllowed=!0},{once:!0}),m.focus())},0)),f._structTreeParentId=this.#e?.moveElementInDOM(this.div,f.div,f.contentDiv,!0)}addOrRebuild(f){f.needsToBeRebuilt()?f.rebuild():this.add(f)}addUndoableEditor(f){const m=()=>f._uiManager.rebuild(f),v=()=>{f.remove()};this.addCommands({cmd:m,undo:v,mustExec:!1})}getNextId(){return this.#l.getId()}#h(f){switch(this.#l.getMode()){case n.AnnotationEditorType.FREETEXT:return new o.FreeTextEditor(f);case n.AnnotationEditorType.INK:return new a.InkEditor(f);case n.AnnotationEditorType.STAMP:return new h.StampEditor(f)}return null}pasteEditor(f,m){this.#l.updateToolbar(f),this.#l.updateMode(f);const{offsetX:v,offsetY:g}=this.#f(),x=this.getNextId(),E=this.#h({parent:this,id:x,x:v,y:g,uiManager:this.#l,isCentered:!0,...m});E&&this.add(E)}deserialize(f){switch(f.annotationType??f.annotationEditorType){case n.AnnotationEditorType.FREETEXT:return o.FreeTextEditor.deserialize(f,this,this.#l);case n.AnnotationEditorType.INK:return a.InkEditor.deserialize(f,this,this.#l);case n.AnnotationEditorType.STAMP:return h.StampEditor.deserialize(f,this,this.#l)}return null}#d(f,m){const v=this.getNextId(),g=this.#h({parent:this,id:v,x:f.offsetX,y:f.offsetY,uiManager:this.#l,isCentered:m});return g&&this.add(g),g}#f(){const{x:f,y:m,width:v,height:g}=this.div.getBoundingClientRect(),x=Math.max(0,f),E=Math.max(0,m),b=Math.min(window.innerWidth,f+v),_=Math.min(window.innerHeight,m+g),S=(x+b)/2-f,C=(E+_)/2-m,[A,R]=this.viewport.rotation%180===0?[S,C]:[C,S];return{offsetX:A,offsetY:R}}addNewEditor(){this.#d(this.#f(),!0)}setSelected(f){this.#l.setSelected(f)}toggleSelected(f){this.#l.toggleSelected(f)}isSelected(f){return this.#l.isSelected(f)}unselect(f){this.#l.unselect(f)}pointerup(f){const{isMac:m}=n.FeatureTest.platform;if(!(f.button!==0||f.ctrlKey&&m)&&f.target===this.div&&this.#i){if(this.#i=!1,!this.#t){this.#t=!0;return}if(this.#l.getMode()===n.AnnotationEditorType.STAMP){this.#l.unselectAll();return}this.#d(f,!1)}}pointerdown(f){if(this.#i){this.#i=!1;return}const{isMac:m}=n.FeatureTest.platform;if(f.button!==0||f.ctrlKey&&m||f.target!==this.div)return;this.#i=!0;const v=this.#l.getActive();this.#t=!v||v.isEmpty()}findNewParent(f,m,v){const g=this.#l.findParent(m,v);return g===null||g===this?!1:(g.changeParent(f),!0)}destroy(){this.#l.getActive()?.parent===this&&(this.#l.commitOrRemove(),this.#l.setActiveEditor(null));for(const f of this.#o.values())this.#e?.removePointerInTextLayer(f.contentDiv),f.setParent(null),f.isAttachedToDOM=!1,f.div.remove();this.div=null,this.#o.clear(),this.#l.removeLayer(this)}#g(){this.#a=!0;for(const f of this.#o.values())f.isEmpty()&&f.remove();this.#a=!1}render({viewport:f}){this.viewport=f,(0,l.setLayerDimensions)(this.div,f);for(const m of this.#l.getEditors(this.pageIndex))this.add(m);this.updateMode()}update({viewport:f}){this.#l.commitOrRemove(),this.viewport=f,(0,l.setLayerDimensions)(this.div,{rotation:f.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:f,pageHeight:m}=this.viewport.rawDims;return[f,m]}}e.AnnotationEditorLayer=d}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FreeTextEditor=void 0;var n=t(1),i=t(5),o=t(4),a=t(29);class l extends o.AnnotationEditor{#e=this.editorDivBlur.bind(this);#t=this.editorDivFocus.bind(this);#n=this.editorDivInput.bind(this);#r=this.editorDivKeydown.bind(this);#s;#o="";#i=`${this.id}-editor`;#a;#c=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const d=l.prototype,u=v=>v.isEmpty(),f=i.AnnotationEditorUIManager.TRANSLATE_SMALL,m=i.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new i.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],d.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],d.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],d._translateEmpty,{args:[-f,0],checker:u}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],d._translateEmpty,{args:[-m,0],checker:u}],[["ArrowRight","mac+ArrowRight"],d._translateEmpty,{args:[f,0],checker:u}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],d._translateEmpty,{args:[m,0],checker:u}],[["ArrowUp","mac+ArrowUp"],d._translateEmpty,{args:[0,-f],checker:u}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],d._translateEmpty,{args:[0,-m],checker:u}],[["ArrowDown","mac+ArrowDown"],d._translateEmpty,{args:[0,f],checker:u}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],d._translateEmpty,{args:[0,m],checker:u}]]))}static _type="freetext";constructor(d){super({...d,name:"freeTextEditor"}),this.#s=d.color||l._defaultColor||o.AnnotationEditor._defaultLineColor,this.#a=d.fontSize||l._defaultFontSize}static initialize(d){o.AnnotationEditor.initialize(d,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const u=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(u.getPropertyValue("--freetext-padding"))}static updateDefaultParams(d,u){switch(d){case n.AnnotationEditorParamsType.FREETEXT_SIZE:l._defaultFontSize=u;break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:l._defaultColor=u;break}}updateParams(d,u){switch(d){case n.AnnotationEditorParamsType.FREETEXT_SIZE:this.#l(u);break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:this.#h(u);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,l._defaultFontSize],[n.AnnotationEditorParamsType.FREETEXT_COLOR,l._defaultColor||o.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,this.#a],[n.AnnotationEditorParamsType.FREETEXT_COLOR,this.#s]]}#l(d){const u=m=>{this.editorDiv.style.fontSize=`calc(${m}px * var(--scale-factor))`,this.translate(0,-(m-this.#a)*this.parentScale),this.#a=m,this.#f()},f=this.#a;this.addCommands({cmd:()=>{u(d)},undo:()=>{u(f)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#h(d){const u=this.#s;this.addCommands({cmd:()=>{this.#s=this.editorDiv.style.color=d},undo:()=>{this.#s=this.editorDiv.style.color=u},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(d,u){this._uiManager.translateSelectedEditors(d,u,!0)}getInitialTranslation(){const d=this.parentScale;return[-l._internalPadding*d,-(l._internalPadding+this.#a)*d]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(n.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",this.#r),this.editorDiv.addEventListener("focus",this.#t),this.editorDiv.addEventListener("blur",this.#e),this.editorDiv.addEventListener("input",this.#n))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#i),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",this.#r),this.editorDiv.removeEventListener("focus",this.#t),this.editorDiv.removeEventListener("blur",this.#e),this.editorDiv.removeEventListener("input",this.#n),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(d){this._focusEventsAllowed&&(super.focusin(d),d.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){if(this.width){this.#u();return}this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}#d(){const d=this.editorDiv.getElementsByTagName("div");if(d.length===0)return this.editorDiv.innerText;const u=[];for(const f of d)u.push(f.innerText.replace(/\r\n?|\n/,""));return u.join(`
`)}#f(){const[d,u]=this.parentDimensions;let f;if(this.isAttachedToDOM)f=this.div.getBoundingClientRect();else{const{currentLayer:m,div:v}=this,g=v.style.display;v.style.display="hidden",m.div.append(this.div),f=v.getBoundingClientRect(),v.remove(),v.style.display=g}this.rotation%180===this.parentRotation%180?(this.width=f.width/d,this.height=f.height/u):(this.width=f.height/d,this.height=f.width/u),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const d=this.#o,u=this.#o=this.#d().trimEnd();if(d===u)return;const f=m=>{if(this.#o=m,!m){this.remove();return}this.#g(),this._uiManager.rebuild(this),this.#f()};this.addCommands({cmd:()=>{f(u)},undo:()=>{f(d)},mustExec:!1}),this.#f()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(d){this.enterInEditMode()}keydown(d){d.target===this.div&&d.key==="Enter"&&(this.enterInEditMode(),d.preventDefault())}editorDivKeydown(d){l._keyboardManager.exec(this,d)}editorDivFocus(d){this.isEditing=!0}editorDivBlur(d){this.isEditing=!1}editorDivInput(d){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let d,u;this.width&&(d=this.x,u=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#i),this.enableEditing(),o.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(m=>this.editorDiv?.setAttribute("aria-label",m)),o.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(m=>this.editorDiv?.setAttribute("default-content",m)),this.editorDiv.contentEditable=!0;const{style:f}=this.editorDiv;if(f.fontSize=`calc(${this.#a}px * var(--scale-factor))`,f.color=this.#s,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,i.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[m,v]=this.parentDimensions;if(this.annotationElementId){const{position:g}=this.#c;let[x,E]=this.getInitialTranslation();[x,E]=this.pageTranslationToScreen(x,E);const[b,_]=this.pageDimensions,[S,C]=this.pageTranslation;let A,R;switch(this.rotation){case 0:A=d+(g[0]-S)/b,R=u+this.height-(g[1]-C)/_;break;case 90:A=d+(g[0]-S)/b,R=u-(g[1]-C)/_,[x,E]=[E,-x];break;case 180:A=d-this.width+(g[0]-S)/b,R=u-(g[1]-C)/_,[x,E]=[-x,-E];break;case 270:A=d+(g[0]-S-this.height*_)/b,R=u+(g[1]-C-this.width*b)/_,[x,E]=[-E,x];break}this.setAt(A*m,R*v,x,E)}else this.setAt(d*m,u*v,this.width*m,this.height*v);this.#g(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}#g(){if(this.editorDiv.replaceChildren(),!!this.#o)for(const d of this.#o.split(`
`)){const u=document.createElement("div");u.append(d?document.createTextNode(d):document.createElement("br")),this.editorDiv.append(u)}}get contentDiv(){return this.editorDiv}static deserialize(d,u,f){let m=null;if(d instanceof a.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:g,fontColor:x},rect:E,rotation:b,id:_},textContent:S,textPosition:C,parent:{page:{pageNumber:A}}}=d;if(!S||S.length===0)return null;m=d={annotationType:n.AnnotationEditorType.FREETEXT,color:Array.from(x),fontSize:g,value:S.join(`
`),position:C,pageIndex:A-1,rect:E,rotation:b,id:_,deleted:!1}}const v=super.deserialize(d,u,f);return v.#a=d.fontSize,v.#s=n.Util.makeHexColor(...d.color),v.#o=d.value,v.annotationElementId=d.id||null,v.#c=m,v}serialize(d=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const u=l._internalPadding*this.parentScale,f=this.getRect(u,u),m=o.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#s),v={annotationType:n.AnnotationEditorType.FREETEXT,color:m,fontSize:this.#a,value:this.#o,pageIndex:this.pageIndex,rect:f,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return d?v:this.annotationElementId&&!this.#m(v)?null:(v.id=this.annotationElementId,v)}#m(d){const{value:u,fontSize:f,color:m,rect:v,pageIndex:g}=this.#c;return d.value!==u||d.fontSize!==f||d.rect.some((x,E)=>Math.abs(x-v[E])>=1)||d.color.some((x,E)=>x!==m[E])||d.pageIndex!==g}#u(d=!1){if(!this.annotationElementId)return;if(this.#f(),!d&&(this.width===0||this.height===0)){setTimeout(()=>this.#u(!0),0);return}const u=l._internalPadding*this.parentScale;this.#c.rect=this.getRect(u,u)}}e.FreeTextEditor=l}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.StampAnnotationElement=e.InkAnnotationElement=e.FreeTextAnnotationElement=e.AnnotationLayer=void 0;var n=t(1),i=t(6),o=t(3),a=t(30),l=t(31),h=t(32);const d=1e3,u=9,f=new WeakSet;function m(V){return{width:V[2]-V[0],height:V[3]-V[1]}}class v{static create(P){switch(P.data.annotationType){case n.AnnotationType.LINK:return new x(P);case n.AnnotationType.TEXT:return new E(P);case n.AnnotationType.WIDGET:switch(P.data.fieldType){case"Tx":return new _(P);case"Btn":return P.data.radioButton?new A(P):P.data.checkBox?new C(P):new R(P);case"Ch":return new L(P);case"Sig":return new S(P)}return new b(P);case n.AnnotationType.POPUP:return new j(P);case n.AnnotationType.FREETEXT:return new W(P);case n.AnnotationType.LINE:return new K(P);case n.AnnotationType.SQUARE:return new ee(P);case n.AnnotationType.CIRCLE:return new te(P);case n.AnnotationType.POLYLINE:return new re(P);case n.AnnotationType.CARET:return new Q(P);case n.AnnotationType.INK:return new z(P);case n.AnnotationType.POLYGON:return new ie(P);case n.AnnotationType.HIGHLIGHT:return new N(P);case n.AnnotationType.UNDERLINE:return new k(P);case n.AnnotationType.SQUIGGLY:return new I(P);case n.AnnotationType.STRIKEOUT:return new D(P);case n.AnnotationType.STAMP:return new U(P);case n.AnnotationType.FILEATTACHMENT:return new $(P);default:return new g(P)}}}class g{#e=!1;constructor(P,{isRenderable:O=!1,ignoreBorder:B=!1,createQuadrilaterals:G=!1}={}){this.isRenderable=O,this.data=P.data,this.layer=P.layer,this.linkService=P.linkService,this.downloadManager=P.downloadManager,this.imageResourcesPath=P.imageResourcesPath,this.renderForms=P.renderForms,this.svgFactory=P.svgFactory,this.annotationStorage=P.annotationStorage,this.enableScripting=P.enableScripting,this.hasJSActions=P.hasJSActions,this._fieldObjects=P.fieldObjects,this.parent=P.parent,O&&(this.container=this._createContainer(B)),G&&this._createQuadrilaterals()}static _hasPopupData({titleObj:P,contentsObj:O,richText:B}){return!!(P?.str||O?.str||B?.str)}get hasPopupData(){return g._hasPopupData(this.data)}_createContainer(P){const{data:O,parent:{page:B,viewport:G}}=this,Y=document.createElement("section");Y.setAttribute("data-annotation-id",O.id),this instanceof b||(Y.tabIndex=d),Y.style.zIndex=this.parent.zIndex++,this.data.popupRef&&Y.setAttribute("aria-haspopup","dialog"),O.noRotate&&Y.classList.add("norotate");const{pageWidth:J,pageHeight:Z,pageX:oe,pageY:ve}=G.rawDims;if(!O.rect||this instanceof j){const{rotation:ye}=O;return!O.hasOwnCanvas&&ye!==0&&this.setRotation(ye,Y),Y}const{width:ce,height:ue}=m(O.rect),de=n.Util.normalizeRect([O.rect[0],B.view[3]-O.rect[1]+B.view[1],O.rect[2],B.view[3]-O.rect[3]+B.view[1]]);if(!P&&O.borderStyle.width>0){Y.style.borderWidth=`${O.borderStyle.width}px`;const ye=O.borderStyle.horizontalCornerRadius,Ae=O.borderStyle.verticalCornerRadius;if(ye>0||Ae>0){const Pe=`calc(${ye}px * var(--scale-factor)) / calc(${Ae}px * var(--scale-factor))`;Y.style.borderRadius=Pe}else if(this instanceof A){const Pe=`calc(${ce}px * var(--scale-factor)) / calc(${ue}px * var(--scale-factor))`;Y.style.borderRadius=Pe}switch(O.borderStyle.style){case n.AnnotationBorderStyleType.SOLID:Y.style.borderStyle="solid";break;case n.AnnotationBorderStyleType.DASHED:Y.style.borderStyle="dashed";break;case n.AnnotationBorderStyleType.BEVELED:(0,n.warn)("Unimplemented border style: beveled");break;case n.AnnotationBorderStyleType.INSET:(0,n.warn)("Unimplemented border style: inset");break;case n.AnnotationBorderStyleType.UNDERLINE:Y.style.borderBottomStyle="solid";break}const Ce=O.borderColor||null;Ce?(this.#e=!0,Y.style.borderColor=n.Util.makeHexColor(Ce[0]|0,Ce[1]|0,Ce[2]|0)):Y.style.borderWidth=0}Y.style.left=`${100*(de[0]-oe)/J}%`,Y.style.top=`${100*(de[1]-ve)/Z}%`;const{rotation:pe}=O;return O.hasOwnCanvas||pe===0?(Y.style.width=`${100*ce/J}%`,Y.style.height=`${100*ue/Z}%`):this.setRotation(pe,Y),Y}setRotation(P,O=this.container){if(!this.data.rect)return;const{pageWidth:B,pageHeight:G}=this.parent.viewport.rawDims,{width:Y,height:J}=m(this.data.rect);let Z,oe;P%180===0?(Z=100*Y/B,oe=100*J/G):(Z=100*J/B,oe=100*Y/G),O.style.width=`${Z}%`,O.style.height=`${oe}%`,O.setAttribute("data-main-rotation",(360-P)%360)}get _commonActions(){const P=(O,B,G)=>{const Y=G.detail[O],J=Y[0],Z=Y.slice(1);G.target.style[B]=a.ColorConverters[`${J}_HTML`](Z),this.annotationStorage.setValue(this.data.id,{[B]:a.ColorConverters[`${J}_rgb`](Z)})};return(0,n.shadow)(this,"_commonActions",{display:O=>{const{display:B}=O.detail,G=B%2===1;this.container.style.visibility=G?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:G,noPrint:B===1||B===2})},print:O=>{this.annotationStorage.setValue(this.data.id,{noPrint:!O.detail.print})},hidden:O=>{const{hidden:B}=O.detail;this.container.style.visibility=B?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:B,noView:B})},focus:O=>{setTimeout(()=>O.target.focus({preventScroll:!1}),0)},userName:O=>{O.target.title=O.detail.userName},readonly:O=>{O.target.disabled=O.detail.readonly},required:O=>{this._setRequired(O.target,O.detail.required)},bgColor:O=>{P("bgColor","backgroundColor",O)},fillColor:O=>{P("fillColor","backgroundColor",O)},fgColor:O=>{P("fgColor","color",O)},textColor:O=>{P("textColor","color",O)},borderColor:O=>{P("borderColor","borderColor",O)},strokeColor:O=>{P("strokeColor","borderColor",O)},rotation:O=>{const B=O.detail.rotation;this.setRotation(B),this.annotationStorage.setValue(this.data.id,{rotation:B})}})}_dispatchEventFromSandbox(P,O){const B=this._commonActions;for(const G of Object.keys(O.detail))(P[G]||B[G])?.(O)}_setDefaultPropertiesFromJS(P){if(!this.enableScripting)return;const O=this.annotationStorage.getRawValue(this.data.id);if(!O)return;const B=this._commonActions;for(const[G,Y]of Object.entries(O)){const J=B[G];if(J){const Z={detail:{[G]:Y},target:P};J(Z),delete O[G]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:P}=this.data;if(!P)return;const[O,B,G,Y]=this.data.rect;if(P.length===1){const[,{x:Ae,y:Ce},{x:Pe,y:Oe}]=P[0];if(G===Ae&&Y===Ce&&O===Pe&&B===Oe)return}const{style:J}=this.container;let Z;if(this.#e){const{borderColor:Ae,borderWidth:Ce}=J;J.borderWidth=0,Z=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Ae}" stroke-width="${Ce}">`],this.container.classList.add("hasBorder")}const oe=G-O,ve=Y-B,{svgFactory:ce}=this,ue=ce.createElement("svg");ue.classList.add("quadrilateralsContainer"),ue.setAttribute("width",0),ue.setAttribute("height",0);const de=ce.createElement("defs");ue.append(de);const pe=ce.createElement("clipPath"),ye=`clippath_${this.data.id}`;pe.setAttribute("id",ye),pe.setAttribute("clipPathUnits","objectBoundingBox"),de.append(pe);for(const[,{x:Ae,y:Ce},{x:Pe,y:Oe}]of P){const xe=ce.createElement("rect"),Te=(Pe-O)/oe,$e=(Y-Ce)/ve,Ue=(Ae-Pe)/oe,qe=(Ce-Oe)/ve;xe.setAttribute("x",Te),xe.setAttribute("y",$e),xe.setAttribute("width",Ue),xe.setAttribute("height",qe),pe.append(xe),Z?.push(`<rect vector-effect="non-scaling-stroke" x="${Te}" y="${$e}" width="${Ue}" height="${qe}"/>`)}this.#e&&(Z.push("</g></svg>')"),J.backgroundImage=Z.join("")),this.container.append(ue),this.container.style.clipPath=`url(#${ye})`}_createPopup(){const{container:P,data:O}=this;P.setAttribute("aria-haspopup","dialog");const B=new j({data:{color:O.color,titleObj:O.titleObj,modificationDate:O.modificationDate,contentsObj:O.contentsObj,richText:O.richText,parentRect:O.rect,borderStyle:0,id:`popup_${O.id}`,rotation:O.rotation},parent:this.parent,elements:[this]});this.parent.div.append(B.render())}render(){(0,n.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(P,O=null){const B=[];if(this._fieldObjects){const G=this._fieldObjects[P];if(G)for(const{page:Y,id:J,exportValues:Z}of G){if(Y===-1||J===O)continue;const oe=typeof Z=="string"?Z:null,ve=document.querySelector(`[data-element-id="${J}"]`);if(ve&&!f.has(ve)){(0,n.warn)(`_getElementsByName - element not allowed: ${J}`);continue}B.push({id:J,exportValue:oe,domElement:ve})}return B}for(const G of document.getElementsByName(P)){const{exportValue:Y}=G,J=G.getAttribute("data-element-id");J!==O&&f.has(G)&&B.push({id:J,exportValue:Y,domElement:G})}return B}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const P=this.getElementsToTriggerPopup();if(Array.isArray(P))for(const O of P)O.classList.add("highlightArea");else P.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:P,data:{id:O}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:P,editId:O})})}}class x extends g{constructor(P,O=null){super(P,{isRenderable:!0,ignoreBorder:!!O?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=P.data.isTooltipOnly}render(){const{data:P,linkService:O}=this,B=document.createElement("a");B.setAttribute("data-element-id",P.id);let G=!1;return P.url?(O.addLinkAttributes(B,P.url,P.newWindow),G=!0):P.action?(this._bindNamedAction(B,P.action),G=!0):P.attachment?(this._bindAttachment(B,P.attachment),G=!0):P.setOCGState?(this.#t(B,P.setOCGState),G=!0):P.dest?(this._bindLink(B,P.dest),G=!0):(P.actions&&(P.actions.Action||P.actions["Mouse Up"]||P.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(B,P),G=!0),P.resetForm?(this._bindResetFormAction(B,P.resetForm),G=!0):this.isTooltipOnly&&!G&&(this._bindLink(B,""),G=!0)),this.container.classList.add("linkAnnotation"),G&&this.container.append(B),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(P,O){P.href=this.linkService.getDestinationHash(O),P.onclick=()=>(O&&this.linkService.goToDestination(O),!1),(O||O==="")&&this.#e()}_bindNamedAction(P,O){P.href=this.linkService.getAnchorUrl(""),P.onclick=()=>(this.linkService.executeNamedAction(O),!1),this.#e()}_bindAttachment(P,O){P.href=this.linkService.getAnchorUrl(""),P.onclick=()=>(this.downloadManager?.openOrDownloadData(this.container,O.content,O.filename),!1),this.#e()}#t(P,O){P.href=this.linkService.getAnchorUrl(""),P.onclick=()=>(this.linkService.executeSetOCGState(O),!1),this.#e()}_bindJSAction(P,O){P.href=this.linkService.getAnchorUrl("");const B=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const G of Object.keys(O.actions)){const Y=B.get(G);Y&&(P[Y]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:O.id,name:G}}),!1))}P.onclick||(P.onclick=()=>!1),this.#e()}_bindResetFormAction(P,O){const B=P.onclick;if(B||(P.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){(0,n.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),B||(P.onclick=()=>!1);return}P.onclick=()=>{B?.();const{fields:G,refs:Y,include:J}=O,Z=[];if(G.length!==0||Y.length!==0){const ce=new Set(Y);for(const ue of G){const de=this._fieldObjects[ue]||[];for(const{id:pe}of de)ce.add(pe)}for(const ue of Object.values(this._fieldObjects))for(const de of ue)ce.has(de.id)===J&&Z.push(de)}else for(const ce of Object.values(this._fieldObjects))Z.push(...ce);const oe=this.annotationStorage,ve=[];for(const ce of Z){const{id:ue}=ce;switch(ve.push(ue),ce.type){case"text":{const pe=ce.defaultValue||"";oe.setValue(ue,{value:pe});break}case"checkbox":case"radiobutton":{const pe=ce.defaultValue===ce.exportValues;oe.setValue(ue,{value:pe});break}case"combobox":case"listbox":{const pe=ce.defaultValue||"";oe.setValue(ue,{value:pe});break}default:continue}const de=document.querySelector(`[data-element-id="${ue}"]`);if(de){if(!f.has(de)){(0,n.warn)(`_bindResetFormAction - element not allowed: ${ue}`);continue}}else continue;de.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:ve,name:"ResetForm"}}),!1}}}class E extends g{constructor(P){super(P,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const P=document.createElement("img");return P.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",P.alt="[{{type}} Annotation]",P.dataset.l10nId="text_annotation_type",P.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(P),this.container}}class b extends g{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(P){this.data.hasOwnCanvas&&(P.previousSibling?.nodeName==="CANVAS"&&(P.previousSibling.hidden=!0),P.hidden=!1)}_getKeyModifier(P){const{isWin:O,isMac:B}=n.FeatureTest.platform;return O&&P.ctrlKey||B&&P.metaKey}_setEventListener(P,O,B,G,Y){B.includes("mouse")?P.addEventListener(B,J=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:G,value:Y(J),shift:J.shiftKey,modifier:this._getKeyModifier(J)}})}):P.addEventListener(B,J=>{if(B==="blur"){if(!O.focused||!J.relatedTarget)return;O.focused=!1}else if(B==="focus"){if(O.focused)return;O.focused=!0}Y&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:G,value:Y(J)}})})}_setEventListeners(P,O,B,G){for(const[Y,J]of B)(J==="Action"||this.data.actions?.[J])&&((J==="Focus"||J==="Blur")&&(O||={focused:!1}),this._setEventListener(P,O,Y,J,G),J==="Focus"&&!this.data.actions?.Blur?this._setEventListener(P,O,"blur","Blur",null):J==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(P,O,"focus","Focus",null))}_setBackgroundColor(P){const O=this.data.backgroundColor||null;P.style.backgroundColor=O===null?"transparent":n.Util.makeHexColor(O[0],O[1],O[2])}_setTextStyle(P){const O=["left","center","right"],{fontColor:B}=this.data.defaultAppearanceData,G=this.data.defaultAppearanceData.fontSize||u,Y=P.style;let J;const Z=2,oe=ve=>Math.round(10*ve)/10;if(this.data.multiLine){const ve=Math.abs(this.data.rect[3]-this.data.rect[1]-Z),ce=Math.round(ve/(n.LINE_FACTOR*G))||1,ue=ve/ce;J=Math.min(G,oe(ue/n.LINE_FACTOR))}else{const ve=Math.abs(this.data.rect[3]-this.data.rect[1]-Z);J=Math.min(G,oe(ve/n.LINE_FACTOR))}Y.fontSize=`calc(${J}px * var(--scale-factor))`,Y.color=n.Util.makeHexColor(B[0],B[1],B[2]),this.data.textAlignment!==null&&(Y.textAlign=O[this.data.textAlignment])}_setRequired(P,O){O?P.setAttribute("required",!0):P.removeAttribute("required"),P.setAttribute("aria-required",O)}}class _ extends b{constructor(P){const O=P.renderForms||!P.data.hasAppearance&&!!P.data.fieldValue;super(P,{isRenderable:O})}setPropertyOnSiblings(P,O,B,G){const Y=this.annotationStorage;for(const J of this._getElementsByName(P.name,P.id))J.domElement&&(J.domElement[O]=B),Y.setValue(J.id,{[G]:B})}render(){const P=this.annotationStorage,O=this.data.id;this.container.classList.add("textWidgetAnnotation");let B=null;if(this.renderForms){const G=P.getValue(O,{value:this.data.fieldValue});let Y=G.value||"";const J=P.getValue(O,{charLimit:this.data.maxLen}).charLimit;J&&Y.length>J&&(Y=Y.slice(0,J));let Z=G.formattedValue||this.data.textContent?.join(`
`)||null;Z&&this.data.comb&&(Z=Z.replaceAll(/\s+/g,""));const oe={userValue:Y,formattedValue:Z,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(B=document.createElement("textarea"),B.textContent=Z??Y,this.data.doNotScroll&&(B.style.overflowY="hidden")):(B=document.createElement("input"),B.type="text",B.setAttribute("value",Z??Y),this.data.doNotScroll&&(B.style.overflowX="hidden")),this.data.hasOwnCanvas&&(B.hidden=!0),f.add(B),B.setAttribute("data-element-id",O),B.disabled=this.data.readOnly,B.name=this.data.fieldName,B.tabIndex=d,this._setRequired(B,this.data.required),J&&(B.maxLength=J),B.addEventListener("input",ce=>{P.setValue(O,{value:ce.target.value}),this.setPropertyOnSiblings(B,"value",ce.target.value,"value"),oe.formattedValue=null}),B.addEventListener("resetform",ce=>{const ue=this.data.defaultFieldValue??"";B.value=oe.userValue=ue,oe.formattedValue=null});let ve=ce=>{const{formattedValue:ue}=oe;ue!=null&&(ce.target.value=ue),ce.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){B.addEventListener("focus",ue=>{if(oe.focused)return;const{target:de}=ue;oe.userValue&&(de.value=oe.userValue),oe.lastCommittedValue=de.value,oe.commitKey=1,oe.focused=!0}),B.addEventListener("updatefromsandbox",ue=>{this.showElementAndHideCanvas(ue.target);const de={value(pe){oe.userValue=pe.detail.value??"",P.setValue(O,{value:oe.userValue.toString()}),pe.target.value=oe.userValue},formattedValue(pe){const{formattedValue:ye}=pe.detail;oe.formattedValue=ye,ye!=null&&pe.target!==document.activeElement&&(pe.target.value=ye),P.setValue(O,{formattedValue:ye})},selRange(pe){pe.target.setSelectionRange(...pe.detail.selRange)},charLimit:pe=>{const{charLimit:ye}=pe.detail,{target:Ae}=pe;if(ye===0){Ae.removeAttribute("maxLength");return}Ae.setAttribute("maxLength",ye);let Ce=oe.userValue;!Ce||Ce.length<=ye||(Ce=Ce.slice(0,ye),Ae.value=oe.userValue=Ce,P.setValue(O,{value:Ce}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:O,name:"Keystroke",value:Ce,willCommit:!0,commitKey:1,selStart:Ae.selectionStart,selEnd:Ae.selectionEnd}}))}};this._dispatchEventFromSandbox(de,ue)}),B.addEventListener("keydown",ue=>{oe.commitKey=1;let de=-1;if(ue.key==="Escape"?de=0:ue.key==="Enter"&&!this.data.multiLine?de=2:ue.key==="Tab"&&(oe.commitKey=3),de===-1)return;const{value:pe}=ue.target;oe.lastCommittedValue!==pe&&(oe.lastCommittedValue=pe,oe.userValue=pe,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:O,name:"Keystroke",value:pe,willCommit:!0,commitKey:de,selStart:ue.target.selectionStart,selEnd:ue.target.selectionEnd}}))});const ce=ve;ve=null,B.addEventListener("blur",ue=>{if(!oe.focused||!ue.relatedTarget)return;oe.focused=!1;const{value:de}=ue.target;oe.userValue=de,oe.lastCommittedValue!==de&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:O,name:"Keystroke",value:de,willCommit:!0,commitKey:oe.commitKey,selStart:ue.target.selectionStart,selEnd:ue.target.selectionEnd}}),ce(ue)}),this.data.actions?.Keystroke&&B.addEventListener("beforeinput",ue=>{oe.lastCommittedValue=null;const{data:de,target:pe}=ue,{value:ye,selectionStart:Ae,selectionEnd:Ce}=pe;let Pe=Ae,Oe=Ce;switch(ue.inputType){case"deleteWordBackward":{const xe=ye.substring(0,Ae).match(/\w*[^\w]*$/);xe&&(Pe-=xe[0].length);break}case"deleteWordForward":{const xe=ye.substring(Ae).match(/^[^\w]*\w*/);xe&&(Oe+=xe[0].length);break}case"deleteContentBackward":Ae===Ce&&(Pe-=1);break;case"deleteContentForward":Ae===Ce&&(Oe+=1);break}ue.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:O,name:"Keystroke",value:ye,change:de||"",willCommit:!1,selStart:Pe,selEnd:Oe}})}),this._setEventListeners(B,oe,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],ue=>ue.target.value)}if(ve&&B.addEventListener("blur",ve),this.data.comb){const ue=(this.data.rect[2]-this.data.rect[0])/J;B.classList.add("comb"),B.style.letterSpacing=`calc(${ue}px * var(--scale-factor) - 1ch)`}}else B=document.createElement("div"),B.textContent=this.data.fieldValue,B.style.verticalAlign="middle",B.style.display="table-cell";return this._setTextStyle(B),this._setBackgroundColor(B),this._setDefaultPropertiesFromJS(B),this.container.append(B),this.container}}class S extends b{constructor(P){super(P,{isRenderable:!!P.data.hasOwnCanvas})}}class C extends b{constructor(P){super(P,{isRenderable:P.renderForms})}render(){const P=this.annotationStorage,O=this.data,B=O.id;let G=P.getValue(B,{value:O.exportValue===O.fieldValue}).value;typeof G=="string"&&(G=G!=="Off",P.setValue(B,{value:G})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const Y=document.createElement("input");return f.add(Y),Y.setAttribute("data-element-id",B),Y.disabled=O.readOnly,this._setRequired(Y,this.data.required),Y.type="checkbox",Y.name=O.fieldName,G&&Y.setAttribute("checked",!0),Y.setAttribute("exportValue",O.exportValue),Y.tabIndex=d,Y.addEventListener("change",J=>{const{name:Z,checked:oe}=J.target;for(const ve of this._getElementsByName(Z,B)){const ce=oe&&ve.exportValue===O.exportValue;ve.domElement&&(ve.domElement.checked=ce),P.setValue(ve.id,{value:ce})}P.setValue(B,{value:oe})}),Y.addEventListener("resetform",J=>{const Z=O.defaultFieldValue||"Off";J.target.checked=Z===O.exportValue}),this.enableScripting&&this.hasJSActions&&(Y.addEventListener("updatefromsandbox",J=>{const Z={value(oe){oe.target.checked=oe.detail.value!=="Off",P.setValue(B,{value:oe.target.checked})}};this._dispatchEventFromSandbox(Z,J)}),this._setEventListeners(Y,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],J=>J.target.checked)),this._setBackgroundColor(Y),this._setDefaultPropertiesFromJS(Y),this.container.append(Y),this.container}}class A extends b{constructor(P){super(P,{isRenderable:P.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const P=this.annotationStorage,O=this.data,B=O.id;let G=P.getValue(B,{value:O.fieldValue===O.buttonValue}).value;typeof G=="string"&&(G=G!==O.buttonValue,P.setValue(B,{value:G}));const Y=document.createElement("input");if(f.add(Y),Y.setAttribute("data-element-id",B),Y.disabled=O.readOnly,this._setRequired(Y,this.data.required),Y.type="radio",Y.name=O.fieldName,G&&Y.setAttribute("checked",!0),Y.tabIndex=d,Y.addEventListener("change",J=>{const{name:Z,checked:oe}=J.target;for(const ve of this._getElementsByName(Z,B))P.setValue(ve.id,{value:!1});P.setValue(B,{value:oe})}),Y.addEventListener("resetform",J=>{const Z=O.defaultFieldValue;J.target.checked=Z!=null&&Z===O.buttonValue}),this.enableScripting&&this.hasJSActions){const J=O.buttonValue;Y.addEventListener("updatefromsandbox",Z=>{const oe={value:ve=>{const ce=J===ve.detail.value;for(const ue of this._getElementsByName(ve.target.name)){const de=ce&&ue.id===B;ue.domElement&&(ue.domElement.checked=de),P.setValue(ue.id,{value:de})}}};this._dispatchEventFromSandbox(oe,Z)}),this._setEventListeners(Y,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Z=>Z.target.checked)}return this._setBackgroundColor(Y),this._setDefaultPropertiesFromJS(Y),this.container.append(Y),this.container}}class R extends x{constructor(P){super(P,{ignoreBorder:P.data.hasAppearance})}render(){const P=super.render();P.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(P.title=this.data.alternativeText);const O=P.lastChild;return this.enableScripting&&this.hasJSActions&&O&&(this._setDefaultPropertiesFromJS(O),O.addEventListener("updatefromsandbox",B=>{this._dispatchEventFromSandbox({},B)})),P}}class L extends b{constructor(P){super(P,{isRenderable:P.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const P=this.annotationStorage,O=this.data.id,B=P.getValue(O,{value:this.data.fieldValue}),G=document.createElement("select");f.add(G),G.setAttribute("data-element-id",O),G.disabled=this.data.readOnly,this._setRequired(G,this.data.required),G.name=this.data.fieldName,G.tabIndex=d;let Y=this.data.combo&&this.data.options.length>0;this.data.combo||(G.size=this.data.options.length,this.data.multiSelect&&(G.multiple=!0)),G.addEventListener("resetform",ce=>{const ue=this.data.defaultFieldValue;for(const de of G.options)de.selected=de.value===ue});for(const ce of this.data.options){const ue=document.createElement("option");ue.textContent=ce.displayValue,ue.value=ce.exportValue,B.value.includes(ce.exportValue)&&(ue.setAttribute("selected",!0),Y=!1),G.append(ue)}let J=null;if(Y){const ce=document.createElement("option");ce.value=" ",ce.setAttribute("hidden",!0),ce.setAttribute("selected",!0),G.prepend(ce),J=()=>{ce.remove(),G.removeEventListener("input",J),J=null},G.addEventListener("input",J)}const Z=ce=>{const ue=ce?"value":"textContent",{options:de,multiple:pe}=G;return pe?Array.prototype.filter.call(de,ye=>ye.selected).map(ye=>ye[ue]):de.selectedIndex===-1?null:de[de.selectedIndex][ue]};let oe=Z(!1);const ve=ce=>{const ue=ce.target.options;return Array.prototype.map.call(ue,de=>({displayValue:de.textContent,exportValue:de.value}))};return this.enableScripting&&this.hasJSActions?(G.addEventListener("updatefromsandbox",ce=>{const ue={value(de){J?.();const pe=de.detail.value,ye=new Set(Array.isArray(pe)?pe:[pe]);for(const Ae of G.options)Ae.selected=ye.has(Ae.value);P.setValue(O,{value:Z(!0)}),oe=Z(!1)},multipleSelection(de){G.multiple=!0},remove(de){const pe=G.options,ye=de.detail.remove;pe[ye].selected=!1,G.remove(ye),pe.length>0&&Array.prototype.findIndex.call(pe,Ce=>Ce.selected)===-1&&(pe[0].selected=!0),P.setValue(O,{value:Z(!0),items:ve(de)}),oe=Z(!1)},clear(de){for(;G.length!==0;)G.remove(0);P.setValue(O,{value:null,items:[]}),oe=Z(!1)},insert(de){const{index:pe,displayValue:ye,exportValue:Ae}=de.detail.insert,Ce=G.children[pe],Pe=document.createElement("option");Pe.textContent=ye,Pe.value=Ae,Ce?Ce.before(Pe):G.append(Pe),P.setValue(O,{value:Z(!0),items:ve(de)}),oe=Z(!1)},items(de){const{items:pe}=de.detail;for(;G.length!==0;)G.remove(0);for(const ye of pe){const{displayValue:Ae,exportValue:Ce}=ye,Pe=document.createElement("option");Pe.textContent=Ae,Pe.value=Ce,G.append(Pe)}G.options.length>0&&(G.options[0].selected=!0),P.setValue(O,{value:Z(!0),items:ve(de)}),oe=Z(!1)},indices(de){const pe=new Set(de.detail.indices);for(const ye of de.target.options)ye.selected=pe.has(ye.index);P.setValue(O,{value:Z(!0)}),oe=Z(!1)},editable(de){de.target.disabled=!de.detail.editable}};this._dispatchEventFromSandbox(ue,ce)}),G.addEventListener("input",ce=>{const ue=Z(!0);P.setValue(O,{value:ue}),ce.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:O,name:"Keystroke",value:oe,changeEx:ue,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(G,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],ce=>ce.target.value)):G.addEventListener("input",function(ce){P.setValue(O,{value:Z(!0)})}),this.data.combo&&this._setTextStyle(G),this._setBackgroundColor(G),this._setDefaultPropertiesFromJS(G),this.container.append(G),this.container}}class j extends g{constructor(P){const{data:O,elements:B}=P;super(P,{isRenderable:g._hasPopupData(O)}),this.elements=B}render(){this.container.classList.add("popupAnnotation");const P=new F({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),O=[];for(const B of this.elements)B.popup=P,O.push(B.data.id),B.addHighlightArea();return this.container.setAttribute("aria-controls",O.map(B=>`${n.AnnotationPrefix}${B}`).join(",")),this.container}}class F{#e=null;#t=this.#v.bind(this);#n=this.#A.bind(this);#r=this.#x.bind(this);#s=this.#y.bind(this);#o=null;#i=null;#a=null;#c=null;#l=null;#h=null;#d=!1;#f=null;#g=null;#m=null;#u=null;#p=!1;constructor({container:P,color:O,elements:B,titleObj:G,modificationDate:Y,contentsObj:J,richText:Z,parent:oe,rect:ve,parentRect:ce,open:ue}){this.#i=P,this.#u=G,this.#a=J,this.#m=Z,this.#l=oe,this.#o=O,this.#g=ve,this.#h=ce,this.#c=B;const de=i.PDFDateString.toDateObject(Y);de&&(this.#e=oe.l10n.get("annotation_date_string",{date:de.toLocaleDateString(),time:de.toLocaleTimeString()})),this.trigger=B.flatMap(pe=>pe.getElementsToTriggerPopup());for(const pe of this.trigger)pe.addEventListener("click",this.#s),pe.addEventListener("mouseenter",this.#r),pe.addEventListener("mouseleave",this.#n),pe.classList.add("popupTriggerArea");for(const pe of B)pe.container?.addEventListener("keydown",this.#t);this.#i.hidden=!0,ue&&this.#y()}render(){if(this.#f)return;const{page:{view:P},viewport:{rawDims:{pageWidth:O,pageHeight:B,pageX:G,pageY:Y}}}=this.#l,J=this.#f=document.createElement("div");if(J.className="popup",this.#o){const xe=J.style.outlineColor=n.Util.makeHexColor(...this.#o);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?J.style.backgroundColor=`color-mix(in srgb, ${xe} 30%, white)`:J.style.backgroundColor=n.Util.makeHexColor(...this.#o.map($e=>Math.floor(.7*(255-$e)+$e)))}const Z=document.createElement("span");Z.className="header";const oe=document.createElement("h1");if(Z.append(oe),{dir:oe.dir,str:oe.textContent}=this.#u,J.append(Z),this.#e){const xe=document.createElement("span");xe.classList.add("popupDate"),this.#e.then(Te=>{xe.textContent=Te}),Z.append(xe)}const ve=this.#a,ce=this.#m;if(ce?.str&&(!ve?.str||ve.str===ce.str))h.XfaLayer.render({xfaHtml:ce.html,intent:"richText",div:J}),J.lastChild.classList.add("richText","popupContent");else{const xe=this._formatContents(ve);J.append(xe)}let ue=!!this.#h,de=ue?this.#h:this.#g;for(const xe of this.#c)if(!de||n.Util.intersect(xe.data.rect,de)!==null){de=xe.data.rect,ue=!0;break}const pe=n.Util.normalizeRect([de[0],P[3]-de[1]+P[1],de[2],P[3]-de[3]+P[1]]),Ae=ue?de[2]-de[0]+5:0,Ce=pe[0]+Ae,Pe=pe[1],{style:Oe}=this.#i;Oe.left=`${100*(Ce-G)/O}%`,Oe.top=`${100*(Pe-Y)/B}%`,this.#i.append(J)}_formatContents({str:P,dir:O}){const B=document.createElement("p");B.classList.add("popupContent"),B.dir=O;const G=P.split(/(?:\r\n?|\n)/);for(let Y=0,J=G.length;Y<J;++Y){const Z=G[Y];B.append(document.createTextNode(Z)),Y<J-1&&B.append(document.createElement("br"))}return B}#v(P){P.altKey||P.shiftKey||P.ctrlKey||P.metaKey||(P.key==="Enter"||P.key==="Escape"&&this.#d)&&this.#y()}#y(){this.#d=!this.#d,this.#d?(this.#x(),this.#i.addEventListener("click",this.#s),this.#i.addEventListener("keydown",this.#t)):(this.#A(),this.#i.removeEventListener("click",this.#s),this.#i.removeEventListener("keydown",this.#t))}#x(){this.#f||this.render(),this.isVisible?this.#d&&this.#i.classList.add("focused"):(this.#i.hidden=!1,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)+1e3)}#A(){this.#i.classList.remove("focused"),!(this.#d||!this.isVisible)&&(this.#i.hidden=!0,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)-1e3)}forceHide(){this.#p=this.isVisible,this.#p&&(this.#i.hidden=!0)}maybeShow(){this.#p&&(this.#p=!1,this.#i.hidden=!1)}get isVisible(){return this.#i.hidden===!1}}class W extends g{constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0}),this.textContent=P.data.textContent,this.textPosition=P.data.textPosition,this.annotationEditorType=n.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const P=document.createElement("div");P.classList.add("annotationTextContent"),P.setAttribute("role","comment");for(const O of this.textContent){const B=document.createElement("span");B.textContent=O,P.append(B)}this.container.append(P)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}e.FreeTextAnnotationElement=W;class K extends g{#e=null;constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const P=this.data,{width:O,height:B}=m(P.rect),G=this.svgFactory.create(O,B,!0),Y=this.#e=this.svgFactory.createElement("svg:line");return Y.setAttribute("x1",P.rect[2]-P.lineCoordinates[0]),Y.setAttribute("y1",P.rect[3]-P.lineCoordinates[1]),Y.setAttribute("x2",P.rect[2]-P.lineCoordinates[2]),Y.setAttribute("y2",P.rect[3]-P.lineCoordinates[3]),Y.setAttribute("stroke-width",P.borderStyle.width||1),Y.setAttribute("stroke","transparent"),Y.setAttribute("fill","transparent"),G.append(Y),this.container.append(G),!P.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class ee extends g{#e=null;constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const P=this.data,{width:O,height:B}=m(P.rect),G=this.svgFactory.create(O,B,!0),Y=P.borderStyle.width,J=this.#e=this.svgFactory.createElement("svg:rect");return J.setAttribute("x",Y/2),J.setAttribute("y",Y/2),J.setAttribute("width",O-Y),J.setAttribute("height",B-Y),J.setAttribute("stroke-width",Y||1),J.setAttribute("stroke","transparent"),J.setAttribute("fill","transparent"),G.append(J),this.container.append(G),!P.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class te extends g{#e=null;constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const P=this.data,{width:O,height:B}=m(P.rect),G=this.svgFactory.create(O,B,!0),Y=P.borderStyle.width,J=this.#e=this.svgFactory.createElement("svg:ellipse");return J.setAttribute("cx",O/2),J.setAttribute("cy",B/2),J.setAttribute("rx",O/2-Y/2),J.setAttribute("ry",B/2-Y/2),J.setAttribute("stroke-width",Y||1),J.setAttribute("stroke","transparent"),J.setAttribute("fill","transparent"),G.append(J),this.container.append(G),!P.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class re extends g{#e=null;constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const P=this.data,{width:O,height:B}=m(P.rect),G=this.svgFactory.create(O,B,!0);let Y=[];for(const Z of P.vertices){const oe=Z.x-P.rect[0],ve=P.rect[3]-Z.y;Y.push(oe+","+ve)}Y=Y.join(" ");const J=this.#e=this.svgFactory.createElement(this.svgElementName);return J.setAttribute("points",Y),J.setAttribute("stroke-width",P.borderStyle.width||1),J.setAttribute("stroke","transparent"),J.setAttribute("fill","transparent"),G.append(J),this.container.append(G),!P.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class ie extends re{constructor(P){super(P),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Q extends g{constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class z extends g{#e=[];constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=n.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const P=this.data,{width:O,height:B}=m(P.rect),G=this.svgFactory.create(O,B,!0);for(const Y of P.inkLists){let J=[];for(const oe of Y){const ve=oe.x-P.rect[0],ce=P.rect[3]-oe.y;J.push(`${ve},${ce}`)}J=J.join(" ");const Z=this.svgFactory.createElement(this.svgElementName);this.#e.push(Z),Z.setAttribute("points",J),Z.setAttribute("stroke-width",P.borderStyle.width||1),Z.setAttribute("stroke","transparent"),Z.setAttribute("fill","transparent"),!P.popupRef&&this.hasPopupData&&this._createPopup(),G.append(Z)}return this.container.append(G),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}e.InkAnnotationElement=z;class N extends g{constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class k extends g{constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class I extends g{constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class D extends g{constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class U extends g{constructor(P){super(P,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}e.StampAnnotationElement=U;class $ extends g{#e=null;constructor(P){super(P,{isRenderable:!0});const{filename:O,content:B}=this.data.file;this.filename=(0,i.getFilenameFromUrl)(O,!0),this.content=B,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:O,content:B})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:P,data:O}=this;let B;O.hasAppearance||O.fillAlpha===0?B=document.createElement("div"):(B=document.createElement("img"),B.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(O.name)?"paperclip":"pushpin"}.svg`,O.fillAlpha&&O.fillAlpha<1&&(B.style=`filter: opacity(${Math.round(O.fillAlpha*100)}%);`)),B.addEventListener("dblclick",this.#t.bind(this)),this.#e=B;const{isMac:G}=n.FeatureTest.platform;return P.addEventListener("keydown",Y=>{Y.key==="Enter"&&(G?Y.metaKey:Y.ctrlKey)&&this.#t()}),!O.popupRef&&this.hasPopupData?this._createPopup():B.classList.add("popupTriggerArea"),P.append(B),P}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}class q{#e=null;#t=null;#n=new Map;constructor({div:P,accessibilityManager:O,annotationCanvasMap:B,l10n:G,page:Y,viewport:J}){this.div=P,this.#e=O,this.#t=B,this.l10n=G,this.page=Y,this.viewport=J,this.zIndex=0,this.l10n||=l.NullL10n}#r(P,O){const B=P.firstChild||P;B.id=`${n.AnnotationPrefix}${O}`,this.div.append(P),this.#e?.moveElementInDOM(this.div,P,B,!1)}async render(P){const{annotations:O}=P,B=this.div;(0,i.setLayerDimensions)(B,this.viewport);const G=new Map,Y={data:null,layer:B,linkService:P.linkService,downloadManager:P.downloadManager,imageResourcesPath:P.imageResourcesPath||"",renderForms:P.renderForms!==!1,svgFactory:new i.DOMSVGFactory,annotationStorage:P.annotationStorage||new o.AnnotationStorage,enableScripting:P.enableScripting===!0,hasJSActions:P.hasJSActions,fieldObjects:P.fieldObjects,parent:this,elements:null};for(const J of O){if(J.noHTML)continue;const Z=J.annotationType===n.AnnotationType.POPUP;if(Z){const ce=G.get(J.id);if(!ce)continue;Y.elements=ce}else{const{width:ce,height:ue}=m(J.rect);if(ce<=0||ue<=0)continue}Y.data=J;const oe=v.create(Y);if(!oe.isRenderable)continue;if(!Z&&J.popupRef){const ce=G.get(J.popupRef);ce?ce.push(oe):G.set(J.popupRef,[oe])}oe.annotationEditorType>0&&this.#n.set(oe.data.id,oe);const ve=oe.render();J.hidden&&(ve.style.visibility="hidden"),this.#r(ve,J.id)}this.#s(),await this.l10n.translate(B)}update({viewport:P}){const O=this.div;this.viewport=P,(0,i.setLayerDimensions)(O,{rotation:P.rotation}),this.#s(),O.hidden=!1}#s(){if(!this.#t)return;const P=this.div;for(const[O,B]of this.#t){const G=P.querySelector(`[data-annotation-id="${O}"]`);if(!G)continue;const{firstChild:Y}=G;Y?Y.nodeName==="CANVAS"?Y.replaceWith(B):Y.before(B):G.append(B)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(P){return this.#n.get(P)}}e.AnnotationLayer=q}),((s,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorConverters=void 0;function t(o){return Math.floor(Math.max(0,Math.min(1,o))*255).toString(16).padStart(2,"0")}function n(o){return Math.max(0,Math.min(255,255*o))}class i{static CMYK_G([a,l,h,d]){return["G",1-Math.min(1,.3*a+.59*h+.11*l+d)]}static G_CMYK([a]){return["CMYK",0,0,0,1-a]}static G_RGB([a]){return["RGB",a,a,a]}static G_rgb([a]){return a=n(a),[a,a,a]}static G_HTML([a]){const l=t(a);return`#${l}${l}${l}`}static RGB_G([a,l,h]){return["G",.3*a+.59*l+.11*h]}static RGB_rgb(a){return a.map(n)}static RGB_HTML(a){return`#${a.map(t).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([a,l,h,d]){return["RGB",1-Math.min(1,a+d),1-Math.min(1,h+d),1-Math.min(1,l+d)]}static CMYK_rgb([a,l,h,d]){return[n(1-Math.min(1,a+d)),n(1-Math.min(1,h+d)),n(1-Math.min(1,l+d))]}static CMYK_HTML(a){const l=this.CMYK_RGB(a).slice(1);return this.RGB_HTML(l)}static RGB_CMYK([a,l,h]){const d=1-a,u=1-l,f=1-h,m=Math.min(d,u,f);return["CMYK",d,u,f,m]}}e.ColorConverters=i}),((s,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NullL10n=void 0,e.getL10nFallback=n;const t={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}}  {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}}  {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};t.print_progress_percent="{{progress}}%";function n(a,l){switch(a){case"find_match_count":a=`find_match_count[${l.total===1?"one":"other"}]`;break;case"find_match_count_limit":a=`find_match_count_limit[${l.limit===1?"one":"other"}]`;break}return t[a]||""}function i(a,l){return l?a.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(h,d)=>d in l?l[d]:"{{"+d+"}}"):a}const o={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(a,l=null,h=n(a,l)){return i(h,l)},async translate(a){}};e.NullL10n=o}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.XfaLayer=void 0;var n=t(25);class i{static setupStorage(a,l,h,d,u){const f=d.getValue(l,{value:null});switch(h.name){case"textarea":if(f.value!==null&&(a.textContent=f.value),u==="print")break;a.addEventListener("input",m=>{d.setValue(l,{value:m.target.value})});break;case"input":if(h.attributes.type==="radio"||h.attributes.type==="checkbox"){if(f.value===h.attributes.xfaOn?a.setAttribute("checked",!0):f.value===h.attributes.xfaOff&&a.removeAttribute("checked"),u==="print")break;a.addEventListener("change",m=>{d.setValue(l,{value:m.target.checked?m.target.getAttribute("xfaOn"):m.target.getAttribute("xfaOff")})})}else{if(f.value!==null&&a.setAttribute("value",f.value),u==="print")break;a.addEventListener("input",m=>{d.setValue(l,{value:m.target.value})})}break;case"select":if(f.value!==null){a.setAttribute("value",f.value);for(const m of h.children)m.attributes.value===f.value?m.attributes.selected=!0:m.attributes.hasOwnProperty("selected")&&delete m.attributes.selected}a.addEventListener("input",m=>{const v=m.target.options,g=v.selectedIndex===-1?"":v[v.selectedIndex].value;d.setValue(l,{value:g})});break}}static setAttributes({html:a,element:l,storage:h=null,intent:d,linkService:u}){const{attributes:f}=l,m=a instanceof HTMLAnchorElement;f.type==="radio"&&(f.name=`${f.name}-${d}`);for(const[v,g]of Object.entries(f))if(g!=null)switch(v){case"class":g.length&&a.setAttribute(v,g.join(" "));break;case"dataId":break;case"id":a.setAttribute("data-element-id",g);break;case"style":Object.assign(a.style,g);break;case"textContent":a.textContent=g;break;default:(!m||v!=="href"&&v!=="newWindow")&&a.setAttribute(v,g)}m&&u.addLinkAttributes(a,f.href,f.newWindow),h&&f.dataId&&this.setupStorage(a,f.dataId,l,h)}static render(a){const l=a.annotationStorage,h=a.linkService,d=a.xfaHtml,u=a.intent||"display",f=document.createElement(d.name);d.attributes&&this.setAttributes({html:f,element:d,intent:u,linkService:h});const m=[[d,-1,f]],v=a.div;if(v.append(f),a.viewport){const x=`matrix(${a.viewport.transform.join(",")})`;v.style.transform=x}u!=="richText"&&v.setAttribute("class","xfaLayer xfaFont");const g=[];for(;m.length>0;){const[x,E,b]=m.at(-1);if(E+1===x.children.length){m.pop();continue}const _=x.children[++m.at(-1)[1]];if(_===null)continue;const{name:S}=_;if(S==="#text"){const A=document.createTextNode(_.value);g.push(A),b.append(A);continue}const C=_?.attributes?.xmlns?document.createElementNS(_.attributes.xmlns,S):document.createElement(S);if(b.append(C),_.attributes&&this.setAttributes({html:C,element:_,storage:l,intent:u,linkService:h}),_.children&&_.children.length>0)m.push([_,-1,C]);else if(_.value){const A=document.createTextNode(_.value);n.XfaText.shouldBuildText(S)&&g.push(A),C.append(A)}}for(const x of v.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))x.setAttribute("readOnly",!0);return{textDivs:g}}static update(a){const l=`matrix(${a.viewport.transform.join(",")})`;a.div.style.transform=l,a.div.hidden=!1}}e.XfaLayer=i}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.InkEditor=void 0;var n=t(1),i=t(4),o=t(29),a=t(6),l=t(5);class h extends i.AnnotationEditor{#e=0;#t=0;#n=this.canvasPointermove.bind(this);#r=this.canvasPointerleave.bind(this);#s=this.canvasPointerup.bind(this);#o=this.canvasPointerdown.bind(this);#i=new Path2D;#a=!1;#c=!1;#l=!1;#h=null;#d=0;#f=0;#g=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _type="ink";constructor(u){super({...u,name:"inkEditor"}),this.color=u.color||null,this.thickness=u.thickness||null,this.opacity=u.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(u){i.AnnotationEditor.initialize(u,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(u,f){switch(u){case n.AnnotationEditorParamsType.INK_THICKNESS:h._defaultThickness=f;break;case n.AnnotationEditorParamsType.INK_COLOR:h._defaultColor=f;break;case n.AnnotationEditorParamsType.INK_OPACITY:h._defaultOpacity=f/100;break}}updateParams(u,f){switch(u){case n.AnnotationEditorParamsType.INK_THICKNESS:this.#m(f);break;case n.AnnotationEditorParamsType.INK_COLOR:this.#u(f);break;case n.AnnotationEditorParamsType.INK_OPACITY:this.#p(f);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,h._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,h._defaultColor||i.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(h._defaultOpacity*100)]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||h._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,this.color||h._defaultColor||i.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??h._defaultOpacity))]]}#m(u){const f=this.thickness;this.addCommands({cmd:()=>{this.thickness=u,this.#j()},undo:()=>{this.thickness=f,this.#j()},mustExec:!0,type:n.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#u(u){const f=this.color;this.addCommands({cmd:()=>{this.color=u,this.#T()},undo:()=>{this.color=f,this.#T()},mustExec:!0,type:n.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#p(u){u/=100;const f=this.opacity;this.addCommands({cmd:()=>{this.opacity=u,this.#T()},undo:()=>{this.opacity=f,this.#T()},mustExec:!0,type:n.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(this.#M(),this.#N()),this.isAttachedToDOM||(this.parent.add(this),this.#R()),this.#j()))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#h.disconnect(),this.#h=null,super.remove())}setParent(u){!this.parent&&u?this._uiManager.removeShouldRescale(this):this.parent&&u===null&&this._uiManager.addShouldRescale(this),super.setParent(u)}onScaleChanging(){const[u,f]=this.parentDimensions,m=this.width*u,v=this.height*f;this.setDimensions(m,v)}enableEditMode(){this.#a||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",this.#o))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#o))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#v(){const{parentRotation:u,parentDimensions:[f,m]}=this;switch(u){case 90:return[0,m,m,f];case 180:return[f,m,f,m];case 270:return[f,0,m,f];default:return[0,0,f,m]}}#y(){const{ctx:u,color:f,opacity:m,thickness:v,parentScale:g,scaleFactor:x}=this;u.lineWidth=v*g/x,u.lineCap="round",u.lineJoin="round",u.miterLimit=10,u.strokeStyle=`${f}${(0,l.opacityToHex)(m)}`}#x(u,f){this.canvas.addEventListener("contextmenu",a.noContextMenu),this.canvas.addEventListener("pointerleave",this.#r),this.canvas.addEventListener("pointermove",this.#n),this.canvas.addEventListener("pointerup",this.#s),this.canvas.removeEventListener("pointerdown",this.#o),this.isEditing=!0,this.#l||(this.#l=!0,this.#R(),this.thickness||=h._defaultThickness,this.color||=h._defaultColor||i.AnnotationEditor._defaultLineColor,this.opacity??=h._defaultOpacity),this.currentPath.push([u,f]),this.#c=!1,this.#y(),this.#g=()=>{this.#P(),this.#g&&window.requestAnimationFrame(this.#g)},window.requestAnimationFrame(this.#g)}#A(u,f){const[m,v]=this.currentPath.at(-1);if(this.currentPath.length>1&&u===m&&f===v)return;const g=this.currentPath;let x=this.#i;if(g.push([u,f]),this.#c=!0,g.length<=2){x.moveTo(...g[0]),x.lineTo(u,f);return}g.length===3&&(this.#i=x=new Path2D,x.moveTo(...g[0])),this.#_(x,...g.at(-3),...g.at(-2),u,f)}#w(){if(this.currentPath.length===0)return;const u=this.currentPath.at(-1);this.#i.lineTo(...u)}#b(u,f){this.#g=null,u=Math.min(Math.max(u,0),this.canvas.width),f=Math.min(Math.max(f,0),this.canvas.height),this.#A(u,f),this.#w();let m;if(this.currentPath.length!==1)m=this.#S();else{const b=[u,f];m=[[b,b.slice(),b.slice(),b]]}const v=this.#i,g=this.currentPath;this.currentPath=[],this.#i=new Path2D;const x=()=>{this.allRawPaths.push(g),this.paths.push(m),this.bezierPath2D.push(v),this.rebuild()},E=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#M(),this.#N()),this.#j())};this.addCommands({cmd:x,undo:E,mustExec:!0})}#P(){if(!this.#c)return;this.#c=!1;const u=Math.ceil(this.thickness*this.parentScale),f=this.currentPath.slice(-3),m=f.map(x=>x[0]),v=f.map(x=>x[1]);Math.min(...m)-u,Math.max(...m)+u,Math.min(...v)-u,Math.max(...v)+u;const{ctx:g}=this;g.save(),g.clearRect(0,0,this.canvas.width,this.canvas.height);for(const x of this.bezierPath2D)g.stroke(x);g.stroke(this.#i),g.restore()}#_(u,f,m,v,g,x,E){const b=(f+v)/2,_=(m+g)/2,S=(v+x)/2,C=(g+E)/2;u.bezierCurveTo(b+2*(v-b)/3,_+2*(g-_)/3,S+2*(v-S)/3,C+2*(g-C)/3,S,C)}#S(){const u=this.currentPath;if(u.length<=2)return[[u[0],u[0],u.at(-1),u.at(-1)]];const f=[];let m,[v,g]=u[0];for(m=1;m<u.length-2;m++){const[A,R]=u[m],[L,j]=u[m+1],F=(A+L)/2,W=(R+j)/2,K=[v+2*(A-v)/3,g+2*(R-g)/3],ee=[F+2*(A-F)/3,W+2*(R-W)/3];f.push([[v,g],K,ee,[F,W]]),[v,g]=[F,W]}const[x,E]=u[m],[b,_]=u[m+1],S=[v+2*(x-v)/3,g+2*(E-g)/3],C=[b+2*(x-b)/3,_+2*(E-_)/3];return f.push([[v,g],S,C,[b,_]]),f}#T(){if(this.isEmpty()){this.#I();return}this.#y();const{canvas:u,ctx:f}=this;f.setTransform(1,0,0,1,0,0),f.clearRect(0,0,u.width,u.height),this.#I();for(const m of this.bezierPath2D)f.stroke(m)}commit(){this.#a||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#a=!0,this.div.classList.add("disabled"),this.#j(!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(u){this._focusEventsAllowed&&(super.focusin(u),this.enableEditMode())}canvasPointerdown(u){u.button!==0||!this.isInEditMode()||this.#a||(this.setInForeground(),u.preventDefault(),u.type!=="mouse"&&this.div.focus(),this.#x(u.offsetX,u.offsetY))}canvasPointermove(u){u.preventDefault(),this.#A(u.offsetX,u.offsetY)}canvasPointerup(u){u.preventDefault(),this.#k(u)}canvasPointerleave(u){this.#k(u)}#k(u){this.canvas.removeEventListener("pointerleave",this.#r),this.canvas.removeEventListener("pointermove",this.#n),this.canvas.removeEventListener("pointerup",this.#s),this.canvas.addEventListener("pointerdown",this.#o),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",a.noContextMenu)},10),this.#b(u.offsetX,u.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#M(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",i.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(u=>this.canvas?.setAttribute("aria-label",u)),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#N(){this.#h=new ResizeObserver(u=>{const f=u[0].contentRect;f.width&&f.height&&this.setDimensions(f.width,f.height)}),this.#h.observe(this.div)}get isResizable(){return!this.isEmpty()&&this.#a}render(){if(this.div)return this.div;let u,f;this.width&&(u=this.x,f=this.y),super.render(),i.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then(E=>this.div?.setAttribute("aria-label",E));const[m,v,g,x]=this.#v();if(this.setAt(m,v,0,0),this.setDims(g,x),this.#M(),this.width){const[E,b]=this.parentDimensions;this.setAspectRatio(this.width*E,this.height*b),this.setAt(u*E,f*b,this.width*E,this.height*b),this.#l=!0,this.#R(),this.setDims(this.width*E,this.height*b),this.#T(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#N(),this.div}#R(){if(!this.#l)return;const[u,f]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*u),this.canvas.height=Math.ceil(this.height*f),this.#I()}setDimensions(u,f){const m=Math.round(u),v=Math.round(f);if(this.#d===m&&this.#f===v)return;this.#d=m,this.#f=v,this.canvas.style.visibility="hidden";const[g,x]=this.parentDimensions;this.width=u/g,this.height=f/x,this.fixAndSetPosition(),this.#a&&this.#D(u,f),this.#R(),this.#T(),this.canvas.style.visibility="visible",this.fixDims()}#D(u,f){const m=this.#F(),v=(u-m)/this.#t,g=(f-m)/this.#e;this.scaleFactor=Math.min(v,g)}#I(){const u=this.#F()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+u,this.translationY*this.scaleFactor+u)}static#L(u){const f=new Path2D;for(let m=0,v=u.length;m<v;m++){const[g,x,E,b]=u[m];m===0&&f.moveTo(...g),f.bezierCurveTo(x[0],x[1],E[0],E[1],b[0],b[1])}return f}static#z(u,f,m){const[v,g,x,E]=f;switch(m){case 0:for(let b=0,_=u.length;b<_;b+=2)u[b]+=v,u[b+1]=E-u[b+1];break;case 90:for(let b=0,_=u.length;b<_;b+=2){const S=u[b];u[b]=u[b+1]+v,u[b+1]=S+g}break;case 180:for(let b=0,_=u.length;b<_;b+=2)u[b]=x-u[b],u[b+1]+=g;break;case 270:for(let b=0,_=u.length;b<_;b+=2){const S=u[b];u[b]=x-u[b+1],u[b+1]=E-S}break;default:throw new Error("Invalid rotation")}return u}static#C(u,f,m){const[v,g,x,E]=f;switch(m){case 0:for(let b=0,_=u.length;b<_;b+=2)u[b]-=v,u[b+1]=E-u[b+1];break;case 90:for(let b=0,_=u.length;b<_;b+=2){const S=u[b];u[b]=u[b+1]-g,u[b+1]=S-v}break;case 180:for(let b=0,_=u.length;b<_;b+=2)u[b]=x-u[b],u[b+1]-=g;break;case 270:for(let b=0,_=u.length;b<_;b+=2){const S=u[b];u[b]=E-u[b+1],u[b+1]=x-S}break;default:throw new Error("Invalid rotation")}return u}#E(u,f,m,v){const g=[],x=this.thickness/2,E=u*f+x,b=u*m+x;for(const _ of this.paths){const S=[],C=[];for(let A=0,R=_.length;A<R;A++){const[L,j,F,W]=_[A],K=u*L[0]+E,ee=u*L[1]+b,te=u*j[0]+E,re=u*j[1]+b,ie=u*F[0]+E,Q=u*F[1]+b,z=u*W[0]+E,N=u*W[1]+b;A===0&&(S.push(K,ee),C.push(K,ee)),S.push(te,re,ie,Q,z,N),C.push(te,re),A===R-1&&C.push(z,N)}g.push({bezier:h.#z(S,v,this.rotation),points:h.#z(C,v,this.rotation)})}return g}#O(){let u=1/0,f=-1/0,m=1/0,v=-1/0;for(const g of this.paths)for(const[x,E,b,_]of g){const S=n.Util.bezierBoundingBox(...x,...E,...b,..._);u=Math.min(u,S[0]),m=Math.min(m,S[1]),f=Math.max(f,S[2]),v=Math.max(v,S[3])}return[u,m,f,v]}#F(){return this.#a?Math.ceil(this.thickness*this.parentScale):0}#j(u=!1){if(this.isEmpty())return;if(!this.#a){this.#T();return}const f=this.#O(),m=this.#F();this.#t=Math.max(i.AnnotationEditor.MIN_SIZE,f[2]-f[0]),this.#e=Math.max(i.AnnotationEditor.MIN_SIZE,f[3]-f[1]);const v=Math.ceil(m+this.#t*this.scaleFactor),g=Math.ceil(m+this.#e*this.scaleFactor),[x,E]=this.parentDimensions;this.width=v/x,this.height=g/E,this.setAspectRatio(v,g);const b=this.translationX,_=this.translationY;this.translationX=-f[0],this.translationY=-f[1],this.#R(),this.#T(),this.#d=v,this.#f=g,this.setDims(v,g);const S=u?m/this.scaleFactor/2:0;this.translate(b-this.translationX-S,_-this.translationY-S)}static deserialize(u,f,m){if(u instanceof o.InkAnnotationElement)return null;const v=super.deserialize(u,f,m);v.thickness=u.thickness,v.color=n.Util.makeHexColor(...u.color),v.opacity=u.opacity;const[g,x]=v.pageDimensions,E=v.width*g,b=v.height*x,_=v.parentScale,S=u.thickness/2;v.#a=!0,v.#d=Math.round(E),v.#f=Math.round(b);const{paths:C,rect:A,rotation:R}=u;for(let{bezier:j}of C){j=h.#C(j,A,R);const F=[];v.paths.push(F);let W=_*(j[0]-S),K=_*(j[1]-S);for(let te=2,re=j.length;te<re;te+=6){const ie=_*(j[te]-S),Q=_*(j[te+1]-S),z=_*(j[te+2]-S),N=_*(j[te+3]-S),k=_*(j[te+4]-S),I=_*(j[te+5]-S);F.push([[W,K],[ie,Q],[z,N],[k,I]]),W=k,K=I}const ee=this.#L(F);v.bezierPath2D.push(ee)}const L=v.#O();return v.#t=Math.max(i.AnnotationEditor.MIN_SIZE,L[2]-L[0]),v.#e=Math.max(i.AnnotationEditor.MIN_SIZE,L[3]-L[1]),v.#D(E,b),v}serialize(){if(this.isEmpty())return null;const u=this.getRect(0,0),f=i.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:n.AnnotationEditorType.INK,color:f,thickness:this.thickness,opacity:this.opacity,paths:this.#E(this.scaleFactor/this.parentScale,this.translationX,this.translationY,u),pageIndex:this.pageIndex,rect:u,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}}e.InkEditor=h}),((s,e,t)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.StampEditor=void 0;var n=t(1),i=t(4),o=t(6),a=t(29);class l extends i.AnnotationEditor{#e=null;#t=null;#n=null;#r=null;#s=null;#o=null;#i=null;#a=null;#c=!1;#l=!1;static _type="stamp";constructor(d){super({...d,name:"stampEditor"}),this.#r=d.bitmapUrl,this.#s=d.bitmapFile}static initialize(d){i.AnnotationEditor.initialize(d)}static get supportedTypes(){const d=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,n.shadow)(this,"supportedTypes",d.map(u=>`image/${u}`))}static get supportedTypesStr(){return(0,n.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(d){return this.supportedTypes.includes(d)}static paste(d,u){u.pasteEditor(n.AnnotationEditorType.STAMP,{bitmapFile:d.getAsFile()})}#h(d,u=!1){if(!d){this.remove();return}this.#e=d.bitmap,u||(this.#t=d.id,this.#c=d.isSvg),this.#g()}#d(){this.#n=null,this._uiManager.enableWaiting(!1),this.#o&&this.div.focus()}#f(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(u=>this.#h(u,!0)).finally(()=>this.#d());return}if(this.#r){const u=this.#r;this.#r=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromUrl(u).then(f=>this.#h(f)).finally(()=>this.#d());return}if(this.#s){const u=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#n=this._uiManager.imageManager.getFromFile(u).then(f=>this.#h(f)).finally(()=>this.#d());return}const d=document.createElement("input");d.type="file",d.accept=l.supportedTypesStr,this.#n=new Promise(u=>{d.addEventListener("change",async()=>{if(!d.files||d.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const f=await this._uiManager.imageManager.getFromFile(d.files[0]);this.#h(f)}u()}),d.addEventListener("cancel",()=>{this.remove(),u()})}).finally(()=>this.#d()),d.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#o?.remove(),this.#o=null,this.#i?.disconnect(),this.#i=null),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#f();return}super.rebuild(),this.div!==null&&(this.#t&&this.#f(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#n||this.#e||this.#r||this.#s)}get isResizable(){return!0}render(){if(this.div)return this.div;let d,u;if(this.width&&(d=this.x,u=this.y),super.render(),this.div.hidden=!0,this.#e?this.#g():this.#f(),this.width){const[f,m]=this.parentDimensions;this.setAt(d*f,u*m,this.width*f,this.height*m)}return this.div}#g(){const{div:d}=this;let{width:u,height:f}=this.#e;const[m,v]=this.pageDimensions,g=.75;if(this.width)u=this.width*m,f=this.height*v;else if(u>g*m||f>g*v){const _=Math.min(g*m/u,g*v/f);u*=_,f*=_}const[x,E]=this.parentDimensions;this.setDims(u*x/m,f*E/v),this._uiManager.enableWaiting(!1);const b=this.#o=document.createElement("canvas");d.append(b),d.hidden=!1,this.#p(u,f),this.#y(),this.#l||(this.parent.addUndoableEditor(this),this.#l=!0),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()}#m(d,u){const[f,m]=this.parentDimensions;this.width=d/f,this.height=u/m,this.setDims(d,u),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this.#a!==null&&clearTimeout(this.#a);const v=200;this.#a=setTimeout(()=>{this.#a=null,this.#p(d,u)},v)}#u(d,u){const{width:f,height:m}=this.#e;let v=f,g=m,x=this.#e;for(;v>2*d||g>2*u;){const E=v,b=g;v>2*d&&(v=v>=16384?Math.floor(v/2)-1:Math.ceil(v/2)),g>2*u&&(g=g>=16384?Math.floor(g/2)-1:Math.ceil(g/2));const _=new OffscreenCanvas(v,g);_.getContext("2d").drawImage(x,0,0,E,b,0,0,v,g),x=_.transferToImageBitmap()}return x}#p(d,u){d=Math.ceil(d),u=Math.ceil(u);const f=this.#o;if(!f||f.width===d&&f.height===u)return;f.width=d,f.height=u;const m=this.#c?this.#e:this.#u(d,u),v=f.getContext("2d");v.filter=this._uiManager.hcmFilter,v.drawImage(m,0,0,m.width,m.height,0,0,d,u)}#v(d){if(d){if(this.#c){const m=this._uiManager.imageManager.getSvgUrl(this.#t);if(m)return m}const u=document.createElement("canvas");return{width:u.width,height:u.height}=this.#e,u.getContext("2d").drawImage(this.#e,0,0),u.toDataURL()}if(this.#c){const[u,f]=this.pageDimensions,m=Math.round(this.width*u*o.PixelsPerInch.PDF_TO_CSS_UNITS),v=Math.round(this.height*f*o.PixelsPerInch.PDF_TO_CSS_UNITS),g=new OffscreenCanvas(m,v);return g.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,m,v),g.transferToImageBitmap()}return structuredClone(this.#e)}#y(){this.#i=new ResizeObserver(d=>{const u=d[0].contentRect;u.width&&u.height&&this.#m(u.width,u.height)}),this.#i.observe(this.div)}static deserialize(d,u,f){if(d instanceof a.StampAnnotationElement)return null;const m=super.deserialize(d,u,f),{rect:v,bitmapUrl:g,bitmapId:x,isSvg:E,accessibilityData:b}=d;x&&f.imageManager.isValidId(x)?m.#t=x:m.#r=g,m.#c=E;const[_,S]=m.pageDimensions;return m.width=(v[2]-v[0])/_,m.height=(v[3]-v[1])/S,b&&(m.altTextData=b),m}serialize(d=!1,u=null){if(this.isEmpty())return null;const f={annotationType:n.AnnotationEditorType.STAMP,bitmapId:this.#t,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#c,structTreeParentId:this._structTreeParentId};if(d)return f.bitmapUrl=this.#v(!0),f.accessibilityData=this.altTextData,f;const{decorative:m,altText:v}=this.altTextData;if(!m&&v&&(f.accessibilityData={type:"Figure",alt:v}),u===null)return f;u.stamps||=new Map;const g=this.#c?(f.rect[2]-f.rect[0])*(f.rect[3]-f.rect[1]):null;if(!u.stamps.has(this.#t))u.stamps.set(this.#t,{area:g,serialized:f}),f.bitmap=this.#v(!1);else if(this.#c){const x=u.stamps.get(this.#t);g>x.area&&(x.area=g,x.serialized.bitmap.close(),x.serialized.bitmap=this.#v(!1))}return f}}e.StampEditor=l})],__webpack_module_cache__={};function __w_pdfjs_require__(s){var e=__webpack_module_cache__[s];if(e!==void 0)return e.exports;var t=__webpack_module_cache__[s]={exports:{}};return __webpack_modules__[s](t,t.exports,__w_pdfjs_require__),t.exports}var __webpack_exports__={};return(()=>{var s=__webpack_exports__;Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"AbortException",{enumerable:!0,get:function(){return e.AbortException}}),Object.defineProperty(s,"AnnotationEditorLayer",{enumerable:!0,get:function(){return o.AnnotationEditorLayer}}),Object.defineProperty(s,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return e.AnnotationEditorParamsType}}),Object.defineProperty(s,"AnnotationEditorType",{enumerable:!0,get:function(){return e.AnnotationEditorType}}),Object.defineProperty(s,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return a.AnnotationEditorUIManager}}),Object.defineProperty(s,"AnnotationLayer",{enumerable:!0,get:function(){return l.AnnotationLayer}}),Object.defineProperty(s,"AnnotationMode",{enumerable:!0,get:function(){return e.AnnotationMode}}),Object.defineProperty(s,"CMapCompressionType",{enumerable:!0,get:function(){return e.CMapCompressionType}}),Object.defineProperty(s,"DOMSVGFactory",{enumerable:!0,get:function(){return n.DOMSVGFactory}}),Object.defineProperty(s,"FeatureTest",{enumerable:!0,get:function(){return e.FeatureTest}}),Object.defineProperty(s,"GlobalWorkerOptions",{enumerable:!0,get:function(){return h.GlobalWorkerOptions}}),Object.defineProperty(s,"ImageKind",{enumerable:!0,get:function(){return e.ImageKind}}),Object.defineProperty(s,"InvalidPDFException",{enumerable:!0,get:function(){return e.InvalidPDFException}}),Object.defineProperty(s,"MissingPDFException",{enumerable:!0,get:function(){return e.MissingPDFException}}),Object.defineProperty(s,"OPS",{enumerable:!0,get:function(){return e.OPS}}),Object.defineProperty(s,"PDFDataRangeTransport",{enumerable:!0,get:function(){return t.PDFDataRangeTransport}}),Object.defineProperty(s,"PDFDateString",{enumerable:!0,get:function(){return n.PDFDateString}}),Object.defineProperty(s,"PDFWorker",{enumerable:!0,get:function(){return t.PDFWorker}}),Object.defineProperty(s,"PasswordResponses",{enumerable:!0,get:function(){return e.PasswordResponses}}),Object.defineProperty(s,"PermissionFlag",{enumerable:!0,get:function(){return e.PermissionFlag}}),Object.defineProperty(s,"PixelsPerInch",{enumerable:!0,get:function(){return n.PixelsPerInch}}),Object.defineProperty(s,"PromiseCapability",{enumerable:!0,get:function(){return e.PromiseCapability}}),Object.defineProperty(s,"RenderingCancelledException",{enumerable:!0,get:function(){return n.RenderingCancelledException}}),Object.defineProperty(s,"SVGGraphics",{enumerable:!0,get:function(){return t.SVGGraphics}}),Object.defineProperty(s,"UnexpectedResponseException",{enumerable:!0,get:function(){return e.UnexpectedResponseException}}),Object.defineProperty(s,"Util",{enumerable:!0,get:function(){return e.Util}}),Object.defineProperty(s,"VerbosityLevel",{enumerable:!0,get:function(){return e.VerbosityLevel}}),Object.defineProperty(s,"XfaLayer",{enumerable:!0,get:function(){return d.XfaLayer}}),Object.defineProperty(s,"build",{enumerable:!0,get:function(){return t.build}}),Object.defineProperty(s,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return e.createValidAbsoluteUrl}}),Object.defineProperty(s,"getDocument",{enumerable:!0,get:function(){return t.getDocument}}),Object.defineProperty(s,"getFilenameFromUrl",{enumerable:!0,get:function(){return n.getFilenameFromUrl}}),Object.defineProperty(s,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return n.getPdfFilenameFromUrl}}),Object.defineProperty(s,"getXfaPageViewport",{enumerable:!0,get:function(){return n.getXfaPageViewport}}),Object.defineProperty(s,"isDataScheme",{enumerable:!0,get:function(){return n.isDataScheme}}),Object.defineProperty(s,"isPdfFile",{enumerable:!0,get:function(){return n.isPdfFile}}),Object.defineProperty(s,"loadScript",{enumerable:!0,get:function(){return n.loadScript}}),Object.defineProperty(s,"noContextMenu",{enumerable:!0,get:function(){return n.noContextMenu}}),Object.defineProperty(s,"normalizeUnicode",{enumerable:!0,get:function(){return e.normalizeUnicode}}),Object.defineProperty(s,"renderTextLayer",{enumerable:!0,get:function(){return i.renderTextLayer}}),Object.defineProperty(s,"setLayerDimensions",{enumerable:!0,get:function(){return n.setLayerDimensions}}),Object.defineProperty(s,"shadow",{enumerable:!0,get:function(){return e.shadow}}),Object.defineProperty(s,"updateTextLayer",{enumerable:!0,get:function(){return i.updateTextLayer}}),Object.defineProperty(s,"version",{enumerable:!0,get:function(){return t.version}});var e=__w_pdfjs_require__(1),t=__w_pdfjs_require__(2),n=__w_pdfjs_require__(6),i=__w_pdfjs_require__(26),o=__w_pdfjs_require__(27),a=__w_pdfjs_require__(5),l=__w_pdfjs_require__(29),h=__w_pdfjs_require__(14),d=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf$1)),pdf$1.exports}var pdfExports=requirePdf();const pdf=getDefaultExportFromCjs(pdfExports),pdfjs=pdf;var __spreadArray=function(s,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return s.concat(o||Array.prototype.slice.call(e))},clipboardEvents=["onCopy","onCut","onPaste"],compositionEvents=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],focusEvents=["onFocus","onBlur"],formEvents=["onInput","onInvalid","onReset","onSubmit"],imageEvents=["onLoad","onError"],keyboardEvents=["onKeyDown","onKeyPress","onKeyUp"],mediaEvents=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],mouseEvents=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],dragEvents=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],selectionEvents=["onSelect"],touchEvents=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],pointerEvents=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],uiEvents=["onScroll"],wheelEvents=["onWheel"],animationEvents=["onAnimationStart","onAnimationEnd","onAnimationIteration"],transitionEvents=["onTransitionEnd"],otherEvents=["onToggle"],changeEvents=["onChange"],allEvents=__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray(__spreadArray([],clipboardEvents,!0),compositionEvents,!0),focusEvents,!0),formEvents,!0),imageEvents,!0),keyboardEvents,!0),mediaEvents,!0),mouseEvents,!0),dragEvents,!0),selectionEvents,!0),touchEvents,!0),pointerEvents,!0),uiEvents,!0),wheelEvents,!0),animationEvents,!0),transitionEvents,!0),changeEvents,!0),otherEvents,!0);function makeEventProps(s,e){var t={};return allEvents.forEach(function(n){var i=s[n];i&&(e?t[n]=(function(o){return i(o,e(n))}):t[n]=i)}),t}function makeCancellablePromise(s){var e=!1,t=new Promise(function(n,i){s.then(function(o){return!e&&n(o)}).catch(function(o){return!e&&i(o)})});return{promise:t,cancel:function(){e=!0}}}var prefix="Invariant failed";function invariant$1(s,e){if(!s)throw new Error(prefix)}var warning_1,hasRequiredWarning;function requireWarning(){if(hasRequiredWarning)return warning_1;hasRequiredWarning=1;var s=function(){};return warning_1=s,warning_1}var warningExports=requireWarning();const warning=getDefaultExportFromCjs(warningExports);var has=Object.prototype.hasOwnProperty;function find(s,e,t){for(t of s.keys())if(dequal(t,e))return t}function dequal(s,e){var t,n,i;if(s===e)return!0;if(s&&e&&(t=s.constructor)===e.constructor){if(t===Date)return s.getTime()===e.getTime();if(t===RegExp)return s.toString()===e.toString();if(t===Array){if((n=s.length)===e.length)for(;n--&&dequal(s[n],e[n]););return n===-1}if(t===Set){if(s.size!==e.size)return!1;for(n of s)if(i=n,i&&typeof i=="object"&&(i=find(e,i),!i)||!e.has(i))return!1;return!0}if(t===Map){if(s.size!==e.size)return!1;for(n of s)if(i=n[0],i&&typeof i=="object"&&(i=find(e,i),!i)||!dequal(n[1],e.get(i)))return!1;return!0}if(t===ArrayBuffer)s=new Uint8Array(s),e=new Uint8Array(e);else if(t===DataView){if((n=s.byteLength)===e.byteLength)for(;n--&&s.getInt8(n)===e.getInt8(n););return n===-1}if(ArrayBuffer.isView(s)){if((n=s.byteLength)===e.byteLength)for(;n--&&s[n]===e[n];);return n===-1}if(!t||typeof s=="object"){n=0;for(t in s)if(has.call(s,t)&&++n&&!has.call(e,t)||!(t in e)||!dequal(s[t],e[t]))return!1;return Object.keys(e).length===n}}return s!==s&&e!==e}const DocumentContext=reactExports.createContext(null);function Message({children:s,type:e}){return React.createElement("div",{className:`react-pdf__message react-pdf__message--${e}`},s)}const DEFAULT_LINK_REL="noopener noreferrer nofollow";class LinkService{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(e){this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setExternalLinkRel(e){this.externalLinkRel=e}setExternalLinkTarget(e){this.externalLinkTarget=e}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return invariant$1(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(e){invariant$1(this.pdfViewer),this.pdfViewer.currentPageNumber=e}get rotation(){return 0}set rotation(e){}goToDestination(e){return new Promise(t=>{invariant$1(this.pdfDocument),invariant$1(e),typeof e=="string"?this.pdfDocument.getDestination(e).then(t):Array.isArray(e)?t(e):e.then(t)}).then(t=>{invariant$1(Array.isArray(t));const n=t[0];new Promise(i=>{invariant$1(this.pdfDocument),n instanceof Object?this.pdfDocument.getPageIndex(n).then(o=>{i(o)}).catch(()=>{invariant$1(!1)}):typeof n=="number"?i(n):invariant$1(!1)}).then(i=>{const o=i+1;invariant$1(this.pdfViewer),invariant$1(o>=1&&o<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:t,pageIndex:i,pageNumber:o})})})}navigateTo(e){this.goToDestination(e)}goToPage(e){const t=e-1;invariant$1(this.pdfViewer),invariant$1(e>=1&&e<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:t,pageNumber:e})}addLinkAttributes(e,t,n){e.href=t,e.rel=this.externalLinkRel||DEFAULT_LINK_REL,e.target=n?"_blank":this.externalLinkTarget||""}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}setHash(){}executeNamedAction(){}cachePageRef(){}isPageVisible(){return!0}isPageCached(){return!0}executeSetOCGState(){}}const PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2},isBrowser$1=typeof document<"u",isLocalFileSystem=isBrowser$1&&window.location.protocol==="file:";function isDefined(s){return typeof s<"u"}function isProvided(s){return isDefined(s)&&s!==null}function isString(s){return typeof s=="string"}function isArrayBuffer(s){return s instanceof ArrayBuffer}function isBlob(s){return invariant$1(isBrowser$1),s instanceof Blob}function isDataURI(s){return isString(s)&&/^data:/.test(s)}function dataURItoByteString(s){invariant$1(isDataURI(s));const[e="",t=""]=s.split(",");return e.split(";").indexOf("base64")!==-1?atob(t):unescape(t)}function getDevicePixelRatio(){return isBrowser$1&&window.devicePixelRatio||1}const allowFileAccessFromFilesTip="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function displayCORSWarning(){warning(!isLocalFileSystem,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function displayWorkerWarning(){warning(!isLocalFileSystem,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${allowFileAccessFromFilesTip}`)}function cancelRunningTask(s){s&&s.cancel&&s.cancel()}function makePageCallback(s,e){return Object.defineProperty(s,"width",{get(){return this.view[2]*e},configurable:!0}),Object.defineProperty(s,"height",{get(){return this.view[3]*e},configurable:!0}),Object.defineProperty(s,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(s,"originalHeight",{get(){return this.view[3]},configurable:!0}),s}function isCancelException(s){return s.name==="RenderingCancelledException"}function loadFromFile(s){return new Promise((e,t)=>{const n=new FileReader;n.onload=()=>{if(!n.result)return t(new Error("Error while reading a file."));e(n.result)},n.onerror=i=>{if(!i.target)return t(new Error("Error while reading a file."));const{error:o}=i.target;if(!o)return t(new Error("Error while reading a file."));switch(o.code){case o.NOT_FOUND_ERR:return t(new Error("Error while reading a file: File not found."));case o.SECURITY_ERR:return t(new Error("Error while reading a file: Security error."));case o.ABORT_ERR:return t(new Error("Error while reading a file: Aborted."));default:return t(new Error("Error while reading a file."))}},n.readAsArrayBuffer(s)})}function reducer(s,e){switch(e.type){case"RESOLVE":return{value:e.value,error:void 0};case"REJECT":return{value:!1,error:e.error};case"RESET":return{value:void 0,error:void 0};default:return s}}function useResolver(){return reactExports.useReducer(reducer,{value:void 0,error:void 0})}const{PDFDataRangeTransport:PDFDataRangeTransport$1}=pdfjs,eventProps=(()=>{const s={};return allEvents.forEach(e=>{s[e]=PropTypes.func}),s})(),isTypedArray=PropTypes.oneOfType([PropTypes.instanceOf(Int8Array),PropTypes.instanceOf(Uint8Array),PropTypes.instanceOf(Uint8ClampedArray),PropTypes.instanceOf(Int16Array),PropTypes.instanceOf(Uint16Array),PropTypes.instanceOf(Int32Array),PropTypes.instanceOf(Uint32Array),PropTypes.instanceOf(Float32Array),PropTypes.instanceOf(Float64Array)]),fileTypes=[PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.shape({data:PropTypes.oneOfType([PropTypes.string,PropTypes.instanceOf(ArrayBuffer),PropTypes.arrayOf(PropTypes.number.isRequired),isTypedArray]).isRequired}),PropTypes.shape({range:PropTypes.instanceOf(PDFDataRangeTransport$1).isRequired}),PropTypes.shape({url:PropTypes.string.isRequired})];typeof Blob<"u"&&fileTypes.push(PropTypes.instanceOf(Blob));const isClassName=PropTypes.oneOfType([PropTypes.string,PropTypes.arrayOf(PropTypes.string)]),isFile=PropTypes.oneOfType(fileTypes);PropTypes.instanceOf(LinkService);PropTypes.oneOf(["_self","_blank","_parent","_top"]);PropTypes.shape({commonObjs:PropTypes.shape({}).isRequired,getAnnotations:PropTypes.func.isRequired,getTextContent:PropTypes.func.isRequired,getViewport:PropTypes.func.isRequired,render:PropTypes.func.isRequired});const isPageIndex=function s(e,t,n){const{[t]:i,pageNumber:o,pdf:a}=e;if(!isDefined(a))return null;if(isDefined(i)){if(typeof i!="number")return new Error(`\`${t}\` of type \`${typeof i}\` supplied to \`${n}\`, expected \`number\`.`);if(i<0)return new Error(`Expected \`${t}\` to be greater or equal to 0.`);const{numPages:l}=a;if(i+1>l)return new Error(`Expected \`${t}\` to be less or equal to ${l-1}.`)}else if(!isDefined(o))return new Error(`\`${t}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${n}\`.`);return null},isPageNumber=function s(e,t,n){const{[t]:i,pageIndex:o,pdf:a}=e;if(!isDefined(a))return null;if(isDefined(i)){if(typeof i!="number")return new Error(`\`${t}\` of type \`${typeof i}\` supplied to \`${n}\`, expected \`number\`.`);if(i<1)return new Error(`Expected \`${t}\` to be greater or equal to 1.`);const{numPages:l}=a;if(i>l)return new Error(`Expected \`${t}\` to be less or equal to ${l}.`)}else if(!isDefined(o))return new Error(`\`${t}\` not supplied. Either pageIndex or pageNumber must be supplied to \`${n}\`.`);return null},isPdf=PropTypes.oneOfType([PropTypes.any,PropTypes.oneOf([!1])]),isRef=PropTypes.oneOfType([PropTypes.func,PropTypes.exact({current:PropTypes.any})]),isRenderMode=PropTypes.oneOf(["canvas","custom","none","svg"]),isRotate=PropTypes.oneOf([0,90,180,270]);var __awaiter=function(s,e,t,n){function i(o){return o instanceof t?o:new t(function(a){a(o)})}return new(t||(t=Promise))(function(o,a){function l(u){try{d(n.next(u))}catch(f){a(f)}}function h(u){try{d(n.throw(u))}catch(f){a(f)}}function d(u){u.done?o(u.value):i(u.value).then(l,h)}d((n=n.apply(s,e||[])).next())})},__rest$1=function(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(s);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(s,n[i])&&(t[n[i]]=s[n[i]]);return t};const{PDFDataRangeTransport}=pdfjs,defaultOnPassword=(s,e)=>{switch(e){case PasswordResponses.NEED_PASSWORD:{const t=prompt("Enter the password to open this PDF file.");s(t);break}case PasswordResponses.INCORRECT_PASSWORD:{const t=prompt("Invalid password. Please try again.");s(t);break}}};function isParameterObject(s){return typeof s=="object"&&s!==null&&("data"in s||"range"in s||"url"in s)}const Document=reactExports.forwardRef(function s(e,t){var{children:n,className:i,error:o="Failed to load PDF file.",externalLinkRel:a,externalLinkTarget:l,file:h,inputRef:d,imageResourcesPath:u,loading:f="Loading PDF",noData:m="No PDF file specified.",onItemClick:v,onLoadError:g,onLoadProgress:x,onLoadSuccess:E,onPassword:b=defaultOnPassword,onSourceError:_,onSourceSuccess:S,options:C,renderMode:A,rotate:R}=e,L=__rest$1(e,["children","className","error","externalLinkRel","externalLinkTarget","file","inputRef","imageResourcesPath","loading","noData","onItemClick","onLoadError","onLoadProgress","onLoadSuccess","onPassword","onSourceError","onSourceSuccess","options","renderMode","rotate"]);const[j,F]=useResolver(),{value:W,error:K}=j,[ee,te]=useResolver(),{value:re,error:ie}=ee,Q=reactExports.useRef(new LinkService),z=reactExports.useRef([]),N=reactExports.useRef(),k=reactExports.useRef();reactExports.useEffect(()=>{h&&h!==N.current&&isParameterObject(h)&&(warning(!dequal(h,N.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),N.current=h)},[h]),reactExports.useEffect(()=>{C&&C!==k.current&&(warning(!dequal(C,k.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),k.current=C)},[C]);const I=reactExports.useRef({scrollPageIntoView:ue=>{const{dest:de,pageNumber:pe,pageIndex:ye=pe-1}=ue;if(v){v({dest:de,pageIndex:ye,pageNumber:pe});return}const Ae=z.current[ye];if(Ae){Ae.scrollIntoView();return}warning(!1,`An internal link leading to page ${pe} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});reactExports.useImperativeHandle(t,()=>({linkService:Q,pages:z,viewer:I}),[]);function D(){S&&S()}function U(){K&&(warning(!1,K.toString()),_&&_(K))}function $(){F({type:"RESET"})}reactExports.useEffect($,[h,F]);const q=reactExports.useCallback(()=>__awaiter(this,void 0,void 0,function*(){if(!h)return null;if(typeof h=="string")return isDataURI(h)?{data:dataURItoByteString(h)}:(displayCORSWarning(),{url:h});if(h instanceof PDFDataRangeTransport)return{range:h};if(isArrayBuffer(h))return{data:h};if(isBrowser$1&&isBlob(h))return{data:yield loadFromFile(h)};if(invariant$1(typeof h=="object"),invariant$1(isParameterObject(h)),"url"in h&&typeof h.url=="string"){if(isDataURI(h.url)){const{url:ue}=h,de=__rest$1(h,["url"]),pe=dataURItoByteString(ue);return Object.assign({data:pe},de)}displayCORSWarning()}return h}),[h]);reactExports.useEffect(()=>{const ue=makeCancellablePromise(q());return ue.promise.then(de=>{F({type:"RESOLVE",value:de})}).catch(de=>{F({type:"REJECT",error:de})}),()=>{cancelRunningTask(ue)}},[q,F]),reactExports.useEffect(()=>{if(!(typeof W>"u")){if(W===!1){U();return}D()}},[W]);function V(){re&&(E&&E(re),z.current=new Array(re.numPages),Q.current.setDocument(re))}function P(){ie&&(warning(!1,ie.toString()),g&&g(ie))}function O(){te({type:"RESET"})}reactExports.useEffect(O,[te,W]);function B(){if(!W)return;const ue=Object.assign(Object.assign({},C),{isEvalSupported:!1}),de=Object.assign(Object.assign({},W),ue),pe=pdfjs.getDocument(de);x&&(pe.onProgress=x),b&&(pe.onPassword=b);const ye=pe;return ye.promise.then(Ae=>{te({type:"RESOLVE",value:Ae})}).catch(Ae=>{ye.destroyed||te({type:"REJECT",error:Ae})}),()=>{ye.destroy()}}reactExports.useEffect(B,[C,te,W]),reactExports.useEffect(()=>{if(!(typeof re>"u")){if(re===!1){P();return}V()}},[re]);function G(){Q.current.setViewer(I.current),Q.current.setExternalLinkRel(a),Q.current.setExternalLinkTarget(l)}reactExports.useEffect(G,[a,l]);function Y(ue,de){z.current[ue]=de}function J(ue){delete z.current[ue]}const Z=reactExports.useMemo(()=>({imageResourcesPath:u,linkService:Q.current,onItemClick:v,pdf:re,registerPage:Y,renderMode:A,rotate:R,unregisterPage:J}),[u,v,re,A,R]),oe=reactExports.useMemo(()=>makeEventProps(L,()=>re),[L,re]);function ve(){return React.createElement(DocumentContext.Provider,{value:Z},n)}function ce(){return h?re==null?React.createElement(Message,{type:"loading"},typeof f=="function"?f():f):re===!1?React.createElement(Message,{type:"error"},typeof o=="function"?o():o):ve():React.createElement(Message,{type:"no-data"},typeof m=="function"?m():m)}return React.createElement("div",Object.assign({className:clsx("react-pdf__Document",i),ref:d,style:{"--scale-factor":"1"}},oe),ce())}),isFunctionOrNode$1=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Document.propTypes=Object.assign(Object.assign({},eventProps),{children:PropTypes.node,className:isClassName,error:isFunctionOrNode$1,externalLinkRel:PropTypes.string,externalLinkTarget:PropTypes.oneOf(["_self","_blank","_parent","_top"]),file:isFile,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode$1,noData:isFunctionOrNode$1,onItemClick:PropTypes.func,onLoadError:PropTypes.func,onLoadProgress:PropTypes.func,onLoadSuccess:PropTypes.func,onPassword:PropTypes.func,onSourceError:PropTypes.func,onSourceSuccess:PropTypes.func,options:PropTypes.shape({canvasFactory:PropTypes.any,canvasMaxAreaInBytes:PropTypes.number,cMapPacked:PropTypes.bool,CMapReaderFactory:PropTypes.any,cMapUrl:PropTypes.string,disableAutoFetch:PropTypes.bool,disableFontFace:PropTypes.bool,disableRange:PropTypes.bool,disableStream:PropTypes.bool,docBaseUrl:PropTypes.string,enableXfa:PropTypes.bool,filterFactory:PropTypes.any,fontExtraProperties:PropTypes.bool,httpHeaders:PropTypes.object,isEvalSupported:PropTypes.bool,isOffscreenCanvasSupported:PropTypes.bool,length:PropTypes.number,maxImageSize:PropTypes.number,ownerDocument:PropTypes.any,password:PropTypes.string,pdfBug:PropTypes.bool,rangeChunkSize:PropTypes.number,StandardFontDataFactory:PropTypes.any,standardFontDataUrl:PropTypes.string,stopAtErrors:PropTypes.bool,useSystemFonts:PropTypes.bool,useWorkerFetch:PropTypes.bool,verbosity:PropTypes.number,withCredentials:PropTypes.bool,worker:PropTypes.any}),rotate:PropTypes.number});function useDocumentContext(){return reactExports.useContext(DocumentContext)}function mergeRefs(){for(var s=[],e=0;e<arguments.length;e++)s[e]=arguments[e];var t=s.filter(Boolean);if(t.length<=1){var n=t[0];return n||null}return function(o){t.forEach(function(a){typeof a=="function"?a(o):a&&(a.current=o)})}}const PageContext=reactExports.createContext(null),PDF_ROLE_TO_HTML_ROLE={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},HEADING_PATTERN=/^H(\d+)$/;function isPdfRole(s){return s in PDF_ROLE_TO_HTML_ROLE}function isStructTreeNode(s){return"children"in s}function isStructTreeNodeWithOnlyContentChild(s){return isStructTreeNode(s)?s.children.length===1&&0 in s.children&&"id"in s.children[0]:!1}function getRoleAttributes(s){const e={};if(isStructTreeNode(s)){const{role:t}=s,n=t.match(HEADING_PATTERN);if(n)e.role="heading",e["aria-level"]=Number(n[1]);else if(isPdfRole(t)){const i=PDF_ROLE_TO_HTML_ROLE[t];i&&(e.role=i)}}return e}function getBaseAttributes(s){const e={};if(isStructTreeNode(s)){if(s.alt!==void 0&&(e["aria-label"]=s.alt),s.lang!==void 0&&(e.lang=s.lang),isStructTreeNodeWithOnlyContentChild(s)){const[t]=s.children;if(t){const n=getBaseAttributes(t);return Object.assign(Object.assign({},e),n)}}}else"id"in s&&(e["aria-owns"]=s.id);return e}function getAttributes(s){return s?Object.assign(Object.assign({},getRoleAttributes(s)),getBaseAttributes(s)):null}function StructTreeItem({className:s,node:e}){const t=reactExports.useMemo(()=>getAttributes(e),[e]),n=reactExports.useMemo(()=>!isStructTreeNode(e)||isStructTreeNodeWithOnlyContentChild(e)?null:e.children.map((i,o)=>React.createElement(StructTreeItem,{key:o,node:i})),[e]);return React.createElement("span",Object.assign({className:s},t),n)}function usePageContext(){return reactExports.useContext(PageContext)}function StructTree(){const s=usePageContext();invariant$1(s);const{onGetStructTreeError:e,onGetStructTreeSuccess:t}=s,[n,i]=useResolver(),{value:o,error:a}=n,{customTextRenderer:l,page:h}=s;function d(){o&&t&&t(o)}function u(){a&&(warning(!1,a.toString()),e&&e(a))}function f(){i({type:"RESET"})}reactExports.useEffect(f,[i,h]);function m(){if(l||!h)return;const v=makeCancellablePromise(h.getStructTree()),g=v;return v.promise.then(x=>{i({type:"RESOLVE",value:x})}).catch(x=>{i({type:"REJECT",error:x})}),()=>cancelRunningTask(g)}return reactExports.useEffect(m,[l,h,i]),reactExports.useEffect(()=>{if(o!==void 0){if(o===!1){u();return}d()}},[o]),o?React.createElement(StructTreeItem,{className:"react-pdf__Page__structTree structTree",node:o}):null}const ANNOTATION_MODE=pdfjs.AnnotationMode;function PageCanvas(s){const e=usePageContext();invariant$1(e);const t=Object.assign(Object.assign({},e),s),{_className:n,canvasBackground:i,devicePixelRatio:o=getDevicePixelRatio(),onRenderError:a,onRenderSuccess:l,page:h,renderForms:d,renderTextLayer:u,rotate:f,scale:m}=t,{canvasRef:v}=s;invariant$1(h);const g=reactExports.useRef(null);function x(){h&&l&&l(makePageCallback(h,m))}function E(A){isCancelException(A)||(warning(!1,A.toString()),a&&a(A))}const b=reactExports.useMemo(()=>h.getViewport({scale:m*o,rotation:f}),[o,h,f,m]),_=reactExports.useMemo(()=>h.getViewport({scale:m,rotation:f}),[h,f,m]);function S(){if(!h)return;h.cleanup();const{current:A}=g;if(!A)return;A.width=b.width,A.height=b.height,A.style.width=`${Math.floor(_.width)}px`,A.style.height=`${Math.floor(_.height)}px`,A.style.visibility="hidden";const R={annotationMode:d?ANNOTATION_MODE.ENABLE_FORMS:ANNOTATION_MODE.ENABLE,canvasContext:A.getContext("2d",{alpha:!1}),viewport:b};i&&(R.background=i);const L=h.render(R),j=L;return L.promise.then(()=>{A.style.visibility="",x()}).catch(E),()=>cancelRunningTask(j)}reactExports.useEffect(S,[i,g,o,h,d,b,_]);const C=reactExports.useCallback(()=>{const{current:A}=g;A&&(A.width=0,A.height=0)},[g]);return reactExports.useEffect(()=>C,[C]),React.createElement("canvas",{className:`${n}__canvas`,dir:"ltr",ref:mergeRefs(v,g),style:{display:"block",userSelect:"none"}},u?React.createElement(StructTree,null):null)}function PageSVG(){const s=usePageContext();invariant$1(s);const{_className:e,onRenderSuccess:t,onRenderError:n,page:i,rotate:o,scale:a}=s;invariant$1(i);const[l,h]=useResolver(),{value:d,error:u}=l;function f(){i&&t&&t(makePageCallback(i,a))}function m(){u&&(isCancelException(u)||(warning(!1,u.toString()),n&&n(u)))}const v=reactExports.useMemo(()=>i.getViewport({scale:a,rotation:o}),[i,o,a]);function g(){h({type:"RESET"})}reactExports.useEffect(g,[i,h,v]);function x(){if(!i)return;const S=makeCancellablePromise(i.getOperatorList());return S.promise.then(C=>{new pdfjs.SVGGraphics(i.commonObjs,i.objs).getSVG(C,v).then(R=>{if(!(R instanceof SVGElement))throw new Error("getSVG returned unexpected result.");h({type:"RESOLVE",value:R})}).catch(R=>{h({type:"REJECT",error:R})})}).catch(C=>{h({type:"REJECT",error:C})}),()=>cancelRunningTask(S)}reactExports.useEffect(x,[i,h,v]),reactExports.useEffect(()=>{if(d!==void 0){if(d===!1){m();return}f()}},[d]);function E(S){if(!S||!d)return;S.firstElementChild||S.appendChild(d);const{width:C,height:A}=v;d.setAttribute("width",`${C}`),d.setAttribute("height",`${A}`)}const{width:b,height:_}=v;return React.createElement("div",{className:`${e}__svg`,ref:S=>E(S),style:{display:"block",backgroundColor:"white",overflow:"hidden",width:b,height:_,userSelect:"none"}})}function isTextItem(s){return"str"in s}function TextLayer(){const s=usePageContext();invariant$1(s);const{customTextRenderer:e,onGetTextError:t,onGetTextSuccess:n,onRenderTextLayerError:i,onRenderTextLayerSuccess:o,page:a,pageIndex:l,pageNumber:h,rotate:d,scale:u}=s;invariant$1(a);const[f,m]=useResolver(),{value:v,error:g}=f,x=reactExports.useRef(null),E=reactExports.useRef();warning(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function b(){v&&n&&n(v)}function _(){g&&(warning(!1,g.toString()),t&&t(g))}function S(){m({type:"RESET"})}reactExports.useEffect(S,[a,m]);function C(){if(!a)return;const K=makeCancellablePromise(a.getTextContent()),ee=K;return K.promise.then(te=>{m({type:"RESOLVE",value:te})}).catch(te=>{m({type:"REJECT",error:te})}),()=>cancelRunningTask(ee)}reactExports.useEffect(C,[a,m]),reactExports.useEffect(()=>{if(v!==void 0){if(v===!1){_();return}b()}},[v]);const A=reactExports.useCallback(()=>{o&&o()},[o]),R=reactExports.useCallback(K=>{warning(!1,K.toString()),i&&i(K)},[i]);function L(){const K=E.current;K&&K.classList.add("active")}function j(){const K=E.current;K&&K.classList.remove("active")}const F=reactExports.useMemo(()=>a.getViewport({scale:u,rotation:d}),[a,d,u]);function W(){if(!a||!v)return;const{current:K}=x;if(!K)return;K.innerHTML="";const ee=a.streamTextContent({includeMarkedContent:!0}),te={container:K,textContentSource:ee,viewport:F},re=pdfjs.renderTextLayer(te),ie=re;return re.promise.then(()=>{const Q=document.createElement("div");Q.className="endOfContent",K.append(Q),E.current=Q;const z=K.querySelectorAll('[role="presentation"]');if(e){let N=0;v.items.forEach((k,I)=>{if(!isTextItem(k))return;const D=z[N];if(!D)return;const U=e(Object.assign({pageIndex:l,pageNumber:h,itemIndex:I},k));D.innerHTML=U,N+=k.str&&k.hasEOL?2:1})}A()}).catch(R),()=>cancelRunningTask(ie)}return reactExports.useLayoutEffect(W,[e,R,A,a,l,h,v,F]),React.createElement("div",{className:clsx("react-pdf__Page__textContent","textLayer"),onMouseUp:j,onMouseDown:L,ref:x})}function AnnotationLayer(){const s=useDocumentContext(),e=usePageContext();invariant$1(e);const t=Object.assign(Object.assign({},s),e),{imageResourcesPath:n,linkService:i,onGetAnnotationsError:o,onGetAnnotationsSuccess:a,onRenderAnnotationLayerError:l,onRenderAnnotationLayerSuccess:h,page:d,pdf:u,renderForms:f,rotate:m,scale:v=1}=t;invariant$1(u),invariant$1(d),invariant$1(i);const[g,x]=useResolver(),{value:E,error:b}=g,_=reactExports.useRef(null);warning(parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function S(){E&&a&&a(E)}function C(){b&&(warning(!1,b.toString()),o&&o(b))}function A(){x({type:"RESET"})}reactExports.useEffect(A,[x,d]);function R(){if(!d)return;const K=makeCancellablePromise(d.getAnnotations()),ee=K;return K.promise.then(te=>{x({type:"RESOLVE",value:te})}).catch(te=>{x({type:"REJECT",error:te})}),()=>{cancelRunningTask(ee)}}reactExports.useEffect(R,[x,d,f]),reactExports.useEffect(()=>{if(E!==void 0){if(E===!1){C();return}S()}},[E]);function L(){h&&h()}function j(K){warning(!1,`${K}`),l&&l(K)}const F=reactExports.useMemo(()=>d.getViewport({scale:v,rotation:m}),[d,m,v]);function W(){if(!u||!d||!i||!E)return;const{current:K}=_;if(!K)return;const ee=F.clone({dontFlip:!0}),te={accessibilityManager:null,annotationCanvasMap:null,div:K,l10n:null,page:d,viewport:ee},re={annotations:E,annotationStorage:u.annotationStorage,div:K,downloadManager:null,imageResourcesPath:n,linkService:i,page:d,renderForms:f,viewport:ee};K.innerHTML="";try{new pdfjs.AnnotationLayer(te).render(re),L()}catch(ie){j(ie)}return()=>{}}return reactExports.useEffect(W,[E,n,i,d,f,F]),React.createElement("div",{className:clsx("react-pdf__Page__annotations","annotationLayer"),ref:_})}var __rest=function(s,e){var t={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&e.indexOf(n)<0&&(t[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(s);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(s,n[i])&&(t[n[i]]=s[n[i]]);return t};const defaultScale=1,Page=function s(e){const t=useDocumentContext(),n=Object.assign(Object.assign({},t),e),{_className:i="react-pdf__Page",_enableRegisterUnregisterPage:o=!0,canvasBackground:a,canvasRef:l,children:h,className:d,customRenderer:u,customTextRenderer:f,devicePixelRatio:m,error:v="Failed to load the page.",height:g,inputRef:x,loading:E="Loading page",noData:b="No page specified.",onGetAnnotationsError:_,onGetAnnotationsSuccess:S,onGetStructTreeError:C,onGetStructTreeSuccess:A,onGetTextError:R,onGetTextSuccess:L,onLoadError:j,onLoadSuccess:F,onRenderAnnotationLayerError:W,onRenderAnnotationLayerSuccess:K,onRenderError:ee,onRenderSuccess:te,onRenderTextLayerError:re,onRenderTextLayerSuccess:ie,pageIndex:Q,pageNumber:z,pdf:N,registerPage:k,renderAnnotationLayer:I=!0,renderForms:D=!1,renderMode:U="canvas",renderTextLayer:$=!0,rotate:q,scale:V=defaultScale,unregisterPage:P,width:O}=n,B=__rest(n,["_className","_enableRegisterUnregisterPage","canvasBackground","canvasRef","children","className","customRenderer","customTextRenderer","devicePixelRatio","error","height","inputRef","loading","noData","onGetAnnotationsError","onGetAnnotationsSuccess","onGetStructTreeError","onGetStructTreeSuccess","onGetTextError","onGetTextSuccess","onLoadError","onLoadSuccess","onRenderAnnotationLayerError","onRenderAnnotationLayerSuccess","onRenderError","onRenderSuccess","onRenderTextLayerError","onRenderTextLayerSuccess","pageIndex","pageNumber","pdf","registerPage","renderAnnotationLayer","renderForms","renderMode","renderTextLayer","rotate","scale","unregisterPage","width"]),[G,Y]=useResolver(),{value:J,error:Z}=G,oe=reactExports.useRef(null);invariant$1(N);const ve=isProvided(z)?z-1:Q??null,ce=z??(isProvided(Q)?Q+1:null),ue=q??(J?J.rotate:null),de=reactExports.useMemo(()=>{if(!J)return null;let ut=1;const Ot=V??defaultScale;if(O||g){const be=J.getViewport({scale:1,rotation:ue});O?ut=O/be.width:g&&(ut=g/be.height)}return Ot*ut},[g,J,ue,V,O]);function pe(){return()=>{isProvided(ve)&&o&&P&&P(ve)}}reactExports.useEffect(pe,[o,N,ve,P]);function ye(){if(F){if(!J||!de)return;F(makePageCallback(J,de))}if(o&&k){if(!isProvided(ve)||!oe.current)return;k(ve,oe.current)}}function Ae(){Z&&(warning(!1,Z.toString()),j&&j(Z))}function Ce(){Y({type:"RESET"})}reactExports.useEffect(Ce,[Y,N,ve]);function Pe(){if(!N||!ce)return;const ut=makeCancellablePromise(N.getPage(ce)),Ot=ut;return ut.promise.then(be=>{Y({type:"RESOLVE",value:be})}).catch(be=>{Y({type:"REJECT",error:be})}),()=>cancelRunningTask(Ot)}reactExports.useEffect(Pe,[Y,N,ve,ce,k]),reactExports.useEffect(()=>{if(J!==void 0){if(J===!1){Ae();return}ye()}},[J,de]);const Oe=reactExports.useMemo(()=>J&&isProvided(ve)&&ce&&isProvided(ue)&&isProvided(de)?{_className:i,canvasBackground:a,customTextRenderer:f,devicePixelRatio:m,onGetAnnotationsError:_,onGetAnnotationsSuccess:S,onGetStructTreeError:C,onGetStructTreeSuccess:A,onGetTextError:R,onGetTextSuccess:L,onRenderAnnotationLayerError:W,onRenderAnnotationLayerSuccess:K,onRenderError:ee,onRenderSuccess:te,onRenderTextLayerError:re,onRenderTextLayerSuccess:ie,page:J,pageIndex:ve,pageNumber:ce,renderForms:D,renderTextLayer:$,rotate:ue,scale:de}:null,[i,a,f,m,_,S,C,A,R,L,W,K,ee,te,re,ie,J,ve,ce,D,$,ue,de]),xe=reactExports.useMemo(()=>makeEventProps(B,()=>J&&(de?makePageCallback(J,de):void 0)),[B,J,de]),Te=`${ve}@${de}/${ue}`,$e=`${ve}/${ue}`;function Ue(){switch(U){case"custom":return invariant$1(u),React.createElement(u,{key:`${Te}_custom`});case"none":return null;case"svg":return React.createElement(PageSVG,{key:`${$e}_svg`});case"canvas":default:return React.createElement(PageCanvas,{key:`${Te}_canvas`,canvasRef:l})}}function qe(){return $?React.createElement(TextLayer,{key:`${Te}_text`}):null}function Ke(){return I?React.createElement(AnnotationLayer,{key:`${Te}_annotations`}):null}function Ge(){return React.createElement(PageContext.Provider,{value:Oe},Ue(),qe(),Ke(),h)}function xt(){return ce?N===null||J===void 0||J===null?React.createElement(Message,{type:"loading"},typeof E=="function"?E():E):N===!1||J===!1?React.createElement(Message,{type:"error"},typeof v=="function"?v():v):Ge():React.createElement(Message,{type:"no-data"},typeof b=="function"?b():b)}return React.createElement("div",Object.assign({className:clsx(i,d),"data-page-number":ce,ref:mergeRefs(x,oe),style:{"--scale-factor":`${de}`,backgroundColor:a||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"}},xe),xt())},isFunctionOrNode=PropTypes.oneOfType([PropTypes.func,PropTypes.node]);Page.propTypes=Object.assign(Object.assign({},eventProps),{canvasBackground:PropTypes.string,canvasRef:isRef,children:PropTypes.node,className:isClassName,customRenderer:PropTypes.func,customTextRenderer:PropTypes.func,devicePixelRatio:PropTypes.number,error:isFunctionOrNode,height:PropTypes.number,imageResourcesPath:PropTypes.string,inputRef:isRef,loading:isFunctionOrNode,noData:isFunctionOrNode,onGetTextError:PropTypes.func,onGetTextSuccess:PropTypes.func,onLoadError:PropTypes.func,onLoadSuccess:PropTypes.func,onRenderError:PropTypes.func,onRenderSuccess:PropTypes.func,onRenderTextLayerError:PropTypes.func,onRenderTextLayerSuccess:PropTypes.func,pageIndex:isPageIndex,pageNumber:isPageNumber,pdf:isPdf,renderAnnotationLayer:PropTypes.bool,renderForms:PropTypes.bool,renderMode:isRenderMode,renderTextLayer:PropTypes.bool,rotate:isRotate,scale:PropTypes.number,width:PropTypes.number});displayWorkerWarning();pdfjs.GlobalWorkerOptions.workerSrc="pdf.worker.js";pdfjs.GlobalWorkerOptions.workerSrc=`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjs.version}/pdf.worker.min.js`;function PDFReader({onTextSelect:s}){const[e,t]=reactExports.useState(100),[n,i]=reactExports.useState(!1),o=reactExports.useRef(null),{currentTextbook:a,currentPage:l,currentPageData:h,loading:d,nextPage:u,prevPage:f,uploadTextbook:m}=useTextbook(),v=async(x,E)=>{await m(x,E)},g=()=>{const x=window.getSelection(),E=x?.toString().trim();if(E&&E.length>10&&o.current){const _=x?.getRangeAt(0)?.getBoundingClientRect();_&&s(E,{x:_.left+_.width/2,y:_.top})}};return a?jsxRuntimeExports.jsxs("div",{className:"h-full flex flex-col bg-white",children:[jsxRuntimeExports.jsxs("div",{className:"px-3 py-2 border-b border-border flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"sm",onClick:f,disabled:l===1||d,className:"h-7 px-2",children:jsxRuntimeExports.jsx(ChevronLeft,{className:"w-4 h-4"})}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-muted-foreground min-w-[80px] text-center",children:[l," / ",a.total_pages]}),jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"sm",onClick:u,disabled:l===a.total_pages||d,className:"h-7 px-2",children:jsxRuntimeExports.jsx(ChevronRight,{className:"w-4 h-4"})})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"sm",onClick:()=>t(Math.max(50,e-10)),className:"h-7 px-2",children:jsxRuntimeExports.jsx(ZoomOut,{className:"w-4 h-4"})}),jsxRuntimeExports.jsxs("span",{className:"text-xs text-muted-foreground min-w-[50px] text-center",children:[e,"%"]}),jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"sm",onClick:()=>t(Math.min(200,e+10)),className:"h-7 px-2",children:jsxRuntimeExports.jsx(ZoomIn,{className:"w-4 h-4"})})]})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-auto bg-neutral-100 p-6",children:d?jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center h-full",children:jsxRuntimeExports.jsx(LoaderCircle,{className:"w-8 h-8 animate-spin text-muted-foreground"})}):a?.pdf_url?jsxRuntimeExports.jsx("div",{className:"flex justify-center",ref:o,onMouseUp:g,children:jsxRuntimeExports.jsx(Document,{file:a.pdf_url,loading:jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center py-20",children:jsxRuntimeExports.jsx(LoaderCircle,{className:"w-8 h-8 animate-spin text-muted-foreground"})}),error:jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center py-20",children:jsxRuntimeExports.jsx("p",{className:"text-red-500",children:"Failed to load PDF"})}),children:jsxRuntimeExports.jsx(Page,{pageNumber:l,scale:e/100,className:"shadow-lg",loading:jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center py-20",children:jsxRuntimeExports.jsx(LoaderCircle,{className:"w-6 h-6 animate-spin text-muted-foreground"})}),renderTextLayer:!0,renderAnnotationLayer:!0})})}):jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center h-full",children:jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"No PDF available"})})})]}):jsxRuntimeExports.jsxs("div",{className:"h-full flex items-center justify-center bg-neutral-100",children:[jsxRuntimeExports.jsxs("div",{className:"text-center space-y-6 max-w-md px-6",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx("div",{className:"flex justify-center",children:jsxRuntimeExports.jsx("div",{className:"p-4 bg-primary/10 rounded-full",children:jsxRuntimeExports.jsx(Upload,{className:"w-12 h-12 text-primary"})})}),jsxRuntimeExports.jsx("h3",{className:"text-xl font-semibold",children:"No textbook loaded"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Upload a PDF textbook to start reading with AI-powered summaries, practice questions, and interactive chat."})]}),jsxRuntimeExports.jsx("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:jsxRuntimeExports.jsxs(Button,{onClick:x=>{x.preventDefault(),x.stopPropagation(),console.log("Upload button clicked!"),i(!0)},size:"lg",children:[jsxRuntimeExports.jsx(Upload,{className:"w-4 h-4 mr-2"}),"Upload PDF"]})}),jsxRuntimeExports.jsx("div",{className:"pt-4 border-t border-border",children:jsxRuntimeExports.jsx("p",{className:"text-xs text-muted-foreground",children:"Supported: PDF files up to 50MB"})})]}),jsxRuntimeExports.jsx(UploadDialog,{open:n,onOpenChange:i,onUpload:v})]})}var TABS_NAME="Tabs",[createTabsContext]=createContextScope(TABS_NAME,[createRovingFocusGroupScope]),useRovingFocusGroupScope=createRovingFocusGroupScope(),[TabsProvider,useTabsContext]=createTabsContext(TABS_NAME),Tabs$1=reactExports.forwardRef((s,e)=>{const{__scopeTabs:t,value:n,onValueChange:i,defaultValue:o,orientation:a="horizontal",dir:l,activationMode:h="automatic",...d}=s,u=useDirection(l),[f,m]=useControllableState({prop:n,onChange:i,defaultProp:o??"",caller:TABS_NAME});return jsxRuntimeExports.jsx(TabsProvider,{scope:t,baseId:useId$1(),value:f,onValueChange:m,orientation:a,dir:u,activationMode:h,children:jsxRuntimeExports.jsx(Primitive.div,{dir:u,"data-orientation":a,...d,ref:e})})});Tabs$1.displayName=TABS_NAME;var TAB_LIST_NAME="TabsList",TabsList$1=reactExports.forwardRef((s,e)=>{const{__scopeTabs:t,loop:n=!0,...i}=s,o=useTabsContext(TAB_LIST_NAME,t),a=useRovingFocusGroupScope(t);return jsxRuntimeExports.jsx(Root$3,{asChild:!0,...a,orientation:o.orientation,dir:o.dir,loop:n,children:jsxRuntimeExports.jsx(Primitive.div,{role:"tablist","aria-orientation":o.orientation,...i,ref:e})})});TabsList$1.displayName=TAB_LIST_NAME;var TRIGGER_NAME="TabsTrigger",TabsTrigger$1=reactExports.forwardRef((s,e)=>{const{__scopeTabs:t,value:n,disabled:i=!1,...o}=s,a=useTabsContext(TRIGGER_NAME,t),l=useRovingFocusGroupScope(t),h=makeTriggerId(a.baseId,n),d=makeContentId(a.baseId,n),u=n===a.value;return jsxRuntimeExports.jsx(Item,{asChild:!0,...l,focusable:!i,active:u,children:jsxRuntimeExports.jsx(Primitive.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":d,"data-state":u?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:h,...o,ref:e,onMouseDown:composeEventHandlers$1(s.onMouseDown,f=>{!i&&f.button===0&&f.ctrlKey===!1?a.onValueChange(n):f.preventDefault()}),onKeyDown:composeEventHandlers$1(s.onKeyDown,f=>{[" ","Enter"].includes(f.key)&&a.onValueChange(n)}),onFocus:composeEventHandlers$1(s.onFocus,()=>{const f=a.activationMode!=="manual";!u&&!i&&f&&a.onValueChange(n)})})})});TabsTrigger$1.displayName=TRIGGER_NAME;var CONTENT_NAME="TabsContent",TabsContent$1=reactExports.forwardRef((s,e)=>{const{__scopeTabs:t,value:n,forceMount:i,children:o,...a}=s,l=useTabsContext(CONTENT_NAME,t),h=makeTriggerId(l.baseId,n),d=makeContentId(l.baseId,n),u=n===l.value,f=reactExports.useRef(u);return reactExports.useEffect(()=>{const m=requestAnimationFrame(()=>f.current=!1);return()=>cancelAnimationFrame(m)},[]),jsxRuntimeExports.jsx(Presence,{present:i||u,children:({present:m})=>jsxRuntimeExports.jsx(Primitive.div,{"data-state":u?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":h,hidden:!m,id:d,tabIndex:0,...a,ref:e,style:{...s.style,animationDuration:f.current?"0s":void 0},children:m&&o})})});TabsContent$1.displayName=CONTENT_NAME;function makeTriggerId(s,e){return`${s}-trigger-${e}`}function makeContentId(s,e){return`${s}-content-${e}`}var Root2=Tabs$1,List=TabsList$1,Trigger=TabsTrigger$1,Content=TabsContent$1;function Tabs({className:s,...e}){return jsxRuntimeExports.jsx(Root2,{"data-slot":"tabs",className:cn("flex flex-col gap-2",s),...e})}function TabsList({className:s,...e}){return jsxRuntimeExports.jsx(List,{"data-slot":"tabs-list",className:cn("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-xl p-[3px] flex",s),...e})}function TabsTrigger({className:s,...e}){return jsxRuntimeExports.jsx(Trigger,{"data-slot":"tabs-trigger",className:cn("data-[state=active]:bg-card dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-xl border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",s),...e})}function TabsContent({className:s,...e}){return jsxRuntimeExports.jsx(Content,{"data-slot":"tabs-content",className:cn("flex-1 outline-none",s),...e})}function SummaryPanel({onHeadingClick:s}){const{currentTextbook:e,currentPage:t}=useTextbook(),[n,i]=reactExports.useState(null),[o,a]=reactExports.useState(null),[l,h]=reactExports.useState(!0);return reactExports.useEffect(()=>{(async()=>{if(!(!e||!t))try{h(!0);const{data:u,error:f}=await supabase.from("chapters").select("*, chapter_summaries(*)").eq("textbook_id",e.id).lte("page_start",t).gte("page_end",t).single();if(f&&f.code!=="PGRST116"){console.error("[SummaryPanel] Error loading chapter:",f);return}if(u){i(u);const m=u.chapter_summaries?.[0];a(m?{chapter_number:u.chapter_number,title:u.title,summary_text:m.summary_text,key_concepts:m.key_concepts||[]}:null)}}catch(u){console.error("[SummaryPanel] Error:",u)}finally{h(!1)}})()},[e,t]),l?jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center py-8",children:jsxRuntimeExports.jsx(LoaderCircle,{className:"w-6 h-6 animate-spin text-muted-foreground"})}):o?jsxRuntimeExports.jsxs("div",{className:"px-3 space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"pb-2 border-b border-border",children:[jsxRuntimeExports.jsxs("div",{className:"text-xs font-medium text-muted-foreground",children:["Chapter ",o.chapter_number]}),jsxRuntimeExports.jsx("h3",{className:"text-sm font-semibold mt-1",children:o.title})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx("h4",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wide",children:"Summary"}),jsxRuntimeExports.jsx("p",{className:"text-xs leading-relaxed text-foreground/90",children:o.summary_text})]}),o.key_concepts&&o.key_concepts.length>0&&jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx("h4",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wide",children:"Key Concepts"}),jsxRuntimeExports.jsx("ul",{className:"space-y-2",children:o.key_concepts.map((d,u)=>jsxRuntimeExports.jsxs("li",{className:"flex items-start gap-2",children:[jsxRuntimeExports.jsx("span",{className:"text-xs text-accent mt-0.5",children:""}),jsxRuntimeExports.jsx("span",{className:"text-xs leading-relaxed",children:d})]},u))})]})]}):jsxRuntimeExports.jsxs("div",{className:"px-3 py-4 text-xs text-muted-foreground space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(BookOpen,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("p",{className:"font-medium",children:"Summary not available yet"})]}),jsxRuntimeExports.jsx("p",{children:"AI analysis is still being generated for this chapter. Check back soon!"})]})}function RecallPanel(){const[s,e]=reactExports.useState(new Set),{currentTextbook:t,currentPage:n}=useTextbook(),[i,o]=reactExports.useState([]),[a,l]=reactExports.useState(!0);if(reactExports.useEffect(()=>{(async()=>{if(!(!t||!n))try{l(!0);const{data:f,error:m}=await supabase.from("chapters").select("id").eq("textbook_id",t.id).lte("page_start",n).gte("page_end",n).single();if(m&&m.code!=="PGRST116"){console.error("[RecallPanel] Error loading chapter:",m);return}if(f){const{data:v,error:g}=await supabase.from("recall_questions").select("*").eq("chapter_id",f.id).order("order_index");if(g){console.error("[RecallPanel] Error loading questions:",g);return}o(v||[])}}catch(f){console.error("[RecallPanel] Error:",f)}finally{l(!1)}})()},[t,n]),a)return jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center py-8",children:jsxRuntimeExports.jsx(LoaderCircle,{className:"w-6 h-6 animate-spin text-muted-foreground"})});const h=u=>{const f=new Set(s);f.has(u)?f.delete(u):f.add(u),e(f)},d=()=>{e(new Set)};return!i||i.length===0?jsxRuntimeExports.jsxs("div",{className:"px-3 py-4 text-xs text-muted-foreground space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(Brain,{className:"w-4 h-4"}),jsxRuntimeExports.jsx("p",{className:"font-medium",children:"Recall questions not available yet"})]}),jsxRuntimeExports.jsx("p",{children:"AI is still generating practice questions for this chapter. Check back soon!"})]}):jsxRuntimeExports.jsxs("div",{className:"space-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between px-3",children:[jsxRuntimeExports.jsxs("span",{className:"text-xs text-muted-foreground",children:[i.length," questions"]}),jsxRuntimeExports.jsxs(Button,{variant:"ghost",size:"sm",onClick:d,className:"h-7 px-2 text-xs",children:[jsxRuntimeExports.jsx(RotateCw,{className:"w-3 h-3 mr-1"}),"Regenerate"]})]}),jsxRuntimeExports.jsx("div",{className:"space-y-2",children:i.map((u,f)=>jsxRuntimeExports.jsxs("div",{className:"border border-border rounded-md overflow-hidden hover:border-accent/50 transition-colors",children:[jsxRuntimeExports.jsx("div",{className:"px-3 py-2 bg-muted/50",children:jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-2",children:[jsxRuntimeExports.jsxs("span",{className:"text-xs font-mono text-muted-foreground mt-0.5",children:["Q",f+1]}),jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("p",{className:"text-xs leading-relaxed",children:u.question}),u.difficulty&&jsxRuntimeExports.jsx("span",{className:"text-xs text-muted-foreground mt-1 inline-block capitalize",children:u.difficulty})]})]})}),s.has(f)?jsxRuntimeExports.jsx("div",{className:"px-3 py-2 bg-accent/5 border-t border-border",children:jsxRuntimeExports.jsx("p",{className:"text-xs leading-relaxed",children:u.answer})}):jsxRuntimeExports.jsx("button",{onClick:()=>h(f),className:"w-full px-3 py-2 text-xs text-accent hover:bg-accent/5 transition-colors border-t border-border",children:"Reveal answer"})]},u.id))})]})}const ChatContext=reactExports.createContext(void 0);function ChatProvider({children:s}){const{user:e}=useAuth(),{currentTextbook:t,currentPage:n,currentPageData:i,currentAIContent:o}=useTextbook(),[a,l]=reactExports.useState([]),[h,d]=reactExports.useState(!1),[u,f]=reactExports.useState(null),m=async()=>{if(!(!e||!t))try{const{data:x,error:E}=await supabase.from("chat_conversations").select("*").eq("user_id",e.id).eq("textbook_id",t.id).order("updated_at",{ascending:!1}).limit(1).single();if(E&&E.code!=="PGRST116")throw E;if(x)f(x.id),l(x.messages||[]);else{const{data:b,error:_}=await supabase.from("chat_conversations").insert({user_id:e.id,textbook_id:t.id,context_pages:[n],messages:[]}).select().single();if(_)throw _;b&&f(b.id)}}catch(x){console.error("[Chat] Failed to load conversation:",x)}},v=async x=>{if(!e||!t||!u)return;const E={role:"user",content:x,timestamp:new Date().toISOString()};l(b=>[...b,E]),d(!0);try{let b="";try{const{data:R}=await supabase.from("chapters").select("chapter_summaries(*)").eq("textbook_id",t.id).lte("page_start",n).gte("page_end",n).single();R?.chapter_summaries?.[0]&&(b=R.chapter_summaries[0].summary_text)}catch{console.log("[Chat] No chapter summary available")}const _=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:x,context:{pageText:i?.raw_text||"",summary:b,page:n},conversationId:u})});if(!_.ok)throw new Error("Failed to get response");const C={role:"assistant",content:(await _.json()).response,timestamp:new Date().toISOString()},A=[...a,E,C];l(A),await supabase.from("chat_conversations").update({messages:A,context_pages:[n],updated_at:new Date().toISOString()}).eq("id",u)}catch(b){console.error("[Chat] Failed to send message:",b),toast.error("Failed to send message. Chat API not configured yet.");const _={role:"assistant",content:"I apologize, but the AI chat service is not yet configured. Please set up the OpenAI API endpoint to enable this feature.",timestamp:new Date().toISOString()};l(S=>[...S,_])}finally{d(!1)}},g=async()=>{if(u)try{await supabase.from("chat_conversations").update({messages:[],updated_at:new Date().toISOString()}).eq("id",u),l([]),toast.success("Chat cleared")}catch(x){console.error("[Chat] Failed to clear chat:",x),toast.error("Failed to clear chat")}};return reactExports.useEffect(()=>{e&&t&&m()},[e,t]),jsxRuntimeExports.jsx(ChatContext.Provider,{value:{messages:a,loading:h,sendMessage:v,clearChat:g},children:s})}function useChat(){const s=reactExports.useContext(ChatContext);if(s===void 0)throw new Error("useChat must be used within a ChatProvider");return s}function ChatPanel(){const{messages:s,loading:e,sendMessage:t}=useChat(),{currentPage:n}=useTextbook(),[i,o]=reactExports.useState(""),a=reactExports.useRef(null),l=()=>{a.current?.scrollIntoView({behavior:"smooth"})};reactExports.useEffect(()=>{l()},[s]);const h=async()=>{if(!i.trim()||e)return;const d=i;o(""),await t(d)};return jsxRuntimeExports.jsxs("div",{className:"flex flex-col h-full",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1 overflow-auto px-3 py-3 space-y-3",children:[s.length===0?jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center h-full",children:jsxRuntimeExports.jsx("p",{className:"text-xs text-muted-foreground text-center px-4",children:"Ask questions about the current page to get AI-powered explanations"})}):jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[s.map((d,u)=>jsxRuntimeExports.jsxs("div",{className:`${d.role==="user"?"ml-8":"mr-8"}`,children:[jsxRuntimeExports.jsx("div",{className:`rounded-md p-2.5 ${d.role==="user"?"bg-accent text-accent-foreground ml-auto":"bg-muted"}`,children:jsxRuntimeExports.jsx("p",{className:"text-xs leading-relaxed whitespace-pre-line",children:d.content})}),d.role==="assistant"&&jsxRuntimeExports.jsx("div",{className:"flex gap-1 mt-1.5 flex-wrap",children:jsxRuntimeExports.jsxs("span",{className:"text-xs px-1.5 py-0.5 bg-accent/10 text-accent rounded border border-accent/20",children:["Page ",n]})})]},u)),e&&jsxRuntimeExports.jsx("div",{className:"mr-8",children:jsxRuntimeExports.jsxs("div",{className:"rounded-md p-2.5 bg-muted flex items-center gap-2",children:[jsxRuntimeExports.jsx(LoaderCircle,{className:"w-3 h-3 animate-spin"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-muted-foreground",children:"Thinking..."})]})})]}),jsxRuntimeExports.jsx("div",{ref:a})]}),jsxRuntimeExports.jsx("div",{className:"border-t border-border p-3",children:jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx(Textarea,{value:i,onChange:d=>o(d.target.value),onKeyDown:d=>{d.key==="Enter"&&!d.shiftKey&&(d.preventDefault(),h())},placeholder:"Ask about this page...",className:"min-h-[60px] text-xs resize-none",disabled:e}),jsxRuntimeExports.jsx(Button,{onClick:h,size:"sm",className:"h-[60px] px-3",disabled:!i.trim()||e,children:e?jsxRuntimeExports.jsx(LoaderCircle,{className:"w-3.5 h-3.5 animate-spin"}):jsxRuntimeExports.jsx(Send,{className:"w-3.5 h-3.5"})})]})})]})}function MinimalAIPane(){const s=e=>{console.log("Scroll to section:",e)};return jsxRuntimeExports.jsx("div",{className:"h-full flex flex-col border-l border-border bg-card",children:jsxRuntimeExports.jsxs(Tabs,{defaultValue:"summary",className:"flex-1 flex flex-col",children:[jsxRuntimeExports.jsxs(TabsList,{className:"w-full justify-start rounded-none border-b border-border bg-transparent h-10 p-0 gap-0",children:[jsxRuntimeExports.jsx(TabsTrigger,{value:"summary",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-accent data-[state=active]:bg-transparent data-[state=active]:shadow-none px-4 text-xs h-10",children:"Summary"}),jsxRuntimeExports.jsx(TabsTrigger,{value:"recall",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-accent data-[state=active]:bg-transparent data-[state=active]:shadow-none px-4 text-xs h-10",children:"Recall"}),jsxRuntimeExports.jsx(TabsTrigger,{value:"chat",className:"rounded-none border-b-2 border-transparent data-[state=active]:border-accent data-[state=active]:bg-transparent data-[state=active]:shadow-none px-4 text-xs h-10",children:"Chat"})]}),jsxRuntimeExports.jsx(TabsContent,{value:"summary",className:"flex-1 overflow-auto py-3 mt-0",children:jsxRuntimeExports.jsx(SummaryPanel,{onHeadingClick:s})}),jsxRuntimeExports.jsx(TabsContent,{value:"recall",className:"flex-1 overflow-auto py-3 mt-0",children:jsxRuntimeExports.jsx(RecallPanel,{})}),jsxRuntimeExports.jsx(TabsContent,{value:"chat",className:"flex-1 overflow-hidden mt-0",children:jsxRuntimeExports.jsx(ChatPanel,{})})]})})}const LayoutGroupContext=reactExports.createContext({});function useConstant(s){const e=reactExports.useRef(null);return e.current===null&&(e.current=s()),e.current}const PresenceContext=reactExports.createContext(null),MotionConfigContext=reactExports.createContext({transformPagePoint:s=>s,isStatic:!1,reducedMotion:"never"});class PopChildMeasure extends reactExports.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const n=this.props.sizeRef.current;n.height=t.offsetHeight||0,n.width=t.offsetWidth||0,n.top=t.offsetTop,n.left=t.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function PopChild({children:s,isPresent:e}){const t=reactExports.useId(),n=reactExports.useRef(null),i=reactExports.useRef({width:0,height:0,top:0,left:0}),{nonce:o}=reactExports.useContext(MotionConfigContext);return reactExports.useInsertionEffect(()=>{const{width:a,height:l,top:h,left:d}=i.current;if(e||!n.current||!a||!l)return;n.current.dataset.motionPopId=t;const u=document.createElement("style");return o&&(u.nonce=o),document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${t}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${l}px !important;
            top: ${h}px !important;
            left: ${d}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[e]),jsxRuntimeExports.jsx(PopChildMeasure,{isPresent:e,childRef:n,sizeRef:i,children:reactExports.cloneElement(s,{ref:n})})}const PresenceChild=({children:s,initial:e,isPresent:t,onExitComplete:n,custom:i,presenceAffectsLayout:o,mode:a})=>{const l=useConstant(newChildrenMap),h=reactExports.useId(),d=reactExports.useCallback(f=>{l.set(f,!0);for(const m of l.values())if(!m)return;n&&n()},[l,n]),u=reactExports.useMemo(()=>({id:h,initial:e,isPresent:t,custom:i,onExitComplete:d,register:f=>(l.set(f,!1),()=>l.delete(f))}),o?[Math.random(),d]:[t,d]);return reactExports.useMemo(()=>{l.forEach((f,m)=>l.set(m,!1))},[t]),reactExports.useEffect(()=>{!t&&!l.size&&n&&n()},[t]),a==="popLayout"&&(s=jsxRuntimeExports.jsx(PopChild,{isPresent:t,children:s})),jsxRuntimeExports.jsx(PresenceContext.Provider,{value:u,children:s})};function newChildrenMap(){return new Map}function usePresence(s=!0){const e=reactExports.useContext(PresenceContext);if(e===null)return[!0,null];const{isPresent:t,onExitComplete:n,register:i}=e,o=reactExports.useId();reactExports.useEffect(()=>{s&&i(o)},[s]);const a=reactExports.useCallback(()=>s&&n&&n(o),[o,n,s]);return!t&&n?[!1,a]:[!0]}const getChildKey=s=>s.key||"";function onlyElements(s){const e=[];return reactExports.Children.forEach(s,t=>{reactExports.isValidElement(t)&&e.push(t)}),e}const isBrowser=typeof window<"u",useIsomorphicLayoutEffect$1=isBrowser?reactExports.useLayoutEffect:reactExports.useEffect,AnimatePresence=({children:s,custom:e,initial:t=!0,onExitComplete:n,presenceAffectsLayout:i=!0,mode:o="sync",propagate:a=!1})=>{const[l,h]=usePresence(a),d=reactExports.useMemo(()=>onlyElements(s),[s]),u=a&&!l?[]:d.map(getChildKey),f=reactExports.useRef(!0),m=reactExports.useRef(d),v=useConstant(()=>new Map),[g,x]=reactExports.useState(d),[E,b]=reactExports.useState(d);useIsomorphicLayoutEffect$1(()=>{f.current=!1,m.current=d;for(let C=0;C<E.length;C++){const A=getChildKey(E[C]);u.includes(A)?v.delete(A):v.get(A)!==!0&&v.set(A,!1)}},[E,u.length,u.join("-")]);const _=[];if(d!==g){let C=[...d];for(let A=0;A<E.length;A++){const R=E[A],L=getChildKey(R);u.includes(L)||(C.splice(A,0,R),_.push(R))}o==="wait"&&_.length&&(C=_),b(onlyElements(C)),x(d);return}const{forceRender:S}=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:E.map(C=>{const A=getChildKey(C),R=a&&!l?!1:d===E||u.includes(A),L=()=>{if(v.has(A))v.set(A,!0);else return;let j=!0;v.forEach(F=>{F||(j=!1)}),j&&(S?.(),b(m.current),a&&h?.(),n&&n())};return jsxRuntimeExports.jsx(PresenceChild,{isPresent:R,initial:!f.current||t?void 0:!1,custom:R?void 0:e,presenceAffectsLayout:i,mode:o,onExitComplete:R?void 0:L,children:C},A)})})},noop=s=>s;let invariant=noop;function memo(s){let e;return()=>(e===void 0&&(e=s()),e)}const progress=(s,e,t)=>{const n=e-s;return n===0?1:(t-s)/n},secondsToMilliseconds=s=>s*1e3,millisecondsToSeconds=s=>s/1e3,MotionGlobalConfig={useManualTiming:!1};function createRenderStep(s){let e=new Set,t=new Set,n=!1,i=!1;const o=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function l(d){o.has(d)&&(h.schedule(d),s()),d(a)}const h={schedule:(d,u=!1,f=!1)=>{const v=f&&n?e:t;return u&&o.add(d),v.has(d)||v.add(d),d},cancel:d=>{t.delete(d),o.delete(d)},process:d=>{if(a=d,n){i=!0;return}n=!0,[e,t]=[t,e],e.forEach(l),e.clear(),n=!1,i&&(i=!1,h.process(d))}};return h}const stepsOrder=["read","resolveKeyframes","update","preRender","render","postRender"],maxElapsed=40;function createRenderBatcher(s,e){let t=!1,n=!0;const i={delta:0,timestamp:0,isProcessing:!1},o=()=>t=!0,a=stepsOrder.reduce((b,_)=>(b[_]=createRenderStep(o),b),{}),{read:l,resolveKeyframes:h,update:d,preRender:u,render:f,postRender:m}=a,v=()=>{const b=performance.now();t=!1,i.delta=n?1e3/60:Math.max(Math.min(b-i.timestamp,maxElapsed),1),i.timestamp=b,i.isProcessing=!0,l.process(i),h.process(i),d.process(i),u.process(i),f.process(i),m.process(i),i.isProcessing=!1,t&&e&&(n=!1,s(v))},g=()=>{t=!0,n=!0,i.isProcessing||s(v)};return{schedule:stepsOrder.reduce((b,_)=>{const S=a[_];return b[_]=(C,A=!1,R=!1)=>(t||g(),S.schedule(C,A,R)),b},{}),cancel:b=>{for(let _=0;_<stepsOrder.length;_++)a[stepsOrder[_]].cancel(b)},state:i,steps:a}}const{schedule:frame,cancel:cancelFrame,state:frameData,steps:frameSteps}=createRenderBatcher(typeof requestAnimationFrame<"u"?requestAnimationFrame:noop,!0),LazyContext=reactExports.createContext({strict:!1}),featureProps={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},featureDefinitions={};for(const s in featureProps)featureDefinitions[s]={isEnabled:e=>featureProps[s].some(t=>!!e[t])};function loadFeatures(s){for(const e in s)featureDefinitions[e]={...featureDefinitions[e],...s[e]}}const validMotionProps=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function isValidMotionProp(s){return s.startsWith("while")||s.startsWith("drag")&&s!=="draggable"||s.startsWith("layout")||s.startsWith("onTap")||s.startsWith("onPan")||s.startsWith("onLayout")||validMotionProps.has(s)}let shouldForward=s=>!isValidMotionProp(s);function loadExternalIsValidProp(s){s&&(shouldForward=e=>e.startsWith("on")?!isValidMotionProp(e):s(e))}try{loadExternalIsValidProp(require("@emotion/is-prop-valid").default)}catch(s){}function filterProps(s,e,t){const n={};for(const i in s)i==="values"&&typeof s.values=="object"||(shouldForward(i)||t===!0&&isValidMotionProp(i)||!e&&!isValidMotionProp(i)||s.draggable&&i.startsWith("onDrag"))&&(n[i]=s[i]);return n}function createDOMMotionComponentProxy(s){if(typeof Proxy>"u")return s;const e=new Map,t=(...n)=>s(...n);return new Proxy(t,{get:(n,i)=>i==="create"?s:(e.has(i)||e.set(i,s(i)),e.get(i))})}const MotionContext=reactExports.createContext({});function isVariantLabel(s){return typeof s=="string"||Array.isArray(s)}function isAnimationControls(s){return s!==null&&typeof s=="object"&&typeof s.start=="function"}const variantPriorityOrder=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],variantProps=["initial",...variantPriorityOrder];function isControllingVariants(s){return isAnimationControls(s.animate)||variantProps.some(e=>isVariantLabel(s[e]))}function isVariantNode(s){return!!(isControllingVariants(s)||s.variants)}function getCurrentTreeVariants(s,e){if(isControllingVariants(s)){const{initial:t,animate:n}=s;return{initial:t===!1||isVariantLabel(t)?t:void 0,animate:isVariantLabel(n)?n:void 0}}return s.inherit!==!1?e:{}}function useCreateMotionContext(s){const{initial:e,animate:t}=getCurrentTreeVariants(s,reactExports.useContext(MotionContext));return reactExports.useMemo(()=>({initial:e,animate:t}),[variantLabelsAsDependency(e),variantLabelsAsDependency(t)])}function variantLabelsAsDependency(s){return Array.isArray(s)?s.join(" "):s}const motionComponentSymbol=Symbol.for("motionComponentSymbol");function isRefObject(s){return s&&typeof s=="object"&&Object.prototype.hasOwnProperty.call(s,"current")}function useMotionRef(s,e,t){return reactExports.useCallback(n=>{n&&s.onMount&&s.onMount(n),e&&(n?e.mount(n):e.unmount()),t&&(typeof t=="function"?t(n):isRefObject(t)&&(t.current=n))},[e])}const camelToDash=s=>s.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),optimizedAppearDataId="framerAppearId",optimizedAppearDataAttribute="data-"+camelToDash(optimizedAppearDataId),{schedule:microtask}=createRenderBatcher(queueMicrotask,!1),SwitchLayoutGroupContext=reactExports.createContext({});function useVisualElement(s,e,t,n,i){var o,a;const{visualElement:l}=reactExports.useContext(MotionContext),h=reactExports.useContext(LazyContext),d=reactExports.useContext(PresenceContext),u=reactExports.useContext(MotionConfigContext).reducedMotion,f=reactExports.useRef(null);n=n||h.renderer,!f.current&&n&&(f.current=n(s,{visualState:e,parent:l,props:t,presenceContext:d,blockInitialAnimation:d?d.initial===!1:!1,reducedMotionConfig:u}));const m=f.current,v=reactExports.useContext(SwitchLayoutGroupContext);m&&!m.projection&&i&&(m.type==="html"||m.type==="svg")&&createProjectionNode$1(f.current,t,i,v);const g=reactExports.useRef(!1);reactExports.useInsertionEffect(()=>{m&&g.current&&m.update(t,d)});const x=t[optimizedAppearDataAttribute],E=reactExports.useRef(!!x&&!(!((o=window.MotionHandoffIsComplete)===null||o===void 0)&&o.call(window,x))&&((a=window.MotionHasOptimisedAnimation)===null||a===void 0?void 0:a.call(window,x)));return useIsomorphicLayoutEffect$1(()=>{m&&(g.current=!0,window.MotionIsMounted=!0,m.updateFeatures(),microtask.render(m.render),E.current&&m.animationState&&m.animationState.animateChanges())}),reactExports.useEffect(()=>{m&&(!E.current&&m.animationState&&m.animationState.animateChanges(),E.current&&(queueMicrotask(()=>{var b;(b=window.MotionHandoffMarkAsComplete)===null||b===void 0||b.call(window,x)}),E.current=!1))}),m}function createProjectionNode$1(s,e,t,n){const{layoutId:i,layout:o,drag:a,dragConstraints:l,layoutScroll:h,layoutRoot:d}=e;s.projection=new t(s.latestValues,e["data-framer-portal-id"]?void 0:getClosestProjectingNode(s.parent)),s.projection.setOptions({layoutId:i,layout:o,alwaysMeasureLayout:!!a||l&&isRefObject(l),visualElement:s,animationType:typeof o=="string"?o:"both",initialPromotionConfig:n,layoutScroll:h,layoutRoot:d})}function getClosestProjectingNode(s){if(s)return s.options.allowProjection!==!1?s.projection:getClosestProjectingNode(s.parent)}function createRendererMotionComponent({preloadedFeatures:s,createVisualElement:e,useRender:t,useVisualState:n,Component:i}){var o,a;s&&loadFeatures(s);function l(d,u){let f;const m={...reactExports.useContext(MotionConfigContext),...d,layoutId:useLayoutId(d)},{isStatic:v}=m,g=useCreateMotionContext(d),x=n(d,v);if(!v&&isBrowser){useStrictMode();const E=getProjectionFunctionality(m);f=E.MeasureLayout,g.visualElement=useVisualElement(i,x,m,e,E.ProjectionNode)}return jsxRuntimeExports.jsxs(MotionContext.Provider,{value:g,children:[f&&g.visualElement?jsxRuntimeExports.jsx(f,{visualElement:g.visualElement,...m}):null,t(i,d,useMotionRef(x,g.visualElement,u),x,v,g.visualElement)]})}l.displayName=`motion.${typeof i=="string"?i:`create(${(a=(o=i.displayName)!==null&&o!==void 0?o:i.name)!==null&&a!==void 0?a:""})`}`;const h=reactExports.forwardRef(l);return h[motionComponentSymbol]=i,h}function useLayoutId({layoutId:s}){const e=reactExports.useContext(LayoutGroupContext).id;return e&&s!==void 0?e+"-"+s:s}function useStrictMode(s,e){reactExports.useContext(LazyContext).strict}function getProjectionFunctionality(s){const{drag:e,layout:t}=featureDefinitions;if(!e&&!t)return{};const n={...e,...t};return{MeasureLayout:e?.isEnabled(s)||t?.isEnabled(s)?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}const lowercaseSVGElements=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function isSVGComponent(s){return typeof s!="string"||s.includes("-")?!1:!!(lowercaseSVGElements.indexOf(s)>-1||/[A-Z]/u.test(s))}function getValueState(s){const e=[{},{}];return s?.values.forEach((t,n)=>{e[0][n]=t.get(),e[1][n]=t.getVelocity()}),e}function resolveVariantFromProps(s,e,t,n){if(typeof e=="function"){const[i,o]=getValueState(n);e=e(t!==void 0?t:s.custom,i,o)}if(typeof e=="string"&&(e=s.variants&&s.variants[e]),typeof e=="function"){const[i,o]=getValueState(n);e=e(t!==void 0?t:s.custom,i,o)}return e}const isKeyframesTarget=s=>Array.isArray(s),isCustomValue=s=>!!(s&&typeof s=="object"&&s.mix&&s.toValue),resolveFinalValueInKeyframes=s=>isKeyframesTarget(s)?s[s.length-1]||0:s,isMotionValue=s=>!!(s&&s.getVelocity);function resolveMotionValue(s){const e=isMotionValue(s)?s.get():s;return isCustomValue(e)?e.toValue():e}function makeState({scrapeMotionValuesFromProps:s,createRenderState:e,onUpdate:t},n,i,o){const a={latestValues:makeLatestValues(n,i,o,s),renderState:e()};return t&&(a.onMount=l=>t({props:n,current:l,...a}),a.onUpdate=l=>t(l)),a}const makeUseVisualState=s=>(e,t)=>{const n=reactExports.useContext(MotionContext),i=reactExports.useContext(PresenceContext),o=()=>makeState(s,e,n,i);return t?o():useConstant(o)};function makeLatestValues(s,e,t,n){const i={},o=n(s,{});for(const m in o)i[m]=resolveMotionValue(o[m]);let{initial:a,animate:l}=s;const h=isControllingVariants(s),d=isVariantNode(s);e&&d&&!h&&s.inherit!==!1&&(a===void 0&&(a=e.initial),l===void 0&&(l=e.animate));let u=t?t.initial===!1:!1;u=u||a===!1;const f=u?l:a;if(f&&typeof f!="boolean"&&!isAnimationControls(f)){const m=Array.isArray(f)?f:[f];for(let v=0;v<m.length;v++){const g=resolveVariantFromProps(s,m[v]);if(g){const{transitionEnd:x,transition:E,...b}=g;for(const _ in b){let S=b[_];if(Array.isArray(S)){const C=u?S.length-1:0;S=S[C]}S!==null&&(i[_]=S)}for(const _ in x)i[_]=x[_]}}}return i}const transformPropOrder=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],transformProps=new Set(transformPropOrder),checkStringStartsWith=s=>e=>typeof e=="string"&&e.startsWith(s),isCSSVariableName=checkStringStartsWith("--"),startsAsVariableToken=checkStringStartsWith("var(--"),isCSSVariableToken=s=>startsAsVariableToken(s)?singleCssVariableRegex.test(s.split("/*")[0].trim()):!1,singleCssVariableRegex=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,getValueAsType=(s,e)=>e&&typeof s=="number"?e.transform(s):s,clamp=(s,e,t)=>t>e?e:t<s?s:t,number={test:s=>typeof s=="number",parse:parseFloat,transform:s=>s},alpha={...number,transform:s=>clamp(0,1,s)},scale={...number,default:1},createUnitType=s=>({test:e=>typeof e=="string"&&e.endsWith(s)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${s}`}),degrees=createUnitType("deg"),percent=createUnitType("%"),px=createUnitType("px"),vh=createUnitType("vh"),vw=createUnitType("vw"),progressPercentage={...percent,parse:s=>percent.parse(s)/100,transform:s=>percent.transform(s*100)},browserNumberValueTypes={borderWidth:px,borderTopWidth:px,borderRightWidth:px,borderBottomWidth:px,borderLeftWidth:px,borderRadius:px,radius:px,borderTopLeftRadius:px,borderTopRightRadius:px,borderBottomRightRadius:px,borderBottomLeftRadius:px,width:px,maxWidth:px,height:px,maxHeight:px,top:px,right:px,bottom:px,left:px,padding:px,paddingTop:px,paddingRight:px,paddingBottom:px,paddingLeft:px,margin:px,marginTop:px,marginRight:px,marginBottom:px,marginLeft:px,backgroundPositionX:px,backgroundPositionY:px},transformValueTypes={rotate:degrees,rotateX:degrees,rotateY:degrees,rotateZ:degrees,scale,scaleX:scale,scaleY:scale,scaleZ:scale,skew:degrees,skewX:degrees,skewY:degrees,distance:px,translateX:px,translateY:px,translateZ:px,x:px,y:px,z:px,perspective:px,transformPerspective:px,opacity:alpha,originX:progressPercentage,originY:progressPercentage,originZ:px},int={...number,transform:Math.round},numberValueTypes={...browserNumberValueTypes,...transformValueTypes,zIndex:int,size:px,fillOpacity:alpha,strokeOpacity:alpha,numOctaves:int},translateAlias={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},numTransforms=transformPropOrder.length;function buildTransform(s,e,t){let n="",i=!0;for(let o=0;o<numTransforms;o++){const a=transformPropOrder[o],l=s[a];if(l===void 0)continue;let h=!0;if(typeof l=="number"?h=l===(a.startsWith("scale")?1:0):h=parseFloat(l)===0,!h||t){const d=getValueAsType(l,numberValueTypes[a]);if(!h){i=!1;const u=translateAlias[a]||a;n+=`${u}(${d}) `}t&&(e[a]=d)}}return n=n.trim(),t?n=t(e,i?"":n):i&&(n="none"),n}function buildHTMLStyles(s,e,t){const{style:n,vars:i,transformOrigin:o}=s;let a=!1,l=!1;for(const h in e){const d=e[h];if(transformProps.has(h)){a=!0;continue}else if(isCSSVariableName(h)){i[h]=d;continue}else{const u=getValueAsType(d,numberValueTypes[h]);h.startsWith("origin")?(l=!0,o[h]=u):n[h]=u}}if(e.transform||(a||t?n.transform=buildTransform(e,s.transform,t):n.transform&&(n.transform="none")),l){const{originX:h="50%",originY:d="50%",originZ:u=0}=o;n.transformOrigin=`${h} ${d} ${u}`}}const dashKeys={offset:"stroke-dashoffset",array:"stroke-dasharray"},camelKeys={offset:"strokeDashoffset",array:"strokeDasharray"};function buildSVGPath(s,e,t=1,n=0,i=!0){s.pathLength=1;const o=i?dashKeys:camelKeys;s[o.offset]=px.transform(-n);const a=px.transform(e),l=px.transform(t);s[o.array]=`${a} ${l}`}function calcOrigin$1(s,e,t){return typeof s=="string"?s:px.transform(e+t*s)}function calcSVGTransformOrigin(s,e,t){const n=calcOrigin$1(e,s.x,s.width),i=calcOrigin$1(t,s.y,s.height);return`${n} ${i}`}function buildSVGAttrs(s,{attrX:e,attrY:t,attrScale:n,originX:i,originY:o,pathLength:a,pathSpacing:l=1,pathOffset:h=0,...d},u,f){if(buildHTMLStyles(s,d,f),u){s.style.viewBox&&(s.attrs.viewBox=s.style.viewBox);return}s.attrs=s.style,s.style={};const{attrs:m,style:v,dimensions:g}=s;m.transform&&(g&&(v.transform=m.transform),delete m.transform),g&&(i!==void 0||o!==void 0||v.transform)&&(v.transformOrigin=calcSVGTransformOrigin(g,i!==void 0?i:.5,o!==void 0?o:.5)),e!==void 0&&(m.x=e),t!==void 0&&(m.y=t),n!==void 0&&(m.scale=n),a!==void 0&&buildSVGPath(m,a,l,h,!1)}const createHtmlRenderState=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),createSvgRenderState=()=>({...createHtmlRenderState(),attrs:{}}),isSVGTag=s=>typeof s=="string"&&s.toLowerCase()==="svg";function renderHTML(s,{style:e,vars:t},n,i){Object.assign(s.style,e,i&&i.getProjectionStyles(n));for(const o in t)s.style.setProperty(o,t[o])}const camelCaseAttributes=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function renderSVG(s,e,t,n){renderHTML(s,e,void 0,n);for(const i in e.attrs)s.setAttribute(camelCaseAttributes.has(i)?i:camelToDash(i),e.attrs[i])}const scaleCorrectors={};function addScaleCorrector(s){Object.assign(scaleCorrectors,s)}function isForcedMotionValue(s,{layout:e,layoutId:t}){return transformProps.has(s)||s.startsWith("origin")||(e||t!==void 0)&&(!!scaleCorrectors[s]||s==="opacity")}function scrapeMotionValuesFromProps$1(s,e,t){var n;const{style:i}=s,o={};for(const a in i)(isMotionValue(i[a])||e.style&&isMotionValue(e.style[a])||isForcedMotionValue(a,s)||((n=t?.getValue(a))===null||n===void 0?void 0:n.liveStyle)!==void 0)&&(o[a]=i[a]);return o}function scrapeMotionValuesFromProps(s,e,t){const n=scrapeMotionValuesFromProps$1(s,e,t);for(const i in s)if(isMotionValue(s[i])||isMotionValue(e[i])){const o=transformPropOrder.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;n[o]=s[i]}return n}function updateSVGDimensions(s,e){try{e.dimensions=typeof s.getBBox=="function"?s.getBBox():s.getBoundingClientRect()}catch{e.dimensions={x:0,y:0,width:0,height:0}}}const layoutProps=["x","y","width","height","cx","cy","r"],svgMotionConfig={useVisualState:makeUseVisualState({scrapeMotionValuesFromProps,createRenderState:createSvgRenderState,onUpdate:({props:s,prevProps:e,current:t,renderState:n,latestValues:i})=>{if(!t)return;let o=!!s.drag;if(!o){for(const l in i)if(transformProps.has(l)){o=!0;break}}if(!o)return;let a=!e;if(e)for(let l=0;l<layoutProps.length;l++){const h=layoutProps[l];s[h]!==e[h]&&(a=!0)}a&&frame.read(()=>{updateSVGDimensions(t,n),frame.render(()=>{buildSVGAttrs(n,i,isSVGTag(t.tagName),s.transformTemplate),renderSVG(t,n)})})}})},htmlMotionConfig={useVisualState:makeUseVisualState({scrapeMotionValuesFromProps:scrapeMotionValuesFromProps$1,createRenderState:createHtmlRenderState})};function copyRawValuesOnly(s,e,t){for(const n in e)!isMotionValue(e[n])&&!isForcedMotionValue(n,t)&&(s[n]=e[n])}function useInitialMotionValues({transformTemplate:s},e){return reactExports.useMemo(()=>{const t=createHtmlRenderState();return buildHTMLStyles(t,e,s),Object.assign({},t.vars,t.style)},[e])}function useStyle(s,e){const t=s.style||{},n={};return copyRawValuesOnly(n,t,s),Object.assign(n,useInitialMotionValues(s,e)),n}function useHTMLProps(s,e){const t={},n=useStyle(s,e);return s.drag&&s.dragListener!==!1&&(t.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=s.drag===!0?"none":`pan-${s.drag==="x"?"y":"x"}`),s.tabIndex===void 0&&(s.onTap||s.onTapStart||s.whileTap)&&(t.tabIndex=0),t.style=n,t}function useSVGProps(s,e,t,n){const i=reactExports.useMemo(()=>{const o=createSvgRenderState();return buildSVGAttrs(o,e,isSVGTag(n),s.transformTemplate),{...o.attrs,style:{...o.style}}},[e]);if(s.style){const o={};copyRawValuesOnly(o,s.style,s),i.style={...o,...i.style}}return i}function createUseRender(s=!1){return(t,n,i,{latestValues:o},a)=>{const h=(isSVGComponent(t)?useSVGProps:useHTMLProps)(n,o,a,t),d=filterProps(n,typeof t=="string",s),u=t!==reactExports.Fragment?{...d,...h,ref:i}:{},{children:f}=n,m=reactExports.useMemo(()=>isMotionValue(f)?f.get():f,[f]);return reactExports.createElement(t,{...u,children:m})}}function createMotionComponentFactory(s,e){return function(n,{forwardMotionProps:i}={forwardMotionProps:!1}){const a={...isSVGComponent(n)?svgMotionConfig:htmlMotionConfig,preloadedFeatures:s,useRender:createUseRender(i),createVisualElement:e,Component:n};return createRendererMotionComponent(a)}}function shallowCompare(s,e){if(!Array.isArray(e))return!1;const t=e.length;if(t!==s.length)return!1;for(let n=0;n<t;n++)if(e[n]!==s[n])return!1;return!0}function resolveVariant(s,e,t){const n=s.getProps();return resolveVariantFromProps(n,e,t!==void 0?t:n.custom,s)}const supportsScrollTimeline=memo(()=>window.ScrollTimeline!==void 0);class BaseGroupPlaybackControls{constructor(e){this.stop=()=>this.runAll("stop"),this.animations=e.filter(Boolean)}get finished(){return Promise.all(this.animations.map(e=>"finished"in e?e.finished:e))}getAll(e){return this.animations[0][e]}setAll(e,t){for(let n=0;n<this.animations.length;n++)this.animations[n][e]=t}attachTimeline(e,t){const n=this.animations.map(i=>{if(supportsScrollTimeline()&&i.attachTimeline)return i.attachTimeline(e);if(typeof t=="function")return t(i)});return()=>{n.forEach((i,o)=>{i&&i(),this.animations[o].stop()})}}get time(){return this.getAll("time")}set time(e){this.setAll("time",e)}get speed(){return this.getAll("speed")}set speed(e){this.setAll("speed",e)}get startTime(){return this.getAll("startTime")}get duration(){let e=0;for(let t=0;t<this.animations.length;t++)e=Math.max(e,this.animations[t].duration);return e}runAll(e){this.animations.forEach(t=>t[e]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class GroupPlaybackControls extends BaseGroupPlaybackControls{then(e,t){return Promise.all(this.animations).then(e).catch(t)}}function getValueTransition(s,e){return s?s[e]||s.default||s:void 0}const maxGeneratorDuration=2e4;function calcGeneratorDuration(s){let e=0;const t=50;let n=s.next(e);for(;!n.done&&e<maxGeneratorDuration;)e+=t,n=s.next(e);return e>=maxGeneratorDuration?1/0:e}function isGenerator(s){return typeof s=="function"}function attachTimeline(s,e){s.timeline=e,s.onfinish=null}const isBezierDefinition=s=>Array.isArray(s)&&typeof s[0]=="number",supportsFlags={linearEasing:void 0};function memoSupports(s,e){const t=memo(s);return()=>{var n;return(n=supportsFlags[e])!==null&&n!==void 0?n:t()}}const supportsLinearEasing=memoSupports(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),generateLinearEasing=(s,e,t=10)=>{let n="";const i=Math.max(Math.round(e/t),2);for(let o=0;o<i;o++)n+=s(progress(0,i-1,o))+", ";return`linear(${n.substring(0,n.length-2)})`};function isWaapiSupportedEasing(s){return!!(typeof s=="function"&&supportsLinearEasing()||!s||typeof s=="string"&&(s in supportedWaapiEasing||supportsLinearEasing())||isBezierDefinition(s)||Array.isArray(s)&&s.every(isWaapiSupportedEasing))}const cubicBezierAsString=([s,e,t,n])=>`cubic-bezier(${s}, ${e}, ${t}, ${n})`,supportedWaapiEasing={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:cubicBezierAsString([0,.65,.55,1]),circOut:cubicBezierAsString([.55,0,1,.45]),backIn:cubicBezierAsString([.31,.01,.66,-.59]),backOut:cubicBezierAsString([.33,1.53,.69,.99])};function mapEasingToNativeEasing(s,e){if(s)return typeof s=="function"&&supportsLinearEasing()?generateLinearEasing(s,e):isBezierDefinition(s)?cubicBezierAsString(s):Array.isArray(s)?s.map(t=>mapEasingToNativeEasing(t,e)||supportedWaapiEasing.easeOut):supportedWaapiEasing[s]}const isDragging={x:!1,y:!1};function isDragActive(){return isDragging.x||isDragging.y}function resolveElements(s,e,t){var n;if(s instanceof Element)return[s];if(typeof s=="string"){let i=document;const o=(n=void 0)!==null&&n!==void 0?n:i.querySelectorAll(s);return o?Array.from(o):[]}return Array.from(s)}function setupGesture(s,e){const t=resolveElements(s),n=new AbortController,i={passive:!0,...e,signal:n.signal};return[t,i,()=>n.abort()]}function filterEvents$1(s){return e=>{e.pointerType==="touch"||isDragActive()||s(e)}}function hover(s,e,t={}){const[n,i,o]=setupGesture(s,t),a=filterEvents$1(l=>{const{target:h}=l,d=e(l);if(typeof d!="function"||!h)return;const u=filterEvents$1(f=>{d(f),h.removeEventListener("pointerleave",u)});h.addEventListener("pointerleave",u,i)});return n.forEach(l=>{l.addEventListener("pointerenter",a,i)}),o}const isNodeOrChild=(s,e)=>e?s===e?!0:isNodeOrChild(s,e.parentElement):!1,isPrimaryPointer=s=>s.pointerType==="mouse"?typeof s.button!="number"||s.button<=0:s.isPrimary!==!1,focusableElements=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function isElementKeyboardAccessible(s){return focusableElements.has(s.tagName)||s.tabIndex!==-1}const isPressing=new WeakSet;function filterEvents(s){return e=>{e.key==="Enter"&&s(e)}}function firePointerEvent(s,e){s.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const enableKeyboardPress=(s,e)=>{const t=s.currentTarget;if(!t)return;const n=filterEvents(()=>{if(isPressing.has(t))return;firePointerEvent(t,"down");const i=filterEvents(()=>{firePointerEvent(t,"up")}),o=()=>firePointerEvent(t,"cancel");t.addEventListener("keyup",i,e),t.addEventListener("blur",o,e)});t.addEventListener("keydown",n,e),t.addEventListener("blur",()=>t.removeEventListener("keydown",n),e)};function isValidPressEvent(s){return isPrimaryPointer(s)&&!isDragActive()}function press(s,e,t={}){const[n,i,o]=setupGesture(s,t),a=l=>{const h=l.currentTarget;if(!isValidPressEvent(l)||isPressing.has(h))return;isPressing.add(h);const d=e(l),u=(v,g)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",m),!(!isValidPressEvent(v)||!isPressing.has(h))&&(isPressing.delete(h),typeof d=="function"&&d(v,{success:g}))},f=v=>{u(v,t.useGlobalTarget||isNodeOrChild(h,v.target))},m=v=>{u(v,!1)};window.addEventListener("pointerup",f,i),window.addEventListener("pointercancel",m,i)};return n.forEach(l=>{!isElementKeyboardAccessible(l)&&l.getAttribute("tabindex")===null&&(l.tabIndex=0),(t.useGlobalTarget?window:l).addEventListener("pointerdown",a,i),l.addEventListener("focus",d=>enableKeyboardPress(d,i),i)}),o}function setDragLock(s){return s==="x"||s==="y"?isDragging[s]?null:(isDragging[s]=!0,()=>{isDragging[s]=!1}):isDragging.x||isDragging.y?null:(isDragging.x=isDragging.y=!0,()=>{isDragging.x=isDragging.y=!1})}const positionalKeys=new Set(["width","height","top","left","right","bottom",...transformPropOrder]);let now;function clearTime(){now=void 0}const time={now:()=>(now===void 0&&time.set(frameData.isProcessing||MotionGlobalConfig.useManualTiming?frameData.timestamp:performance.now()),now),set:s=>{now=s,queueMicrotask(clearTime)}};function addUniqueItem(s,e){s.indexOf(e)===-1&&s.push(e)}function removeItem(s,e){const t=s.indexOf(e);t>-1&&s.splice(t,1)}class SubscriptionManager{constructor(){this.subscriptions=[]}add(e){return addUniqueItem(this.subscriptions,e),()=>removeItem(this.subscriptions,e)}notify(e,t,n){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](e,t,n);else for(let o=0;o<i;o++){const a=this.subscriptions[o];a&&a(e,t,n)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function velocityPerSecond(s,e){return e?s*(1e3/e):0}const MAX_VELOCITY_DELTA=30,isFloat=s=>!isNaN(parseFloat(s));class MotionValue{constructor(e,t={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(n,i=!0)=>{const o=time.now();this.updatedAt!==o&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(n),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){this.current=e,this.updatedAt=time.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=isFloat(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new SubscriptionManager);const n=this.events[e].add(t);return e==="change"?()=>{n(),frame.read(()=>{this.events.change.getSize()||this.stop()})}:n}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){!t||!this.passiveEffect?this.updateAndNotify(e,t):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,t,n){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-n}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=time.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>MAX_VELOCITY_DELTA)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,MAX_VELOCITY_DELTA);return velocityPerSecond(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function motionValue(s,e){return new MotionValue(s,e)}function setMotionValue(s,e,t){s.hasValue(e)?s.getValue(e).set(t):s.addValue(e,motionValue(t))}function setTarget(s,e){const t=resolveVariant(s,e);let{transitionEnd:n={},transition:i={},...o}=t||{};o={...o,...n};for(const a in o){const l=resolveFinalValueInKeyframes(o[a]);setMotionValue(s,a,l)}}function isWillChangeMotionValue(s){return!!(isMotionValue(s)&&s.add)}function addValueToWillChange(s,e){const t=s.getValue("willChange");if(isWillChangeMotionValue(t))return t.add(e)}function getOptimisedAppearId(s){return s.props[optimizedAppearDataAttribute]}const calcBezier=(s,e,t)=>(((1-3*t+3*e)*s+(3*t-6*e))*s+3*e)*s,subdivisionPrecision=1e-7,subdivisionMaxIterations=12;function binarySubdivide(s,e,t,n,i){let o,a,l=0;do a=e+(t-e)/2,o=calcBezier(a,n,i)-s,o>0?t=a:e=a;while(Math.abs(o)>subdivisionPrecision&&++l<subdivisionMaxIterations);return a}function cubicBezier(s,e,t,n){if(s===e&&t===n)return noop;const i=o=>binarySubdivide(o,0,1,s,t);return o=>o===0||o===1?o:calcBezier(i(o),e,n)}const mirrorEasing=s=>e=>e<=.5?s(2*e)/2:(2-s(2*(1-e)))/2,reverseEasing=s=>e=>1-s(1-e),backOut=cubicBezier(.33,1.53,.69,.99),backIn=reverseEasing(backOut),backInOut=mirrorEasing(backIn),anticipate=s=>(s*=2)<1?.5*backIn(s):.5*(2-Math.pow(2,-10*(s-1))),circIn=s=>1-Math.sin(Math.acos(s)),circOut=reverseEasing(circIn),circInOut=mirrorEasing(circIn),isZeroValueString=s=>/^0[^.\s]+$/u.test(s);function isNone(s){return typeof s=="number"?s===0:s!==null?s==="none"||s==="0"||isZeroValueString(s):!0}const sanitize=s=>Math.round(s*1e5)/1e5,floatRegex=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function isNullish(s){return s==null}const singleColorRegex=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,isColorString=(s,e)=>t=>!!(typeof t=="string"&&singleColorRegex.test(t)&&t.startsWith(s)||e&&!isNullish(t)&&Object.prototype.hasOwnProperty.call(t,e)),splitColor=(s,e,t)=>n=>{if(typeof n!="string")return n;const[i,o,a,l]=n.match(floatRegex);return{[s]:parseFloat(i),[e]:parseFloat(o),[t]:parseFloat(a),alpha:l!==void 0?parseFloat(l):1}},clampRgbUnit=s=>clamp(0,255,s),rgbUnit={...number,transform:s=>Math.round(clampRgbUnit(s))},rgba={test:isColorString("rgb","red"),parse:splitColor("red","green","blue"),transform:({red:s,green:e,blue:t,alpha:n=1})=>"rgba("+rgbUnit.transform(s)+", "+rgbUnit.transform(e)+", "+rgbUnit.transform(t)+", "+sanitize(alpha.transform(n))+")"};function parseHex(s){let e="",t="",n="",i="";return s.length>5?(e=s.substring(1,3),t=s.substring(3,5),n=s.substring(5,7),i=s.substring(7,9)):(e=s.substring(1,2),t=s.substring(2,3),n=s.substring(3,4),i=s.substring(4,5),e+=e,t+=t,n+=n,i+=i),{red:parseInt(e,16),green:parseInt(t,16),blue:parseInt(n,16),alpha:i?parseInt(i,16)/255:1}}const hex={test:isColorString("#"),parse:parseHex,transform:rgba.transform},hsla={test:isColorString("hsl","hue"),parse:splitColor("hue","saturation","lightness"),transform:({hue:s,saturation:e,lightness:t,alpha:n=1})=>"hsla("+Math.round(s)+", "+percent.transform(sanitize(e))+", "+percent.transform(sanitize(t))+", "+sanitize(alpha.transform(n))+")"},color={test:s=>rgba.test(s)||hex.test(s)||hsla.test(s),parse:s=>rgba.test(s)?rgba.parse(s):hsla.test(s)?hsla.parse(s):hex.parse(s),transform:s=>typeof s=="string"?s:s.hasOwnProperty("red")?rgba.transform(s):hsla.transform(s)},colorRegex=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function test(s){var e,t;return isNaN(s)&&typeof s=="string"&&(((e=s.match(floatRegex))===null||e===void 0?void 0:e.length)||0)+(((t=s.match(colorRegex))===null||t===void 0?void 0:t.length)||0)>0}const NUMBER_TOKEN="number",COLOR_TOKEN="color",VAR_TOKEN="var",VAR_FUNCTION_TOKEN="var(",SPLIT_TOKEN="${}",complexRegex=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function analyseComplexValue(s){const e=s.toString(),t=[],n={color:[],number:[],var:[]},i=[];let o=0;const l=e.replace(complexRegex,h=>(color.test(h)?(n.color.push(o),i.push(COLOR_TOKEN),t.push(color.parse(h))):h.startsWith(VAR_FUNCTION_TOKEN)?(n.var.push(o),i.push(VAR_TOKEN),t.push(h)):(n.number.push(o),i.push(NUMBER_TOKEN),t.push(parseFloat(h))),++o,SPLIT_TOKEN)).split(SPLIT_TOKEN);return{values:t,split:l,indexes:n,types:i}}function parseComplexValue(s){return analyseComplexValue(s).values}function createTransformer(s){const{split:e,types:t}=analyseComplexValue(s),n=e.length;return i=>{let o="";for(let a=0;a<n;a++)if(o+=e[a],i[a]!==void 0){const l=t[a];l===NUMBER_TOKEN?o+=sanitize(i[a]):l===COLOR_TOKEN?o+=color.transform(i[a]):o+=i[a]}return o}}const convertNumbersToZero=s=>typeof s=="number"?0:s;function getAnimatableNone$1(s){const e=parseComplexValue(s);return createTransformer(s)(e.map(convertNumbersToZero))}const complex={test,parse:parseComplexValue,createTransformer,getAnimatableNone:getAnimatableNone$1},maxDefaults=new Set(["brightness","contrast","saturate","opacity"]);function applyDefaultFilter(s){const[e,t]=s.slice(0,-1).split("(");if(e==="drop-shadow")return s;const[n]=t.match(floatRegex)||[];if(!n)return s;const i=t.replace(n,"");let o=maxDefaults.has(e)?1:0;return n!==t&&(o*=100),e+"("+o+i+")"}const functionRegex=/\b([a-z-]*)\(.*?\)/gu,filter={...complex,getAnimatableNone:s=>{const e=s.match(functionRegex);return e?e.map(applyDefaultFilter).join(" "):s}},defaultValueTypes={...numberValueTypes,color,backgroundColor:color,outlineColor:color,fill:color,stroke:color,borderColor:color,borderTopColor:color,borderRightColor:color,borderBottomColor:color,borderLeftColor:color,filter,WebkitFilter:filter},getDefaultValueType=s=>defaultValueTypes[s];function getAnimatableNone(s,e){let t=getDefaultValueType(s);return t!==filter&&(t=complex),t.getAnimatableNone?t.getAnimatableNone(e):void 0}const invalidTemplates=new Set(["auto","none","0"]);function makeNoneKeyframesAnimatable(s,e,t){let n=0,i;for(;n<s.length&&!i;){const o=s[n];typeof o=="string"&&!invalidTemplates.has(o)&&analyseComplexValue(o).values.length&&(i=s[n]),n++}if(i&&t)for(const o of e)s[o]=getAnimatableNone(t,i)}const isNumOrPxType=s=>s===number||s===px,getPosFromMatrix=(s,e)=>parseFloat(s.split(", ")[e]),getTranslateFromMatrix=(s,e)=>(t,{transform:n})=>{if(n==="none"||!n)return 0;const i=n.match(/^matrix3d\((.+)\)$/u);if(i)return getPosFromMatrix(i[1],e);{const o=n.match(/^matrix\((.+)\)$/u);return o?getPosFromMatrix(o[1],s):0}},transformKeys=new Set(["x","y","z"]),nonTranslationalTransformKeys=transformPropOrder.filter(s=>!transformKeys.has(s));function removeNonTranslationalTransform(s){const e=[];return nonTranslationalTransformKeys.forEach(t=>{const n=s.getValue(t);n!==void 0&&(e.push([t,n.get()]),n.set(t.startsWith("scale")?1:0))}),e}const positionalValues={width:({x:s},{paddingLeft:e="0",paddingRight:t="0"})=>s.max-s.min-parseFloat(e)-parseFloat(t),height:({y:s},{paddingTop:e="0",paddingBottom:t="0"})=>s.max-s.min-parseFloat(e)-parseFloat(t),top:(s,{top:e})=>parseFloat(e),left:(s,{left:e})=>parseFloat(e),bottom:({y:s},{top:e})=>parseFloat(e)+(s.max-s.min),right:({x:s},{left:e})=>parseFloat(e)+(s.max-s.min),x:getTranslateFromMatrix(4,13),y:getTranslateFromMatrix(5,14)};positionalValues.translateX=positionalValues.x;positionalValues.translateY=positionalValues.y;const toResolve=new Set;let isScheduled=!1,anyNeedsMeasurement=!1;function measureAllKeyframes(){if(anyNeedsMeasurement){const s=Array.from(toResolve).filter(n=>n.needsMeasurement),e=new Set(s.map(n=>n.element)),t=new Map;e.forEach(n=>{const i=removeNonTranslationalTransform(n);i.length&&(t.set(n,i),n.render())}),s.forEach(n=>n.measureInitialState()),e.forEach(n=>{n.render();const i=t.get(n);i&&i.forEach(([o,a])=>{var l;(l=n.getValue(o))===null||l===void 0||l.set(a)})}),s.forEach(n=>n.measureEndState()),s.forEach(n=>{n.suspendedScrollY!==void 0&&window.scrollTo(0,n.suspendedScrollY)})}anyNeedsMeasurement=!1,isScheduled=!1,toResolve.forEach(s=>s.complete()),toResolve.clear()}function readAllKeyframes(){toResolve.forEach(s=>{s.readKeyframes(),s.needsMeasurement&&(anyNeedsMeasurement=!0)})}function flushKeyframeResolvers(){readAllKeyframes(),measureAllKeyframes()}class KeyframeResolver{constructor(e,t,n,i,o,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=n,this.motionValue=i,this.element=o,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(toResolve.add(this),isScheduled||(isScheduled=!0,frame.read(readAllKeyframes),frame.resolveKeyframes(measureAllKeyframes))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:n,motionValue:i}=this;for(let o=0;o<e.length;o++)if(e[o]===null)if(o===0){const a=i?.get(),l=e[e.length-1];if(a!==void 0)e[0]=a;else if(n&&t){const h=n.readValue(t,l);h!=null&&(e[0]=h)}e[0]===void 0&&(e[0]=l),i&&a===void 0&&i.set(e[0])}else e[o]=e[o-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),toResolve.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,toResolve.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const isNumericalString=s=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(s),splitCSSVariableRegex=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function parseCSSVariable(s){const e=splitCSSVariableRegex.exec(s);if(!e)return[,];const[,t,n,i]=e;return[`--${t??n}`,i]}function getVariableValue(s,e,t=1){const[n,i]=parseCSSVariable(s);if(!n)return;const o=window.getComputedStyle(e).getPropertyValue(n);if(o){const a=o.trim();return isNumericalString(a)?parseFloat(a):a}return isCSSVariableToken(i)?getVariableValue(i,e,t+1):i}const testValueType=s=>e=>e.test(s),auto={test:s=>s==="auto",parse:s=>s},dimensionValueTypes=[number,px,percent,degrees,vw,vh,auto],findDimensionValueType=s=>dimensionValueTypes.find(testValueType(s));class DOMKeyframesResolver extends KeyframeResolver{constructor(e,t,n,i,o){super(e,t,n,i,o,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:n}=this;if(!t||!t.current)return;super.readKeyframes();for(let h=0;h<e.length;h++){let d=e[h];if(typeof d=="string"&&(d=d.trim(),isCSSVariableToken(d))){const u=getVariableValue(d,t.current);u!==void 0&&(e[h]=u),h===e.length-1&&(this.finalKeyframe=d)}}if(this.resolveNoneKeyframes(),!positionalKeys.has(n)||e.length!==2)return;const[i,o]=e,a=findDimensionValueType(i),l=findDimensionValueType(o);if(a!==l)if(isNumOrPxType(a)&&isNumOrPxType(l))for(let h=0;h<e.length;h++){const d=e[h];typeof d=="string"&&(e[h]=parseFloat(d))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,n=[];for(let i=0;i<e.length;i++)isNone(e[i])&&n.push(i);n.length&&makeNoneKeyframesAnimatable(e,n,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:n}=this;if(!e||!e.current)return;n==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=positionalValues[n](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const i=t[t.length-1];i!==void 0&&e.getValue(n,i).jump(i,!1)}measureEndState(){var e;const{element:t,name:n,unresolvedKeyframes:i}=this;if(!t||!t.current)return;const o=t.getValue(n);o&&o.jump(this.measuredOrigin,!1);const a=i.length-1,l=i[a];i[a]=positionalValues[n](t.measureViewportBox(),window.getComputedStyle(t.current)),l!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=l),!((e=this.removedTransforms)===null||e===void 0)&&e.length&&this.removedTransforms.forEach(([h,d])=>{t.getValue(h).set(d)}),this.resolveNoneKeyframes()}}const isAnimatable=(s,e)=>e==="zIndex"?!1:!!(typeof s=="number"||Array.isArray(s)||typeof s=="string"&&(complex.test(s)||s==="0")&&!s.startsWith("url("));function hasKeyframesChanged(s){const e=s[0];if(s.length===1)return!0;for(let t=0;t<s.length;t++)if(s[t]!==e)return!0}function canAnimate(s,e,t,n){const i=s[0];if(i===null)return!1;if(e==="display"||e==="visibility")return!0;const o=s[s.length-1],a=isAnimatable(i,e),l=isAnimatable(o,e);return!a||!l?!1:hasKeyframesChanged(s)||(t==="spring"||isGenerator(t))&&n}const isNotNull=s=>s!==null;function getFinalKeyframe(s,{repeat:e,repeatType:t="loop"},n){const i=s.filter(isNotNull),o=e&&t!=="loop"&&e%2===1?0:i.length-1;return!o||n===void 0?i[o]:n}const MAX_RESOLVE_DELAY=40;class BaseAnimation{constructor({autoplay:e=!0,delay:t=0,type:n="keyframes",repeat:i=0,repeatDelay:o=0,repeatType:a="loop",...l}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=time.now(),this.options={autoplay:e,delay:t,type:n,repeat:i,repeatDelay:o,repeatType:a,...l},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>MAX_RESOLVE_DELAY?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&flushKeyframeResolvers(),this._resolved}onKeyframesResolved(e,t){this.resolvedAt=time.now(),this.hasAttemptedResolve=!0;const{name:n,type:i,velocity:o,delay:a,onComplete:l,onUpdate:h,isGenerator:d}=this.options;if(!d&&!canAnimate(e,n,i,o))if(a)this.options.duration=0;else{h&&h(getFinalKeyframe(e,this.options,t)),l&&l(),this.resolveFinishedPromise();return}const u=this.initPlayback(e,t);u!==!1&&(this._resolved={keyframes:e,finalKeyframe:t,...u},this.onPostResolved())}onPostResolved(){}then(e,t){return this.currentFinishedPromise.then(e,t)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(e=>{this.resolveFinishedPromise=e})}}const mixNumber$1=(s,e,t)=>s+(e-s)*t;function hueToRgb(s,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?s+(e-s)*6*t:t<1/2?e:t<2/3?s+(e-s)*(2/3-t)*6:s}function hslaToRgba({hue:s,saturation:e,lightness:t,alpha:n}){s/=360,e/=100,t/=100;let i=0,o=0,a=0;if(!e)i=o=a=t;else{const l=t<.5?t*(1+e):t+e-t*e,h=2*t-l;i=hueToRgb(h,l,s+1/3),o=hueToRgb(h,l,s),a=hueToRgb(h,l,s-1/3)}return{red:Math.round(i*255),green:Math.round(o*255),blue:Math.round(a*255),alpha:n}}function mixImmediate(s,e){return t=>t>0?e:s}const mixLinearColor=(s,e,t)=>{const n=s*s,i=t*(e*e-n)+n;return i<0?0:Math.sqrt(i)},colorTypes=[hex,rgba,hsla],getColorType=s=>colorTypes.find(e=>e.test(s));function asRGBA(s){const e=getColorType(s);if(!e)return!1;let t=e.parse(s);return e===hsla&&(t=hslaToRgba(t)),t}const mixColor=(s,e)=>{const t=asRGBA(s),n=asRGBA(e);if(!t||!n)return mixImmediate(s,e);const i={...t};return o=>(i.red=mixLinearColor(t.red,n.red,o),i.green=mixLinearColor(t.green,n.green,o),i.blue=mixLinearColor(t.blue,n.blue,o),i.alpha=mixNumber$1(t.alpha,n.alpha,o),rgba.transform(i))},combineFunctions=(s,e)=>t=>e(s(t)),pipe=(...s)=>s.reduce(combineFunctions),invisibleValues=new Set(["none","hidden"]);function mixVisibility(s,e){return invisibleValues.has(s)?t=>t<=0?s:e:t=>t>=1?e:s}function mixNumber(s,e){return t=>mixNumber$1(s,e,t)}function getMixer(s){return typeof s=="number"?mixNumber:typeof s=="string"?isCSSVariableToken(s)?mixImmediate:color.test(s)?mixColor:mixComplex:Array.isArray(s)?mixArray:typeof s=="object"?color.test(s)?mixColor:mixObject:mixImmediate}function mixArray(s,e){const t=[...s],n=t.length,i=s.map((o,a)=>getMixer(o)(o,e[a]));return o=>{for(let a=0;a<n;a++)t[a]=i[a](o);return t}}function mixObject(s,e){const t={...s,...e},n={};for(const i in t)s[i]!==void 0&&e[i]!==void 0&&(n[i]=getMixer(s[i])(s[i],e[i]));return i=>{for(const o in n)t[o]=n[o](i);return t}}function matchOrder(s,e){var t;const n=[],i={color:0,var:0,number:0};for(let o=0;o<e.values.length;o++){const a=e.types[o],l=s.indexes[a][i[a]],h=(t=s.values[l])!==null&&t!==void 0?t:0;n[o]=h,i[a]++}return n}const mixComplex=(s,e)=>{const t=complex.createTransformer(e),n=analyseComplexValue(s),i=analyseComplexValue(e);return n.indexes.var.length===i.indexes.var.length&&n.indexes.color.length===i.indexes.color.length&&n.indexes.number.length>=i.indexes.number.length?invisibleValues.has(s)&&!i.values.length||invisibleValues.has(e)&&!n.values.length?mixVisibility(s,e):pipe(mixArray(matchOrder(n,i),i.values),t):mixImmediate(s,e)};function mix(s,e,t){return typeof s=="number"&&typeof e=="number"&&typeof t=="number"?mixNumber$1(s,e,t):getMixer(s)(s,e)}const velocitySampleDuration=5;function calcGeneratorVelocity(s,e,t){const n=Math.max(e-velocitySampleDuration,0);return velocityPerSecond(t-s(n),e-n)}const springDefaults={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},safeMin=.001;function findSpring({duration:s=springDefaults.duration,bounce:e=springDefaults.bounce,velocity:t=springDefaults.velocity,mass:n=springDefaults.mass}){let i,o,a=1-e;a=clamp(springDefaults.minDamping,springDefaults.maxDamping,a),s=clamp(springDefaults.minDuration,springDefaults.maxDuration,millisecondsToSeconds(s)),a<1?(i=d=>{const u=d*a,f=u*s,m=u-t,v=calcAngularFreq(d,a),g=Math.exp(-f);return safeMin-m/v*g},o=d=>{const f=d*a*s,m=f*t+t,v=Math.pow(a,2)*Math.pow(d,2)*s,g=Math.exp(-f),x=calcAngularFreq(Math.pow(d,2),a);return(-i(d)+safeMin>0?-1:1)*((m-v)*g)/x}):(i=d=>{const u=Math.exp(-d*s),f=(d-t)*s+1;return-safeMin+u*f},o=d=>{const u=Math.exp(-d*s),f=(t-d)*(s*s);return u*f});const l=5/s,h=approximateRoot(i,o,l);if(s=secondsToMilliseconds(s),isNaN(h))return{stiffness:springDefaults.stiffness,damping:springDefaults.damping,duration:s};{const d=Math.pow(h,2)*n;return{stiffness:d,damping:a*2*Math.sqrt(n*d),duration:s}}}const rootIterations=12;function approximateRoot(s,e,t){let n=t;for(let i=1;i<rootIterations;i++)n=n-s(n)/e(n);return n}function calcAngularFreq(s,e){return s*Math.sqrt(1-e*e)}const durationKeys=["duration","bounce"],physicsKeys=["stiffness","damping","mass"];function isSpringType(s,e){return e.some(t=>s[t]!==void 0)}function getSpringOptions(s){let e={velocity:springDefaults.velocity,stiffness:springDefaults.stiffness,damping:springDefaults.damping,mass:springDefaults.mass,isResolvedFromDuration:!1,...s};if(!isSpringType(s,physicsKeys)&&isSpringType(s,durationKeys))if(s.visualDuration){const t=s.visualDuration,n=2*Math.PI/(t*1.2),i=n*n,o=2*clamp(.05,1,1-(s.bounce||0))*Math.sqrt(i);e={...e,mass:springDefaults.mass,stiffness:i,damping:o}}else{const t=findSpring(s);e={...e,...t,mass:springDefaults.mass},e.isResolvedFromDuration=!0}return e}function spring(s=springDefaults.visualDuration,e=springDefaults.bounce){const t=typeof s!="object"?{visualDuration:s,keyframes:[0,1],bounce:e}:s;let{restSpeed:n,restDelta:i}=t;const o=t.keyframes[0],a=t.keyframes[t.keyframes.length-1],l={done:!1,value:o},{stiffness:h,damping:d,mass:u,duration:f,velocity:m,isResolvedFromDuration:v}=getSpringOptions({...t,velocity:-millisecondsToSeconds(t.velocity||0)}),g=m||0,x=d/(2*Math.sqrt(h*u)),E=a-o,b=millisecondsToSeconds(Math.sqrt(h/u)),_=Math.abs(E)<5;n||(n=_?springDefaults.restSpeed.granular:springDefaults.restSpeed.default),i||(i=_?springDefaults.restDelta.granular:springDefaults.restDelta.default);let S;if(x<1){const A=calcAngularFreq(b,x);S=R=>{const L=Math.exp(-x*b*R);return a-L*((g+x*b*E)/A*Math.sin(A*R)+E*Math.cos(A*R))}}else if(x===1)S=A=>a-Math.exp(-b*A)*(E+(g+b*E)*A);else{const A=b*Math.sqrt(x*x-1);S=R=>{const L=Math.exp(-x*b*R),j=Math.min(A*R,300);return a-L*((g+x*b*E)*Math.sinh(j)+A*E*Math.cosh(j))/A}}const C={calculatedDuration:v&&f||null,next:A=>{const R=S(A);if(v)l.done=A>=f;else{let L=0;x<1&&(L=A===0?secondsToMilliseconds(g):calcGeneratorVelocity(S,A,R));const j=Math.abs(L)<=n,F=Math.abs(a-R)<=i;l.done=j&&F}return l.value=l.done?a:R,l},toString:()=>{const A=Math.min(calcGeneratorDuration(C),maxGeneratorDuration),R=generateLinearEasing(L=>C.next(A*L).value,A,30);return A+"ms "+R}};return C}function inertia({keyframes:s,velocity:e=0,power:t=.8,timeConstant:n=325,bounceDamping:i=10,bounceStiffness:o=500,modifyTarget:a,min:l,max:h,restDelta:d=.5,restSpeed:u}){const f=s[0],m={done:!1,value:f},v=j=>l!==void 0&&j<l||h!==void 0&&j>h,g=j=>l===void 0?h:h===void 0||Math.abs(l-j)<Math.abs(h-j)?l:h;let x=t*e;const E=f+x,b=a===void 0?E:a(E);b!==E&&(x=b-f);const _=j=>-x*Math.exp(-j/n),S=j=>b+_(j),C=j=>{const F=_(j),W=S(j);m.done=Math.abs(F)<=d,m.value=m.done?b:W};let A,R;const L=j=>{v(m.value)&&(A=j,R=spring({keyframes:[m.value,g(m.value)],velocity:calcGeneratorVelocity(S,j,m.value),damping:i,stiffness:o,restDelta:d,restSpeed:u}))};return L(0),{calculatedDuration:null,next:j=>{let F=!1;return!R&&A===void 0&&(F=!0,C(j),L(j)),A!==void 0&&j>=A?R.next(j-A):(!F&&C(j),m)}}}const easeIn=cubicBezier(.42,0,1,1),easeOut=cubicBezier(0,0,.58,1),easeInOut=cubicBezier(.42,0,.58,1),isEasingArray=s=>Array.isArray(s)&&typeof s[0]!="number",easingLookup={linear:noop,easeIn,easeInOut,easeOut,circIn,circInOut,circOut,backIn,backInOut,backOut,anticipate},easingDefinitionToFunction=s=>{if(isBezierDefinition(s)){invariant(s.length===4);const[e,t,n,i]=s;return cubicBezier(e,t,n,i)}else if(typeof s=="string")return easingLookup[s];return s};function createMixers(s,e,t){const n=[],i=t||mix,o=s.length-1;for(let a=0;a<o;a++){let l=i(s[a],s[a+1]);if(e){const h=Array.isArray(e)?e[a]||noop:e;l=pipe(h,l)}n.push(l)}return n}function interpolate(s,e,{clamp:t=!0,ease:n,mixer:i}={}){const o=s.length;if(invariant(o===e.length),o===1)return()=>e[0];if(o===2&&e[0]===e[1])return()=>e[1];const a=s[0]===s[1];s[0]>s[o-1]&&(s=[...s].reverse(),e=[...e].reverse());const l=createMixers(e,n,i),h=l.length,d=u=>{if(a&&u<s[0])return e[0];let f=0;if(h>1)for(;f<s.length-2&&!(u<s[f+1]);f++);const m=progress(s[f],s[f+1],u);return l[f](m)};return t?u=>d(clamp(s[0],s[o-1],u)):d}function fillOffset(s,e){const t=s[s.length-1];for(let n=1;n<=e;n++){const i=progress(0,e,n);s.push(mixNumber$1(t,1,i))}}function defaultOffset(s){const e=[0];return fillOffset(e,s.length-1),e}function convertOffsetToTimes(s,e){return s.map(t=>t*e)}function defaultEasing(s,e){return s.map(()=>e||easeInOut).splice(0,s.length-1)}function keyframes({duration:s=300,keyframes:e,times:t,ease:n="easeInOut"}){const i=isEasingArray(n)?n.map(easingDefinitionToFunction):easingDefinitionToFunction(n),o={done:!1,value:e[0]},a=convertOffsetToTimes(t&&t.length===e.length?t:defaultOffset(e),s),l=interpolate(a,e,{ease:Array.isArray(i)?i:defaultEasing(e,i)});return{calculatedDuration:s,next:h=>(o.value=l(h),o.done=h>=s,o)}}const frameloopDriver=s=>{const e=({timestamp:t})=>s(t);return{start:()=>frame.update(e,!0),stop:()=>cancelFrame(e),now:()=>frameData.isProcessing?frameData.timestamp:time.now()}},generators={decay:inertia,inertia,tween:keyframes,keyframes,spring},percentToProgress=s=>s/100;class MainThreadAnimation extends BaseAnimation{constructor(e){super(e),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:h}=this.options;h&&h()};const{name:t,motionValue:n,element:i,keyframes:o}=this.options,a=i?.KeyframeResolver||KeyframeResolver,l=(h,d)=>this.onKeyframesResolved(h,d);this.resolver=new a(o,l,t,n,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(e){const{type:t="keyframes",repeat:n=0,repeatDelay:i=0,repeatType:o,velocity:a=0}=this.options,l=isGenerator(t)?t:generators[t]||keyframes;let h,d;l!==keyframes&&typeof e[0]!="number"&&(h=pipe(percentToProgress,mix(e[0],e[1])),e=[0,100]);const u=l({...this.options,keyframes:e});o==="mirror"&&(d=l({...this.options,keyframes:[...e].reverse(),velocity:-a})),u.calculatedDuration===null&&(u.calculatedDuration=calcGeneratorDuration(u));const{calculatedDuration:f}=u,m=f+i,v=m*(n+1)-i;return{generator:u,mirroredGenerator:d,mapPercentToKeyframes:h,calculatedDuration:f,resolvedDuration:m,totalDuration:v}}onPostResolved(){const{autoplay:e=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!e?this.pause():this.state=this.pendingPlayState}tick(e,t=!1){const{resolved:n}=this;if(!n){const{keyframes:j}=this.options;return{done:!0,value:j[j.length-1]}}const{finalKeyframe:i,generator:o,mirroredGenerator:a,mapPercentToKeyframes:l,keyframes:h,calculatedDuration:d,totalDuration:u,resolvedDuration:f}=n;if(this.startTime===null)return o.next(0);const{delay:m,repeat:v,repeatType:g,repeatDelay:x,onUpdate:E}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-u/this.speed,this.startTime)),t?this.currentTime=e:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(e-this.startTime)*this.speed;const b=this.currentTime-m*(this.speed>=0?1:-1),_=this.speed>=0?b<0:b>u;this.currentTime=Math.max(b,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=u);let S=this.currentTime,C=o;if(v){const j=Math.min(this.currentTime,u)/f;let F=Math.floor(j),W=j%1;!W&&j>=1&&(W=1),W===1&&F--,F=Math.min(F,v+1),!!(F%2)&&(g==="reverse"?(W=1-W,x&&(W-=x/f)):g==="mirror"&&(C=a)),S=clamp(0,1,W)*f}const A=_?{done:!1,value:h[0]}:C.next(S);l&&(A.value=l(A.value));let{done:R}=A;!_&&d!==null&&(R=this.speed>=0?this.currentTime>=u:this.currentTime<=0);const L=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&R);return L&&i!==void 0&&(A.value=getFinalKeyframe(h,this.options,i)),E&&E(A.value),L&&this.finish(),A}get duration(){const{resolved:e}=this;return e?millisecondsToSeconds(e.calculatedDuration):0}get time(){return millisecondsToSeconds(this.currentTime)}set time(e){e=secondsToMilliseconds(e),this.currentTime=e,this.holdTime!==null||this.speed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.speed)}get speed(){return this.playbackSpeed}set speed(e){const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=millisecondsToSeconds(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:e=frameloopDriver,onPlay:t,startTime:n}=this.options;this.driver||(this.driver=e(o=>this.tick(o))),t&&t();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=n??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var e;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(e=this.currentTime)!==null&&e!==void 0?e:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:e}=this.options;e&&e()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}}const acceleratedValues=new Set(["opacity","clipPath","filter","transform"]);function startWaapiAnimation(s,e,t,{delay:n=0,duration:i=300,repeat:o=0,repeatType:a="loop",ease:l="easeInOut",times:h}={}){const d={[e]:t};h&&(d.offset=h);const u=mapEasingToNativeEasing(l,i);return Array.isArray(u)&&(d.easing=u),s.animate(d,{delay:n,duration:i,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:o+1,direction:a==="reverse"?"alternate":"normal"})}const supportsWaapi=memo(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),sampleDelta=10,maxDuration=2e4;function requiresPregeneratedKeyframes(s){return isGenerator(s.type)||s.type==="spring"||!isWaapiSupportedEasing(s.ease)}function pregenerateKeyframes(s,e){const t=new MainThreadAnimation({...e,keyframes:s,repeat:0,delay:0,isGenerator:!0});let n={done:!1,value:s[0]};const i=[];let o=0;for(;!n.done&&o<maxDuration;)n=t.sample(o),i.push(n.value),o+=sampleDelta;return{times:void 0,keyframes:i,duration:o-sampleDelta,ease:"linear"}}const unsupportedEasingFunctions={anticipate,backInOut,circInOut};function isUnsupportedEase(s){return s in unsupportedEasingFunctions}class AcceleratedAnimation extends BaseAnimation{constructor(e){super(e);const{name:t,motionValue:n,element:i,keyframes:o}=this.options;this.resolver=new DOMKeyframesResolver(o,(a,l)=>this.onKeyframesResolved(a,l),t,n,i),this.resolver.scheduleResolve()}initPlayback(e,t){let{duration:n=300,times:i,ease:o,type:a,motionValue:l,name:h,startTime:d}=this.options;if(!l.owner||!l.owner.current)return!1;if(typeof o=="string"&&supportsLinearEasing()&&isUnsupportedEase(o)&&(o=unsupportedEasingFunctions[o]),requiresPregeneratedKeyframes(this.options)){const{onComplete:f,onUpdate:m,motionValue:v,element:g,...x}=this.options,E=pregenerateKeyframes(e,x);e=E.keyframes,e.length===1&&(e[1]=e[0]),n=E.duration,i=E.times,o=E.ease,a="keyframes"}const u=startWaapiAnimation(l.owner.current,h,e,{...this.options,duration:n,times:i,ease:o});return u.startTime=d??this.calcStartTime(),this.pendingTimeline?(attachTimeline(u,this.pendingTimeline),this.pendingTimeline=void 0):u.onfinish=()=>{const{onComplete:f}=this.options;l.set(getFinalKeyframe(e,this.options,t)),f&&f(),this.cancel(),this.resolveFinishedPromise()},{animation:u,duration:n,times:i,type:a,ease:o,keyframes:e}}get duration(){const{resolved:e}=this;if(!e)return 0;const{duration:t}=e;return millisecondsToSeconds(t)}get time(){const{resolved:e}=this;if(!e)return 0;const{animation:t}=e;return millisecondsToSeconds(t.currentTime||0)}set time(e){const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.currentTime=secondsToMilliseconds(e)}get speed(){const{resolved:e}=this;if(!e)return 1;const{animation:t}=e;return t.playbackRate}set speed(e){const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.playbackRate=e}get state(){const{resolved:e}=this;if(!e)return"idle";const{animation:t}=e;return t.playState}get startTime(){const{resolved:e}=this;if(!e)return null;const{animation:t}=e;return t.startTime}attachTimeline(e){if(!this._resolved)this.pendingTimeline=e;else{const{resolved:t}=this;if(!t)return noop;const{animation:n}=t;attachTimeline(n,e)}return noop}play(){if(this.isStopped)return;const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.playState==="finished"&&this.updateFinishedPromise(),t.play()}pause(){const{resolved:e}=this;if(!e)return;const{animation:t}=e;t.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:e}=this;if(!e)return;const{animation:t,keyframes:n,duration:i,type:o,ease:a,times:l}=e;if(t.playState==="idle"||t.playState==="finished")return;if(this.time){const{motionValue:d,onUpdate:u,onComplete:f,element:m,...v}=this.options,g=new MainThreadAnimation({...v,keyframes:n,duration:i,type:o,ease:a,times:l,isGenerator:!0}),x=secondsToMilliseconds(this.time);d.setWithVelocity(g.sample(x-sampleDelta).value,g.sample(x).value,sampleDelta)}const{onStop:h}=this.options;h&&h(),this.cancel()}complete(){const{resolved:e}=this;e&&e.animation.finish()}cancel(){const{resolved:e}=this;e&&e.animation.cancel()}static supports(e){const{motionValue:t,name:n,repeatDelay:i,repeatType:o,damping:a,type:l}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:h,transformTemplate:d}=t.owner.getProps();return supportsWaapi()&&n&&acceleratedValues.has(n)&&!h&&!d&&!i&&o!=="mirror"&&a!==0&&l!=="inertia"}}const underDampedSpring={type:"spring",stiffness:500,damping:25,restSpeed:10},criticallyDampedSpring=s=>({type:"spring",stiffness:550,damping:s===0?2*Math.sqrt(550):30,restSpeed:10}),keyframesTransition={type:"keyframes",duration:.8},ease={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},getDefaultTransition=(s,{keyframes:e})=>e.length>2?keyframesTransition:transformProps.has(s)?s.startsWith("scale")?criticallyDampedSpring(e[1]):underDampedSpring:ease;function isTransitionDefined({when:s,delay:e,delayChildren:t,staggerChildren:n,staggerDirection:i,repeat:o,repeatType:a,repeatDelay:l,from:h,elapsed:d,...u}){return!!Object.keys(u).length}const animateMotionValue=(s,e,t,n={},i,o)=>a=>{const l=getValueTransition(n,s)||{},h=l.delay||n.delay||0;let{elapsed:d=0}=n;d=d-secondsToMilliseconds(h);let u={keyframes:Array.isArray(t)?t:[null,t],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-d,onUpdate:m=>{e.set(m),l.onUpdate&&l.onUpdate(m)},onComplete:()=>{a(),l.onComplete&&l.onComplete()},name:s,motionValue:e,element:o?void 0:i};isTransitionDefined(l)||(u={...u,...getDefaultTransition(s,u)}),u.duration&&(u.duration=secondsToMilliseconds(u.duration)),u.repeatDelay&&(u.repeatDelay=secondsToMilliseconds(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let f=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(u.duration=0,u.delay===0&&(f=!0)),f&&!o&&e.get()!==void 0){const m=getFinalKeyframe(u.keyframes,l);if(m!==void 0)return frame.update(()=>{u.onUpdate(m),u.onComplete()}),new GroupPlaybackControls([])}return!o&&AcceleratedAnimation.supports(u)?new AcceleratedAnimation(u):new MainThreadAnimation(u)};function shouldBlockAnimation({protectedKeys:s,needsAnimating:e},t){const n=s.hasOwnProperty(t)&&e[t]!==!0;return e[t]=!1,n}function animateTarget(s,e,{delay:t=0,transitionOverride:n,type:i}={}){var o;let{transition:a=s.getDefaultTransition(),transitionEnd:l,...h}=e;n&&(a=n);const d=[],u=i&&s.animationState&&s.animationState.getState()[i];for(const f in h){const m=s.getValue(f,(o=s.latestValues[f])!==null&&o!==void 0?o:null),v=h[f];if(v===void 0||u&&shouldBlockAnimation(u,f))continue;const g={delay:t,...getValueTransition(a||{},f)};let x=!1;if(window.MotionHandoffAnimation){const b=getOptimisedAppearId(s);if(b){const _=window.MotionHandoffAnimation(b,f,frame);_!==null&&(g.startTime=_,x=!0)}}addValueToWillChange(s,f),m.start(animateMotionValue(f,m,v,s.shouldReduceMotion&&positionalKeys.has(f)?{type:!1}:g,s,x));const E=m.animation;E&&d.push(E)}return l&&Promise.all(d).then(()=>{frame.update(()=>{l&&setTarget(s,l)})}),d}function animateVariant(s,e,t={}){var n;const i=resolveVariant(s,e,t.type==="exit"?(n=s.presenceContext)===null||n===void 0?void 0:n.custom:void 0);let{transition:o=s.getDefaultTransition()||{}}=i||{};t.transitionOverride&&(o=t.transitionOverride);const a=i?()=>Promise.all(animateTarget(s,i,t)):()=>Promise.resolve(),l=s.variantChildren&&s.variantChildren.size?(d=0)=>{const{delayChildren:u=0,staggerChildren:f,staggerDirection:m}=o;return animateChildren(s,e,u+d,f,m,t)}:()=>Promise.resolve(),{when:h}=o;if(h){const[d,u]=h==="beforeChildren"?[a,l]:[l,a];return d().then(()=>u())}else return Promise.all([a(),l(t.delay)])}function animateChildren(s,e,t=0,n=0,i=1,o){const a=[],l=(s.variantChildren.size-1)*n,h=i===1?(d=0)=>d*n:(d=0)=>l-d*n;return Array.from(s.variantChildren).sort(sortByTreeOrder).forEach((d,u)=>{d.notify("AnimationStart",e),a.push(animateVariant(d,e,{...o,delay:t+h(u)}).then(()=>d.notify("AnimationComplete",e)))}),Promise.all(a)}function sortByTreeOrder(s,e){return s.sortNodePosition(e)}function animateVisualElement(s,e,t={}){s.notify("AnimationStart",e);let n;if(Array.isArray(e)){const i=e.map(o=>animateVariant(s,o,t));n=Promise.all(i)}else if(typeof e=="string")n=animateVariant(s,e,t);else{const i=typeof e=="function"?resolveVariant(s,e,t.custom):e;n=Promise.all(animateTarget(s,i,t))}return n.then(()=>{s.notify("AnimationComplete",e)})}const numVariantProps=variantProps.length;function getVariantContext(s){if(!s)return;if(!s.isControllingVariants){const t=s.parent?getVariantContext(s.parent)||{}:{};return s.props.initial!==void 0&&(t.initial=s.props.initial),t}const e={};for(let t=0;t<numVariantProps;t++){const n=variantProps[t],i=s.props[n];(isVariantLabel(i)||i===!1)&&(e[n]=i)}return e}const reversePriorityOrder=[...variantPriorityOrder].reverse(),numAnimationTypes=variantPriorityOrder.length;function animateList(s){return e=>Promise.all(e.map(({animation:t,options:n})=>animateVisualElement(s,t,n)))}function createAnimationState(s){let e=animateList(s),t=createState(),n=!0;const i=h=>(d,u)=>{var f;const m=resolveVariant(s,u,h==="exit"?(f=s.presenceContext)===null||f===void 0?void 0:f.custom:void 0);if(m){const{transition:v,transitionEnd:g,...x}=m;d={...d,...x,...g}}return d};function o(h){e=h(s)}function a(h){const{props:d}=s,u=getVariantContext(s.parent)||{},f=[],m=new Set;let v={},g=1/0;for(let E=0;E<numAnimationTypes;E++){const b=reversePriorityOrder[E],_=t[b],S=d[b]!==void 0?d[b]:u[b],C=isVariantLabel(S),A=b===h?_.isActive:null;A===!1&&(g=E);let R=S===u[b]&&S!==d[b]&&C;if(R&&n&&s.manuallyAnimateOnMount&&(R=!1),_.protectedKeys={...v},!_.isActive&&A===null||!S&&!_.prevProp||isAnimationControls(S)||typeof S=="boolean")continue;const L=checkVariantsDidChange(_.prevProp,S);let j=L||b===h&&_.isActive&&!R&&C||E>g&&C,F=!1;const W=Array.isArray(S)?S:[S];let K=W.reduce(i(b),{});A===!1&&(K={});const{prevResolvedValues:ee={}}=_,te={...ee,...K},re=z=>{j=!0,m.has(z)&&(F=!0,m.delete(z)),_.needsAnimating[z]=!0;const N=s.getValue(z);N&&(N.liveStyle=!1)};for(const z in te){const N=K[z],k=ee[z];if(v.hasOwnProperty(z))continue;let I=!1;isKeyframesTarget(N)&&isKeyframesTarget(k)?I=!shallowCompare(N,k):I=N!==k,I?N!=null?re(z):m.add(z):N!==void 0&&m.has(z)?re(z):_.protectedKeys[z]=!0}_.prevProp=S,_.prevResolvedValues=K,_.isActive&&(v={...v,...K}),n&&s.blockInitialAnimation&&(j=!1),j&&(!(R&&L)||F)&&f.push(...W.map(z=>({animation:z,options:{type:b}})))}if(m.size){const E={};m.forEach(b=>{const _=s.getBaseTarget(b),S=s.getValue(b);S&&(S.liveStyle=!0),E[b]=_??null}),f.push({animation:E})}let x=!!f.length;return n&&(d.initial===!1||d.initial===d.animate)&&!s.manuallyAnimateOnMount&&(x=!1),n=!1,x?e(f):Promise.resolve()}function l(h,d){var u;if(t[h].isActive===d)return Promise.resolve();(u=s.variantChildren)===null||u===void 0||u.forEach(m=>{var v;return(v=m.animationState)===null||v===void 0?void 0:v.setActive(h,d)}),t[h].isActive=d;const f=a(h);for(const m in t)t[m].protectedKeys={};return f}return{animateChanges:a,setActive:l,setAnimateFunction:o,getState:()=>t,reset:()=>{t=createState(),n=!0}}}function checkVariantsDidChange(s,e){return typeof e=="string"?e!==s:Array.isArray(e)?!shallowCompare(e,s):!1}function createTypeState(s=!1){return{isActive:s,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function createState(){return{animate:createTypeState(!0),whileInView:createTypeState(),whileHover:createTypeState(),whileTap:createTypeState(),whileDrag:createTypeState(),whileFocus:createTypeState(),exit:createTypeState()}}class Feature{constructor(e){this.isMounted=!1,this.node=e}update(){}}class AnimationFeature extends Feature{constructor(e){super(e),e.animationState||(e.animationState=createAnimationState(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();isAnimationControls(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)===null||e===void 0||e.call(this)}}let id$1=0;class ExitAnimationFeature extends Feature{constructor(){super(...arguments),this.id=id$1++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:n}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===n)return;const i=this.node.animationState.setActive("exit",!e);t&&!e&&i.then(()=>t(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const animations={animation:{Feature:AnimationFeature},exit:{Feature:ExitAnimationFeature}};function addDomEvent(s,e,t,n={passive:!0}){return s.addEventListener(e,t,n),()=>s.removeEventListener(e,t)}function extractEventInfo(s){return{point:{x:s.pageX,y:s.pageY}}}const addPointerInfo=s=>e=>isPrimaryPointer(e)&&s(e,extractEventInfo(e));function addPointerEvent(s,e,t,n){return addDomEvent(s,e,addPointerInfo(t),n)}const distance=(s,e)=>Math.abs(s-e);function distance2D(s,e){const t=distance(s.x,e.x),n=distance(s.y,e.y);return Math.sqrt(t**2+n**2)}class PanSession{constructor(e,t,{transformPagePoint:n,contextWindow:i,dragSnapToOrigin:o=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const f=getPanInfo(this.lastMoveEventInfo,this.history),m=this.startEvent!==null,v=distance2D(f.offset,{x:0,y:0})>=3;if(!m&&!v)return;const{point:g}=f,{timestamp:x}=frameData;this.history.push({...g,timestamp:x});const{onStart:E,onMove:b}=this.handlers;m||(E&&E(this.lastMoveEvent,f),this.startEvent=this.lastMoveEvent),b&&b(this.lastMoveEvent,f)},this.handlePointerMove=(f,m)=>{this.lastMoveEvent=f,this.lastMoveEventInfo=transformPoint(m,this.transformPagePoint),frame.update(this.updatePoint,!0)},this.handlePointerUp=(f,m)=>{this.end();const{onEnd:v,onSessionEnd:g,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const E=getPanInfo(f.type==="pointercancel"?this.lastMoveEventInfo:transformPoint(m,this.transformPagePoint),this.history);this.startEvent&&v&&v(f,E),g&&g(f,E)},!isPrimaryPointer(e))return;this.dragSnapToOrigin=o,this.handlers=t,this.transformPagePoint=n,this.contextWindow=i||window;const a=extractEventInfo(e),l=transformPoint(a,this.transformPagePoint),{point:h}=l,{timestamp:d}=frameData;this.history=[{...h,timestamp:d}];const{onSessionStart:u}=t;u&&u(e,getPanInfo(l,this.history)),this.removeListeners=pipe(addPointerEvent(this.contextWindow,"pointermove",this.handlePointerMove),addPointerEvent(this.contextWindow,"pointerup",this.handlePointerUp),addPointerEvent(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),cancelFrame(this.updatePoint)}}function transformPoint(s,e){return e?{point:e(s.point)}:s}function subtractPoint(s,e){return{x:s.x-e.x,y:s.y-e.y}}function getPanInfo({point:s},e){return{point:s,delta:subtractPoint(s,lastDevicePoint(e)),offset:subtractPoint(s,startDevicePoint(e)),velocity:getVelocity(e,.1)}}function startDevicePoint(s){return s[0]}function lastDevicePoint(s){return s[s.length-1]}function getVelocity(s,e){if(s.length<2)return{x:0,y:0};let t=s.length-1,n=null;const i=lastDevicePoint(s);for(;t>=0&&(n=s[t],!(i.timestamp-n.timestamp>secondsToMilliseconds(e)));)t--;if(!n)return{x:0,y:0};const o=millisecondsToSeconds(i.timestamp-n.timestamp);if(o===0)return{x:0,y:0};const a={x:(i.x-n.x)/o,y:(i.y-n.y)/o};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}const SCALE_PRECISION=1e-4,SCALE_MIN=1-SCALE_PRECISION,SCALE_MAX=1+SCALE_PRECISION,TRANSLATE_PRECISION=.01,TRANSLATE_MIN=0-TRANSLATE_PRECISION,TRANSLATE_MAX=0+TRANSLATE_PRECISION;function calcLength(s){return s.max-s.min}function isNear(s,e,t){return Math.abs(s-e)<=t}function calcAxisDelta(s,e,t,n=.5){s.origin=n,s.originPoint=mixNumber$1(e.min,e.max,s.origin),s.scale=calcLength(t)/calcLength(e),s.translate=mixNumber$1(t.min,t.max,s.origin)-s.originPoint,(s.scale>=SCALE_MIN&&s.scale<=SCALE_MAX||isNaN(s.scale))&&(s.scale=1),(s.translate>=TRANSLATE_MIN&&s.translate<=TRANSLATE_MAX||isNaN(s.translate))&&(s.translate=0)}function calcBoxDelta(s,e,t,n){calcAxisDelta(s.x,e.x,t.x,n?n.originX:void 0),calcAxisDelta(s.y,e.y,t.y,n?n.originY:void 0)}function calcRelativeAxis(s,e,t){s.min=t.min+e.min,s.max=s.min+calcLength(e)}function calcRelativeBox(s,e,t){calcRelativeAxis(s.x,e.x,t.x),calcRelativeAxis(s.y,e.y,t.y)}function calcRelativeAxisPosition(s,e,t){s.min=e.min-t.min,s.max=s.min+calcLength(e)}function calcRelativePosition(s,e,t){calcRelativeAxisPosition(s.x,e.x,t.x),calcRelativeAxisPosition(s.y,e.y,t.y)}function applyConstraints(s,{min:e,max:t},n){return e!==void 0&&s<e?s=n?mixNumber$1(e,s,n.min):Math.max(s,e):t!==void 0&&s>t&&(s=n?mixNumber$1(t,s,n.max):Math.min(s,t)),s}function calcRelativeAxisConstraints(s,e,t){return{min:e!==void 0?s.min+e:void 0,max:t!==void 0?s.max+t-(s.max-s.min):void 0}}function calcRelativeConstraints(s,{top:e,left:t,bottom:n,right:i}){return{x:calcRelativeAxisConstraints(s.x,t,i),y:calcRelativeAxisConstraints(s.y,e,n)}}function calcViewportAxisConstraints(s,e){let t=e.min-s.min,n=e.max-s.max;return e.max-e.min<s.max-s.min&&([t,n]=[n,t]),{min:t,max:n}}function calcViewportConstraints(s,e){return{x:calcViewportAxisConstraints(s.x,e.x),y:calcViewportAxisConstraints(s.y,e.y)}}function calcOrigin(s,e){let t=.5;const n=calcLength(s),i=calcLength(e);return i>n?t=progress(e.min,e.max-n,s.min):n>i&&(t=progress(s.min,s.max-i,e.min)),clamp(0,1,t)}function rebaseAxisConstraints(s,e){const t={};return e.min!==void 0&&(t.min=e.min-s.min),e.max!==void 0&&(t.max=e.max-s.min),t}const defaultElastic=.35;function resolveDragElastic(s=defaultElastic){return s===!1?s=0:s===!0&&(s=defaultElastic),{x:resolveAxisElastic(s,"left","right"),y:resolveAxisElastic(s,"top","bottom")}}function resolveAxisElastic(s,e,t){return{min:resolvePointElastic(s,e),max:resolvePointElastic(s,t)}}function resolvePointElastic(s,e){return typeof s=="number"?s:s[e]||0}const createAxisDelta=()=>({translate:0,scale:1,origin:0,originPoint:0}),createDelta=()=>({x:createAxisDelta(),y:createAxisDelta()}),createAxis=()=>({min:0,max:0}),createBox=()=>({x:createAxis(),y:createAxis()});function eachAxis(s){return[s("x"),s("y")]}function convertBoundingBoxToBox({top:s,left:e,right:t,bottom:n}){return{x:{min:e,max:t},y:{min:s,max:n}}}function convertBoxToBoundingBox({x:s,y:e}){return{top:e.min,right:s.max,bottom:e.max,left:s.min}}function transformBoxPoints(s,e){if(!e)return s;const t=e({x:s.left,y:s.top}),n=e({x:s.right,y:s.bottom});return{top:t.y,left:t.x,bottom:n.y,right:n.x}}function isIdentityScale(s){return s===void 0||s===1}function hasScale({scale:s,scaleX:e,scaleY:t}){return!isIdentityScale(s)||!isIdentityScale(e)||!isIdentityScale(t)}function hasTransform(s){return hasScale(s)||has2DTranslate(s)||s.z||s.rotate||s.rotateX||s.rotateY||s.skewX||s.skewY}function has2DTranslate(s){return is2DTranslate(s.x)||is2DTranslate(s.y)}function is2DTranslate(s){return s&&s!=="0%"}function scalePoint(s,e,t){const n=s-t,i=e*n;return t+i}function applyPointDelta(s,e,t,n,i){return i!==void 0&&(s=scalePoint(s,i,n)),scalePoint(s,t,n)+e}function applyAxisDelta(s,e=0,t=1,n,i){s.min=applyPointDelta(s.min,e,t,n,i),s.max=applyPointDelta(s.max,e,t,n,i)}function applyBoxDelta(s,{x:e,y:t}){applyAxisDelta(s.x,e.translate,e.scale,e.originPoint),applyAxisDelta(s.y,t.translate,t.scale,t.originPoint)}const TREE_SCALE_SNAP_MIN=.999999999999,TREE_SCALE_SNAP_MAX=1.0000000000001;function applyTreeDeltas(s,e,t,n=!1){const i=t.length;if(!i)return;e.x=e.y=1;let o,a;for(let l=0;l<i;l++){o=t[l],a=o.projectionDelta;const{visualElement:h}=o.options;h&&h.props.style&&h.props.style.display==="contents"||(n&&o.options.layoutScroll&&o.scroll&&o!==o.root&&transformBox(s,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),a&&(e.x*=a.x.scale,e.y*=a.y.scale,applyBoxDelta(s,a)),n&&hasTransform(o.latestValues)&&transformBox(s,o.latestValues))}e.x<TREE_SCALE_SNAP_MAX&&e.x>TREE_SCALE_SNAP_MIN&&(e.x=1),e.y<TREE_SCALE_SNAP_MAX&&e.y>TREE_SCALE_SNAP_MIN&&(e.y=1)}function translateAxis(s,e){s.min=s.min+e,s.max=s.max+e}function transformAxis(s,e,t,n,i=.5){const o=mixNumber$1(s.min,s.max,i);applyAxisDelta(s,e,t,o,n)}function transformBox(s,e){transformAxis(s.x,e.x,e.scaleX,e.scale,e.originX),transformAxis(s.y,e.y,e.scaleY,e.scale,e.originY)}function measureViewportBox(s,e){return convertBoundingBoxToBox(transformBoxPoints(s.getBoundingClientRect(),e))}function measurePageBox(s,e,t){const n=measureViewportBox(s,t),{scroll:i}=e;return i&&(translateAxis(n.x,i.offset.x),translateAxis(n.y,i.offset.y)),n}const getContextWindow=({current:s})=>s?s.ownerDocument.defaultView:null,elementDragControls=new WeakMap;class VisualElementDragControls{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=createBox(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){const{presenceContext:n}=this.visualElement;if(n&&n.isPresent===!1)return;const i=u=>{const{dragSnapToOrigin:f}=this.getProps();f?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(extractEventInfo(u).point)},o=(u,f)=>{const{drag:m,dragPropagation:v,onDragStart:g}=this.getProps();if(m&&!v&&(this.openDragLock&&this.openDragLock(),this.openDragLock=setDragLock(m),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),eachAxis(E=>{let b=this.getAxisMotionValue(E).get()||0;if(percent.test(b)){const{projection:_}=this.visualElement;if(_&&_.layout){const S=_.layout.layoutBox[E];S&&(b=calcLength(S)*(parseFloat(b)/100))}}this.originPoint[E]=b}),g&&frame.postRender(()=>g(u,f)),addValueToWillChange(this.visualElement,"transform");const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},a=(u,f)=>{const{dragPropagation:m,dragDirectionLock:v,onDirectionLock:g,onDrag:x}=this.getProps();if(!m&&!this.openDragLock)return;const{offset:E}=f;if(v&&this.currentDirection===null){this.currentDirection=getCurrentDirection(E),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",f.point,E),this.updateAxis("y",f.point,E),this.visualElement.render(),x&&x(u,f)},l=(u,f)=>this.stop(u,f),h=()=>eachAxis(u=>{var f;return this.getAnimationState(u)==="paused"&&((f=this.getAxisMotionValue(u).animation)===null||f===void 0?void 0:f.play())}),{dragSnapToOrigin:d}=this.getProps();this.panSession=new PanSession(e,{onSessionStart:i,onStart:o,onMove:a,onSessionEnd:l,resumeAnimation:h},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:d,contextWindow:getContextWindow(this.visualElement)})}stop(e,t){const n=this.isDragging;if(this.cancel(),!n)return;const{velocity:i}=t;this.startAnimation(i);const{onDragEnd:o}=this.getProps();o&&frame.postRender(()=>o(e,t))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:n}=this.getProps();!n&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,n){const{drag:i}=this.getProps();if(!n||!shouldDrag(e,i,this.currentDirection))return;const o=this.getAxisMotionValue(e);let a=this.originPoint[e]+n[e];this.constraints&&this.constraints[e]&&(a=applyConstraints(a,this.constraints[e],this.elastic[e])),o.set(a)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:n}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,o=this.constraints;t&&isRefObject(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&i?this.constraints=calcRelativeConstraints(i.layoutBox,t):this.constraints=!1,this.elastic=resolveDragElastic(n),o!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&eachAxis(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=rebaseAxisConstraints(i.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!isRefObject(e))return!1;const n=e.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const o=measurePageBox(n,i.root,this.visualElement.getTransformPagePoint());let a=calcViewportConstraints(i.layout.layoutBox,o);if(t){const l=t(convertBoxToBoundingBox(a));this.hasMutatedConstraints=!!l,l&&(a=convertBoundingBoxToBox(l))}return a}startAnimation(e){const{drag:t,dragMomentum:n,dragElastic:i,dragTransition:o,dragSnapToOrigin:a,onDragTransitionEnd:l}=this.getProps(),h=this.constraints||{},d=eachAxis(u=>{if(!shouldDrag(u,t,this.currentDirection))return;let f=h&&h[u]||{};a&&(f={min:0,max:0});const m=i?200:1e6,v=i?40:1e7,g={type:"inertia",velocity:n?e[u]:0,bounceStiffness:m,bounceDamping:v,timeConstant:750,restDelta:1,restSpeed:10,...o,...f};return this.startAxisValueAnimation(u,g)});return Promise.all(d).then(l)}startAxisValueAnimation(e,t){const n=this.getAxisMotionValue(e);return addValueToWillChange(this.visualElement,e),n.start(animateMotionValue(e,n,0,t,this.visualElement,!1))}stopAnimation(){eachAxis(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){eachAxis(e=>{var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.pause()})}getAnimationState(e){var t;return(t=this.getAxisMotionValue(e).animation)===null||t===void 0?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,n=this.visualElement.getProps(),i=n[t];return i||this.visualElement.getValue(e,(n.initial?n.initial[e]:void 0)||0)}snapToCursor(e){eachAxis(t=>{const{drag:n}=this.getProps();if(!shouldDrag(t,n,this.currentDirection))return;const{projection:i}=this.visualElement,o=this.getAxisMotionValue(t);if(i&&i.layout){const{min:a,max:l}=i.layout.layoutBox[t];o.set(e[t]-mixNumber$1(a,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:n}=this.visualElement;if(!isRefObject(t)||!n||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};eachAxis(a=>{const l=this.getAxisMotionValue(a);if(l&&this.constraints!==!1){const h=l.get();i[a]=calcOrigin({min:h,max:h},this.constraints[a])}});const{transformTemplate:o}=this.visualElement.getProps();this.visualElement.current.style.transform=o?o({},""):"none",n.root&&n.root.updateScroll(),n.updateLayout(),this.resolveConstraints(),eachAxis(a=>{if(!shouldDrag(a,e,null))return;const l=this.getAxisMotionValue(a),{min:h,max:d}=this.constraints[a];l.set(mixNumber$1(h,d,i[a]))})}addListeners(){if(!this.visualElement.current)return;elementDragControls.set(this.visualElement,this);const e=this.visualElement.current,t=addPointerEvent(e,"pointerdown",h=>{const{drag:d,dragListener:u=!0}=this.getProps();d&&u&&this.start(h)}),n=()=>{const{dragConstraints:h}=this.getProps();isRefObject(h)&&h.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,o=i.addEventListener("measure",n);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),frame.read(n);const a=addDomEvent(window,"resize",()=>this.scalePositionWithinConstraints()),l=i.addEventListener("didUpdate",(({delta:h,hasLayoutChanged:d})=>{this.isDragging&&d&&(eachAxis(u=>{const f=this.getAxisMotionValue(u);f&&(this.originPoint[u]+=h[u].translate,f.set(f.get()+h[u].translate))}),this.visualElement.render())}));return()=>{a(),t(),o(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:n=!1,dragPropagation:i=!1,dragConstraints:o=!1,dragElastic:a=defaultElastic,dragMomentum:l=!0}=e;return{...e,drag:t,dragDirectionLock:n,dragPropagation:i,dragConstraints:o,dragElastic:a,dragMomentum:l}}}function shouldDrag(s,e,t){return(e===!0||e===s)&&(t===null||t===s)}function getCurrentDirection(s,e=10){let t=null;return Math.abs(s.y)>e?t="y":Math.abs(s.x)>e&&(t="x"),t}class DragGesture extends Feature{constructor(e){super(e),this.removeGroupControls=noop,this.removeListeners=noop,this.controls=new VisualElementDragControls(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||noop}unmount(){this.removeGroupControls(),this.removeListeners()}}const asyncHandler=s=>(e,t)=>{s&&frame.postRender(()=>s(e,t))};class PanGesture extends Feature{constructor(){super(...arguments),this.removePointerDownListener=noop}onPointerDown(e){this.session=new PanSession(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:getContextWindow(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:n,onPanEnd:i}=this.node.getProps();return{onSessionStart:asyncHandler(e),onStart:asyncHandler(t),onMove:n,onEnd:(o,a)=>{delete this.session,i&&frame.postRender(()=>i(o,a))}}}mount(){this.removePointerDownListener=addPointerEvent(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const globalProjectionState={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function pixelsToPercent(s,e){return e.max===e.min?0:s/(e.max-e.min)*100}const correctBorderRadius={correct:(s,e)=>{if(!e.target)return s;if(typeof s=="string")if(px.test(s))s=parseFloat(s);else return s;const t=pixelsToPercent(s,e.target.x),n=pixelsToPercent(s,e.target.y);return`${t}% ${n}%`}},correctBoxShadow={correct:(s,{treeScale:e,projectionDelta:t})=>{const n=s,i=complex.parse(s);if(i.length>5)return n;const o=complex.createTransformer(s),a=typeof i[0]!="number"?1:0,l=t.x.scale*e.x,h=t.y.scale*e.y;i[0+a]/=l,i[1+a]/=h;const d=mixNumber$1(l,h,.5);return typeof i[2+a]=="number"&&(i[2+a]/=d),typeof i[3+a]=="number"&&(i[3+a]/=d),o(i)}};class MeasureLayoutWithContext extends reactExports.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n,layoutId:i}=this.props,{projection:o}=e;addScaleCorrector(defaultScaleCorrectors),o&&(t.group&&t.group.add(o),n&&n.register&&i&&n.register(o),o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions({...o.options,onExitComplete:()=>this.safeToRemove()})),globalProjectionState.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:n,drag:i,isPresent:o}=this.props,a=n.projection;return a&&(a.isPresent=o,i||e.layoutDependency!==t||t===void 0?a.willUpdate():this.safeToRemove(),e.isPresent!==o&&(o?a.promote():a.relegate()||frame.postRender(()=>{const l=a.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),microtask.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:n}=this.props,{projection:i}=e;i&&(i.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(i),n&&n.deregister&&n.deregister(i))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function MeasureLayout(s){const[e,t]=usePresence(),n=reactExports.useContext(LayoutGroupContext);return jsxRuntimeExports.jsx(MeasureLayoutWithContext,{...s,layoutGroup:n,switchLayoutGroup:reactExports.useContext(SwitchLayoutGroupContext),isPresent:e,safeToRemove:t})}const defaultScaleCorrectors={borderRadius:{...correctBorderRadius,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:correctBorderRadius,borderTopRightRadius:correctBorderRadius,borderBottomLeftRadius:correctBorderRadius,borderBottomRightRadius:correctBorderRadius,boxShadow:correctBoxShadow};function animateSingleValue(s,e,t){const n=isMotionValue(s)?s:motionValue(s);return n.start(animateMotionValue("",n,e,t)),n.animation}function isSVGElement(s){return s instanceof SVGElement&&s.tagName!=="svg"}const compareByDepth=(s,e)=>s.depth-e.depth;class FlatTree{constructor(){this.children=[],this.isDirty=!1}add(e){addUniqueItem(this.children,e),this.isDirty=!0}remove(e){removeItem(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(compareByDepth),this.isDirty=!1,this.children.forEach(e)}}function delay(s,e){const t=time.now(),n=({timestamp:i})=>{const o=i-t;o>=e&&(cancelFrame(n),s(o-e))};return frame.read(n,!0),()=>cancelFrame(n)}const borders=["TopLeft","TopRight","BottomLeft","BottomRight"],numBorders=borders.length,asNumber=s=>typeof s=="string"?parseFloat(s):s,isPx=s=>typeof s=="number"||px.test(s);function mixValues(s,e,t,n,i,o){i?(s.opacity=mixNumber$1(0,t.opacity!==void 0?t.opacity:1,easeCrossfadeIn(n)),s.opacityExit=mixNumber$1(e.opacity!==void 0?e.opacity:1,0,easeCrossfadeOut(n))):o&&(s.opacity=mixNumber$1(e.opacity!==void 0?e.opacity:1,t.opacity!==void 0?t.opacity:1,n));for(let a=0;a<numBorders;a++){const l=`border${borders[a]}Radius`;let h=getRadius(e,l),d=getRadius(t,l);if(h===void 0&&d===void 0)continue;h||(h=0),d||(d=0),h===0||d===0||isPx(h)===isPx(d)?(s[l]=Math.max(mixNumber$1(asNumber(h),asNumber(d),n),0),(percent.test(d)||percent.test(h))&&(s[l]+="%")):s[l]=d}(e.rotate||t.rotate)&&(s.rotate=mixNumber$1(e.rotate||0,t.rotate||0,n))}function getRadius(s,e){return s[e]!==void 0?s[e]:s.borderRadius}const easeCrossfadeIn=compress(0,.5,circOut),easeCrossfadeOut=compress(.5,.95,noop);function compress(s,e,t){return n=>n<s?0:n>e?1:t(progress(s,e,n))}function copyAxisInto(s,e){s.min=e.min,s.max=e.max}function copyBoxInto(s,e){copyAxisInto(s.x,e.x),copyAxisInto(s.y,e.y)}function copyAxisDeltaInto(s,e){s.translate=e.translate,s.scale=e.scale,s.originPoint=e.originPoint,s.origin=e.origin}function removePointDelta(s,e,t,n,i){return s-=e,s=scalePoint(s,1/t,n),i!==void 0&&(s=scalePoint(s,1/i,n)),s}function removeAxisDelta(s,e=0,t=1,n=.5,i,o=s,a=s){if(percent.test(e)&&(e=parseFloat(e),e=mixNumber$1(a.min,a.max,e/100)-a.min),typeof e!="number")return;let l=mixNumber$1(o.min,o.max,n);s===o&&(l-=e),s.min=removePointDelta(s.min,e,t,l,i),s.max=removePointDelta(s.max,e,t,l,i)}function removeAxisTransforms(s,e,[t,n,i],o,a){removeAxisDelta(s,e[t],e[n],e[i],e.scale,o,a)}const xKeys=["x","scaleX","originX"],yKeys=["y","scaleY","originY"];function removeBoxTransforms(s,e,t,n){removeAxisTransforms(s.x,e,xKeys,t?t.x:void 0,n?n.x:void 0),removeAxisTransforms(s.y,e,yKeys,t?t.y:void 0,n?n.y:void 0)}function isAxisDeltaZero(s){return s.translate===0&&s.scale===1}function isDeltaZero(s){return isAxisDeltaZero(s.x)&&isAxisDeltaZero(s.y)}function axisEquals(s,e){return s.min===e.min&&s.max===e.max}function boxEquals(s,e){return axisEquals(s.x,e.x)&&axisEquals(s.y,e.y)}function axisEqualsRounded(s,e){return Math.round(s.min)===Math.round(e.min)&&Math.round(s.max)===Math.round(e.max)}function boxEqualsRounded(s,e){return axisEqualsRounded(s.x,e.x)&&axisEqualsRounded(s.y,e.y)}function aspectRatio(s){return calcLength(s.x)/calcLength(s.y)}function axisDeltaEquals(s,e){return s.translate===e.translate&&s.scale===e.scale&&s.originPoint===e.originPoint}class NodeStack{constructor(){this.members=[]}add(e){addUniqueItem(this.members,e),e.scheduleRender()}remove(e){if(removeItem(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(e){const t=this.members.findIndex(i=>e===i);if(t===0)return!1;let n;for(let i=t;i>=0;i--){const o=this.members[i];if(o.isPresent!==!1){n=o;break}}return n?(this.promote(n),!0):!1}promote(e,t){const n=this.lead;if(e!==n&&(this.prevLead=n,this.lead=e,e.show(),n)){n.instance&&n.scheduleRender(),e.scheduleRender(),e.resumeFrom=n,t&&(e.resumeFrom.preserveOpacity=!0),n.snapshot&&(e.snapshot=n.snapshot,e.snapshot.latestValues=n.animationValues||n.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:i}=e.options;i===!1&&n.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:n}=e;t.onExitComplete&&t.onExitComplete(),n&&n.options.onExitComplete&&n.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function buildProjectionTransform(s,e,t){let n="";const i=s.x.translate/e.x,o=s.y.translate/e.y,a=t?.z||0;if((i||o||a)&&(n=`translate3d(${i}px, ${o}px, ${a}px) `),(e.x!==1||e.y!==1)&&(n+=`scale(${1/e.x}, ${1/e.y}) `),t){const{transformPerspective:d,rotate:u,rotateX:f,rotateY:m,skewX:v,skewY:g}=t;d&&(n=`perspective(${d}px) ${n}`),u&&(n+=`rotate(${u}deg) `),f&&(n+=`rotateX(${f}deg) `),m&&(n+=`rotateY(${m}deg) `),v&&(n+=`skewX(${v}deg) `),g&&(n+=`skewY(${g}deg) `)}const l=s.x.scale*e.x,h=s.y.scale*e.y;return(l!==1||h!==1)&&(n+=`scale(${l}, ${h})`),n||"none"}const metrics={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},isDebug=typeof window<"u"&&window.MotionDebug!==void 0,transformAxes=["","X","Y","Z"],hiddenVisibility={visibility:"hidden"},animationTarget=1e3;let id=0;function resetDistortingTransform(s,e,t,n){const{latestValues:i}=e;i[s]&&(t[s]=i[s],e.setStaticValue(s,0),n&&(n[s]=0))}function cancelTreeOptimisedTransformAnimations(s){if(s.hasCheckedOptimisedAppear=!0,s.root===s)return;const{visualElement:e}=s.options;if(!e)return;const t=getOptimisedAppearId(e);if(window.MotionHasOptimisedAnimation(t,"transform")){const{layout:i,layoutId:o}=s.options;window.MotionCancelOptimisedAnimation(t,"transform",frame,!(i||o))}const{parent:n}=s;n&&!n.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(n)}function createProjectionNode({attachResizeListener:s,defaultParent:e,measureScroll:t,checkIsScrollRoot:n,resetTransform:i}){return class{constructor(a={},l=e?.()){this.id=id++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,isDebug&&(metrics.totalNodes=metrics.resolvedTargetDeltas=metrics.recalculatedProjection=0),this.nodes.forEach(propagateDirtyNodes),this.nodes.forEach(resolveTargetDelta),this.nodes.forEach(calcProjection),this.nodes.forEach(cleanDirtyNodes),isDebug&&window.MotionDebug.record(metrics)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let h=0;h<this.path.length;h++)this.path[h].shouldResetTransform=!0;this.root===this&&(this.nodes=new FlatTree)}addEventListener(a,l){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new SubscriptionManager),this.eventHandlers.get(a).add(l)}notifyListeners(a,...l){const h=this.eventHandlers.get(a);h&&h.notify(...l)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=isSVGElement(a),this.instance=a;const{layoutId:h,layout:d,visualElement:u}=this.options;if(u&&!u.current&&u.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(d||h)&&(this.isLayoutDirty=!0),s){let f;const m=()=>this.root.updateBlockedByResize=!1;s(a,()=>{this.root.updateBlockedByResize=!0,f&&f(),f=delay(m,250),globalProjectionState.hasAnimatedSinceResize&&(globalProjectionState.hasAnimatedSinceResize=!1,this.nodes.forEach(finishAnimation))})}h&&this.root.registerSharedNode(h,this),this.options.animate!==!1&&u&&(h||d)&&this.addEventListener("didUpdate",({delta:f,hasLayoutChanged:m,hasRelativeTargetChanged:v,layout:g})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||u.getDefaultTransition()||defaultLayoutTransition,{onLayoutAnimationStart:E,onLayoutAnimationComplete:b}=u.getProps(),_=!this.targetLayout||!boxEqualsRounded(this.targetLayout,g)||v,S=!m&&v;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||S||m&&(_||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(f,S);const C={...getValueTransition(x,"layout"),onPlay:E,onComplete:b};(u.shouldReduceMotion||this.options.layoutRoot)&&(C.delay=0,C.type=!1),this.startAnimation(C)}else m||finishAnimation(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=g})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,cancelFrame(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(resetSkewAndRotation),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&cancelTreeOptimisedTransformAnimations(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const f=this.path[u];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:l,layout:h}=this.options;if(l===void 0&&!h)return;const d=this.getTransformTemplate();this.prevTransformTemplateValue=d?d(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(clearMeasurements);return}this.isUpdating||this.nodes.forEach(clearIsLayoutDirty),this.isUpdating=!1,this.nodes.forEach(resetTransformStyle),this.nodes.forEach(updateLayout),this.nodes.forEach(notifyLayoutUpdate),this.clearAllSnapshots();const l=time.now();frameData.delta=clamp(0,1e3/60,l-frameData.timestamp),frameData.timestamp=l,frameData.isProcessing=!0,frameSteps.update.process(frameData),frameSteps.preRender.process(frameData),frameSteps.render.process(frameData),frameData.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,microtask.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(clearSnapshot),this.sharedNodes.forEach(removeLeadSnapshots)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,frame.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){frame.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let h=0;h<this.path.length;h++)this.path[h].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=createBox(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(l=!1),l){const h=n(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:h,offset:t(this.instance),wasRoot:this.scroll?this.scroll.isRoot:h}}}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!isDeltaZero(this.projectionDelta),h=this.getTransformTemplate(),d=h?h(this.latestValues,""):void 0,u=d!==this.prevTransformTemplateValue;a&&(l||hasTransform(this.latestValues)||u)&&(i(this.instance,d),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const l=this.measurePageBox();let h=this.removeElementScroll(l);return a&&(h=this.removeTransform(h)),roundBox(h),{animationId:this.root.animationId,measuredBox:l,layoutBox:h,latestValues:{},source:this.id}}measurePageBox(){var a;const{visualElement:l}=this.options;if(!l)return createBox();const h=l.measureViewportBox();if(!(((a=this.scroll)===null||a===void 0?void 0:a.wasRoot)||this.path.some(checkNodeWasScrollRoot))){const{scroll:u}=this.root;u&&(translateAxis(h.x,u.offset.x),translateAxis(h.y,u.offset.y))}return h}removeElementScroll(a){var l;const h=createBox();if(copyBoxInto(h,a),!((l=this.scroll)===null||l===void 0)&&l.wasRoot)return h;for(let d=0;d<this.path.length;d++){const u=this.path[d],{scroll:f,options:m}=u;u!==this.root&&f&&m.layoutScroll&&(f.wasRoot&&copyBoxInto(h,a),translateAxis(h.x,f.offset.x),translateAxis(h.y,f.offset.y))}return h}applyTransform(a,l=!1){const h=createBox();copyBoxInto(h,a);for(let d=0;d<this.path.length;d++){const u=this.path[d];!l&&u.options.layoutScroll&&u.scroll&&u!==u.root&&transformBox(h,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),hasTransform(u.latestValues)&&transformBox(h,u.latestValues)}return hasTransform(this.latestValues)&&transformBox(h,this.latestValues),h}removeTransform(a){const l=createBox();copyBoxInto(l,a);for(let h=0;h<this.path.length;h++){const d=this.path[h];if(!d.instance||!hasTransform(d.latestValues))continue;hasScale(d.latestValues)&&d.updateSnapshot();const u=createBox(),f=d.measurePageBox();copyBoxInto(u,f),removeBoxTransforms(l,d.latestValues,d.snapshot?d.snapshot.layoutBox:void 0,u)}return hasTransform(this.latestValues)&&removeBoxTransforms(l,this.latestValues),l}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==frameData.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var l;const h=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=h.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=h.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=h.isSharedProjectionDirty);const d=!!this.resumingFrom||this!==h;if(!(a||d&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:f,layoutId:m}=this.options;if(!(!this.layout||!(f||m))){if(this.resolvedRelativeTargetAt=frameData.timestamp,!this.targetDelta&&!this.relativeTarget){const v=this.getClosestProjectingParent();v&&v.layout&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.layout.layoutBox,v.layout.layoutBox),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=createBox(),this.targetWithTransforms=createBox()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),calcRelativeBox(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):copyBoxInto(this.target,this.layout.layoutBox),applyBoxDelta(this.target,this.targetDelta)):copyBoxInto(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const v=this.getClosestProjectingParent();v&&!!v.resumingFrom==!!this.resumingFrom&&!v.options.layoutScroll&&v.target&&this.animationProgress!==1?(this.relativeParent=v,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.target,v.target),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}isDebug&&metrics.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||hasScale(this.parent.latestValues)||has2DTranslate(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const l=this.getLead(),h=!!this.resumingFrom||this!==l;let d=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(d=!1),h&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(d=!1),this.resolvedRelativeTargetAt===frameData.timestamp&&(d=!1),d)return;const{layout:u,layoutId:f}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||f))return;copyBoxInto(this.layoutCorrected,this.layout.layoutBox);const m=this.treeScale.x,v=this.treeScale.y;applyTreeDeltas(this.layoutCorrected,this.treeScale,this.path,h),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox,l.targetWithTransforms=createBox());const{target:g}=l;if(!g){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(copyAxisDeltaInto(this.prevProjectionDelta.x,this.projectionDelta.x),copyAxisDeltaInto(this.prevProjectionDelta.y,this.projectionDelta.y)),calcBoxDelta(this.projectionDelta,this.layoutCorrected,g,this.latestValues),(this.treeScale.x!==m||this.treeScale.y!==v||!axisDeltaEquals(this.projectionDelta.x,this.prevProjectionDelta.x)||!axisDeltaEquals(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g)),isDebug&&metrics.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var l;if((l=this.options.visualElement)===null||l===void 0||l.scheduleRender(),a){const h=this.getStack();h&&h.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=createDelta(),this.projectionDelta=createDelta(),this.projectionDeltaWithTransform=createDelta()}setAnimationOrigin(a,l=!1){const h=this.snapshot,d=h?h.latestValues:{},u={...this.latestValues},f=createDelta();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const m=createBox(),v=h?h.source:void 0,g=this.layout?this.layout.source:void 0,x=v!==g,E=this.getStack(),b=!E||E.members.length<=1,_=!!(x&&!b&&this.options.crossfade===!0&&!this.path.some(hasOpacityCrossfade));this.animationProgress=0;let S;this.mixTargetDelta=C=>{const A=C/1e3;mixAxisDelta(f.x,a.x,A),mixAxisDelta(f.y,a.y,A),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(calcRelativePosition(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),mixBox(this.relativeTarget,this.relativeTargetOrigin,m,A),S&&boxEquals(this.relativeTarget,S)&&(this.isProjectionDirty=!1),S||(S=createBox()),copyBoxInto(S,this.relativeTarget)),x&&(this.animationValues=u,mixValues(u,d,this.latestValues,A,_,b)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=A},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(cancelFrame(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=frame.update(()=>{globalProjectionState.hasAnimatedSinceResize=!0,this.currentAnimation=animateSingleValue(0,animationTarget,{...a,onUpdate:l=>{this.mixTargetDelta(l),a.onUpdate&&a.onUpdate(l)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(animationTarget),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:l,target:h,layout:d,latestValues:u}=a;if(!(!l||!h||!d)){if(this!==a&&this.layout&&d&&shouldAnimatePositionOnly(this.options.animationType,this.layout.layoutBox,d.layoutBox)){h=this.target||createBox();const f=calcLength(this.layout.layoutBox.x);h.x.min=a.target.x.min,h.x.max=h.x.min+f;const m=calcLength(this.layout.layoutBox.y);h.y.min=a.target.y.min,h.y.max=h.y.min+m}copyBoxInto(l,h),transformBox(l,u),calcBoxDelta(this.projectionDeltaWithTransform,this.layoutCorrected,l,u)}}registerSharedNode(a,l){this.sharedNodes.has(a)||this.sharedNodes.set(a,new NodeStack),this.sharedNodes.get(a).add(l);const d=l.options.initialPromotionConfig;l.promote({transition:d?d.transition:void 0,preserveFollowOpacity:d&&d.shouldPreserveFollowOpacity?d.shouldPreserveFollowOpacity(l):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:l}=this.options;return l?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:l}=this.options;return l?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:l,preserveFollowOpacity:h}={}){const d=this.getStack();d&&d.promote(this,h),a&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let l=!1;const{latestValues:h}=a;if((h.z||h.rotate||h.rotateX||h.rotateY||h.rotateZ||h.skewX||h.skewY)&&(l=!0),!l)return;const d={};h.z&&resetDistortingTransform("z",a,d,this.animationValues);for(let u=0;u<transformAxes.length;u++)resetDistortingTransform(`rotate${transformAxes[u]}`,a,d,this.animationValues),resetDistortingTransform(`skew${transformAxes[u]}`,a,d,this.animationValues);a.render();for(const u in d)a.setStaticValue(u,d[u]),this.animationValues&&(this.animationValues[u]=d[u]);a.scheduleRender()}getProjectionStyles(a){var l,h;if(!this.instance||this.isSVG)return;if(!this.isVisible)return hiddenVisibility;const d={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,d.opacity="",d.pointerEvents=resolveMotionValue(a?.pointerEvents)||"",d.transform=u?u(this.latestValues,""):"none",d;const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){const x={};return this.options.layoutId&&(x.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,x.pointerEvents=resolveMotionValue(a?.pointerEvents)||""),this.hasProjected&&!hasTransform(this.latestValues)&&(x.transform=u?u({},""):"none",this.hasProjected=!1),x}const m=f.animationValues||f.latestValues;this.applyTransformsToTarget(),d.transform=buildProjectionTransform(this.projectionDeltaWithTransform,this.treeScale,m),u&&(d.transform=u(m,d.transform));const{x:v,y:g}=this.projectionDelta;d.transformOrigin=`${v.origin*100}% ${g.origin*100}% 0`,f.animationValues?d.opacity=f===this?(h=(l=m.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&h!==void 0?h:1:this.preserveOpacity?this.latestValues.opacity:m.opacityExit:d.opacity=f===this?m.opacity!==void 0?m.opacity:"":m.opacityExit!==void 0?m.opacityExit:0;for(const x in scaleCorrectors){if(m[x]===void 0)continue;const{correct:E,applyTo:b}=scaleCorrectors[x],_=d.transform==="none"?m[x]:E(m[x],f);if(b){const S=b.length;for(let C=0;C<S;C++)d[b[C]]=_}else d[x]=_}return this.options.layoutId&&(d.pointerEvents=f===this?resolveMotionValue(a?.pointerEvents)||"":"none"),d}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var l;return(l=a.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(clearMeasurements),this.root.sharedNodes.clear()}}}function updateLayout(s){s.updateLayout()}function notifyLayoutUpdate(s){var e;const t=((e=s.resumeFrom)===null||e===void 0?void 0:e.snapshot)||s.snapshot;if(s.isLead()&&s.layout&&t&&s.hasListeners("didUpdate")){const{layoutBox:n,measuredBox:i}=s.layout,{animationType:o}=s.options,a=t.source!==s.layout.source;o==="size"?eachAxis(f=>{const m=a?t.measuredBox[f]:t.layoutBox[f],v=calcLength(m);m.min=n[f].min,m.max=m.min+v}):shouldAnimatePositionOnly(o,t.layoutBox,n)&&eachAxis(f=>{const m=a?t.measuredBox[f]:t.layoutBox[f],v=calcLength(n[f]);m.max=m.min+v,s.relativeTarget&&!s.currentAnimation&&(s.isProjectionDirty=!0,s.relativeTarget[f].max=s.relativeTarget[f].min+v)});const l=createDelta();calcBoxDelta(l,n,t.layoutBox);const h=createDelta();a?calcBoxDelta(h,s.applyTransform(i,!0),t.measuredBox):calcBoxDelta(h,n,t.layoutBox);const d=!isDeltaZero(l);let u=!1;if(!s.resumeFrom){const f=s.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:m,layout:v}=f;if(m&&v){const g=createBox();calcRelativePosition(g,t.layoutBox,m.layoutBox);const x=createBox();calcRelativePosition(x,n,v.layoutBox),boxEqualsRounded(g,x)||(u=!0),f.options.layoutRoot&&(s.relativeTarget=x,s.relativeTargetOrigin=g,s.relativeParent=f)}}}s.notifyListeners("didUpdate",{layout:n,snapshot:t,delta:h,layoutDelta:l,hasLayoutChanged:d,hasRelativeTargetChanged:u})}else if(s.isLead()){const{onExitComplete:n}=s.options;n&&n()}s.options.transition=void 0}function propagateDirtyNodes(s){isDebug&&metrics.totalNodes++,s.parent&&(s.isProjecting()||(s.isProjectionDirty=s.parent.isProjectionDirty),s.isSharedProjectionDirty||(s.isSharedProjectionDirty=!!(s.isProjectionDirty||s.parent.isProjectionDirty||s.parent.isSharedProjectionDirty)),s.isTransformDirty||(s.isTransformDirty=s.parent.isTransformDirty))}function cleanDirtyNodes(s){s.isProjectionDirty=s.isSharedProjectionDirty=s.isTransformDirty=!1}function clearSnapshot(s){s.clearSnapshot()}function clearMeasurements(s){s.clearMeasurements()}function clearIsLayoutDirty(s){s.isLayoutDirty=!1}function resetTransformStyle(s){const{visualElement:e}=s.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),s.resetTransform()}function finishAnimation(s){s.finishAnimation(),s.targetDelta=s.relativeTarget=s.target=void 0,s.isProjectionDirty=!0}function resolveTargetDelta(s){s.resolveTargetDelta()}function calcProjection(s){s.calcProjection()}function resetSkewAndRotation(s){s.resetSkewAndRotation()}function removeLeadSnapshots(s){s.removeLeadSnapshot()}function mixAxisDelta(s,e,t){s.translate=mixNumber$1(e.translate,0,t),s.scale=mixNumber$1(e.scale,1,t),s.origin=e.origin,s.originPoint=e.originPoint}function mixAxis(s,e,t,n){s.min=mixNumber$1(e.min,t.min,n),s.max=mixNumber$1(e.max,t.max,n)}function mixBox(s,e,t,n){mixAxis(s.x,e.x,t.x,n),mixAxis(s.y,e.y,t.y,n)}function hasOpacityCrossfade(s){return s.animationValues&&s.animationValues.opacityExit!==void 0}const defaultLayoutTransition={duration:.45,ease:[.4,0,.1,1]},userAgentContains=s=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(s),roundPoint=userAgentContains("applewebkit/")&&!userAgentContains("chrome/")?Math.round:noop;function roundAxis(s){s.min=roundPoint(s.min),s.max=roundPoint(s.max)}function roundBox(s){roundAxis(s.x),roundAxis(s.y)}function shouldAnimatePositionOnly(s,e,t){return s==="position"||s==="preserve-aspect"&&!isNear(aspectRatio(e),aspectRatio(t),.2)}function checkNodeWasScrollRoot(s){var e;return s!==s.root&&((e=s.scroll)===null||e===void 0?void 0:e.wasRoot)}const DocumentProjectionNode=createProjectionNode({attachResizeListener:(s,e)=>addDomEvent(s,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),rootProjectionNode={current:void 0},HTMLProjectionNode=createProjectionNode({measureScroll:s=>({x:s.scrollLeft,y:s.scrollTop}),defaultParent:()=>{if(!rootProjectionNode.current){const s=new DocumentProjectionNode({});s.mount(window),s.setOptions({layoutScroll:!0}),rootProjectionNode.current=s}return rootProjectionNode.current},resetTransform:(s,e)=>{s.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:s=>window.getComputedStyle(s).position==="fixed"}),drag={pan:{Feature:PanGesture},drag:{Feature:DragGesture,ProjectionNode:HTMLProjectionNode,MeasureLayout}};function handleHoverEvent(s,e,t){const{props:n}=s;s.animationState&&n.whileHover&&s.animationState.setActive("whileHover",t==="Start");const i="onHover"+t,o=n[i];o&&frame.postRender(()=>o(e,extractEventInfo(e)))}class HoverGesture extends Feature{mount(){const{current:e}=this.node;e&&(this.unmount=hover(e,t=>(handleHoverEvent(this.node,t,"Start"),n=>handleHoverEvent(this.node,n,"End"))))}unmount(){}}class FocusGesture extends Feature{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=pipe(addDomEvent(this.node.current,"focus",()=>this.onFocus()),addDomEvent(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function handlePressEvent(s,e,t){const{props:n}=s;s.animationState&&n.whileTap&&s.animationState.setActive("whileTap",t==="Start");const i="onTap"+(t==="End"?"":t),o=n[i];o&&frame.postRender(()=>o(e,extractEventInfo(e)))}class PressGesture extends Feature{mount(){const{current:e}=this.node;e&&(this.unmount=press(e,t=>(handlePressEvent(this.node,t,"Start"),(n,{success:i})=>handlePressEvent(this.node,n,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const observerCallbacks=new WeakMap,observers=new WeakMap,fireObserverCallback=s=>{const e=observerCallbacks.get(s.target);e&&e(s)},fireAllObserverCallbacks=s=>{s.forEach(fireObserverCallback)};function initIntersectionObserver({root:s,...e}){const t=s||document;observers.has(t)||observers.set(t,{});const n=observers.get(t),i=JSON.stringify(e);return n[i]||(n[i]=new IntersectionObserver(fireAllObserverCallbacks,{root:s,...e})),n[i]}function observeIntersection(s,e,t){const n=initIntersectionObserver(e);return observerCallbacks.set(s,t),n.observe(s),()=>{observerCallbacks.delete(s),n.unobserve(s)}}const thresholdNames={some:0,all:1};class InViewFeature extends Feature{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:n,amount:i="some",once:o}=e,a={root:t?t.current:void 0,rootMargin:n,threshold:typeof i=="number"?i:thresholdNames[i]},l=h=>{const{isIntersecting:d}=h;if(this.isInView===d||(this.isInView=d,o&&!d&&this.hasEnteredView))return;d&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",d);const{onViewportEnter:u,onViewportLeave:f}=this.node.getProps(),m=d?u:f;m&&m(h)};return observeIntersection(this.node.current,a,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(hasViewportOptionChanged(e,t))&&this.startObserver()}unmount(){}}function hasViewportOptionChanged({viewport:s={}},{viewport:e={}}={}){return t=>s[t]!==e[t]}const gestureAnimations={inView:{Feature:InViewFeature},tap:{Feature:PressGesture},focus:{Feature:FocusGesture},hover:{Feature:HoverGesture}},layout={layout:{ProjectionNode:HTMLProjectionNode,MeasureLayout}},prefersReducedMotion={current:null},hasReducedMotionListener={current:!1};function initPrefersReducedMotion(){if(hasReducedMotionListener.current=!0,!!isBrowser)if(window.matchMedia){const s=window.matchMedia("(prefers-reduced-motion)"),e=()=>prefersReducedMotion.current=s.matches;s.addListener(e),e()}else prefersReducedMotion.current=!1}const valueTypes=[...dimensionValueTypes,color,complex],findValueType=s=>valueTypes.find(testValueType(s)),visualElementStore=new WeakMap;function updateMotionValuesFromProps(s,e,t){for(const n in e){const i=e[n],o=t[n];if(isMotionValue(i))s.addValue(n,i);else if(isMotionValue(o))s.addValue(n,motionValue(i,{owner:s}));else if(o!==i)if(s.hasValue(n)){const a=s.getValue(n);a.liveStyle===!0?a.jump(i):a.hasAnimated||a.set(i)}else{const a=s.getStaticValue(n);s.addValue(n,motionValue(a!==void 0?a:i,{owner:s}))}}for(const n in t)e[n]===void 0&&s.removeValue(n);return e}const propEventHandlers=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class VisualElement{scrapeMotionValuesFromProps(e,t,n){return{}}constructor({parent:e,props:t,presenceContext:n,reducedMotionConfig:i,blockInitialAnimation:o,visualState:a},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=KeyframeResolver,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const v=time.now();this.renderScheduledAt<v&&(this.renderScheduledAt=v,frame.render(this.render,!1,!0))};const{latestValues:h,renderState:d,onUpdate:u}=a;this.onUpdate=u,this.latestValues=h,this.baseTarget={...h},this.initialValues=t.initial?{...h}:{},this.renderState=d,this.parent=e,this.props=t,this.presenceContext=n,this.depth=e?e.depth+1:0,this.reducedMotionConfig=i,this.options=l,this.blockInitialAnimation=!!o,this.isControllingVariants=isControllingVariants(t),this.isVariantNode=isVariantNode(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:f,...m}=this.scrapeMotionValuesFromProps(t,{},this);for(const v in m){const g=m[v];h[v]!==void 0&&isMotionValue(g)&&g.set(h[v],!1)}}mount(e){this.current=e,visualElementStore.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,n)=>this.bindToMotionValue(n,t)),hasReducedMotionListener.current||initPrefersReducedMotion(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:prefersReducedMotion.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){visualElementStore.delete(this.current),this.projection&&this.projection.unmount(),cancelFrame(this.notifyUpdate),cancelFrame(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const t=this.features[e];t&&(t.unmount(),t.isMounted=!1)}this.current=null}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const n=transformProps.has(e),i=t.on("change",l=>{this.latestValues[e]=l,this.props.onUpdate&&frame.preRender(this.notifyUpdate),n&&this.projection&&(this.projection.isTransformDirty=!0)}),o=t.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{i(),o(),a&&a(),t.owner&&t.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in featureDefinitions){const t=featureDefinitions[e];if(!t)continue;const{isEnabled:n,Feature:i}=t;if(!this.features[e]&&i&&n(this.props)&&(this.features[e]=new i(this)),this.features[e]){const o=this.features[e];o.isMounted?o.update():(o.mount(),o.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):createBox()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let n=0;n<propEventHandlers.length;n++){const i=propEventHandlers[n];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const o="on"+i,a=e[o];a&&(this.propEventSubscriptions[i]=this.on(i,a))}this.prevMotionValues=updateMotionValuesFromProps(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const n=this.values.get(e);t!==n&&(n&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let n=this.values.get(e);return n===void 0&&t!==void 0&&(n=motionValue(t===null?void 0:t,{owner:this}),this.addValue(e,n)),n}readValue(e,t){var n;let i=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(n=this.getBaseTargetFromProps(this.props,e))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,e,this.options);return i!=null&&(typeof i=="string"&&(isNumericalString(i)||isZeroValueString(i))?i=parseFloat(i):!findValueType(i)&&complex.test(t)&&(i=getAnimatableNone(e,t)),this.setBaseTarget(e,isMotionValue(i)?i.get():i)),isMotionValue(i)?i.get():i}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:n}=this.props;let i;if(typeof n=="string"||typeof n=="object"){const a=resolveVariantFromProps(this.props,n,(t=this.presenceContext)===null||t===void 0?void 0:t.custom);a&&(i=a[e])}if(n&&i!==void 0)return i;const o=this.getBaseTargetFromProps(this.props,e);return o!==void 0&&!isMotionValue(o)?o:this.initialValues[e]!==void 0&&i===void 0?void 0:this.baseTarget[e]}on(e,t){return this.events[e]||(this.events[e]=new SubscriptionManager),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class DOMVisualElement extends VisualElement{constructor(){super(...arguments),this.KeyframeResolver=DOMKeyframesResolver}sortInstanceNodePosition(e,t){return e.compareDocumentPosition(t)&2?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:n}){delete t[e],delete n[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;isMotionValue(e)&&(this.childSubscription=e.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}}function getComputedStyle$1(s){return window.getComputedStyle(s)}class HTMLVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="html",this.renderInstance=renderHTML}readValueFromInstance(e,t){if(transformProps.has(t)){const n=getDefaultValueType(t);return n&&n.default||0}else{const n=getComputedStyle$1(e),i=(isCSSVariableName(t)?n.getPropertyValue(t):n[t])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:t}){return measureViewportBox(e,t)}build(e,t,n){buildHTMLStyles(e,t,n.transformTemplate)}scrapeMotionValuesFromProps(e,t,n){return scrapeMotionValuesFromProps$1(e,t,n)}}class SVGVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=createBox}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(transformProps.has(t)){const n=getDefaultValueType(t);return n&&n.default||0}return t=camelCaseAttributes.has(t)?t:camelToDash(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,n){return scrapeMotionValuesFromProps(e,t,n)}build(e,t,n){buildSVGAttrs(e,t,this.isSVGTag,n.transformTemplate)}renderInstance(e,t,n,i){renderSVG(e,t,n,i)}mount(e){this.isSVGTag=isSVGTag(e.tagName),super.mount(e)}}const createDomVisualElement=(s,e)=>isSVGComponent(s)?new SVGVisualElement(e):new HTMLVisualElement(e,{allowProjection:s!==reactExports.Fragment}),createMotionComponent=createMotionComponentFactory({...animations,...gestureAnimations,...drag,...layout},createDomVisualElement),motion=createDOMMotionComponentProxy(createMotionComponent);function ExplainTooltip({text:s,position:e,onClose:t,onAddToNotes:n}){const[i,o]=reactExports.useState(""),[a,l]=reactExports.useState(!0),[h,d]=reactExports.useState(!1);return reactExports.useEffect(()=>{(async()=>{try{l(!0),d(!1);const f=await fetch("/api/explain-text",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:s})});if(!f.ok)throw new Error("Failed to get explanation");const m=await f.json();o(m.explanation)}catch(f){console.error("[ExplainTooltip] Error:",f),d(!0),toast.error("Failed to generate explanation")}finally{l(!1)}})()},[s]),jsxRuntimeExports.jsx(AnimatePresence,{children:jsxRuntimeExports.jsx(motion.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"fixed z-50 bg-white border border-border shadow-lg rounded-md",style:{left:`${e.x}px`,top:`${e.y-10}px`,transform:"translate(-50%, -100%)",maxWidth:"360px"},children:jsxRuntimeExports.jsxs("div",{className:"p-3 space-y-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start justify-between gap-2",children:[jsxRuntimeExports.jsxs("div",{className:"flex-1",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Selected"}),jsxRuntimeExports.jsx("div",{className:"text-xs bg-muted px-2 py-1 rounded italic",children:s})]}),jsxRuntimeExports.jsx("button",{onClick:t,className:"p-1 hover:bg-muted rounded transition-colors",children:jsxRuntimeExports.jsx(X,{className:"w-3 h-3"})})]}),jsxRuntimeExports.jsxs("div",{className:"pt-2 border-t border-border",children:[jsxRuntimeExports.jsxs("div",{className:"text-xs text-muted-foreground mb-1 flex items-center gap-1",children:[jsxRuntimeExports.jsx(Sparkles,{className:"w-3 h-3"}),"AI Explanation"]}),a?jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 py-2",children:[jsxRuntimeExports.jsx(LoaderCircle,{className:"w-4 h-4 animate-spin text-muted-foreground"}),jsxRuntimeExports.jsx("span",{className:"text-xs text-muted-foreground",children:"Generating explanation..."})]}):h?jsxRuntimeExports.jsx("p",{className:"text-xs text-red-500",children:"Failed to generate explanation. Try again."}):jsxRuntimeExports.jsx("p",{className:"text-xs leading-relaxed",children:i})]}),!a&&!h&&jsxRuntimeExports.jsxs("button",{onClick:n,className:"w-full flex items-center justify-center gap-1.5 px-3 py-1.5 bg-accent text-accent-foreground hover:bg-accent/90 rounded text-xs transition-colors",children:[jsxRuntimeExports.jsx(FileText,{className:"w-3 h-3"}),"Add to Notes"]})]})})})}const PanelGroupContext=reactExports.createContext(null);PanelGroupContext.displayName="PanelGroupContext";const DATA_ATTRIBUTES={group:"data-panel-group",groupDirection:"data-panel-group-direction",groupId:"data-panel-group-id",panel:"data-panel",panelCollapsible:"data-panel-collapsible",panelId:"data-panel-id",panelSize:"data-panel-size",resizeHandle:"data-resize-handle",resizeHandleActive:"data-resize-handle-active",resizeHandleEnabled:"data-panel-resize-handle-enabled",resizeHandleId:"data-panel-resize-handle-id",resizeHandleState:"data-resize-handle-state"},PRECISION=10,useIsomorphicLayoutEffect=reactExports.useLayoutEffect,useId=React$1.useId,wrappedUseId=typeof useId=="function"?useId:()=>null;let counter=0;function useUniqueId(s=null){const e=wrappedUseId(),t=reactExports.useRef(s||e||null);return t.current===null&&(t.current=""+counter++),s??t.current}function PanelWithForwardedRef({children:s,className:e="",collapsedSize:t,collapsible:n,defaultSize:i,forwardedRef:o,id:a,maxSize:l,minSize:h,onCollapse:d,onExpand:u,onResize:f,order:m,style:v,tagName:g="div",...x}){const E=reactExports.useContext(PanelGroupContext);if(E===null)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:b,expandPanel:_,getPanelSize:S,getPanelStyle:C,groupId:A,isPanelCollapsed:R,reevaluatePanelConstraints:L,registerPanel:j,resizePanel:F,unregisterPanel:W}=E,K=useUniqueId(a),ee=reactExports.useRef({callbacks:{onCollapse:d,onExpand:u,onResize:f},constraints:{collapsedSize:t,collapsible:n,defaultSize:i,maxSize:l,minSize:h},id:K,idIsFromProps:a!==void 0,order:m});reactExports.useRef({didLogMissingDefaultSizeWarning:!1}),useIsomorphicLayoutEffect(()=>{const{callbacks:re,constraints:ie}=ee.current,Q={...ie};ee.current.id=K,ee.current.idIsFromProps=a!==void 0,ee.current.order=m,re.onCollapse=d,re.onExpand=u,re.onResize=f,ie.collapsedSize=t,ie.collapsible=n,ie.defaultSize=i,ie.maxSize=l,ie.minSize=h,(Q.collapsedSize!==ie.collapsedSize||Q.collapsible!==ie.collapsible||Q.maxSize!==ie.maxSize||Q.minSize!==ie.minSize)&&L(ee.current,Q)}),useIsomorphicLayoutEffect(()=>{const re=ee.current;return j(re),()=>{W(re)}},[m,K,j,W]),reactExports.useImperativeHandle(o,()=>({collapse:()=>{b(ee.current)},expand:re=>{_(ee.current,re)},getId(){return K},getSize(){return S(ee.current)},isCollapsed(){return R(ee.current)},isExpanded(){return!R(ee.current)},resize:re=>{F(ee.current,re)}}),[b,_,S,R,K,F]);const te=C(ee.current,i);return reactExports.createElement(g,{...x,children:s,className:e,id:K,style:{...te,...v},[DATA_ATTRIBUTES.groupId]:A,[DATA_ATTRIBUTES.panel]:"",[DATA_ATTRIBUTES.panelCollapsible]:n||void 0,[DATA_ATTRIBUTES.panelId]:K,[DATA_ATTRIBUTES.panelSize]:parseFloat(""+te.flexGrow).toFixed(1)})}const Panel=reactExports.forwardRef((s,e)=>reactExports.createElement(PanelWithForwardedRef,{...s,forwardedRef:e}));PanelWithForwardedRef.displayName="Panel";Panel.displayName="forwardRef(Panel)";let currentCursorStyle=null,prevRuleIndex=-1,styleElement=null;function getCursorStyle(s,e){if(e){const t=(e&EXCEEDED_HORIZONTAL_MIN)!==0,n=(e&EXCEEDED_HORIZONTAL_MAX)!==0,i=(e&EXCEEDED_VERTICAL_MIN)!==0,o=(e&EXCEEDED_VERTICAL_MAX)!==0;if(t)return i?"se-resize":o?"ne-resize":"e-resize";if(n)return i?"sw-resize":o?"nw-resize":"w-resize";if(i)return"s-resize";if(o)return"n-resize"}switch(s){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}function resetGlobalCursorStyle(){styleElement!==null&&(document.head.removeChild(styleElement),currentCursorStyle=null,styleElement=null,prevRuleIndex=-1)}function setGlobalCursorStyle(s,e){var t,n;const i=getCursorStyle(s,e);if(currentCursorStyle!==i){if(currentCursorStyle=i,styleElement===null&&(styleElement=document.createElement("style"),document.head.appendChild(styleElement)),prevRuleIndex>=0){var o;(o=styleElement.sheet)===null||o===void 0||o.removeRule(prevRuleIndex)}prevRuleIndex=(t=(n=styleElement.sheet)===null||n===void 0?void 0:n.insertRule(`*{cursor: ${i} !important;}`))!==null&&t!==void 0?t:-1}}function isKeyDown(s){return s.type==="keydown"}function isPointerEvent(s){return s.type.startsWith("pointer")}function isMouseEvent(s){return s.type.startsWith("mouse")}function getResizeEventCoordinates(s){if(isPointerEvent(s)){if(s.isPrimary)return{x:s.clientX,y:s.clientY}}else if(isMouseEvent(s))return{x:s.clientX,y:s.clientY};return{x:1/0,y:1/0}}function getInputType(){if(typeof matchMedia=="function")return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}function intersects(s,e,t){return s.x<e.x+e.width&&s.x+s.width>e.x&&s.y<e.y+e.height&&s.y+s.height>e.y}function compare(s,e){if(s===e)throw new Error("Cannot compare node with itself");const t={a:get_ancestors(s),b:get_ancestors(e)};let n;for(;t.a.at(-1)===t.b.at(-1);)s=t.a.pop(),e=t.b.pop(),n=s;assert(n,"Stacking order can only be calculated for elements with a common ancestor");const i={a:get_z_index(find_stacking_context(t.a)),b:get_z_index(find_stacking_context(t.b))};if(i.a===i.b){const o=n.childNodes,a={a:t.a.at(-1),b:t.b.at(-1)};let l=o.length;for(;l--;){const h=o[l];if(h===a.a)return 1;if(h===a.b)return-1}}return Math.sign(i.a-i.b)}const props=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function is_flex_item(s){var e;const t=getComputedStyle((e=get_parent(s))!==null&&e!==void 0?e:s).display;return t==="flex"||t==="inline-flex"}function creates_stacking_context(s){const e=getComputedStyle(s);return!!(e.position==="fixed"||e.zIndex!=="auto"&&(e.position!=="static"||is_flex_item(s))||+e.opacity<1||"transform"in e&&e.transform!=="none"||"webkitTransform"in e&&e.webkitTransform!=="none"||"mixBlendMode"in e&&e.mixBlendMode!=="normal"||"filter"in e&&e.filter!=="none"||"webkitFilter"in e&&e.webkitFilter!=="none"||"isolation"in e&&e.isolation==="isolate"||props.test(e.willChange)||e.webkitOverflowScrolling==="touch")}function find_stacking_context(s){let e=s.length;for(;e--;){const t=s[e];if(assert(t,"Missing node"),creates_stacking_context(t))return t}return null}function get_z_index(s){return s&&Number(getComputedStyle(s).zIndex)||0}function get_ancestors(s){const e=[];for(;s;)e.push(s),s=get_parent(s);return e}function get_parent(s){const{parentNode:e}=s;return e&&e instanceof ShadowRoot?e.host:e}const EXCEEDED_HORIZONTAL_MIN=1,EXCEEDED_HORIZONTAL_MAX=2,EXCEEDED_VERTICAL_MIN=4,EXCEEDED_VERTICAL_MAX=8,isCoarsePointer=getInputType()==="coarse";let intersectingHandles=[],isPointerDown=!1,ownerDocumentCounts=new Map,panelConstraintFlags=new Map;const registeredResizeHandlers=new Set;function registerResizeHandle(s,e,t,n,i){var o;const{ownerDocument:a}=e,l={direction:t,element:e,hitAreaMargins:n,setResizeHandlerState:i},h=(o=ownerDocumentCounts.get(a))!==null&&o!==void 0?o:0;return ownerDocumentCounts.set(a,h+1),registeredResizeHandlers.add(l),updateListeners(),function(){var u;panelConstraintFlags.delete(s),registeredResizeHandlers.delete(l);const f=(u=ownerDocumentCounts.get(a))!==null&&u!==void 0?u:1;if(ownerDocumentCounts.set(a,f-1),updateListeners(),f===1&&ownerDocumentCounts.delete(a),intersectingHandles.includes(l)){const m=intersectingHandles.indexOf(l);m>=0&&intersectingHandles.splice(m,1),updateCursor(),i("up",!0,null)}}}function handlePointerDown(s){const{target:e}=s,{x:t,y:n}=getResizeEventCoordinates(s);isPointerDown=!0,recalculateIntersectingHandles({target:e,x:t,y:n}),updateListeners(),intersectingHandles.length>0&&(updateResizeHandlerStates("down",s),s.preventDefault(),isWithinResizeHandle(e)||s.stopImmediatePropagation())}function handlePointerMove(s){const{x:e,y:t}=getResizeEventCoordinates(s);if(isPointerDown&&s.buttons===0&&(isPointerDown=!1,updateResizeHandlerStates("up",s)),!isPointerDown){const{target:n}=s;recalculateIntersectingHandles({target:n,x:e,y:t})}updateResizeHandlerStates("move",s),updateCursor(),intersectingHandles.length>0&&s.preventDefault()}function handlePointerUp(s){const{target:e}=s,{x:t,y:n}=getResizeEventCoordinates(s);panelConstraintFlags.clear(),isPointerDown=!1,intersectingHandles.length>0&&(s.preventDefault(),isWithinResizeHandle(e)||s.stopImmediatePropagation()),updateResizeHandlerStates("up",s),recalculateIntersectingHandles({target:e,x:t,y:n}),updateCursor(),updateListeners()}function isWithinResizeHandle(s){let e=s;for(;e;){if(e.hasAttribute(DATA_ATTRIBUTES.resizeHandle))return!0;e=e.parentElement}return!1}function recalculateIntersectingHandles({target:s,x:e,y:t}){intersectingHandles.splice(0);let n=null;(s instanceof HTMLElement||s instanceof SVGElement)&&(n=s),registeredResizeHandlers.forEach(i=>{const{element:o,hitAreaMargins:a}=i,l=o.getBoundingClientRect(),{bottom:h,left:d,right:u,top:f}=l,m=isCoarsePointer?a.coarse:a.fine;if(e>=d-m&&e<=u+m&&t>=f-m&&t<=h+m){if(n!==null&&document.contains(n)&&o!==n&&!o.contains(n)&&!n.contains(o)&&compare(n,o)>0){let g=n,x=!1;for(;g&&!g.contains(o);){if(intersects(g.getBoundingClientRect(),l)){x=!0;break}g=g.parentElement}if(x)return}intersectingHandles.push(i)}})}function reportConstraintsViolation(s,e){panelConstraintFlags.set(s,e)}function updateCursor(){let s=!1,e=!1;intersectingHandles.forEach(n=>{const{direction:i}=n;i==="horizontal"?s=!0:e=!0});let t=0;panelConstraintFlags.forEach(n=>{t|=n}),s&&e?setGlobalCursorStyle("intersection",t):s?setGlobalCursorStyle("horizontal",t):e?setGlobalCursorStyle("vertical",t):resetGlobalCursorStyle()}let listenersAbortController=new AbortController;function updateListeners(){listenersAbortController.abort(),listenersAbortController=new AbortController;const s={capture:!0,signal:listenersAbortController.signal};registeredResizeHandlers.size&&(isPointerDown?(intersectingHandles.length>0&&ownerDocumentCounts.forEach((e,t)=>{const{body:n}=t;e>0&&(n.addEventListener("contextmenu",handlePointerUp,s),n.addEventListener("pointerleave",handlePointerMove,s),n.addEventListener("pointermove",handlePointerMove,s))}),window.addEventListener("pointerup",handlePointerUp,s),window.addEventListener("pointercancel",handlePointerUp,s)):ownerDocumentCounts.forEach((e,t)=>{const{body:n}=t;e>0&&(n.addEventListener("pointerdown",handlePointerDown,s),n.addEventListener("pointermove",handlePointerMove,s))}))}function updateResizeHandlerStates(s,e){registeredResizeHandlers.forEach(t=>{const{setResizeHandlerState:n}=t,i=intersectingHandles.includes(t);n(s,i,e)})}function useForceUpdate(){const[s,e]=reactExports.useState(0);return reactExports.useCallback(()=>e(t=>t+1),[])}function assert(s,e){if(!s)throw console.error(e),Error(e)}function fuzzyCompareNumbers(s,e,t=PRECISION){return s.toFixed(t)===e.toFixed(t)?0:s>e?1:-1}function fuzzyNumbersEqual$1(s,e,t=PRECISION){return fuzzyCompareNumbers(s,e,t)===0}function fuzzyNumbersEqual(s,e,t){return fuzzyCompareNumbers(s,e,t)===0}function fuzzyLayoutsEqual(s,e,t){if(s.length!==e.length)return!1;for(let n=0;n<s.length;n++){const i=s[n],o=e[n];if(!fuzzyNumbersEqual(i,o,t))return!1}return!0}function resizePanel({panelConstraints:s,panelIndex:e,size:t}){const n=s[e];assert(n!=null,`Panel constraints not found for index ${e}`);let{collapsedSize:i=0,collapsible:o,maxSize:a=100,minSize:l=0}=n;if(fuzzyCompareNumbers(t,l)<0)if(o){const h=(i+l)/2;fuzzyCompareNumbers(t,h)<0?t=i:t=l}else t=l;return t=Math.min(a,t),t=parseFloat(t.toFixed(PRECISION)),t}function adjustLayoutByDelta({delta:s,initialLayout:e,panelConstraints:t,pivotIndices:n,prevLayout:i,trigger:o}){if(fuzzyNumbersEqual(s,0))return e;const a=[...e],[l,h]=n;assert(l!=null,"Invalid first pivot index"),assert(h!=null,"Invalid second pivot index");let d=0;if(o==="keyboard"){{const f=s<0?h:l,m=t[f];assert(m,`Panel constraints not found for index ${f}`);const{collapsedSize:v=0,collapsible:g,minSize:x=0}=m;if(g){const E=e[f];if(assert(E!=null,`Previous layout not found for panel index ${f}`),fuzzyNumbersEqual(E,v)){const b=x-E;fuzzyCompareNumbers(b,Math.abs(s))>0&&(s=s<0?0-b:b)}}}{const f=s<0?l:h,m=t[f];assert(m,`No panel constraints found for index ${f}`);const{collapsedSize:v=0,collapsible:g,minSize:x=0}=m;if(g){const E=e[f];if(assert(E!=null,`Previous layout not found for panel index ${f}`),fuzzyNumbersEqual(E,x)){const b=E-v;fuzzyCompareNumbers(b,Math.abs(s))>0&&(s=s<0?0-b:b)}}}}{const f=s<0?1:-1;let m=s<0?h:l,v=0;for(;;){const x=e[m];assert(x!=null,`Previous layout not found for panel index ${m}`);const b=resizePanel({panelConstraints:t,panelIndex:m,size:100})-x;if(v+=b,m+=f,m<0||m>=t.length)break}const g=Math.min(Math.abs(s),Math.abs(v));s=s<0?0-g:g}{let m=s<0?l:h;for(;m>=0&&m<t.length;){const v=Math.abs(s)-Math.abs(d),g=e[m];assert(g!=null,`Previous layout not found for panel index ${m}`);const x=g-v,E=resizePanel({panelConstraints:t,panelIndex:m,size:x});if(!fuzzyNumbersEqual(g,E)&&(d+=g-E,a[m]=E,d.toPrecision(3).localeCompare(Math.abs(s).toPrecision(3),void 0,{numeric:!0})>=0))break;s<0?m--:m++}}if(fuzzyLayoutsEqual(i,a))return i;{const f=s<0?h:l,m=e[f];assert(m!=null,`Previous layout not found for panel index ${f}`);const v=m+d,g=resizePanel({panelConstraints:t,panelIndex:f,size:v});if(a[f]=g,!fuzzyNumbersEqual(g,v)){let x=v-g,b=s<0?h:l;for(;b>=0&&b<t.length;){const _=a[b];assert(_!=null,`Previous layout not found for panel index ${b}`);const S=_+x,C=resizePanel({panelConstraints:t,panelIndex:b,size:S});if(fuzzyNumbersEqual(_,C)||(x-=C-_,a[b]=C),fuzzyNumbersEqual(x,0))break;s>0?b--:b++}}}const u=a.reduce((f,m)=>m+f,0);return fuzzyNumbersEqual(u,100)?a:i}function calculateAriaValues({layout:s,panelsArray:e,pivotIndices:t}){let n=0,i=100,o=0,a=0;const l=t[0];assert(l!=null,"No pivot index found"),e.forEach((f,m)=>{const{constraints:v}=f,{maxSize:g=100,minSize:x=0}=v;m===l?(n=x,i=g):(o+=x,a+=g)});const h=Math.min(i,100-o),d=Math.max(n,100-a),u=s[l];return{valueMax:h,valueMin:d,valueNow:u}}function getResizeHandleElementsForGroup(s,e=document){return Array.from(e.querySelectorAll(`[${DATA_ATTRIBUTES.resizeHandleId}][data-panel-group-id="${s}"]`))}function getResizeHandleElementIndex(s,e,t=document){const i=getResizeHandleElementsForGroup(s,t).findIndex(o=>o.getAttribute(DATA_ATTRIBUTES.resizeHandleId)===e);return i??null}function determinePivotIndices(s,e,t){const n=getResizeHandleElementIndex(s,e,t);return n!=null?[n,n+1]:[-1,-1]}function getPanelGroupElement(s,e=document){var t;if(e instanceof HTMLElement&&(e==null||(t=e.dataset)===null||t===void 0?void 0:t.panelGroupId)==s)return e;const n=e.querySelector(`[data-panel-group][data-panel-group-id="${s}"]`);return n||null}function getResizeHandleElement(s,e=document){const t=e.querySelector(`[${DATA_ATTRIBUTES.resizeHandleId}="${s}"]`);return t||null}function getResizeHandlePanelIds(s,e,t,n=document){var i,o,a,l;const h=getResizeHandleElement(e,n),d=getResizeHandleElementsForGroup(s,n),u=h?d.indexOf(h):-1,f=(i=(o=t[u])===null||o===void 0?void 0:o.id)!==null&&i!==void 0?i:null,m=(a=(l=t[u+1])===null||l===void 0?void 0:l.id)!==null&&a!==void 0?a:null;return[f,m]}function useWindowSplitterPanelGroupBehavior({committedValuesRef:s,eagerValuesRef:e,groupId:t,layout:n,panelDataArray:i,panelGroupElement:o,setLayout:a}){reactExports.useRef({didWarnAboutMissingResizeHandle:!1}),useIsomorphicLayoutEffect(()=>{if(!o)return;const l=getResizeHandleElementsForGroup(t,o);for(let h=0;h<i.length-1;h++){const{valueMax:d,valueMin:u,valueNow:f}=calculateAriaValues({layout:n,panelsArray:i,pivotIndices:[h,h+1]}),m=l[h];if(m!=null){const v=i[h];assert(v,`No panel data found for index "${h}"`),m.setAttribute("aria-controls",v.id),m.setAttribute("aria-valuemax",""+Math.round(d)),m.setAttribute("aria-valuemin",""+Math.round(u)),m.setAttribute("aria-valuenow",f!=null?""+Math.round(f):"")}}return()=>{l.forEach((h,d)=>{h.removeAttribute("aria-controls"),h.removeAttribute("aria-valuemax"),h.removeAttribute("aria-valuemin"),h.removeAttribute("aria-valuenow")})}},[t,n,i,o]),reactExports.useEffect(()=>{if(!o)return;const l=e.current;assert(l,"Eager values not found");const{panelDataArray:h}=l,d=getPanelGroupElement(t,o);assert(d!=null,`No group found for id "${t}"`);const u=getResizeHandleElementsForGroup(t,o);assert(u,`No resize handles found for group id "${t}"`);const f=u.map(m=>{const v=m.getAttribute(DATA_ATTRIBUTES.resizeHandleId);assert(v,"Resize handle element has no handle id attribute");const[g,x]=getResizeHandlePanelIds(t,v,h,o);if(g==null||x==null)return()=>{};const E=b=>{if(!b.defaultPrevented)switch(b.key){case"Enter":{b.preventDefault();const _=h.findIndex(S=>S.id===g);if(_>=0){const S=h[_];assert(S,`No panel data found for index ${_}`);const C=n[_],{collapsedSize:A=0,collapsible:R,minSize:L=0}=S.constraints;if(C!=null&&R){const j=adjustLayoutByDelta({delta:fuzzyNumbersEqual(C,A)?L-A:A-C,initialLayout:n,panelConstraints:h.map(F=>F.constraints),pivotIndices:determinePivotIndices(t,v,o),prevLayout:n,trigger:"keyboard"});n!==j&&a(j)}}break}}};return m.addEventListener("keydown",E),()=>{m.removeEventListener("keydown",E)}});return()=>{f.forEach(m=>m())}},[o,s,e,t,n,i,a])}function areEqual(s,e){if(s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(s[t]!==e[t])return!1;return!0}function getResizeEventCursorPosition(s,e){const t=s==="horizontal",{x:n,y:i}=getResizeEventCoordinates(e);return t?n:i}function calculateDragOffsetPercentage(s,e,t,n,i){const o=t==="horizontal",a=getResizeHandleElement(e,i);assert(a,`No resize handle element found for id "${e}"`);const l=a.getAttribute(DATA_ATTRIBUTES.groupId);assert(l,"Resize handle element has no group id attribute");let{initialCursorPosition:h}=n;const d=getResizeEventCursorPosition(t,s),u=getPanelGroupElement(l,i);assert(u,`No group element found for id "${l}"`);const f=u.getBoundingClientRect(),m=o?f.width:f.height;return(d-h)/m*100}function calculateDeltaPercentage(s,e,t,n,i,o){if(isKeyDown(s)){const a=t==="horizontal";let l=0;s.shiftKey?l=100:i!=null?l=i:l=10;let h=0;switch(s.key){case"ArrowDown":h=a?0:l;break;case"ArrowLeft":h=a?-l:0;break;case"ArrowRight":h=a?l:0;break;case"ArrowUp":h=a?0:-l;break;case"End":h=100;break;case"Home":h=-100;break}return h}else return n==null?0:calculateDragOffsetPercentage(s,e,t,n,o)}function calculateUnsafeDefaultLayout({panelDataArray:s}){const e=Array(s.length),t=s.map(o=>o.constraints);let n=0,i=100;for(let o=0;o<s.length;o++){const a=t[o];assert(a,`Panel constraints not found for index ${o}`);const{defaultSize:l}=a;l!=null&&(n++,e[o]=l,i-=l)}for(let o=0;o<s.length;o++){const a=t[o];assert(a,`Panel constraints not found for index ${o}`);const{defaultSize:l}=a;if(l!=null)continue;const h=s.length-n,d=i/h;n++,e[o]=d,i-=d}return e}function callPanelCallbacks(s,e,t){e.forEach((n,i)=>{const o=s[i];assert(o,`Panel data not found for index ${i}`);const{callbacks:a,constraints:l,id:h}=o,{collapsedSize:d=0,collapsible:u}=l,f=t[h];if(f==null||n!==f){t[h]=n;const{onCollapse:m,onExpand:v,onResize:g}=a;g&&g(n,f),u&&(m||v)&&(v&&(f==null||fuzzyNumbersEqual$1(f,d))&&!fuzzyNumbersEqual$1(n,d)&&v(),m&&(f==null||!fuzzyNumbersEqual$1(f,d))&&fuzzyNumbersEqual$1(n,d)&&m())}})}function compareLayouts(s,e){if(s.length!==e.length)return!1;for(let t=0;t<s.length;t++)if(s[t]!=e[t])return!1;return!0}function computePanelFlexBoxStyle({defaultSize:s,dragState:e,layout:t,panelData:n,panelIndex:i,precision:o=3}){const a=t[i];let l;return a==null?l=s!=null?s.toPrecision(o):"1":n.length===1?l="1":l=a.toPrecision(o),{flexBasis:0,flexGrow:l,flexShrink:1,overflow:"hidden",pointerEvents:e!==null?"none":void 0}}function debounce(s,e=10){let t=null;return(...i)=>{t!==null&&clearTimeout(t),t=setTimeout(()=>{s(...i)},e)}}function initializeDefaultStorage(s){try{if(typeof localStorage<"u")s.getItem=e=>localStorage.getItem(e),s.setItem=(e,t)=>{localStorage.setItem(e,t)};else throw new Error("localStorage not supported in this environment")}catch(e){console.error(e),s.getItem=()=>null,s.setItem=()=>{}}}function getPanelGroupKey(s){return`react-resizable-panels:${s}`}function getPanelKey(s){return s.map(e=>{const{constraints:t,id:n,idIsFromProps:i,order:o}=e;return i?n:o?`${o}:${JSON.stringify(t)}`:JSON.stringify(t)}).sort((e,t)=>e.localeCompare(t)).join(",")}function loadSerializedPanelGroupState(s,e){try{const t=getPanelGroupKey(s),n=e.getItem(t);if(n){const i=JSON.parse(n);if(typeof i=="object"&&i!=null)return i}}catch{}return null}function loadPanelGroupState(s,e,t){var n,i;const o=(n=loadSerializedPanelGroupState(s,t))!==null&&n!==void 0?n:{},a=getPanelKey(e);return(i=o[a])!==null&&i!==void 0?i:null}function savePanelGroupState(s,e,t,n,i){var o;const a=getPanelGroupKey(s),l=getPanelKey(e),h=(o=loadSerializedPanelGroupState(s,i))!==null&&o!==void 0?o:{};h[l]={expandToSizes:Object.fromEntries(t.entries()),layout:n};try{i.setItem(a,JSON.stringify(h))}catch(d){console.error(d)}}function validatePanelGroupLayout({layout:s,panelConstraints:e}){const t=[...s],n=t.reduce((o,a)=>o+a,0);if(t.length!==e.length)throw Error(`Invalid ${e.length} panel layout: ${t.map(o=>`${o}%`).join(", ")}`);if(!fuzzyNumbersEqual(n,100)&&t.length>0)for(let o=0;o<e.length;o++){const a=t[o];assert(a!=null,`No layout data found for index ${o}`);const l=100/n*a;t[o]=l}let i=0;for(let o=0;o<e.length;o++){const a=t[o];assert(a!=null,`No layout data found for index ${o}`);const l=resizePanel({panelConstraints:e,panelIndex:o,size:a});a!=l&&(i+=a-l,t[o]=l)}if(!fuzzyNumbersEqual(i,0))for(let o=0;o<e.length;o++){const a=t[o];assert(a!=null,`No layout data found for index ${o}`);const l=a+i,h=resizePanel({panelConstraints:e,panelIndex:o,size:l});if(a!==h&&(i-=h-a,t[o]=h,fuzzyNumbersEqual(i,0)))break}return t}const LOCAL_STORAGE_DEBOUNCE_INTERVAL=100,defaultStorage={getItem:s=>(initializeDefaultStorage(defaultStorage),defaultStorage.getItem(s)),setItem:(s,e)=>{initializeDefaultStorage(defaultStorage),defaultStorage.setItem(s,e)}},debounceMap={};function PanelGroupWithForwardedRef({autoSaveId:s=null,children:e,className:t="",direction:n,forwardedRef:i,id:o=null,onLayout:a=null,keyboardResizeBy:l=null,storage:h=defaultStorage,style:d,tagName:u="div",...f}){const m=useUniqueId(o),v=reactExports.useRef(null),[g,x]=reactExports.useState(null),[E,b]=reactExports.useState([]),_=useForceUpdate(),S=reactExports.useRef({}),C=reactExports.useRef(new Map),A=reactExports.useRef(0),R=reactExports.useRef({autoSaveId:s,direction:n,dragState:g,id:m,keyboardResizeBy:l,onLayout:a,storage:h}),L=reactExports.useRef({layout:E,panelDataArray:[],panelDataArrayChanged:!1});reactExports.useRef({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),reactExports.useImperativeHandle(i,()=>({getId:()=>R.current.id,getLayout:()=>{const{layout:$}=L.current;return $},setLayout:$=>{const{onLayout:q}=R.current,{layout:V,panelDataArray:P}=L.current,O=validatePanelGroupLayout({layout:$,panelConstraints:P.map(B=>B.constraints)});areEqual(V,O)||(b(O),L.current.layout=O,q&&q(O),callPanelCallbacks(P,O,S.current))}}),[]),useIsomorphicLayoutEffect(()=>{R.current.autoSaveId=s,R.current.direction=n,R.current.dragState=g,R.current.id=m,R.current.onLayout=a,R.current.storage=h}),useWindowSplitterPanelGroupBehavior({committedValuesRef:R,eagerValuesRef:L,groupId:m,layout:E,panelDataArray:L.current.panelDataArray,setLayout:b,panelGroupElement:v.current}),reactExports.useEffect(()=>{const{panelDataArray:$}=L.current;if(s){if(E.length===0||E.length!==$.length)return;let q=debounceMap[s];q==null&&(q=debounce(savePanelGroupState,LOCAL_STORAGE_DEBOUNCE_INTERVAL),debounceMap[s]=q);const V=[...$],P=new Map(C.current);q(s,V,P,E,h)}},[s,E,h]),reactExports.useEffect(()=>{});const j=reactExports.useCallback($=>{const{onLayout:q}=R.current,{layout:V,panelDataArray:P}=L.current;if($.constraints.collapsible){const O=P.map(J=>J.constraints),{collapsedSize:B=0,panelSize:G,pivotIndices:Y}=panelDataHelper(P,$,V);if(assert(G!=null,`Panel size not found for panel "${$.id}"`),!fuzzyNumbersEqual$1(G,B)){C.current.set($.id,G);const Z=findPanelDataIndex(P,$)===P.length-1?G-B:B-G,oe=adjustLayoutByDelta({delta:Z,initialLayout:V,panelConstraints:O,pivotIndices:Y,prevLayout:V,trigger:"imperative-api"});compareLayouts(V,oe)||(b(oe),L.current.layout=oe,q&&q(oe),callPanelCallbacks(P,oe,S.current))}}},[]),F=reactExports.useCallback(($,q)=>{const{onLayout:V}=R.current,{layout:P,panelDataArray:O}=L.current;if($.constraints.collapsible){const B=O.map(ve=>ve.constraints),{collapsedSize:G=0,panelSize:Y=0,minSize:J=0,pivotIndices:Z}=panelDataHelper(O,$,P),oe=q??J;if(fuzzyNumbersEqual$1(Y,G)){const ve=C.current.get($.id),ce=ve!=null&&ve>=oe?ve:oe,de=findPanelDataIndex(O,$)===O.length-1?Y-ce:ce-Y,pe=adjustLayoutByDelta({delta:de,initialLayout:P,panelConstraints:B,pivotIndices:Z,prevLayout:P,trigger:"imperative-api"});compareLayouts(P,pe)||(b(pe),L.current.layout=pe,V&&V(pe),callPanelCallbacks(O,pe,S.current))}}},[]),W=reactExports.useCallback($=>{const{layout:q,panelDataArray:V}=L.current,{panelSize:P}=panelDataHelper(V,$,q);return assert(P!=null,`Panel size not found for panel "${$.id}"`),P},[]),K=reactExports.useCallback(($,q)=>{const{panelDataArray:V}=L.current,P=findPanelDataIndex(V,$);return computePanelFlexBoxStyle({defaultSize:q,dragState:g,layout:E,panelData:V,panelIndex:P})},[g,E]),ee=reactExports.useCallback($=>{const{layout:q,panelDataArray:V}=L.current,{collapsedSize:P=0,collapsible:O,panelSize:B}=panelDataHelper(V,$,q);return assert(B!=null,`Panel size not found for panel "${$.id}"`),O===!0&&fuzzyNumbersEqual$1(B,P)},[]),te=reactExports.useCallback($=>{const{layout:q,panelDataArray:V}=L.current,{collapsedSize:P=0,collapsible:O,panelSize:B}=panelDataHelper(V,$,q);return assert(B!=null,`Panel size not found for panel "${$.id}"`),!O||fuzzyCompareNumbers(B,P)>0},[]),re=reactExports.useCallback($=>{const{panelDataArray:q}=L.current;q.push($),q.sort((V,P)=>{const O=V.order,B=P.order;return O==null&&B==null?0:O==null?-1:B==null?1:O-B}),L.current.panelDataArrayChanged=!0,_()},[_]);useIsomorphicLayoutEffect(()=>{if(L.current.panelDataArrayChanged){L.current.panelDataArrayChanged=!1;const{autoSaveId:$,onLayout:q,storage:V}=R.current,{layout:P,panelDataArray:O}=L.current;let B=null;if($){const Y=loadPanelGroupState($,O,V);Y&&(C.current=new Map(Object.entries(Y.expandToSizes)),B=Y.layout)}B==null&&(B=calculateUnsafeDefaultLayout({panelDataArray:O}));const G=validatePanelGroupLayout({layout:B,panelConstraints:O.map(Y=>Y.constraints)});areEqual(P,G)||(b(G),L.current.layout=G,q&&q(G),callPanelCallbacks(O,G,S.current))}}),useIsomorphicLayoutEffect(()=>{const $=L.current;return()=>{$.layout=[]}},[]);const ie=reactExports.useCallback($=>{let q=!1;const V=v.current;return V&&window.getComputedStyle(V,null).getPropertyValue("direction")==="rtl"&&(q=!0),function(O){O.preventDefault();const B=v.current;if(!B)return()=>null;const{direction:G,dragState:Y,id:J,keyboardResizeBy:Z,onLayout:oe}=R.current,{layout:ve,panelDataArray:ce}=L.current,{initialLayout:ue}=Y??{},de=determinePivotIndices(J,$,B);let pe=calculateDeltaPercentage(O,$,G,Y,Z,B);const ye=G==="horizontal";ye&&q&&(pe=-pe);const Ae=ce.map(Oe=>Oe.constraints),Ce=adjustLayoutByDelta({delta:pe,initialLayout:ue??ve,panelConstraints:Ae,pivotIndices:de,prevLayout:ve,trigger:isKeyDown(O)?"keyboard":"mouse-or-touch"}),Pe=!compareLayouts(ve,Ce);(isPointerEvent(O)||isMouseEvent(O))&&A.current!=pe&&(A.current=pe,!Pe&&pe!==0?ye?reportConstraintsViolation($,pe<0?EXCEEDED_HORIZONTAL_MIN:EXCEEDED_HORIZONTAL_MAX):reportConstraintsViolation($,pe<0?EXCEEDED_VERTICAL_MIN:EXCEEDED_VERTICAL_MAX):reportConstraintsViolation($,0)),Pe&&(b(Ce),L.current.layout=Ce,oe&&oe(Ce),callPanelCallbacks(ce,Ce,S.current))}},[]),Q=reactExports.useCallback(($,q)=>{const{onLayout:V}=R.current,{layout:P,panelDataArray:O}=L.current,B=O.map(ve=>ve.constraints),{panelSize:G,pivotIndices:Y}=panelDataHelper(O,$,P);assert(G!=null,`Panel size not found for panel "${$.id}"`);const Z=findPanelDataIndex(O,$)===O.length-1?G-q:q-G,oe=adjustLayoutByDelta({delta:Z,initialLayout:P,panelConstraints:B,pivotIndices:Y,prevLayout:P,trigger:"imperative-api"});compareLayouts(P,oe)||(b(oe),L.current.layout=oe,V&&V(oe),callPanelCallbacks(O,oe,S.current))},[]),z=reactExports.useCallback(($,q)=>{const{layout:V,panelDataArray:P}=L.current,{collapsedSize:O=0,collapsible:B}=q,{collapsedSize:G=0,collapsible:Y,maxSize:J=100,minSize:Z=0}=$.constraints,{panelSize:oe}=panelDataHelper(P,$,V);oe!=null&&(B&&Y&&fuzzyNumbersEqual$1(oe,O)?fuzzyNumbersEqual$1(O,G)||Q($,G):oe<Z?Q($,Z):oe>J&&Q($,J))},[Q]),N=reactExports.useCallback(($,q)=>{const{direction:V}=R.current,{layout:P}=L.current;if(!v.current)return;const O=getResizeHandleElement($,v.current);assert(O,`Drag handle element not found for id "${$}"`);const B=getResizeEventCursorPosition(V,q);x({dragHandleId:$,dragHandleRect:O.getBoundingClientRect(),initialCursorPosition:B,initialLayout:P})},[]),k=reactExports.useCallback(()=>{x(null)},[]),I=reactExports.useCallback($=>{const{panelDataArray:q}=L.current,V=findPanelDataIndex(q,$);V>=0&&(q.splice(V,1),delete S.current[$.id],L.current.panelDataArrayChanged=!0,_())},[_]),D=reactExports.useMemo(()=>({collapsePanel:j,direction:n,dragState:g,expandPanel:F,getPanelSize:W,getPanelStyle:K,groupId:m,isPanelCollapsed:ee,isPanelExpanded:te,reevaluatePanelConstraints:z,registerPanel:re,registerResizeHandle:ie,resizePanel:Q,startDragging:N,stopDragging:k,unregisterPanel:I,panelGroupElement:v.current}),[j,g,n,F,W,K,m,ee,te,z,re,ie,Q,N,k,I]),U={display:"flex",flexDirection:n==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return reactExports.createElement(PanelGroupContext.Provider,{value:D},reactExports.createElement(u,{...f,children:e,className:t,id:o,ref:v,style:{...U,...d},[DATA_ATTRIBUTES.group]:"",[DATA_ATTRIBUTES.groupDirection]:n,[DATA_ATTRIBUTES.groupId]:m}))}const PanelGroup=reactExports.forwardRef((s,e)=>reactExports.createElement(PanelGroupWithForwardedRef,{...s,forwardedRef:e}));PanelGroupWithForwardedRef.displayName="PanelGroup";PanelGroup.displayName="forwardRef(PanelGroup)";function findPanelDataIndex(s,e){return s.findIndex(t=>t===e||t.id===e.id)}function panelDataHelper(s,e,t){const n=findPanelDataIndex(s,e),o=n===s.length-1?[n-1,n]:[n,n+1],a=t[n];return{...e.constraints,panelSize:a,pivotIndices:o}}function useWindowSplitterResizeHandlerBehavior({disabled:s,handleId:e,resizeHandler:t,panelGroupElement:n}){reactExports.useEffect(()=>{if(s||t==null||n==null)return;const i=getResizeHandleElement(e,n);if(i==null)return;const o=a=>{if(!a.defaultPrevented)switch(a.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{a.preventDefault(),t(a);break}case"F6":{a.preventDefault();const l=i.getAttribute(DATA_ATTRIBUTES.groupId);assert(l,`No group element found for id "${l}"`);const h=getResizeHandleElementsForGroup(l,n),d=getResizeHandleElementIndex(l,e,n);assert(d!==null,`No resize element found for id "${e}"`);const u=a.shiftKey?d>0?d-1:h.length-1:d+1<h.length?d+1:0;h[u].focus();break}}};return i.addEventListener("keydown",o),()=>{i.removeEventListener("keydown",o)}},[n,s,e,t])}function PanelResizeHandle({children:s=null,className:e="",disabled:t=!1,hitAreaMargins:n,id:i,onBlur:o,onClick:a,onDragging:l,onFocus:h,onPointerDown:d,onPointerUp:u,style:f={},tabIndex:m=0,tagName:v="div",...g}){var x,E;const b=reactExports.useRef(null),_=reactExports.useRef({onClick:a,onDragging:l,onPointerDown:d,onPointerUp:u});reactExports.useEffect(()=>{_.current.onClick=a,_.current.onDragging=l,_.current.onPointerDown=d,_.current.onPointerUp=u});const S=reactExports.useContext(PanelGroupContext);if(S===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:C,groupId:A,registerResizeHandle:R,startDragging:L,stopDragging:j,panelGroupElement:F}=S,W=useUniqueId(i),[K,ee]=reactExports.useState("inactive"),[te,re]=reactExports.useState(!1),[ie,Q]=reactExports.useState(null),z=reactExports.useRef({state:K});useIsomorphicLayoutEffect(()=>{z.current.state=K}),reactExports.useEffect(()=>{if(t)Q(null);else{const D=R(W);Q(()=>D)}},[t,W,R]);const N=(x=n?.coarse)!==null&&x!==void 0?x:15,k=(E=n?.fine)!==null&&E!==void 0?E:5;reactExports.useEffect(()=>{if(t||ie==null)return;const D=b.current;assert(D,"Element ref not attached");let U=!1;return registerResizeHandle(W,D,C,{coarse:N,fine:k},(q,V,P)=>{if(!V){ee("inactive");return}switch(q){case"down":{ee("drag"),U=!1,assert(P,'Expected event to be defined for "down" action'),L(W,P);const{onDragging:O,onPointerDown:B}=_.current;O?.(!0),B?.();break}case"move":{const{state:O}=z.current;U=!0,O!=="drag"&&ee("hover"),assert(P,'Expected event to be defined for "move" action'),ie(P);break}case"up":{ee("hover"),j();const{onClick:O,onDragging:B,onPointerUp:G}=_.current;B?.(!1),G?.(),U||O?.();break}}})},[N,C,t,k,R,W,ie,L,j]),useWindowSplitterResizeHandlerBehavior({disabled:t,handleId:W,resizeHandler:ie,panelGroupElement:F});const I={touchAction:"none",userSelect:"none"};return reactExports.createElement(v,{...g,children:s,className:e,id:i,onBlur:()=>{re(!1),o?.()},onFocus:()=>{re(!0),h?.()},ref:b,role:"separator",style:{...I,...f},tabIndex:m,[DATA_ATTRIBUTES.groupDirection]:C,[DATA_ATTRIBUTES.groupId]:A,[DATA_ATTRIBUTES.resizeHandle]:"",[DATA_ATTRIBUTES.resizeHandleActive]:K==="drag"?"pointer":te?"keyboard":void 0,[DATA_ATTRIBUTES.resizeHandleEnabled]:!t,[DATA_ATTRIBUTES.resizeHandleId]:W,[DATA_ATTRIBUTES.resizeHandleState]:K})}PanelResizeHandle.displayName="PanelResizeHandle";function ResizablePanelGroup({className:s,...e}){return jsxRuntimeExports.jsx(PanelGroup,{"data-slot":"resizable-panel-group",className:cn("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",s),...e})}function ResizablePanel({...s}){return jsxRuntimeExports.jsx(Panel,{"data-slot":"resizable-panel",...s})}function ResizableHandle({withHandle:s,className:e,...t}){return jsxRuntimeExports.jsx(PanelResizeHandle,{"data-slot":"resizable-handle",className:cn("bg-border focus-visible:ring-ring relative flex w-px items-center justify-center after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:ring-1 focus-visible:ring-offset-1 focus-visible:outline-hidden data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",e),...t,children:s&&jsxRuntimeExports.jsx("div",{className:"bg-border z-10 flex h-4 w-3 items-center justify-center rounded-xs border",children:jsxRuntimeExports.jsx(GripVertical,{className:"size-2.5"})})})}function Input({className:s,type:e,...t}){return jsxRuntimeExports.jsx("input",{type:e,"data-slot":"input",className:cn("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border px-3 py-1 text-base bg-input-background transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",s),...t})}var NAME="Label",Label$1=reactExports.forwardRef((s,e)=>jsxRuntimeExports.jsx(Primitive.label,{...s,ref:e,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(s.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));Label$1.displayName=NAME;var Root=Label$1;function Label({className:s,...e}){return jsxRuntimeExports.jsx(Root,{"data-slot":"label",className:cn("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",s),...e})}function Card({className:s,...e}){return jsxRuntimeExports.jsx("div",{"data-slot":"card",className:cn("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border",s),...e})}function CardHeader({className:s,...e}){return jsxRuntimeExports.jsx("div",{"data-slot":"card-header",className:cn("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 pt-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",s),...e})}function CardTitle({className:s,...e}){return jsxRuntimeExports.jsx("h4",{"data-slot":"card-title",className:cn("leading-none",s),...e})}function CardDescription({className:s,...e}){return jsxRuntimeExports.jsx("p",{"data-slot":"card-description",className:cn("text-muted-foreground",s),...e})}function CardContent({className:s,...e}){return jsxRuntimeExports.jsx("div",{"data-slot":"card-content",className:cn("px-6 [&:last-child]:pb-6",s),...e})}function LoginPage(){const[s,e]=reactExports.useState(!0),[t,n]=reactExports.useState(""),[i,o]=reactExports.useState(""),[a,l]=reactExports.useState(!1),[h,d]=reactExports.useState(""),{signIn:u,signUp:f}=useAuth(),m=async v=>{v.preventDefault(),d(""),l(!0);try{const g=s?await u(t,i):await f(t,i);g.success||d(g.error||"Authentication failed")}catch(g){d("An unexpected error occurred"),console.error("[Login]",g)}finally{l(!1)}};return jsxRuntimeExports.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-neutral-50 to-neutral-100 dark:from-neutral-950 dark:to-neutral-900 p-4",children:jsxRuntimeExports.jsxs(Card,{className:"w-full max-w-md",children:[jsxRuntimeExports.jsxs(CardHeader,{className:"space-y-3",children:[jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center",children:jsxRuntimeExports.jsx("div",{className:"bg-primary/10 p-3 rounded-full",children:jsxRuntimeExports.jsx(BookOpen,{className:"w-8 h-8 text-primary"})})}),jsxRuntimeExports.jsx(CardTitle,{className:"text-2xl text-center",children:s?"Welcome Back":"Create Account"}),jsxRuntimeExports.jsx(CardDescription,{className:"text-center",children:s?"Sign in to continue your learning journey":"Join to start reading with AI assistance"})]}),jsxRuntimeExports.jsx(CardContent,{children:jsxRuntimeExports.jsxs("form",{onSubmit:m,className:"space-y-4",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"email",children:"Email"}),jsxRuntimeExports.jsx(Input,{id:"email",type:"email",placeholder:"you@example.com",value:t,onChange:v=>n(v.target.value),required:!0,disabled:a})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-2",children:[jsxRuntimeExports.jsx(Label,{htmlFor:"password",children:"Password"}),jsxRuntimeExports.jsx(Input,{id:"password",type:"password",placeholder:"",value:i,onChange:v=>o(v.target.value),required:!0,disabled:a,minLength:6})]}),h&&jsxRuntimeExports.jsx("div",{className:"p-3 text-sm text-red-600 bg-red-50 dark:bg-red-950/30 border border-red-200 dark:border-red-900 rounded-md",children:h}),jsxRuntimeExports.jsx(Button,{type:"submit",className:"w-full",disabled:a,children:a?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(LoaderCircle,{className:"mr-2 h-4 w-4 animate-spin"}),s?"Signing in...":"Creating account..."]}):s?"Sign In":"Sign Up"}),jsxRuntimeExports.jsx("div",{className:"text-center text-sm",children:jsxRuntimeExports.jsx("button",{type:"button",onClick:()=>{e(!s),d("")},className:"text-primary hover:underline",disabled:a,children:s?"Don't have an account? Sign up":"Already have an account? Sign in"})}),!s&&jsxRuntimeExports.jsx("p",{className:"text-xs text-muted-foreground text-center mt-4",children:"Note: Only whitelisted emails can create accounts. Contact the administrator if you need access."})]})})]})})}function ProtectedRoute({children:s}){const{user:e,loading:t,isWhitelisted:n}=useAuth();return t?jsxRuntimeExports.jsx("div",{className:"min-h-screen flex items-center justify-center",children:jsxRuntimeExports.jsxs("div",{className:"text-center space-y-4",children:[jsxRuntimeExports.jsx(LoaderCircle,{className:"w-8 h-8 animate-spin mx-auto text-primary"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading..."})]})}):e?n?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{children:s}):jsxRuntimeExports.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:jsxRuntimeExports.jsxs("div",{className:"max-w-md text-center space-y-4",children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-bold",children:"Access Denied"}),jsxRuntimeExports.jsx("p",{className:"text-muted-foreground",children:"Your account is not authorized to use this application. Please contact the administrator for access."})]})}):jsxRuntimeExports.jsx(LoginPage,{})}function AppContent(){const[s,e]=reactExports.useState(null),t=reactExports.useRef(null),{nextPage:n,prevPage:i}=useTextbook(),{activeNote:o,updateNoteContent:a}=useNotes();reactExports.useEffect(()=>{const u=f=>{f.key==="j"&&!f.ctrlKey&&!f.metaKey?(f.preventDefault(),n()):f.key==="k"&&!f.ctrlKey&&!f.metaKey?(f.preventDefault(),i()):f.key==="n"&&!f.ctrlKey&&!f.metaKey?(f.preventDefault(),t.current?.querySelector("textarea")?.focus()):f.key==="r"&&!f.ctrlKey&&!f.metaKey&&(f.preventDefault(),console.log("Regenerate AI panel"))};return window.addEventListener("keydown",u),()=>window.removeEventListener("keydown",u)},[n,i]);const l=(u,f)=>{e({text:u,position:f})},h=()=>{e(null)},d=()=>{if(s?.text&&o){const u=o.content?`${o.content}

${s.text}`:s.text;a(u)}e(null)};return jsxRuntimeExports.jsxs("div",{className:"h-screen flex flex-col bg-background",children:[jsxRuntimeExports.jsx(MinimalHeader,{}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-hidden",children:jsxRuntimeExports.jsxs(ResizablePanelGroup,{direction:"horizontal",className:"h-full",children:[jsxRuntimeExports.jsx(ResizablePanel,{defaultSize:20,minSize:15,maxSize:30,children:jsxRuntimeExports.jsx("div",{ref:t,children:jsxRuntimeExports.jsx(NotesPanel,{})})}),jsxRuntimeExports.jsx(ResizableHandle,{className:"w-px bg-border hover:bg-accent transition-colors"}),jsxRuntimeExports.jsx(ResizablePanel,{defaultSize:50,minSize:35,children:jsxRuntimeExports.jsx(PDFReader,{onTextSelect:l})}),jsxRuntimeExports.jsx(ResizableHandle,{className:"w-px bg-border hover:bg-accent transition-colors"}),jsxRuntimeExports.jsx(ResizablePanel,{defaultSize:30,minSize:25,maxSize:40,children:jsxRuntimeExports.jsx(MinimalAIPane,{})})]})}),s&&jsxRuntimeExports.jsx(ExplainTooltip,{text:s.text,position:s.position,onClose:h,onAddToNotes:d})]})}function App(){return jsxRuntimeExports.jsx(ProtectedRoute,{children:jsxRuntimeExports.jsx(AppContent,{})})}const queryClient=new QueryClient({defaultOptions:{queries:{staleTime:1e3*60*5,retry:1,refetchOnWindowFocus:!1},mutations:{retry:1}}});clientExports.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(QueryClientProvider,{client:queryClient,children:jsxRuntimeExports.jsx(AuthProvider,{children:jsxRuntimeExports.jsx(TextbookProvider,{children:jsxRuntimeExports.jsx(NotesProvider,{children:jsxRuntimeExports.jsxs(ChatProvider,{children:[jsxRuntimeExports.jsx(App,{}),jsxRuntimeExports.jsx(Toaster,{position:"top-right"})]})})})})}));
